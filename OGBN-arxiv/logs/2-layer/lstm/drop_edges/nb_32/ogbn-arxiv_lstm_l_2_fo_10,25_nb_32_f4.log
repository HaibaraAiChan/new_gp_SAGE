[05:35:07] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28387380 edges into 32 parts and get 9176708 edge cuts
main start at this time 1651556085.9788554
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.032462358474731445
global_2_local spend time (sec) 0.03577089309692383
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0048296451568603516
A = g.adjacency_matrix() spent  0.007807016372680664
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07842445373535156
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2776763439178467
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1791927814483643

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366})
Convert a graph into a bidirected graph: 1.309 seconds
Metis partitioning: 5.485 seconds
Split the graph: 0.578 seconds
Construct subgraphs: 0.069 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.455657005310059
2897
2907
2836
2847
2786
2923
2922
2790
2880
2914
2885
2927
2920
2909
2872
2903
2861
2794
2925
2880
2786
2780
2758
2789
2767
2778
2758
2760
2758
2913
2758
2758
total k batches seeds list generation spend  18.080806016921997
after graph partition
graph partition algorithm spend time 18.1800274848938
2897
2907
2836
2847
2786
2923
2922
2790
2880
2914
2885
2927
2920
2909
2872
2903
2861
2794
2925
2880
2786
2780
2758
2789
2767
2778
2758
2760
2758
2913
2758
2758
partition_len_list
[5975, 6866, 6230, 5985, 8106, 7261, 7768, 7225, 5792, 6746, 6931, 9293, 7309, 5154, 5498, 6316, 7855, 7324, 8175, 6259, 12428, 9916, 15726, 12359, 13585, 13481, 18172, 18028, 18952, 17974, 16563, 17217]
shared_neighbor_graph_partition_s0 selection method  spend 18.268872022628784
time for parepare:  0.018099069595336914
local_output_nid generation:  0.0006861686706542969
local_in_edges_tensor generation:  0.0009465217590332031
mini_batch_src_global generation:  0.0010821819305419922
r_  generation:  0.007070779800415039
local_output_nid generation:  0.0007259845733642578
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0008435249328613281
r_  generation:  0.005767822265625
local_output_nid generation:  0.0007176399230957031
local_in_edges_tensor generation:  0.0007600784301757812
mini_batch_src_global generation:  0.0008733272552490234
r_  generation:  0.007250070571899414
local_output_nid generation:  0.0007264614105224609
local_in_edges_tensor generation:  0.0009386539459228516
mini_batch_src_global generation:  0.0007500648498535156
r_  generation:  0.006619930267333984
local_output_nid generation:  0.0007236003875732422
local_in_edges_tensor generation:  0.0006403923034667969
mini_batch_src_global generation:  0.0006227493286132812
r_  generation:  0.0068895816802978516
local_output_nid generation:  0.00078582763671875
local_in_edges_tensor generation:  0.0007522106170654297
mini_batch_src_global generation:  0.0007793903350830078
r_  generation:  0.007466554641723633
local_output_nid generation:  0.0007693767547607422
local_in_edges_tensor generation:  0.0007061958312988281
mini_batch_src_global generation:  0.0007898807525634766
r_  generation:  0.0071451663970947266
local_output_nid generation:  0.0007355213165283203
local_in_edges_tensor generation:  0.0006880760192871094
mini_batch_src_global generation:  0.0007491111755371094
r_  generation:  0.007077217102050781
local_output_nid generation:  0.0007603168487548828
local_in_edges_tensor generation:  0.0006737709045410156
mini_batch_src_global generation:  0.0006988048553466797
r_  generation:  0.006276845932006836
local_output_nid generation:  0.0007681846618652344
local_in_edges_tensor generation:  0.0006690025329589844
mini_batch_src_global generation:  0.0006866455078125
r_  generation:  0.00637054443359375
local_output_nid generation:  0.0007503032684326172
local_in_edges_tensor generation:  0.0007143020629882812
mini_batch_src_global generation:  0.0007839202880859375
r_  generation:  0.006785869598388672
local_output_nid generation:  0.000797271728515625
local_in_edges_tensor generation:  0.0007071495056152344
mini_batch_src_global generation:  0.00087738037109375
r_  generation:  0.007529497146606445
local_output_nid generation:  0.0007841587066650391
local_in_edges_tensor generation:  0.0006761550903320312
mini_batch_src_global generation:  0.0007524490356445312
r_  generation:  0.00625300407409668
local_output_nid generation:  0.0007846355438232422
local_in_edges_tensor generation:  0.0006499290466308594
mini_batch_src_global generation:  0.0005598068237304688
r_  generation:  0.005201816558837891
local_output_nid generation:  0.0007643699645996094
local_in_edges_tensor generation:  0.0006225109100341797
mini_batch_src_global generation:  0.0005311965942382812
r_  generation:  0.005068778991699219
local_output_nid generation:  0.0007622241973876953
local_in_edges_tensor generation:  0.0006570816040039062
mini_batch_src_global generation:  0.0006883144378662109
r_  generation:  0.00642704963684082
local_output_nid generation:  0.0007805824279785156
local_in_edges_tensor generation:  0.0007450580596923828
mini_batch_src_global generation:  0.000652313232421875
r_  generation:  0.00558018684387207
local_output_nid generation:  0.0007624626159667969
local_in_edges_tensor generation:  0.00063323974609375
mini_batch_src_global generation:  0.0006158351898193359
r_  generation:  0.005590200424194336
local_output_nid generation:  0.0007786750793457031
local_in_edges_tensor generation:  0.0006856918334960938
mini_batch_src_global generation:  0.0007290840148925781
r_  generation:  0.00682830810546875
local_output_nid generation:  0.0007936954498291016
local_in_edges_tensor generation:  0.0006558895111083984
mini_batch_src_global generation:  0.0006275177001953125
r_  generation:  0.005434751510620117
local_output_nid generation:  0.0007581710815429688
local_in_edges_tensor generation:  0.0006582736968994141
mini_batch_src_global generation:  0.0008182525634765625
r_  generation:  0.007061958312988281
local_output_nid generation:  0.0007531642913818359
local_in_edges_tensor generation:  0.0006310939788818359
mini_batch_src_global generation:  0.0006625652313232422
r_  generation:  0.0055196285247802734
local_output_nid generation:  0.0007569789886474609
local_in_edges_tensor generation:  0.0007064342498779297
mini_batch_src_global generation:  0.0010478496551513672
r_  generation:  0.009588479995727539
local_output_nid generation:  0.0007967948913574219
local_in_edges_tensor generation:  0.0007207393646240234
mini_batch_src_global generation:  0.0009489059448242188
r_  generation:  0.007544755935668945
local_output_nid generation:  0.0008111000061035156
local_in_edges_tensor generation:  0.0007071495056152344
mini_batch_src_global generation:  0.0008075237274169922
r_  generation:  0.0067174434661865234
local_output_nid generation:  0.0008082389831542969
local_in_edges_tensor generation:  0.005877494812011719
mini_batch_src_global generation:  0.000965118408203125
r_  generation:  0.0072689056396484375
local_output_nid generation:  0.0007758140563964844
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0011069774627685547
r_  generation:  0.008686304092407227
local_output_nid generation:  0.0008084774017333984
local_in_edges_tensor generation:  0.0007278919219970703
mini_batch_src_global generation:  0.0010879039764404297
r_  generation:  0.008808135986328125
local_output_nid generation:  0.0008270740509033203
local_in_edges_tensor generation:  0.0007264614105224609
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.009794473648071289
local_output_nid generation:  0.0008819103240966797
local_in_edges_tensor generation:  0.0008494853973388672
mini_batch_src_global generation:  0.0015878677368164062
r_  generation:  0.012564897537231445
local_output_nid generation:  0.0008935928344726562
local_in_edges_tensor generation:  0.0007278919219970703
mini_batch_src_global generation:  0.0012383460998535156
r_  generation:  0.00876474380493164
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.00070953369140625
mini_batch_src_global generation:  0.0010495185852050781
r_  generation:  0.008860349655151367
----------------------check_connections_block total spend ----------------------------- 0.3943967819213867
generate_one_block  0.011712312698364258
generate_one_block  0.008629798889160156
generate_one_block  0.010535001754760742
generate_one_block  0.00939798355102539
generate_one_block  0.00739288330078125
generate_one_block  0.010842561721801758
generate_one_block  0.010598897933959961
generate_one_block  0.01048588752746582
generate_one_block  0.008846759796142578
generate_one_block  0.009653806686401367
generate_one_block  0.009671926498413086
generate_one_block  0.011211872100830078
generate_one_block  0.008928775787353516
generate_one_block  0.00714421272277832
generate_one_block  0.007143259048461914
generate_one_block  0.008880376815795898
generate_one_block  0.00826120376586914
generate_one_block  0.008012771606445312
generate_one_block  0.010122060775756836
generate_one_block  0.007412910461425781
generate_one_block  0.010917425155639648
generate_one_block  0.00837254524230957
generate_one_block  0.015456438064575195
generate_one_block  0.01052236557006836
generate_one_block  0.010243654251098633
generate_one_block  0.010603904724121094
generate_one_block  0.01383662223815918
generate_one_block  0.01521611213684082
generate_one_block  0.015213727951049805
generate_one_block  0.017461538314819336
generate_one_block  0.014234066009521484
generate_one_block  0.014450550079345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06659078598022461
gen group dst list time:  0.009207725524902344
time for parepare:  0.022380352020263672
local_output_nid generation:  0.0012083053588867188
local_in_edges_tensor generation:  0.008736371994018555
mini_batch_src_global generation:  0.0014488697052001953
r_  generation:  0.013778924942016602
local_output_nid generation:  0.0017130374908447266
local_in_edges_tensor generation:  0.0017011165618896484
mini_batch_src_global generation:  0.0015628337860107422
r_  generation:  0.01409459114074707
local_output_nid generation:  0.0016069412231445312
local_in_edges_tensor generation:  0.001394510269165039
mini_batch_src_global generation:  0.0011866092681884766
r_  generation:  0.013875961303710938
local_output_nid generation:  0.0015108585357666016
local_in_edges_tensor generation:  0.001253366470336914
mini_batch_src_global generation:  0.0010218620300292969
r_  generation:  0.013129472732543945
local_output_nid generation:  0.0021529197692871094
local_in_edges_tensor generation:  0.0017685890197753906
mini_batch_src_global generation:  0.0021622180938720703
r_  generation:  0.01786947250366211
local_output_nid generation:  0.0017778873443603516
local_in_edges_tensor generation:  0.001844167709350586
mini_batch_src_global generation:  0.0016143321990966797
r_  generation:  0.016857385635375977
local_output_nid generation:  0.0018384456634521484
local_in_edges_tensor generation:  0.0015957355499267578
mini_batch_src_global generation:  0.0014369487762451172
r_  generation:  0.017658472061157227
local_output_nid generation:  0.0018460750579833984
local_in_edges_tensor generation:  0.001489877700805664
mini_batch_src_global generation:  0.0015292167663574219
r_  generation:  0.017015457153320312
local_output_nid generation:  0.001583099365234375
local_in_edges_tensor generation:  0.0013124942779541016
mini_batch_src_global generation:  0.0010716915130615234
r_  generation:  0.012285709381103516
local_output_nid generation:  0.001787424087524414
local_in_edges_tensor generation:  0.0014679431915283203
mini_batch_src_global generation:  0.001173257827758789
r_  generation:  0.014307737350463867
local_output_nid generation:  0.001844167709350586
local_in_edges_tensor generation:  0.0014357566833496094
mini_batch_src_global generation:  0.0013256072998046875
r_  generation:  0.0157926082611084
local_output_nid generation:  0.002295970916748047
local_in_edges_tensor generation:  0.0019075870513916016
mini_batch_src_global generation:  0.00191497802734375
r_  generation:  0.022922277450561523
local_output_nid generation:  0.0019330978393554688
local_in_edges_tensor generation:  0.0016567707061767578
mini_batch_src_global generation:  0.0015404224395751953
r_  generation:  0.01588273048400879
local_output_nid generation:  0.0013594627380371094
local_in_edges_tensor generation:  0.001154184341430664
mini_batch_src_global generation:  0.001140594482421875
r_  generation:  0.008794307708740234
local_output_nid generation:  0.0014564990997314453
local_in_edges_tensor generation:  0.001191854476928711
mini_batch_src_global generation:  0.0010325908660888672
r_  generation:  0.009752273559570312
local_output_nid generation:  0.0016252994537353516
local_in_edges_tensor generation:  0.0013091564178466797
mini_batch_src_global generation:  0.0010912418365478516
r_  generation:  0.012921571731567383
local_output_nid generation:  0.002032041549682617
local_in_edges_tensor generation:  0.0017018318176269531
mini_batch_src_global generation:  0.0011777877807617188
r_  generation:  0.016779661178588867
local_output_nid generation:  0.0018181800842285156
local_in_edges_tensor generation:  0.0015027523040771484
mini_batch_src_global generation:  0.0013794898986816406
r_  generation:  0.01603102684020996
local_output_nid generation:  0.0020635128021240234
local_in_edges_tensor generation:  0.0017466545104980469
mini_batch_src_global generation:  0.0015797615051269531
r_  generation:  0.018605470657348633
local_output_nid generation:  0.0016486644744873047
local_in_edges_tensor generation:  0.0013358592987060547
mini_batch_src_global generation:  0.0012764930725097656
r_  generation:  0.013267993927001953
local_output_nid generation:  0.0031280517578125
local_in_edges_tensor generation:  0.0030374526977539062
mini_batch_src_global generation:  0.002448558807373047
r_  generation:  0.03234243392944336
local_output_nid generation:  0.002577543258666992
local_in_edges_tensor generation:  0.0027985572814941406
mini_batch_src_global generation:  0.0025949478149414062
r_  generation:  0.024302244186401367
local_output_nid generation:  0.0038580894470214844
local_in_edges_tensor generation:  0.0046117305755615234
mini_batch_src_global generation:  0.0055255889892578125
r_  generation:  0.04512977600097656
local_output_nid generation:  0.003454923629760742
local_in_edges_tensor generation:  0.0032553672790527344
mini_batch_src_global generation:  0.003567218780517578
r_  generation:  0.032623291015625
local_output_nid generation:  0.003912687301635742
local_in_edges_tensor generation:  0.004449367523193359
mini_batch_src_global generation:  0.00431060791015625
r_  generation:  0.0376126766204834
local_output_nid generation:  0.0037326812744140625
local_in_edges_tensor generation:  0.003535747528076172
mini_batch_src_global generation:  0.0037941932678222656
r_  generation:  0.03669595718383789
local_output_nid generation:  0.00492548942565918
local_in_edges_tensor generation:  0.0069806575775146484
mini_batch_src_global generation:  0.005223274230957031
r_  generation:  0.055058956146240234
local_output_nid generation:  0.005083799362182617
local_in_edges_tensor generation:  0.006090879440307617
mini_batch_src_global generation:  0.006094217300415039
r_  generation:  0.054151296615600586
local_output_nid generation:  0.005146026611328125
local_in_edges_tensor generation:  0.007009029388427734
mini_batch_src_global generation:  0.008108139038085938
r_  generation:  0.06001138687133789
local_output_nid generation:  0.0049364566802978516
local_in_edges_tensor generation:  0.0044901371002197266
mini_batch_src_global generation:  0.006110668182373047
r_  generation:  0.05308413505554199
local_output_nid generation:  0.004662752151489258
local_in_edges_tensor generation:  0.004119157791137695
mini_batch_src_global generation:  0.0051610469818115234
r_  generation:  0.04709339141845703
local_output_nid generation:  0.004824161529541016
local_in_edges_tensor generation:  0.004247903823852539
mini_batch_src_global generation:  0.005255699157714844
r_  generation:  0.05234527587890625
----------------------check_connections_block total spend ----------------------------- 1.3103737831115723
generate_one_block  0.018970251083374023
generate_one_block  0.020081281661987305
generate_one_block  0.01902461051940918
generate_one_block  0.017639875411987305
generate_one_block  0.023378372192382812
generate_one_block  0.0227510929107666
generate_one_block  0.023480653762817383
generate_one_block  0.022808551788330078
generate_one_block  0.01605963706970215
generate_one_block  0.018961668014526367
generate_one_block  0.021457910537719727
generate_one_block  0.038156747817993164
generate_one_block  0.02217698097229004
generate_one_block  0.012398481369018555
generate_one_block  0.012978076934814453
generate_one_block  0.015594482421875
generate_one_block  0.025566577911376953
generate_one_block  0.021970033645629883
generate_one_block  0.028386831283569336
generate_one_block  0.017751693725585938
generate_one_block  0.04690861701965332
generate_one_block  0.03289961814880371
generate_one_block  0.06501007080078125
generate_one_block  0.04537701606750488
generate_one_block  0.05061006546020508
generate_one_block  0.04974007606506348
generate_one_block  0.07187032699584961
generate_one_block  0.07238459587097168
generate_one_block  0.07738566398620605
generate_one_block  0.07257699966430664
generate_one_block  0.06351089477539062
generate_one_block  0.08383846282958984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.3103737831115723
block generation total time  1.1517062187194824
average batch blocks generation time:  0.035990819334983826
pseudo mini batch 0 input nodes size: 12652
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.00881052017211914  GigaBytes
Max Memory Allocated: 0.00881052017211914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.008832454681396484  GigaBytes
Max Memory Allocated: 0.008832454681396484  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.008832454681396484  GigaBytes
Max Memory Allocated: 0.008832454681396484  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009331226348876953  GigaBytes
Max Memory Allocated: 0.009331226348876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009331226348876953  GigaBytes
Max Memory Allocated: 0.009331226348876953  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009331226348876953  GigaBytes
Max Memory Allocated: 0.009331226348876953  GigaBytes

torch.Size([12652, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.009331226348876953  GigaBytes
Max Memory Allocated: 0.009331226348876953  GigaBytes

m.shape torch.Size([343, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.030083656311035156  GigaBytes
Max Memory Allocated: 0.030541419982910156  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.030083656311035156  GigaBytes
Max Memory Allocated: 0.030541419982910156  GigaBytes

 h.shape torch.Size([1, 343, 128]), torch.Size([1, 343, 128])
----------------------------------------3
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.0304107666015625  GigaBytes
Max Memory Allocated: 0.030541419982910156  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.03302764892578125  GigaBytes
Max Memory Allocated: 0.03319120407104492  GigaBytes

rst.shape  torch.Size([1, 343, 128])
m.shape torch.Size([417, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.033261775970458984  GigaBytes
Max Memory Allocated: 0.03327178955078125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.033261775970458984  GigaBytes
Max Memory Allocated: 0.03327178955078125  GigaBytes

 h.shape torch.Size([1, 417, 128]), torch.Size([1, 417, 128])
----------------------------------------3
 Nvidia-smi: 1.2322998046875 GB
    Memory Allocated: 0.03365945816040039  GigaBytes
Max Memory Allocated: 0.03365945816040039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.039624691009521484  GigaBytes
Max Memory Allocated: 0.04002237319946289  GigaBytes

rst.shape  torch.Size([1, 417, 128])
m.shape torch.Size([432, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.04004383087158203  GigaBytes
Max Memory Allocated: 0.04005908966064453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.04004383087158203  GigaBytes
Max Memory Allocated: 0.04005908966064453  GigaBytes

 h.shape torch.Size([1, 432, 128]), torch.Size([1, 432, 128])
----------------------------------------3
 Nvidia-smi: 1.2381591796875 GB
    Memory Allocated: 0.04045581817626953  GigaBytes
Max Memory Allocated: 0.04045581817626953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.04951953887939453  GigaBytes
Max Memory Allocated: 0.05013751983642578  GigaBytes

rst.shape  torch.Size([1, 432, 128])
m.shape torch.Size([447, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.05016613006591797  GigaBytes
Max Memory Allocated: 0.0501861572265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.05016613006591797  GigaBytes
Max Memory Allocated: 0.0501861572265625  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 1.2498779296875 GB
    Memory Allocated: 0.05059242248535156  GigaBytes
Max Memory Allocated: 0.05059242248535156  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.06295490264892578  GigaBytes
Max Memory Allocated: 0.06380748748779297  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([408, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.06371450424194336  GigaBytes
Max Memory Allocated: 0.06380748748779297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.06371450424194336  GigaBytes
Max Memory Allocated: 0.06380748748779297  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.06410360336303711  GigaBytes
Max Memory Allocated: 0.06410360336303711  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.07811117172241211  GigaBytes
Max Memory Allocated: 0.07908391952514648  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([410, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.07935523986816406  GigaBytes
Max Memory Allocated: 0.07938337326049805  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.07935523986816406  GigaBytes
Max Memory Allocated: 0.07938337326049805  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.07974624633789062  GigaBytes
Max Memory Allocated: 0.07974624633789062  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.09655952453613281  GigaBytes
Max Memory Allocated: 0.0977325439453125  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([342, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.09750556945800781  GigaBytes
Max Memory Allocated: 0.0977325439453125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.09750556945800781  GigaBytes
Max Memory Allocated: 0.0977325439453125  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.09783172607421875  GigaBytes
Max Memory Allocated: 0.09783172607421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.11413955688476562  GigaBytes
Max Memory Allocated: 0.1152811050415039  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([316, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.11518192291259766  GigaBytes
Max Memory Allocated: 0.1152811050415039  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.11518192291259766  GigaBytes
Max Memory Allocated: 0.1152811050415039  GigaBytes

 h.shape torch.Size([1, 316, 128]), torch.Size([1, 316, 128])
----------------------------------------3
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.11548328399658203  GigaBytes
Max Memory Allocated: 0.11548328399658203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.1326608657836914  GigaBytes
Max Memory Allocated: 0.1338663101196289  GigaBytes

rst.shape  torch.Size([1, 316, 128])
m.shape torch.Size([244, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.13355731964111328  GigaBytes
Max Memory Allocated: 0.1338663101196289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.13355731964111328  GigaBytes
Max Memory Allocated: 0.1338663101196289  GigaBytes

 h.shape torch.Size([1, 244, 128]), torch.Size([1, 244, 128])
----------------------------------------3
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.1337900161743164  GigaBytes
Max Memory Allocated: 0.1338663101196289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3436279296875 GB
    Memory Allocated: 0.1486825942993164  GigaBytes
Max Memory Allocated: 0.14972972869873047  GigaBytes

rst.shape  torch.Size([1, 244, 128])
m.shape torch.Size([2616, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.1610403060913086  GigaBytes
Max Memory Allocated: 0.1613330841064453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.1610403060913086  GigaBytes
Max Memory Allocated: 0.1613330841064453  GigaBytes

 h.shape torch.Size([1, 2616, 128]), torch.Size([1, 2616, 128])
----------------------------------------3
 Nvidia-smi: 1.3572998046875 GB
    Memory Allocated: 0.16353511810302734  GigaBytes
Max Memory Allocated: 0.16353511810302734  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.34571266174316406  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

rst.shape  torch.Size([1, 2616, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.3271512985229492  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.33284950256347656  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.3385477066040039  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.33280467987060547  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

torch.Size([5975, 256])
first layer input nodes number: 12652
first layer output nodes number: 5975
edges number: 42039
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.33864402770996094  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.3443422317504883  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.3460555076599121  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.5662841796875 GB
    Memory Allocated: 0.3460555076599121  GigaBytes
Max Memory Allocated: 0.3581867218017578  GigaBytes

m.shape torch.Size([280, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.3702573776245117  GigaBytes
Max Memory Allocated: 0.37035369873046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.3702573776245117  GigaBytes
Max Memory Allocated: 0.37035369873046875  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.3707914352416992  GigaBytes
Max Memory Allocated: 0.3707914352416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3758974075317383  GigaBytes
Max Memory Allocated: 0.37616443634033203  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([295, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.37619781494140625  GigaBytes
Max Memory Allocated: 0.37620019912719727  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.37619781494140625  GigaBytes
Max Memory Allocated: 0.37620019912719727  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.37676048278808594  GigaBytes
Max Memory Allocated: 0.37676048278808594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.3853435516357422  GigaBytes
Max Memory Allocated: 0.3859062194824219  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([260, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.38581228256225586  GigaBytes
Max Memory Allocated: 0.3859062194824219  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.38581228256225586  GigaBytes
Max Memory Allocated: 0.3859062194824219  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.3863081932067871  GigaBytes
Max Memory Allocated: 0.3863081932067871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39843177795410156  GigaBytes
Max Memory Allocated: 0.39917564392089844  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([227, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39905691146850586  GigaBytes
Max Memory Allocated: 0.39917564392089844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39905691146850586  GigaBytes
Max Memory Allocated: 0.39917564392089844  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.3994898796081543  GigaBytes
Max Memory Allocated: 0.3994898796081543  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.412045955657959  GigaBytes
Max Memory Allocated: 0.41291189193725586  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.41291093826293945  GigaBytes
Max Memory Allocated: 0.4129152297973633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.41291093826293945  GigaBytes
Max Memory Allocated: 0.4129152297973633  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.41334009170532227  GigaBytes
Max Memory Allocated: 0.41334009170532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.4287896156311035  GigaBytes
Max Memory Allocated: 0.42986249923706055  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([214, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.4298095703125  GigaBytes
Max Memory Allocated: 0.42986249923706055  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.4298095703125  GigaBytes
Max Memory Allocated: 0.42986249923706055  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.4302177429199219  GigaBytes
Max Memory Allocated: 0.4302177429199219  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.4477691650390625  GigaBytes
Max Memory Allocated: 0.4489936828613281  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([166, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.4486823081970215  GigaBytes
Max Memory Allocated: 0.4489936828613281  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.4486823081970215  GigaBytes
Max Memory Allocated: 0.4489936828613281  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.44899892807006836  GigaBytes
Max Memory Allocated: 0.44899892807006836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.4648299217224121  GigaBytes
Max Memory Allocated: 0.46593809127807617  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([147, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.4658021926879883  GigaBytes
Max Memory Allocated: 0.46593809127807617  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.4658021926879883  GigaBytes
Max Memory Allocated: 0.46593809127807617  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.4660825729370117  GigaBytes
Max Memory Allocated: 0.4660825729370117  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.48206424713134766  GigaBytes
Max Memory Allocated: 0.4831857681274414  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.48279809951782227  GigaBytes
Max Memory Allocated: 0.4831857681274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.48279809951782227  GigaBytes
Max Memory Allocated: 0.4831857681274414  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.48299074172973633  GigaBytes
Max Memory Allocated: 0.4831857681274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.49531984329223633  GigaBytes
Max Memory Allocated: 0.4961867332458496  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([119, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.4963674545288086  GigaBytes
Max Memory Allocated: 0.4963722229003906  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.4963674545288086  GigaBytes
Max Memory Allocated: 0.4963722229003906  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.4965944290161133  GigaBytes
Max Memory Allocated: 0.4965944290161133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5127096176147461  GigaBytes
Max Memory Allocated: 0.5138444900512695  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([110, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5137591361999512  GigaBytes
Max Memory Allocated: 0.5138444900512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5137591361999512  GigaBytes
Max Memory Allocated: 0.5138444900512695  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.5139689445495605  GigaBytes
Max Memory Allocated: 0.5139689445495605  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.5303339958190918  GigaBytes
Max Memory Allocated: 0.5314879417419434  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5310134887695312  GigaBytes
Max Memory Allocated: 0.5314879417419434  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5310134887695312  GigaBytes
Max Memory Allocated: 0.5314879417419434  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5311431884765625  GigaBytes
Max Memory Allocated: 0.5314879417419434  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5421676635742188  GigaBytes
Max Memory Allocated: 0.5429458618164062  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5430278778076172  GigaBytes
Max Memory Allocated: 0.5430316925048828  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5430278778076172  GigaBytes
Max Memory Allocated: 0.5430316925048828  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5431690216064453  GigaBytes
Max Memory Allocated: 0.5431690216064453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5561542510986328  GigaBytes
Max Memory Allocated: 0.5570716857910156  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5570392608642578  GigaBytes
Max Memory Allocated: 0.5570716857910156  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5570392608642578  GigaBytes
Max Memory Allocated: 0.5570716857910156  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 1.7518310546875 GB
    Memory Allocated: 0.5571746826171875  GigaBytes
Max Memory Allocated: 0.5571746826171875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.5705814361572266  GigaBytes
Max Memory Allocated: 0.5715293884277344  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.5710763931274414  GigaBytes
Max Memory Allocated: 0.5715293884277344  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.5710763931274414  GigaBytes
Max Memory Allocated: 0.5715293884277344  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.5711507797241211  GigaBytes
Max Memory Allocated: 0.5715293884277344  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.579035758972168  GigaBytes
Max Memory Allocated: 0.5795936584472656  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.5797524452209473  GigaBytes
Max Memory Allocated: 0.5797557830810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.5797524452209473  GigaBytes
Max Memory Allocated: 0.5797557830810547  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.5798459053039551  GigaBytes
Max Memory Allocated: 0.5798459053039551  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5904068946838379  GigaBytes
Max Memory Allocated: 0.5911545753479004  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5912752151489258  GigaBytes
Max Memory Allocated: 0.5912790298461914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5912752151489258  GigaBytes
Max Memory Allocated: 0.5912790298461914  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.5913820266723633  GigaBytes
Max Memory Allocated: 0.5913820266723633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.6041994094848633  GigaBytes
Max Memory Allocated: 0.605107307434082  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.6047172546386719  GigaBytes
Max Memory Allocated: 0.605107307434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.6047172546386719  GigaBytes
Max Memory Allocated: 0.605107307434082  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.6047801971435547  GigaBytes
Max Memory Allocated: 0.605107307434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6127738952636719  GigaBytes
Max Memory Allocated: 0.6133403778076172  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6132540702819824  GigaBytes
Max Memory Allocated: 0.6133403778076172  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6132540702819824  GigaBytes
Max Memory Allocated: 0.6133403778076172  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.6133074760437012  GigaBytes
Max Memory Allocated: 0.6133403778076172  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6204638481140137  GigaBytes
Max Memory Allocated: 0.6209712028503418  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6211676597595215  GigaBytes
Max Memory Allocated: 0.6211705207824707  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6211676597595215  GigaBytes
Max Memory Allocated: 0.6211705207824707  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6212401390075684  GigaBytes
Max Memory Allocated: 0.6212401390075684  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.6314597129821777  GigaBytes
Max Memory Allocated: 0.6321845054626465  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.632049560546875  GigaBytes
Max Memory Allocated: 0.6321845054626465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.632049560546875  GigaBytes
Max Memory Allocated: 0.6321845054626465  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.6321086883544922  GigaBytes
Max Memory Allocated: 0.6321845054626465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6408596038818359  GigaBytes
Max Memory Allocated: 0.6414804458618164  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6413164138793945  GigaBytes
Max Memory Allocated: 0.6414804458618164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6413164138793945  GigaBytes
Max Memory Allocated: 0.6414804458618164  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 1.8338623046875 GB
    Memory Allocated: 0.6413602828979492  GigaBytes
Max Memory Allocated: 0.6414804458618164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6481599807739258  GigaBytes
Max Memory Allocated: 0.6486425399780273  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.648536205291748  GigaBytes
Max Memory Allocated: 0.6486425399780273  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.648536205291748  GigaBytes
Max Memory Allocated: 0.6486425399780273  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.6485705375671387  GigaBytes
Max Memory Allocated: 0.6486425399780273  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.6541323661804199  GigaBytes
Max Memory Allocated: 0.6545271873474121  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.6546459197998047  GigaBytes
Max Memory Allocated: 0.6546483039855957  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.6546459197998047  GigaBytes
Max Memory Allocated: 0.6546483039855957  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.6546897888183594  GigaBytes
Max Memory Allocated: 0.6546897888183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.6621036529541016  GigaBytes
Max Memory Allocated: 0.6626300811767578  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([202, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.6669354438781738  GigaBytes
Max Memory Allocated: 0.666954517364502  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.6669354438781738  GigaBytes
Max Memory Allocated: 0.666954517364502  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.667320728302002  GigaBytes
Max Memory Allocated: 0.667320728302002  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.735130786895752  GigaBytes
Max Memory Allocated: 0.7399468421936035  GigaBytes

rst.shape  torch.Size([1, 202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.7140083312988281  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7144403457641602  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7148723602294922  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7144184112548828  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

torch.Size([2897, 40])
input nodes number: 5975
output nodes number: 2897
edges number: 24766
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7149171829223633  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7149181365966797  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.013484954833984375  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

pseudo mini batch 1 input nodes size: 16303
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.01204061508178711  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.01204061508178711  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.019814491271972656  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.01983642578125  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.013781547546386719  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.014230728149414062  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.014230728149414062  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.014230728149414062  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

torch.Size([16303, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.014230728149414062  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

m.shape torch.Size([774, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.03490304946899414  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.03490304946899414  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 774, 128]), torch.Size([1, 774, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.03564119338989258  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.0418238639831543  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 774, 128])
m.shape torch.Size([777, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.042195796966552734  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.042195796966552734  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 777, 128]), torch.Size([1, 777, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.04293680191040039  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.05415678024291992  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 777, 128])
m.shape torch.Size([679, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.05475759506225586  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.05475759506225586  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 679, 128]), torch.Size([1, 679, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.0554051399230957  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.07018518447875977  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 679, 128])
m.shape torch.Size([573, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.0711512565612793  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.0711512565612793  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.07169771194458008  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.08810186386108398  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([466, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.08893966674804688  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.08893966674804688  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.08938407897949219  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.10538291931152344  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([406, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.1063222885131836  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.1063222885131836  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.10670948028564453  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.12335872650146484  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.12435674667358398  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.12435674667358398  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.12469720840454102  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.14172029495239258  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([319, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.14276695251464844  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.14276695251464844  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.14307117462158203  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.16041183471679688  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([246, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.1613154411315918  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.1613154411315918  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 246, 128]), torch.Size([1, 246, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.16155004501342773  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.17656469345092773  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 246, 128])
m.shape torch.Size([2269, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.18726682662963867  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.18726682662963867  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 2269, 128]), torch.Size([1, 2269, 128])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.19024181365966797  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.3442716598510742  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 2269, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.3265981674194336  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.3331460952758789  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.3396940231323242  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.33309459686279297  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

torch.Size([6866, 256])
first layer input nodes number: 16303
first layer output nodes number: 6866
edges number: 41378
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.33981752395629883  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.34636545181274414  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.34800243377685547  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.34800243377685547  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

m.shape torch.Size([547, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.36667299270629883  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.36667299270629883  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.36771631240844727  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.37627363204956055  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([448, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.37661314010620117  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.37661314010620117  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.37746763229370117  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.39028501510620117  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([337, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.39082956314086914  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.39082956314086914  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.39147233963012695  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.40601062774658203  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4067854881286621  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4067854881286621  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4072909355163574  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.42290258407592773  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4235677719116211  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4235677719116211  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4239320755004883  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.43704700469970703  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4378166198730469  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4378166198730469  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.43813133239746094  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4516639709472656  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4523277282714844  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4523277282714844  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4525604248046875  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.46419525146484375  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.46489429473876953  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.46489429473876953  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.46509647369384766  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4766206741333008  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4772377014160156  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.4772377014160156  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.47739601135253906  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.48752784729003906  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.48819875717163086  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.48819875717163086  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.48834753036499023  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.49891042709350586  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.49956560134887695  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.49956560134887695  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.499697208404541  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5099625587463379  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5104851722717285  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5104851722717285  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.510582447052002  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5188508033752441  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5193395614624023  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5193395614624023  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5194215774536133  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5269670486450195  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5275049209594727  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5275049209594727  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5275869369506836  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5357065200805664  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5361413955688477  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5361413955688477  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5362043380737305  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5428762435913086  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5434756278991699  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5434756278991699  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5435538291931152  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5523905754089355  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.552711009979248  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.552711009979248  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5527529716491699  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5577883720397949  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5582866668701172  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5582866668701172  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5583438873291016  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5656108856201172  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5658745765686035  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5658745765686035  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5659050941467285  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5699944496154785  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5704598426818848  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5704598426818848  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5705075263977051  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5772309303283691  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5775303840637207  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5775303840637207  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5775609016418457  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5820775032043457  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5823798179626465  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5823798179626465  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5824084281921387  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5868430137634277  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5870718955993652  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5870718955993652  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5870928764343262  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.590491771697998  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.590827465057373  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.590827465057373  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5908560752868652  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5956912040710449  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([135, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5989208221435547  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5989208221435547  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5991783142089844  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6444969177246094  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 135, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6291909217834473  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6296243667602539  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6300578117370605  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6296024322509766  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

torch.Size([2907, 40])
input nodes number: 6866
output nodes number: 2907
edges number: 18743
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6296772956848145  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6296777725219727  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.01513051986694336  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

pseudo mini batch 2 input nodes size: 13759
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.013782978057861328  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.013782978057861328  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.020343780517578125  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.020365238189697266  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.012569427490234375  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.013070106506347656  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.013070106506347656  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.013070106506347656  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

torch.Size([13759, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.013070106506347656  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

m.shape torch.Size([494, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.033670902252197266  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.033670902252197266  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 494, 128]), torch.Size([1, 494, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.03414201736450195  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.03791093826293945  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 494, 128])
m.shape torch.Size([579, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.03822755813598633  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.03822755813598633  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.03877973556518555  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.04762887954711914  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([515, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.04808950424194336  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.04808950424194336  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.04858064651489258  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.05999279022216797  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([490, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.060681819915771484  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.060681819915771484  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.06114912033081055  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.07470083236694336  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([387, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.07538986206054688  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.07538986206054688  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 387, 128]), torch.Size([1, 387, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.0757589340209961  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.08904552459716797  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 387, 128])
m.shape torch.Size([352, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.08986806869506836  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.08986806869506836  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.09020376205444336  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.10463857650756836  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([326, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.10555887222290039  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.10555887222290039  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.10586977005004883  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.1214146614074707  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([272, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.12229681015014648  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.12229681015014648  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.12255620956420898  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.13734197616577148  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 272, 128])
m.shape torch.Size([260, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.13832807540893555  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.13832807540893555  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.13857603073120117  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.15444517135620117  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([2555, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.1665043830871582  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.1665043830871582  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 2555, 128]), torch.Size([1, 2555, 128])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.16928768157958984  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3426322937011719  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 2555, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.32440805435180664  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3312220573425293  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.33716344833374023  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.33030271530151367  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

torch.Size([6230, 256])
first layer input nodes number: 13759
first layer output nodes number: 6230
edges number: 41552
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.336395263671875  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.34320926666259766  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3438553810119629  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3438553810119629  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

m.shape torch.Size([353, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3688821792602539  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3688821792602539  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3695554733276367  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.37540769577026367  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([359, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3757615089416504  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3757615089416504  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3764462471008301  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3867173194885254  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3871421813964844  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3871421813964844  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.3876495361328125  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.39940404891967773  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.40004634857177734  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.40004634857177734  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.40049076080322266  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4133787155151367  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([162, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.41393518447875977  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.41393518447875977  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4142441749572754  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4253678321838379  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([131, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.42596912384033203  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.42596912384033203  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.42621898651123047  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4369630813598633  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.43770647048950195  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.43770647048950195  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.43795251846313477  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4502549171447754  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4510011672973633  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4510011672973633  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4512166976928711  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4635019302368164  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4643373489379883  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4643373489379883  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.46454524993896484  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.47785091400146484  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.47850656509399414  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.47850656509399414  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.47865724563598633  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.48935556411743164  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4899783134460449  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4899783134460449  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.49010419845581055  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.4999232292175293  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5007600784301758  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5007600784301758  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5009088516235352  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.513554573059082  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5140800476074219  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5140800476074219  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5141716003417969  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5225944519042969  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5231680870056152  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5231680870056152  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5232558250427246  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5319418907165527  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5324749946594238  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5324749946594238  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5325512886047363  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5406384468078613  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5411081314086914  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5411081314086914  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5411710739135742  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.548283576965332  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.549004077911377  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.549004077911377  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5490918159484863  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5596203804016113  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5602512359619141  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5602512359619141  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5603256225585938  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5697727203369141  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5703930854797363  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5703930854797363  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5704617500305176  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5796627998352051  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5801286697387695  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5801286697387695  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5801782608032227  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5871706008911133  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5878119468688965  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5878119468688965  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5878748893737793  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5971903800964355  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5975608825683594  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5975608825683594  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.5975971221923828  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6032142639160156  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6038374900817871  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6038374900817871  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6038928031921387  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6128535270690918  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6133103370666504  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6133103370666504  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6133503913879395  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.620119571685791  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([342, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6283173561096191  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.6283173561096191  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.628969669342041  GigaBytes
Max Memory Allocated: 0.7432332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.746950626373291  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 342, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.724886417388916  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.7253093719482422  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.7257323265075684  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.725287914276123  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([2836, 40])
input nodes number: 6230
output nodes number: 2836
edges number: 25553
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.7253456115722656  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.7253460884094238  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.014026165008544922  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

pseudo mini batch 3 input nodes size: 12973
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.012558937072753906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.012558937072753906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.01967000961303711  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.01969146728515625  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.013109207153320312  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.013566970825195312  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.013566970825195312  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.013566970825195312  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([12973, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.013566970825195312  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

m.shape torch.Size([496, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.03385591506958008  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.03385591506958008  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.03432893753051758  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.03811311721801758  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([535, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.03838682174682617  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.03838682174682617  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.038897037506103516  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.046988487243652344  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([548, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.04751729965209961  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.04751729965209961  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.048039913177490234  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.059537410736083984  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([487, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.06020498275756836  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.06020498275756836  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.0606694221496582  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.07413816452026367  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([393, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.07484292984008789  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.07484292984008789  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.07521772384643555  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.08871030807495117  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 393, 128])
m.shape torch.Size([381, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.08961296081542969  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.08961296081542969  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.08997631072998047  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.10560035705566406  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([331, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.10652351379394531  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.10652351379394531  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 331, 128]), torch.Size([1, 331, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.10683917999267578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.12262248992919922  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 331, 128])
m.shape torch.Size([313, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.12453460693359375  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.12453460693359375  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1248331069946289  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1418476104736328  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([293, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14295578002929688  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.14295578002929688  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 293, 128]), torch.Size([1, 293, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1432352066040039  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1611185073852539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 293, 128])
m.shape torch.Size([2208, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1715073585510254  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1715073585510254  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 2208, 128]), torch.Size([1, 2208, 128])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.1736130714416504  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.32755279541015625  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 2208, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3097043037414551  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3154120445251465  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3211197853088379  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3153672218322754  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([5985, 256])
first layer input nodes number: 12973
first layer output nodes number: 5985
edges number: 38947
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.32121849060058594  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.32692623138427734  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.32842016220092773  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.32842016220092773  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

m.shape torch.Size([350, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3505373001098633  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3505373001098633  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.35120487213134766  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3565831184387207  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([310, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3568453788757324  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3568453788757324  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3574366569519043  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.36634206771850586  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3668942451477051  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3668942451477051  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.36745500564575195  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3797917366027832  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3805227279663086  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3805227279663086  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3810243606567383  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.39611244201660156  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3968520164489746  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3968520164489746  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.397244930267334  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4113898277282715  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4121394157409668  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4121394157409668  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.41245222091674805  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4259028434753418  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.42674922943115234  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.42674922943115234  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4270334243774414  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.44124317169189453  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([135, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4421391487121582  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4421391487121582  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4423966407775879  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4570736885070801  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([134, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.45810413360595703  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.45810413360595703  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4583597183227539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4747171401977539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.47537755966186523  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.47537755966186523  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.47553396224975586  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.48663854598999023  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([96, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4875755310058594  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4875755310058594  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.4877586364746094  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5020408630371094  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([88, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5029644966125488  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5029644966125488  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5031323432922363  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5173993110656738  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5182027816772461  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5182027816772461  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5183382034301758  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.530797004699707  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5313754081726074  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5313754081726074  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5314669609069824  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5405306816101074  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5411338806152344  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5411338806152344  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5412197113037109  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5503177642822266  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5508747100830078  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5508747100830078  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5509490966796875  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5593547821044922  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5599222183227539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5599222183227539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.559992790222168  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5684614181518555  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5690145492553711  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5690145492553711  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5690793991088867  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5773153305053711  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.577812671661377  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.577812671661377  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5778679847717285  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5852799415588379  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5857906341552734  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5857906341552734  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5858440399169922  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5933742523193359  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5937314033508301  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5937314033508301  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5937676429748535  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5991311073303223  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5995573997497559  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5995573997497559  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5995974540710449  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6058058738708496  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6061840057373047  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6061840057373047  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6062183380126953  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6117801666259766  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.612062931060791  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.612062931060791  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6120877265930176  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6162781715393066  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([174, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6204466819763184  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6204466819763184  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6207785606384277  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6791892051696777  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 174, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6601786613464355  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6606030464172363  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6610274314880371  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6605815887451172  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([2847, 40])
input nodes number: 5985
output nodes number: 2847
edges number: 22362
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.660649299621582  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6606497764587402  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.014456748962402344  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

pseudo mini batch 4 input nodes size: 23211
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.013110637664794922  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.013110637664794922  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.024178504943847656  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.024199485778808594  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.01706695556640625  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.01754474639892578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.01754474639892578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.01754474639892578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([23211, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.01754474639892578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

m.shape torch.Size([928, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.041985511779785156  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.041985511779785156  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 928, 128]), torch.Size([1, 928, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.042870521545410156  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.05108308792114258  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 928, 128])
m.shape torch.Size([942, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.051538944244384766  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.051538944244384766  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.05243730545043945  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.06591272354125977  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([813, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.06662654876708984  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.06662654876708984  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.06740188598632812  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.08445930480957031  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([663, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.08533620834350586  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.08533620834350586  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 663, 128]), torch.Size([1, 663, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.0859684944152832  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.10492324829101562  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 663, 128])
m.shape torch.Size([533, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.10587787628173828  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.10587787628173828  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.10638618469238281  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.1253218650817871  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([476, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.12642955780029297  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.12642955780029297  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.12688350677490234  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.14640331268310547  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([366, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.1473979949951172  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.1473979949951172  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 366, 128]), torch.Size([1, 366, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.14774703979492188  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.16519927978515625  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 366, 128])
m.shape torch.Size([324, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.1662607192993164  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.1662607192993164  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 324, 128]), torch.Size([1, 324, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.16656970977783203  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.18418216705322266  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 324, 128])
m.shape torch.Size([278, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.18522071838378906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.18522071838378906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 278, 128]), torch.Size([1, 278, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.18548583984375  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.20245361328125  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 278, 128])
m.shape torch.Size([2783, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.2155914306640625  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.2155914306640625  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 2783, 128]), torch.Size([1, 2783, 128])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.2182455062866211  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4162731170654297  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 2783, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.39532995223999023  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4030604362487793  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.41079092025756836  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4029998779296875  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([8106, 256])
first layer input nodes number: 23211
first layer output nodes number: 8106
edges number: 48910
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4109659194946289  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.41869640350341797  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4208340644836426  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4208340644836426  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

m.shape torch.Size([624, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.436002254486084  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.436002254486084  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.437192440032959  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4474506378173828  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([485, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4477882385253906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4477882385253906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4487133026123047  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4629192352294922  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([386, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4637284278869629  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4637284278869629  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4644646644592285  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4815363883972168  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4821486473083496  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4821486473083496  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4826350212097168  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.49673986434936523  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4974098205566406  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.4974098205566406  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.497772216796875  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5108184814453125  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5114908218383789  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5114908218383789  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5117731094360352  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5239114761352539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5244431495666504  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5244431495666504  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5246338844299316  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5341706275939941  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5346598625183105  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5346598625183105  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5348048210144043  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.543067455291748  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5435748100280762  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5435748100280762  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5437026023864746  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5518813133239746  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([57, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5523653030395508  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5523653030395508  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5524740219116211  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5601930618286133  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([42, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5605831146240234  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5605831146240234  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5606632232666016  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5669116973876953  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5674715042114258  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5674715042114258  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.567570686340332  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5760011672973633  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5764517784118652  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5764517784118652  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5765280723571777  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5835471153259277  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5839262008666992  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5839262008666992  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5839853286743164  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.589838981628418  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5901412963867188  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5901412963867188  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5901851654052734  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5948352813720703  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.595090389251709  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.595090389251709  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5951247215270996  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5990042686462402  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5992488861083984  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5992488861083984  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.5992794036865234  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6029415130615234  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6032896041870117  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6032896041870117  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6033296585083008  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6084165573120117  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6086888313293457  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6086888313293457  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6087193489074707  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6128087043762207  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6130051612854004  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6130051612854004  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6130261421203613  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6159844398498535  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6163172721862793  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6163172721862793  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6163496971130371  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6211485862731934  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6212382316589355  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6212382316589355  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6212477684020996  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6227259635925293  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6229205131530762  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6229205131530762  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6229376792907715  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6257185935974121  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6259641647338867  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6259641647338867  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6259851455688477  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6295309066772461  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([86, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.631587028503418  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.631587028503418  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6317510604858398  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6606206893920898  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 86, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6487922668457031  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.649207592010498  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.649622917175293  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6491866111755371  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([2786, 40])
input nodes number: 8106
output nodes number: 2786
edges number: 15026
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.649259090423584  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.0584716796875 GB
    Memory Allocated: 0.6492595672607422  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.018512725830078125  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

pseudo mini batch 5 input nodes size: 15807
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.01705789566040039  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.01705789566040039  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.024595260620117188  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.02461719512939453  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.01352834701538086  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.014095783233642578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.014095783233642578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.014095783233642578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([15807, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.014095783233642578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

m.shape torch.Size([510, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.038936614990234375  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.038936614990234375  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.03942298889160156  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.04331398010253906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([542, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.043587684631347656  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.043587684631347656  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.044104576110839844  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.053235530853271484  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([570, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.053792476654052734  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.053792476654052734  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.0543360710144043  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.06629514694213867  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([522, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.06701898574829102  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.06701898574829102  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 522, 128]), torch.Size([1, 522, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.06751680374145508  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.08285379409790039  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 522, 128])
m.shape torch.Size([496, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.08378744125366211  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.08378744125366211  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.08426046371459961  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.10128927230834961  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([425, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.10226869583129883  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.10226869583129883  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.10267400741577148  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.1201024055480957  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([388, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.12119483947753906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.12119483947753906  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.12156486511230469  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.14006614685058594  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([353, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.14185619354248047  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.14185619354248047  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 353, 128]), torch.Size([1, 353, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.14219284057617188  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.16138172149658203  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 353, 128])
m.shape torch.Size([296, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.16248369216918945  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.16248369216918945  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 296, 128]), torch.Size([1, 296, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.1627659797668457  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.1808323860168457  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 296, 128])
m.shape torch.Size([3159, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.1957545280456543  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.1957545280456543  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 3159, 128]), torch.Size([1, 3159, 128])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.19895219802856445  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.41285085678100586  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 3159, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.3907198905944824  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.3976445198059082  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.404569149017334  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.39759016036987305  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

torch.Size([7261, 256])
first layer input nodes number: 15807
first layer output nodes number: 7261
edges number: 50216
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.40468883514404297  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.41161346435546875  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4138331413269043  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4138331413269043  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

m.shape torch.Size([343, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.43987417221069336  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.43987417221069336  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.44052839279174805  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.44620275497436523  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([271, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4463968276977539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4463968276977539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4469137191772461  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4571962356567383  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4577770233154297  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4577770233154297  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4583320617675781  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.471921443939209  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4725475311279297  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4725475311279297  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4729957580566406  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.4859943389892578  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.48702001571655273  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.48702001571655273  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.487424373626709  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.501981258392334  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5027365684509277  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5027365684509277  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5030531883239746  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5166678428649902  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([153, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5175390243530273  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5175390243530273  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5178308486938477  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5324220657348633  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5331606864929199  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5331606864929199  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5333800315856934  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5458827018737793  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.546724796295166  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.546724796295166  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5469346046447754  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5603623390197754  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([111, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5613245964050293  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5613245964050293  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5615363121032715  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5765681266784668  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([93, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5774455070495605  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5774455070495605  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5776228904724121  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.591458797454834  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5922355651855469  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5922355651855469  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5923786163330078  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6045379638671875  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([69, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6053290367126465  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6053290367126465  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6054606437683105  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6175684928894043  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6182432174682617  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6182432174682617  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6183481216430664  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6287336349487305  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6294889450073242  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6294889450073242  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6295957565307617  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6409177780151367  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6415872573852539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6415872573852539  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6416769027709961  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6518068313598633  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6525139808654785  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6525139808654785  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6526017189025879  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6631302833557129  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6636748313903809  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6636748313903809  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6637396812438965  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6719756126403809  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6725826263427734  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6725826263427734  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6726493835449219  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6815948486328125  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6822342872619629  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6822342872619629  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6823010444641113  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.691713809967041  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6923670768737793  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6923670768737793  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6924319267272949  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7020297050476074  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7024416923522949  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7024416923522949  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.702481746673584  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7086901664733887  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7090020179748535  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7090020179748535  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7090306282043457  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7136654853820801  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7141590118408203  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7141590118408203  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7142009735107422  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7212924957275391  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([279, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7279753684997559  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7279753684997559  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7285075187683105  GigaBytes
Max Memory Allocated: 0.7551045417785645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.824195384979248  GigaBytes
Max Memory Allocated: 0.8308472633361816  GigaBytes

rst.shape  torch.Size([1, 279, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.8012533187866211  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.8016891479492188  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.8021249771118164  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.8016672134399414  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([2923, 40])
input nodes number: 7261
output nodes number: 2923
edges number: 25810
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.8017640113830566  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.8017644882202148  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.01519012451171875  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

pseudo mini batch 6 input nodes size: 16063
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.013548851013183594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.013548851013183594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.02120828628540039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.021230220794677734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.013670921325683594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.014245986938476562  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.014245986938476562  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.014245986938476562  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([16063, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.014245986938476562  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([570, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.040596961975097656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.040596961975097656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04114055633544922  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04548931121826172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([616, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04580497741699219  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04580497741699219  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04639244079589844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.055605411529541016  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([622, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05620145797729492  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05620145797729492  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05679464340209961  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07051229476928711  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([582, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07132577896118164  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07132577896118164  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07188081741333008  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08797693252563477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([567, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0890512466430664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0890512466430664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08959197998046875  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.10987710952758789  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([483, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.11098861694335938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.11098861694335938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 483, 128]), torch.Size([1, 483, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1114492416381836  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.131256103515625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 483, 128])
m.shape torch.Size([425, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1324443817138672  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1324443817138672  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13284969329833984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.15311527252197266  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([377, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.15435075759887695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.15435075759887695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1547102928161621  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.17520380020141602  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([311, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.17635869979858398  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.17635869979858398  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 311, 128]), torch.Size([1, 311, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.17665529251098633  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.19563722610473633  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 311, 128])
m.shape torch.Size([3215, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.21081924438476562  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.21081924438476562  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 3215, 128]), torch.Size([1, 3215, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.21388530731201172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4321880340576172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 3215, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.40881824493408203  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4162263870239258  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42363452911376953  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.416168212890625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([7768, 256])
first layer input nodes number: 16063
first layer output nodes number: 7768
edges number: 52669
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42375612258911133  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4311642646789551  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.433016300201416  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.433016300201416  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([363, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45691633224487305  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45691633224487305  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.457608699798584  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.46437978744506836  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([325, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4646587371826172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4646587371826172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.46527862548828125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47542762756347656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47597408294677734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47597408294677734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47654056549072266  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.48902034759521484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4896678924560547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4896678924560547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4901294708251953  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5035152435302734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5043344497680664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5043344497680664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5047502517700195  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.519719123840332  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([181, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5206542015075684  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5206542015075684  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5209994316101074  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5358443260192871  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5366272926330566  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5366272926330566  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.536898136138916  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5504403114318848  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5512275695800781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5512275695800781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5514564514160156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5645027160644531  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([126, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5655317306518555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5655317306518555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5657720565795898  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5811529159545898  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.581974983215332  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.581974983215332  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5821619033813477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.595433235168457  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5960803031921387  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5960803031921387  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5962138175964355  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6066279411315918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6073570251464844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6073570251464844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6074886322021484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6186752319335938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6193094253540039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6193094253540039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6194162368774414  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6292428970336914  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6299700736999512  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6299700736999512  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6300806999206543  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6410326957702637  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6416406631469727  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6416406631469727  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.641728401184082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6510286331176758  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6514310836791992  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6514310836791992  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6514863967895508  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6577367782592773  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6583957672119141  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6583957672119141  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6584758758544922  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6680889129638672  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.668602466583252  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.668602466583252  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.668663501739502  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.676414966583252  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6768231391906738  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6768231391906738  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6768689155578613  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6830029487609863  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6836915016174316  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6836915016174316  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6837620735168457  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6937127113342285  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6941618919372559  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6941618919372559  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6942076683044434  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7009825706481934  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7013192176818848  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7013192176818848  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7013516426086426  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7063775062561035  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7068037986755371  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7068037986755371  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7068419456481934  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7130217552185059  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7132797241210938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7132797241210938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7133026123046875  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7171707153320312  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([274, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7237434387207031  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7237434387207031  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7242660522460938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.8179092407226562  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 274, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7971205711364746  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7975564002990723  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7979922294616699  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7975344657897949  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([2922, 40])
input nodes number: 7768
output nodes number: 2922
edges number: 24370
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.797614574432373  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7976150512695312  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.015330314636230469  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

pseudo mini batch 7 input nodes size: 15030
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013670921325683594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013670921325683594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.020837783813476562  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0208587646484375  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01317739486694336  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013745784759521484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013745784759521484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013745784759521484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([15030, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013745784759521484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([460, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04002237319946289  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04002237319946289  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.040461063385009766  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.043970584869384766  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([521, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.044248104095458984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.044248104095458984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04474496841430664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05274057388305664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([516, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05323028564453125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05323028564453125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.053722381591796875  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06454849243164062  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([450, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06516075134277344  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06516075134277344  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06558990478515625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07803535461425781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([451, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07889604568481445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07889604568481445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07932615280151367  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09481000900268555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([371, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0956563949584961  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0956563949584961  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09601020812988281  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.11122417449951172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([363, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1122589111328125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1122589111328125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.11260509490966797  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1299142837524414  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([328, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13120698928833008  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13120698928833008  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 328, 128]), torch.Size([1, 328, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13151979446411133  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14934968948364258  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 328, 128])
m.shape torch.Size([281, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.15039920806884766  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.15039920806884766  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1506671905517578  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1678180694580078  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 281, 128])
m.shape torch.Size([3484, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1842970848083496  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1842970848083496  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 3484, 128]), torch.Size([1, 3484, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.18761968612670898  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4235243797302246  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 3484, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.39977312088012695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4066634178161621  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41355371475219727  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.40660953521728516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([7225, 256])
first layer input nodes number: 15030
first layer output nodes number: 7225
edges number: 51865
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4136676788330078  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42055797576904297  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42228078842163086  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42228078842163086  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([347, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44611120223999023  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44611120223999023  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44677305221557617  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4530925750732422  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([320, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45337677001953125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45337677001953125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45398712158203125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4633598327636719  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([264, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.46381616592407227  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.46381616592407227  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.46431970596313477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4772043228149414  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([194, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47769880294799805  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47769880294799805  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47806882858276367  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4887995719909668  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4894990921020508  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4894990921020508  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4898500442504883  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5024843215942383  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5030989646911621  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5030989646911621  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5033602714538574  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5145964622497559  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5154819488525391  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5154819488525391  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5157699584960938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5301704406738281  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([129, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5310187339782715  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5310187339782715  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5312647819519043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5452895164489746  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5460405349731445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5460405349731445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5462331771850586  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5585622787475586  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5593023300170898  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5593023300170898  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5594682693481445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5712499618530273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([95, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.572171688079834  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.572171688079834  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5723528861999512  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5864863395690918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5871686935424805  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5871686935424805  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5872964859008789  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5981588363647461  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5988197326660156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5988197326660156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5989303588867188  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6091079711914062  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6099138259887695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6099138259887695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6100358963012695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6221208572387695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6229395866394043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6229395866394043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6230559349060059  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6353888511657715  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6360998153686523  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6360998153686523  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.636195182800293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6469717025756836  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6476268768310547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6476268768310547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6477088928222656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6575508117675781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6580634117126465  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6580634117126465  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6581244468688965  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6658759117126465  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6662473678588867  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6662473678588867  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6662893295288086  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6719121932983398  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6724872589111328  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6724872589111328  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.67254638671875  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6808834075927734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6814393997192383  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6814393997192383  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6814947128295898  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6896810531616211  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6899919509887695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6899919509887695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6900224685668945  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6947526931762695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6952462196350098  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6952462196350098  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6952900886535645  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7023968696594238  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7028827667236328  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7028827667236328  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7029247283935547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7100162506103516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([263, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7163147926330566  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7163147926330566  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7168164253234863  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.8075966835021973  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7874016761779785  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7878174781799316  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7882332801818848  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7877964973449707  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([2790, 40])
input nodes number: 7225
output nodes number: 2790
edges number: 24317
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7878513336181641  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7878518104553223  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.014780998229980469  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

pseudo mini batch 8 input nodes size: 11260
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013157367706298828  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013157367706298828  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.018526554107666016  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.018548011779785156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01136016845703125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.011773109436035156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.011773109436035156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.011773109436035156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([11260, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.011773109436035156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([575, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.029050350189208984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.029050350189208984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.029598712921142578  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.03484153747558594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([625, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.03516340255737305  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.03516340255737305  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.03575944900512695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04471445083618164  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([579, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.045244693756103516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.045244693756103516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.045796871185302734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05794477462768555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([552, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05872154235839844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05872154235839844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 552, 128]), torch.Size([1, 552, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05924797058105469  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0750885009765625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 552, 128])
m.shape torch.Size([466, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07593631744384766  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07593631744384766  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.07638072967529297  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09237957000732422  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([392, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09327888488769531  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09327888488769531  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09365272521972656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.10972785949707031  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([321, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.11061239242553711  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.11061239242553711  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.11091852188110352  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.12622499465942383  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([308, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.12786436080932617  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.12786436080932617  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 308, 128]), torch.Size([1, 308, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1281580924987793  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14490079879760742  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 308, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14585256576538086  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14585256576538086  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14609670639038086  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.16172170639038086  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([1718, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.16979169845581055  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.16979169845581055  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 1718, 128]), torch.Size([1, 1718, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.17143011093139648  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.28816747665405273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 1718, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.2742447853088379  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.2797684669494629  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.2852921485900879  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.2797250747680664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([5792, 256])
first layer input nodes number: 11260
first layer output nodes number: 5792
edges number: 34647
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.28537797927856445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.29090166091918945  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.2928318977355957  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.2928318977355957  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([390, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3132615089416504  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3132615089416504  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.31400537490844727  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.32035398483276367  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3206934928894043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3206934928894043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3213992118835449  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.33263349533081055  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3331775665283203  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3331775665283203  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.333770751953125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.34787702560424805  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([257, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3485689163208008  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3485689163208008  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3490591049194336  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.36327457427978516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3640098571777344  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3640098571777344  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3643989562988281  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3784065246582031  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([188, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.37929630279541016  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.37929630279541016  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3796548843383789  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.39507389068603516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([164, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3959980010986328  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3959980010986328  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.39631080627441406  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41195106506347656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([133, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4128594398498535  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4128594398498535  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4131131172180176  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42757272720336914  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4284234046936035  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4284234046936035  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42863893508911133  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44243288040161133  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44325780868530273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44325780868530273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44344282150268555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45657873153686523  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4573850631713867  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4573850631713867  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4575471878051758  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47019290924072266  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4709310531616211  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4709310531616211  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4710664749145508  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4825773239135742  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.48322200775146484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.48322200775146484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.48333072662353516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4933328628540039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4939112663269043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4939112663269043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4940009117126465  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.502875804901123  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5035519599914551  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5035519599914551  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5036473274230957  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.513756275177002  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5143394470214844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5143394470214844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5144176483154297  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.52325439453125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5235748291015625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5235748291015625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5236167907714844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5286521911621094  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5291504859924316  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5291504859924316  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.529207706451416  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5364747047424316  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5370488166809082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5370488166809082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.537111759185791  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5455460548400879  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5459184646606445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5459184646606445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5459585189819336  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5516061782836914  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5518488883972168  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5518488883972168  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5518736839294434  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5555434226989746  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5559754371643066  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5559754371643066  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5560154914855957  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5622239112854004  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5625357627868652  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5625357627868652  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5625643730163574  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5671992301940918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5675311088562012  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5675311088562012  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5675597190856934  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.572394847869873  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([132, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5755524635314941  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5755524635314941  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5758042335510254  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6201157569885254  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 132, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6028904914855957  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6033196449279785  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6037487983703613  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6032981872558594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([2880, 40])
input nodes number: 5792
output nodes number: 2880
edges number: 20731
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6033763885498047  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6033768653869629  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.012600898742675781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

pseudo mini batch 9 input nodes size: 14517
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.011373519897460938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.011373519897460938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.018540382385253906  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01856231689453125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013171672821044922  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01363992691040039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01363992691040039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01363992691040039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([14517, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01363992691040039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([622, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.03442955017089844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.03442955017089844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.035022735595703125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0401453971862793  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([696, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0405125617980957  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0405125617980957  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04117631912231445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.051282405853271484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([648, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.051877498626708984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.051877498626708984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.052495479583740234  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06609106063842773  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([580, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06688833236694336  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06688833236694336  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06744146347045898  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08348226547241211  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([540, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08449316024780273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08449316024780273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08500814437866211  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.10355520248413086  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([409, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.10490942001342773  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.10490942001342773  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.10529947280883789  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.12207174301147461  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([390, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.12317848205566406  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.12317848205566406  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 390, 128]), torch.Size([1, 390, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1235504150390625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14214706420898438  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 390, 128])
m.shape torch.Size([348, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14328861236572266  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14328861236572266  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.14362049102783203  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1625375747680664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([299, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.16365480422973633  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.16365480422973633  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1639399528503418  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1821894645690918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([2214, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.19260406494140625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.19260406494140625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 2214, 128]), torch.Size([1, 2214, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1947154998779297  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3491644859313965  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 2214, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.331270694732666  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3377041816711426  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.34413766860961914  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.33765363693237305  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([6746, 256])
first layer input nodes number: 14517
first layer output nodes number: 6746
edges number: 41777
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.34424781799316406  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.35091209411621094  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.35279273986816406  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.35279273986816406  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3734416961669922  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3734416961669922  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.37424278259277344  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3806638717651367  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([403, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.38103818893432617  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.38103818893432617  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3818068504333496  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3946070671081543  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3951396942138672  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3951396942138672  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.39574623107910156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41001033782958984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([273, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41075706481933594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41075706481933594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41127777099609375  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4263782501220703  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4271707534790039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4271707534790039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42758846282958984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4426259994506836  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([157, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44332265853881836  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.44332265853881836  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4436221122741699  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4564986228942871  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([162, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45766687393188477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45766687393188477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4579758644104004  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47342538833618164  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47427845001220703  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47427845001220703  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47452831268310547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4887704849243164  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4894590377807617  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4894590377807617  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4896383285522461  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5011129379272461  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5018982887268066  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5018982887268066  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5020718574523926  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5143952369689941  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.515164852142334  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.515164852142334  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5153193473815918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5273699760437012  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([49, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5278582572937012  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5278582572937012  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.527951717376709  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.535895824432373  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5365490913391113  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5365490913391113  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5366559028625488  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5464825630187988  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5470080375671387  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5470080375671387  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5470900535583496  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5552096366882324  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5557456016540527  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5557456016540527  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5558218955993652  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5639090538024902  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5645017623901367  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5645017623901367  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.564579963684082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5734167098999023  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5737209320068359  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5737209320068359  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.573760986328125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5785675048828125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5788936614990234  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5788936614990234  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5789318084716797  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5837764739990234  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5842690467834473  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5842690467834473  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.584322452545166  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5914788246154785  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5919904708862305  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5919904708862305  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5920438766479492  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.599574089050293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5999312400817871  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5999312400817871  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5999674797058105  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6053309440612793  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6056513786315918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6056513786315918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6056818962097168  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6104121208190918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6107730865478516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6107730865478516  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6108055114746094  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.616058349609375  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6162729263305664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6162729263305664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6162919998168945  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6195154190063477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([177, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6237592697143555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6237592697143555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6240968704223633  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6835145950317383  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 177, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6660909652709961  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6665253639221191  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6669597625732422  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6665034294128418  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([2914, 40])
input nodes number: 6746
output nodes number: 2914
edges number: 20928
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6665811538696289  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6665816307067871  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.014562606811523438  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

pseudo mini batch 10 input nodes size: 17785
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013176918029785156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.013176918029785156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.021657466888427734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.021679401397705078  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.014490604400634766  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.015006542205810547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.015006542205810547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.015006542205810547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([17785, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.015006542205810547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([560, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.038114070892333984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.038114070892333984  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.038648128509521484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.042920589447021484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([611, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04323625564575195  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04323625564575195  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.04381895065307617  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05318641662597656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([601, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05375480651855469  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.05375480651855469  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.054327964782714844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06693744659423828  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([502, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06760835647583008  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06760835647583008  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.06808710098266602  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0819706916809082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([449, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08280181884765625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08280181884765625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.08323001861572266  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09864521026611328  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([365, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09947538375854492  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.09947538375854492  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.0998234748840332  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1147913932800293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([313, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1156620979309082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1156620979309082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.11596059799194336  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13088560104370117  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([319, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13195323944091797  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13195323944091797  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 319, 128]), torch.Size([1, 319, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13225746154785156  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1495981216430664  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 319, 128])
m.shape torch.Size([267, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.15059185028076172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.15059185028076172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 267, 128]), torch.Size([1, 267, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1508464813232422  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1671428680419922  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 267, 128])
m.shape torch.Size([2944, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.18105363845825195  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.18105363845825195  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 2944, 128]), torch.Size([1, 2944, 128])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.18386125564575195  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.38373565673828125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 2944, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3640589714050293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3713650703430176  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3779749870300293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3706169128417969  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([6931, 256])
first layer input nodes number: 17785
first layer output nodes number: 6931
edges number: 46614
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.377413272857666  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3847193717956543  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3862452507019043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.3862452507019043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([400, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.40841150283813477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.40841150283813477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.40917444229125977  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4155311584472656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41587066650390625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41587066650390625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.41658592224121094  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42746829986572266  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([319, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42803049087524414  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42803049087524414  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.42863893508911133  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4426083564758301  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([262, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4433174133300781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4433174133300781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.443817138671875  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.45877933502197266  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4595003128051758  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4595003128051758  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4598855972290039  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4737558364868164  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4743995666503906  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4743995666503906  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.47467613220214844  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4865684509277344  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4873185157775879  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.4873185157775879  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.48757028579711914  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5001587867736816  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5008711814880371  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5008711814880371  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5010790824890137  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5129294395446777  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5136733055114746  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5136733055114746  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5138602256774902  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5258231163024902  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5267200469970703  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5267200469970703  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.52691650390625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5408649444580078  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5414648056030273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5414648056030273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.541590690612793  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5514097213745117  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5521426200866699  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5521426200866699  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.552274227142334  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5634608268737793  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5641322135925293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5641322135925293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5642447471618652  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5745978355407715  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.575322151184082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.575322151184082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5754327774047852  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5863847732543945  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5870504379272461  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5870504379272461  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5871458053588867  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.597254753112793  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5976376533508301  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5976376533508301  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.5976910591125488  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6037259101867676  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6042060852050781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6042060852050781  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6042652130126953  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6113605499267578  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6117982864379883  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6117982864379883  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6118497848510742  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6183900833129883  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6187114715576172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6187114715576172  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6187477111816406  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6236038208007812  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6240472793579102  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6240472793579102  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6240930557250977  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6305475234985352  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6309084892272949  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6309084892272949  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6309447288513184  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6363081932067871  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6368188858032227  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6368188858032227  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.636866569519043  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6442575454711914  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6444330215454102  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6444330215454102  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6444501876831055  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6472311019897461  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6475224494934082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6475224494934082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6475472450256348  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6517376899719238  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([243, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6575641632080078  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6575641632080078  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.6580276489257812  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7396011352539062  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 243, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7205619812011719  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7209920883178711  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7214221954345703  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7209701538085938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([2885, 40])
input nodes number: 6931
output nodes number: 2885
edges number: 22471
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7210397720336914  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7210402488708496  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01600790023803711  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

pseudo mini batch 11 input nodes size: 24739
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.014486312866210938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.014486312866210938  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.026282787322998047  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.02630472183227539  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.01780223846435547  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.018492698669433594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.018492698669433594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.018492698669433594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([24739, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.018492698669433594  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([574, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.05146598815917969  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.05146598815917969  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.052013397216796875  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.0574336051940918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([664, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.05779314041137695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.05779314041137695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 664, 128]), torch.Size([1, 664, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.0584263801574707  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.06792497634887695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 664, 128])
m.shape torch.Size([618, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.06849241256713867  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.06849241256713867  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 618, 128]), torch.Size([1, 618, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.06908178329467773  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.08231115341186523  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 618, 128])
m.shape torch.Size([611, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.08318185806274414  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.08318185806274414  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 611, 128]), torch.Size([1, 611, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.08376455307006836  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.10107088088989258  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 611, 128])
m.shape torch.Size([579, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.10215997695922852  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.10215997695922852  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.10271215438842773  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.12276649475097656  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([502, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.12392663955688477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.12392663955688477  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.1244053840637207  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.14499139785766602  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([489, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.14638423919677734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.14638423919677734  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.1468505859375  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.1701679229736328  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([450, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.17165136337280273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.17165136337280273  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.17208051681518555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.19654226303100586  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([400, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.1980443000793457  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.1980443000793457  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 400, 128]), torch.Size([1, 400, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.1984257698059082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.2228398323059082  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 400, 128])
m.shape torch.Size([4406, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.24413347244262695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.24413347244262695  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 4406, 128]), torch.Size([1, 4406, 128])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.2483353614807129  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5562191009521484  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 4406, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5258989334106445  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5347614288330078  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5436239242553711  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5346918106079102  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

torch.Size([9293, 256])
first layer input nodes number: 24739
first layer output nodes number: 9293
edges number: 66790
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5438103675842285  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5526728630065918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.555396556854248  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.555396556854248  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

m.shape torch.Size([367, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5814628601074219  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5814628601074219  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5821628570556641  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.588655948638916  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([326, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.588932991027832  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.588932991027832  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5895547866821289  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5994257926940918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([260, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5998649597167969  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.5998649597167969  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6003608703613281  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.612701416015625  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6133418083190918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6133418083190918  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6137824058532715  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6265597343444824  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6273298263549805  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6273298263549805  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6277227401733398  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6418676376342773  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6426057815551758  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6426057815551758  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6429147720336914  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6562013626098633  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6570158004760742  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6570158004760742  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6572904586791992  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6710233688354492  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([135, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6719241142272949  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6719241142272949  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6721816062927246  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6868586540222168  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6875863075256348  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6875863075256348  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6877751350402832  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.6998600959777832  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.700678825378418  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.700678825378418  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7008600234985352  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7137250900268555  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7144804000854492  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7144804000854492  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7146329879760742  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7265348434448242  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7273468971252441  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7273468971252441  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7274937629699707  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7399773597717285  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7406539916992188  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7406539916992188  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7407684326171875  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7512969970703125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([60, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7520475387573242  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7520475387573242  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.752161979675293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7634916305541992  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7641267776489258  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7641267776489258  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7642183303833008  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7739229202270508  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7745847702026367  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7745847702026367  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7746725082397461  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7845869064331055  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7851643562316895  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7851643562316895  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7852368354797363  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7939343452453613  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7944002151489258  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7944002151489258  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7944555282592773  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8014802932739258  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8020005226135254  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8020005226135254  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8020577430725098  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.809725284576416  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.810215950012207  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.810215950012207  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.810267448425293  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8175287246704102  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8179473876953125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8179473876953125  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8179893493652344  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8241996765136719  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8247499465942383  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8247499465942383  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8248014450073242  GigaBytes
Max Memory Allocated: 0.8324198722839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8327836990356445  GigaBytes
Max Memory Allocated: 0.8333501815795898  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8330898284912109  GigaBytes
Max Memory Allocated: 0.8333501815795898  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8330898284912109  GigaBytes
Max Memory Allocated: 0.8333501815795898  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8331184387207031  GigaBytes
Max Memory Allocated: 0.8333501815795898  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8377532958984375  GigaBytes
Max Memory Allocated: 0.8380823135375977  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8381776809692383  GigaBytes
Max Memory Allocated: 0.8381795883178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8381776809692383  GigaBytes
Max Memory Allocated: 0.8381795883178711  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8382139205932617  GigaBytes
Max Memory Allocated: 0.8382139205932617  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8443384170532227  GigaBytes
Max Memory Allocated: 0.8447732925415039  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([324, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8521056175231934  GigaBytes
Max Memory Allocated: 0.8521361351013184  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8521056175231934  GigaBytes
Max Memory Allocated: 0.8521361351013184  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.8527235984802246  GigaBytes
Max Memory Allocated: 0.8527235984802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 0.9627985954284668  GigaBytes
Max Memory Allocated: 0.9705233573913574  GigaBytes

rst.shape  torch.Size([1, 324, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 0.9398150444030762  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 0.940251350402832  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 0.9406876564025879  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 0.9402294158935547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2927, 40])
input nodes number: 9293
output nodes number: 2927
edges number: 25769
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 0.9403271675109863  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 0.9403276443481445  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.019808292388916016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 12 input nodes size: 18084
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01780843734741211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01780843734741211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.026431560516357422  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.026453495025634766  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.014635086059570312  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015120506286621094  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015120506286621094  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015120506286621094  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([18084, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015120506286621094  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([765, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.037586212158203125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.037586212158203125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.038315773010253906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.044823646545410156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([792, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.045214176177978516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.045214176177978516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.045969486236572266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.057299137115478516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([704, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05792856216430664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05792856216430664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 704, 128]), torch.Size([1, 704, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05859994888305664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07428598403930664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 704, 128])
m.shape torch.Size([570, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07503747940063477  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07503747940063477  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07558107376098633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09213495254516602  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([520, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09310293197631836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09310293197631836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09359884262084961  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11211919784545898  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([456, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11317586898803711  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11317586898803711  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11361074447631836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1323103904724121  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([358, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13328790664672852  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13328790664672852  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 358, 128]), torch.Size([1, 358, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13362932205200195  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15070009231567383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 358, 128])
m.shape torch.Size([342, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15183401107788086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15183401107788086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 342, 128]), torch.Size([1, 342, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1521601676940918  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17075109481811523  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 342, 128])
m.shape torch.Size([285, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17181110382080078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17181110382080078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 285, 128]), torch.Size([1, 285, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17208290100097656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.18947792053222656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 285, 128])
m.shape torch.Size([2517, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.20134401321411133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.20134401321411133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 2517, 128]), torch.Size([1, 2517, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.20374441146850586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3772768974304199  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 2517, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.35837745666503906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.36580944061279297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37277984619140625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.365293025970459  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([7309, 256])
first layer input nodes number: 18084
first layer output nodes number: 7309
edges number: 45054
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3724551200866699  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37988710403442383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3811683654785156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3811683654785156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([516, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4014739990234375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4014739990234375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.40245819091796875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41033172607421875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([419, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4106454849243164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4106454849243164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41144466400146484  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4243001937866211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([325, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4248380661010742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4248380661010742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4254579544067383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43909549713134766  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4396967887878418  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4396967887878418  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44014883041381836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45325803756713867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45397424697875977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45397424697875977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.454348087310791  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.467806339263916  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([192, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46872663497924805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46872663497924805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46909284591674805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48483991622924805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.485471248626709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.485471248626709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4857020378112793  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4972414970397949  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4979872703552246  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4979872703552246  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4982008934020996  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5103774070739746  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5111360549926758  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5111360549926758  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.511326789855957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.523533821105957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5242652893066406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5242652893066406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5244293212890625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5360755920410156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5366387367248535  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5366387367248535  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5367550849914551  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.545830249786377  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5464410781860352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5464410781860352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5465517044067383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5559549331665039  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5566244125366211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5566244125366211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5567350387573242  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5669126510620117  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5674901008605957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5674901008605957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5675797462463379  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5764546394348145  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5769867897033691  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5769867897033691  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5770630836486816  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5851502418518066  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5854506492614746  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5854506492614746  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5854926109313965  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5902342796325684  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5908346176147461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5908346176147461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.590907096862793  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.599604606628418  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5999317169189453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5999317169189453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5999717712402344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6050586700439453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6054954528808594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6054954528808594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6055431365966797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6119327545166016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6123514175415039  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6123514175415039  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6123952865600586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6185808181762695  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6190032958984375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6190032958984375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6190452575683594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6252555847167969  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6256790161132812  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6256790161132812  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6257190704345703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.631927490234375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6323056221008301  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6323056221008301  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6323399543762207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.637901782989502  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.638115406036377  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.638115406036377  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6381344795227051  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6413578987121582  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([152, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6450009346008301  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6450009346008301  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6452908515930176  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6963162422180176  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 152, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6793513298034668  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6797866821289062  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6802220344543457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6797647476196289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2920, 40])
input nodes number: 7309
output nodes number: 2920
edges number: 19980
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6798405647277832  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6798410415649414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01608753204345703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 13 input nodes size: 8331
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.014634132385253906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.014634132385253906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01860666275024414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.018628597259521484  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.009983539581298828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01029348373413086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01029348373413086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01029348373413086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([8331, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01029348373413086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([749, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.023201942443847656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.023201942443847656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.023916244506835938  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.029714107513427734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([772, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03009319305419922  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03009319305419922  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.030829429626464844  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04187297821044922  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([661, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0424504280090332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0424504280090332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.043080806732177734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0570368766784668  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([525, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.057797908782958984  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.057797908782958984  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.058298587799072266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07293844223022461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([455, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07377290725708008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07377290725708008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 455, 128]), torch.Size([1, 455, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07420682907104492  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0898280143737793  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 455, 128])
m.shape torch.Size([370, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09066963195800781  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09066963195800781  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09102249145507812  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10619544982910156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([305, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10703706741333008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10703706741333008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10732793807983398  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1218714714050293  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([238, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1226339340209961  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1226339340209961  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 238, 128]), torch.Size([1, 238, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12286090850830078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13579845428466797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 238, 128])
m.shape torch.Size([199, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13653898239135742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13653898239135742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 199, 128]), torch.Size([1, 199, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13672876358032227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.14887475967407227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 199, 128])
m.shape torch.Size([880, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15297603607177734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15297603607177734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15381526947021484  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.21340084075927734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 880, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.20317506790161133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.20809030532836914  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.21300554275512695  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2080516815185547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([5154, 256])
first layer input nodes number: 8331
first layer output nodes number: 5154
edges number: 25501
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.21306991577148438  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2179851531982422  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.21921396255493164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.21921396255493164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([534, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.23521041870117188  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.23521041870117188  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.23622894287109375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.24460315704345703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([446, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2449512481689453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2449512481689453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2458019256591797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2590012550354004  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([363, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.25965261459350586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.25965261459350586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2603449821472168  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.27592897415161133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2766590118408203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2766590118408203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.27715301513671875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2927069664001465  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([257, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.29369544982910156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.29369544982910156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2941856384277344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3118324279785156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([185, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3126544952392578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3126544952392578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3130073547363281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32818031311035156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([168, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32956647872924805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32956647872924805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32988691329956055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.34590864181518555  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([130, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.34674835205078125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.34674835205078125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3469963073730469  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3611297607421875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.36188840866088867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.36188840866088867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.36208295822143555  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37453413009643555  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3751673698425293  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3751673698425293  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37531232833862305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3856043815612793  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38624048233032227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38624048233032227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3863682746887207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39633607864379883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3969874382019043  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3969874382019043  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39710569381713867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.40715742111206055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4075484275817871  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4075484275817871  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.40761709213256836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41393423080444336  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41433048248291016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41433048248291016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41439151763916016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42043399810791016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42095136642456055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42095136642456055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4210238456726074  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42870664596557617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42905521392822266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42905521392822266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42910289764404297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4344911575317383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43479442596435547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43479442596435547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4348325729370117  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4394102096557617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4396681785583496  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4396681785583496  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4396986961364746  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4435744285583496  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44376039505004883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44376039505004883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44378137588500977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4465928077697754  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4467172622680664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4467172622680664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4467306137084961  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44861316680908203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4488086700439453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4488086700439453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44882774353027344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45165061950683594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45178937911987305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45178937911987305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45180273056030273  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4538722038269043  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4540424346923828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4540424346923828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4540576934814453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4565296173095703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45677614212036133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45677614212036133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45679712295532227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4603428840637207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([39, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4612698554992676  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4612698554992676  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46134424209594727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47443628311157227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 39, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4618644714355469  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4622983932495117  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46273231506347656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4622764587402344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2909, 40])
input nodes number: 5154
output nodes number: 2909
edges number: 15971
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46233558654785156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46233606338500977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01093292236328125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 14 input nodes size: 11148
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.009982109069824219  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.009982109069824219  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015297889709472656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015319347381591797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.011324882507324219  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.011658668518066406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.011658668518066406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.011658668518066406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([11148, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.011658668518066406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.02626800537109375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.02626800537109375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.02695178985595703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.032842159271240234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([792, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.033255577087402344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.033255577087402344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.034010887145996094  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.045340538024902344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([648, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.045889854431152344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.045889854431152344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 648, 128]), torch.Size([1, 648, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.046507835388183594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.060591697692871094  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 648, 128])
m.shape torch.Size([544, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.061371803283691406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.061371803283691406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.061890602111816406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0769357681274414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07778024673461914  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07778024673461914  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07822179794311523  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09411764144897461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([350, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09489822387695312  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09489822387695312  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 350, 128]), torch.Size([1, 350, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09523200988769531  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10958480834960938  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 350, 128])
m.shape torch.Size([299, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11041593551635742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11041593551635742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11070108413696289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12495851516723633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([275, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12632083892822266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12632083892822266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 275, 128]), torch.Size([1, 275, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12658309936523438  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.14153194427490234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 275, 128])
m.shape torch.Size([210, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1423020362854004  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1423020362854004  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 210, 128]), torch.Size([1, 210, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1425023078918457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1553196907043457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 210, 128])
m.shape torch.Size([1200, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16094160079956055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16094160079956055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16208600997924805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.24341535568237305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.23151636123657227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.23675966262817383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2420029640197754  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.23671865463256836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([5498, 256])
first layer input nodes number: 11148
first layer output nodes number: 5498
edges number: 29019
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.24208831787109375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2473316192626953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2486424446105957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2486424446105957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([507, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2643904685974121  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2643904685974121  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.26535749435424805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2737421989440918  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([482, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2741856575012207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2741856575012207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.27510499954223633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2888951301574707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([372, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2896237373352051  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2896237373352051  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.29033327102661133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3069138526916504  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([286, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3077883720397949  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3077883720397949  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3083338737487793  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32495832443237305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32578134536743164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32578134536743164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3262162208557129  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3418717384338379  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.34267520904541016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.34267520904541016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.34301280975341797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3575296401977539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3583230972290039  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3583230972290039  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3585958480834961  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37223339080810547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37301206588745117  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37301206588745117  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37323904037475586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38617658615112305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3867983818054199  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3867983818054199  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.386960506439209  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.397336483001709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39800548553466797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39800548553466797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39815425872802734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.40871715545654297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4093937873840332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4093937873840332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4095292091369629  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4200921058654785  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4205207824707031  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4205207824707031  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42060279846191406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42757415771484375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4280080795288086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4280080795288086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42808055877685547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43474864959716797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4352240562438965  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4352240562438965  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43529653549194336  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.442471981048584  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4430561065673828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4430561065673828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44313812255859375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4518318176269531  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4521293640136719  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4521293640136719  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45217132568359375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4569129943847656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4572029113769531  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4572029113769531  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45723915100097656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46158790588378906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4620199203491211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4620199203491211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4620695114135742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4683675765991211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4685072898864746  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4685072898864746  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4685244560241699  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4708247184753418  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4710664749145508  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4710664749145508  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47109127044677734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47458744049072266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4747166633605957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4747166633605957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4747300148010254  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47670602798461914  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4767632484436035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4767632484436035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47676897048950195  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47765588760375977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47776365280151367  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47776365280151367  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47777318954467773  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47931814193725586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4794750213623047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4794750213623047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4794883728027344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48174476623535156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([51, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48296356201171875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48296356201171875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4830608367919922  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5001811981201172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 51, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48778200149536133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48821020126342773  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48863840103149414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4881887435913086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2872, 40])
input nodes number: 5498
output nodes number: 2872
edges number: 15744
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48824548721313477  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48824596405029297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01234292984008789  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 15 input nodes size: 13056
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.011319160461425781  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.011319160461425781  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01754474639892578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.017566680908203125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.012229442596435547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.012654781341552734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.012654781341552734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.012654781341552734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([13056, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.012654781341552734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([676, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03087139129638672  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03087139129638672  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.031516075134277344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.038378238677978516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([801, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03881978988647461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03881978988647461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.039583683013916016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05201292037963867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([656, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05256938934326172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05256938934326172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05319499969482422  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06701183319091797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([629, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06789875030517578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06789875030517578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06849861145019531  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.08589458465576172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([458, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.08668661117553711  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.08668661117553711  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 458, 128]), torch.Size([1, 458, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.08712339401245117  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10284757614135742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 458, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10381078720092773  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10381078720092773  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10420465469360352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12114095687866211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([337, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12206888198852539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12206888198852539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 337, 128]), torch.Size([1, 337, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1223902702331543  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1384596824645996  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 337, 128])
m.shape torch.Size([315, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13950061798095703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13950061798095703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.139801025390625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15692424774169922  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([274, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15794992446899414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15794992446899414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15821123123168945  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17493486404418945  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([1757, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1837606430053711  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1837606430053711  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 1757, 128]), torch.Size([1, 1757, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.18543624877929688  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.30440425872802734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 1757, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2890739440917969  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.29509735107421875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3011207580566406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.29505014419555664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([6316, 256])
first layer input nodes number: 13056
first layer output nodes number: 6316
edges number: 36445
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3012199401855469  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.30724334716796875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3087491989135742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3087491989135742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([422, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32905006408691406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32905006408691406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32985496520996094  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.33655357360839844  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([426, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.33697032928466797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.33697032928466797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3377828598022461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.34997081756591797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.35045576095581055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.35045576095581055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3510451316833496  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.36521244049072266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([283, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3660764694213867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3660764694213867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.36661624908447266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3827676773071289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38357973098754883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38357973098754883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3839898109436035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39875268936157227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39951658248901367  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39951658248901367  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39983701705932617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41361570358276367  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4143099784851074  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4143099784851074  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4145522117614746  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.426663875579834  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42740392684936523  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42740392684936523  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42761754989624023  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43979406356811523  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([111, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44064760208129883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44064760208129883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.440859317779541  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.454409122467041  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4551687240600586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4551687240600586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4553403854370117  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4675283432006836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46809816360473633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46809816360473633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4682164192199707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47744035720825195  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47802734375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47802734375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4781341552734375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.487213134765625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4878969192504883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4878969192504883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4880094528198242  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49836254119873047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49904680252075195  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49904680252075195  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49915170669555664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5095372200012207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5100183486938477  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5100183486938477  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5100889205932617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5175695419311523  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5179495811462402  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5179495811462402  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5180010795593262  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5238204002380371  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5243830680847168  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5243830680847168  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.524451732635498  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.532691478729248  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5332627296447754  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5332627296447754  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5333294868469238  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5418076515197754  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5422859191894531  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5422859191894531  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5423393249511719  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5494956970214844  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5499691963195801  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5499691963195801  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5500187873840332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5570111274719238  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5574102401733398  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5574102401733398  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5574502944946289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5633783340454102  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5636544227600098  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5636544227600098  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5636811256408691  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5678200721740723  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5682268142700195  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5682268142700195  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.568263053894043  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5741338729858398  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5744619369506836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5744619369506836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5744905471801758  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5793256759643555  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([150, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5829157829284668  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5829157829284668  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5832018852233887  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6335558891296387  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 150, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6164946556091309  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6169276237487793  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6173605918884277  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.616905689239502  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2903, 40])
input nodes number: 6316
output nodes number: 2903
edges number: 20568
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6169795989990234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6169800758361816  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.013510704040527344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 16 input nodes size: 19675
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.012234210968017578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.012234210968017578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.021615982055664062  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.021637439727783203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01538991928100586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015881061553955078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015881061553955078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015881061553955078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([19675, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015881061553955078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([826, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0398712158203125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0398712158203125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04065895080566406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.047838687896728516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([791, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04819917678833008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04819917678833008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04895353317260742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06026887893676758  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([769, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06103086471557617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06103086471557617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 769, 128]), torch.Size([1, 769, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06176424026489258  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07811784744262695  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 769, 128])
m.shape torch.Size([626, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07894515991210938  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07894515991210938  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07954216003417969  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09770965576171875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([641, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09893941879272461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09893941879272461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09955072402954102  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12155771255493164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([510, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.122711181640625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.122711181640625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 510, 128]), torch.Size([1, 510, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12319755554199219  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.14411163330078125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 510, 128])
m.shape torch.Size([423, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1452803611755371  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1452803611755371  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.14568376541137695  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16585397720336914  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([372, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16707134246826172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16707134246826172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16742610931396484  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.18764781951904297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([288, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1887063980102539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1887063980102539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 288, 128]), torch.Size([1, 288, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1889810562133789  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2065591812133789  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 288, 128])
m.shape torch.Size([2609, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.21886253356933594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.21886253356933594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 2609, 128]), torch.Size([1, 2609, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2218642234802246  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4054837226867676  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 2609, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38488101959228516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39237213134765625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39986324310302734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.39231348037719727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([7855, 256])
first layer input nodes number: 19675
first layer output nodes number: 7855
edges number: 48103
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4000120162963867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4075031280517578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4093761444091797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4093761444091797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([556, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4270806312561035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4270806312561035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.42814111709594727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43743276596069336  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([413, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4376964569091797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4376964569091797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43848419189453125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4503002166748047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([327, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4508495330810547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4508495330810547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4514732360839844  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4659748077392578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46653223037719727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46653223037719727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4669632911682129  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.479464054107666  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([253, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48046445846557617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48046445846557617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48094701766967773  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.498319149017334  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49920129776000977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49920129776000977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49953126907348633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5137200355529785  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5144634246826172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5144634246826172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5147209167480469  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5275955200195312  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5283513069152832  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5283513069152832  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5285706520080566  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5410733222961426  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5417423248291016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5417423248291016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5419139862060547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5529003143310547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5535068511962891  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5535068511962891  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5536441802978516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5633945465087891  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5638971328735352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5638971328735352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.564000129699707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5720338821411133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5726170539855957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5726170539855957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5727219581604004  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5816388130187988  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5822486877441406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5822486877441406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5823497772216797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5916500091552734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5922722816467285  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5922722816467285  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5923676490783691  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.601809024810791  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6021943092346191  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6021943092346191  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6022515296936035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6083168983459473  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6086883544921875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6086883544921875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6087379455566406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6143417358398438  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6146764755249023  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6146764755249023  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6147184371948242  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6197538375854492  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.619992733001709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.619992733001709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6200213432312012  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.623654842376709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.623969554901123  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.623969554901123  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6240038871765137  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6286044120788574  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6289525032043457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6289525032043457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6289887428283691  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6340985298156738  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6342220306396484  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6342220306396484  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6342353820800781  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6362113952636719  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6363954544067383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6363954544067383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6364126205444336  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.639073371887207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6393303871154785  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6393303871154785  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6393532752990723  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6430611610412598  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.643165111541748  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.643165111541748  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6431746482849121  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6447863578796387  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([126, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6478095054626465  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6478095054626465  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6480498313903809  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6903471946716309  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 126, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6759719848632812  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.676398754119873  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6768255233764648  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6763772964477539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2861, 40])
input nodes number: 7855
output nodes number: 2861
edges number: 17731
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6764512062072754  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6764516830444336  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.016854286193847656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 17 input nodes size: 19245
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015383720397949219  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015383720397949219  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.02456045150756836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.024581432342529297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015178203582763672  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015639781951904297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015639781951904297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015639781951904297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([19245, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015639781951904297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([735, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03808927536010742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03808927536010742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 735, 128]), torch.Size([1, 735, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.038790225982666016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04468727111816406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 735, 128])
m.shape torch.Size([811, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.045110225677490234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.045110225677490234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0458836555480957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.057485103607177734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([721, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05812978744506836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05812978744506836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.058817386627197266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0745534896850586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([602, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07535791397094727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07535791397094727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07593202590942383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09283876419067383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([581, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09393692016601562  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09393692016601562  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09449100494384766  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1145329475402832  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([428, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11548042297363281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11548042297363281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11588859558105469  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1334400177001953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([399, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1345677375793457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1345677375793457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 399, 128]), torch.Size([1, 399, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1349482536315918  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15397405624389648  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 399, 128])
m.shape torch.Size([370, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1551952362060547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1551952362060547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.155548095703125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1756610870361328  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([268, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1766347885131836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1766347885131836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 268, 128]), torch.Size([1, 268, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17689037322998047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.19324779510498047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 268, 128])
m.shape torch.Size([2409, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2046070098876953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2046070098876953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 2409, 128]), torch.Size([1, 2409, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.20690441131591797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3709592819213867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 2409, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3516707420349121  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3586554527282715  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.36564016342163086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3586006164550781  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([7324, 256])
first layer input nodes number: 19245
first layer output nodes number: 7324
edges number: 44656
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3657855987548828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3727703094482422  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37451648712158203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.37451648712158203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([489, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3916926383972168  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3916926383972168  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3926253318786621  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4000868797302246  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([418, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4004244804382324  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4004244804382324  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.40122175216674805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41356897354125977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([342, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41428422927856445  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41428422927856445  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41493654251098633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4302372932434082  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4308648109436035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4308648109436035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.431337833404541  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4450554847717285  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([228, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44597625732421875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44597625732421875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4464111328125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.462066650390625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4627718925476074  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4627718925476074  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4630770683288574  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4761996269226074  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47699594497680664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47699594497680664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4772648811340332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49071168899536133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49144649505615234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49144649505615234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49166202545166016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5039472579956055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5046095848083496  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5046095848083496  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5047793388366699  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5156435966491699  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5164241790771484  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5164241790771484  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5165958404541016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5287837982177734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5293006896972656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5293006896972656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5294094085693359  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5378894805908203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5385274887084961  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5385274887084961  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5386419296264648  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5483694076538086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.548924446105957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.548924446105957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5490179061889648  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5576162338256836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5579328536987305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5579328536987305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5579843521118164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5630826950073242  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5634899139404297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5634899139404297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5635471343994141  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5696125030517578  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5700454711914062  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5700454711914062  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5701026916503906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.576568603515625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5769162178039551  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5769162178039551  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5769600868225098  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5822243690490723  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5826177597045898  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5826177597045898  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5826635360717773  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5884771347045898  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5887832641601562  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5887832641601562  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5888175964355469  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5934181213378906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5937280654907227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5937280654907227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5937604904174805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.598332405090332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5985584259033203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5985584259033203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5985813140869141  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6019687652587891  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6021480560302734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6021480560302734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6021652221679688  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6048259735107422  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6049942970275879  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6049942970275879  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6050095558166504  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6074814796447754  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6077971458435059  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6077971458435059  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6078238487243652  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6123366355895996  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([98, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6146783828735352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6146783828735352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6148653030395508  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6477632522583008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 98, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6338095664978027  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6342263221740723  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6346430778503418  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6342053413391113  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2794, 40])
input nodes number: 7324
output nodes number: 2794
edges number: 17252
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6342711448669434  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6342716217041016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.016560077667236328  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 18 input nodes size: 20549
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015168190002441406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015168190002441406  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.024966716766357422  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.024988651275634766  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015790939331054688  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.016368865966796875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.016368865966796875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.016368865966796875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([20549, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.016368865966796875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([591, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04337310791015625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04337310791015625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.043936729431152344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.048937320709228516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([765, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04938507080078125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.04938507080078125  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05011463165283203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06105804443359375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([696, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06205463409423828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06205463409423828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 696, 128]), torch.Size([1, 696, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06271839141845703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0774545669555664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 696, 128])
m.shape torch.Size([632, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07832813262939453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07832813262939453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.07893085479736328  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09640979766845703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([536, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09738636016845703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09738636016845703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.09789752960205078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11631488800048828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([477, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11758899688720703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11758899688720703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.11804389953613281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1376047134399414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([420, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1387791633605957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1387791633605957  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13917970657348633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15920686721801758  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([443, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16069650650024414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.16069650650024414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1611189842224121  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.18520021438598633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([376, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.18660259246826172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.18660259246826172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.18696117401123047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.20991039276123047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([3239, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2251758575439453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2251758575439453  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 3239, 128]), torch.Size([1, 3239, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.22826480865478516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44850587844848633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 3239, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4246969223022461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.43253374099731445  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44033002853393555  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4324321746826172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([8175, 256])
first layer input nodes number: 20549
first layer output nodes number: 8175
edges number: 54537
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4404449462890625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44828176498413086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45078325271606445  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45078325271606445  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4732236862182617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4732236862182617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47400760650634766  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4807901382446289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48115015029907227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48115015029907227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48189592361450195  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4948768615722656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([310, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49539804458618164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49539804458618164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4959893226623535  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5089974403381348  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5097284317016602  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5097284317016602  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5102376937866211  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5254077911376953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.526158332824707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.526158332824707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5265569686889648  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5409078598022461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5414986610412598  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5414986610412598  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5417599678039551  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5529961585998535  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5536799430847168  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5536799430847168  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5539107322692871  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5654501914978027  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.566349983215332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.566349983215332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5666017532348633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5809526443481445  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5817265510559082  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5817265510559082  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5819249153137207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5946202278137207  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5952615737915039  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5952615737915039  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5954084396362305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6058359146118164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6065239906311035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6065239906311035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.606661319732666  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.617372989654541  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6181578636169434  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6181578636169434  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6182990074157715  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6302962303161621  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6308379173278809  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6308379173278809  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6309313774108887  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6395297050476074  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6401557922363281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6401557922363281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6402511596679688  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6496925354003906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6503081321716309  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6503081321716309  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6503958702087402  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.659696102142334  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6603903770446777  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6603903770446777  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6604819297790527  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6708273887634277  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.671271800994873  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.671271800994873  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6713290214538574  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6781954765319824  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6787900924682617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6787900924682617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.678858757019043  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6875791549682617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6881661415100098  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6881661415100098  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6882309913635254  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6969208717346191  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6972732543945312  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6972732543945312  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6973114013671875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7026901245117188  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7031760215759277  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7031760215759277  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.703223705291748  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7102808952331543  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7107224464416504  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7107224464416504  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7107644081115723  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7172684669494629  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7177119255065918  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7177119255065918  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7177519798278809  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.724240779876709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7245206832885742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7245206832885742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7245454788208008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7287359237670898  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([226, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.734154224395752  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.734154224395752  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7345852851867676  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.8104519844055176  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 226, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7913675308227539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7918038368225098  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7922401428222656  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7917819023132324  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2925, 40])
input nodes number: 8175
output nodes number: 2925
edges number: 22800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7918844223022461  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.7918848991394043  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.01750659942626953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 19 input nodes size: 16498
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015810489654541016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015810489654541016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.023677349090576172  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.023698806762695312  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.013878345489501953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.014269351959228516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.014269351959228516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.014269351959228516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([16498, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.014269351959228516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([717, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03233194351196289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03233194351196289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03301572799682617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.039438724517822266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([772, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03983306884765625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.03983306884765625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.040569305419921875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05173778533935547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([658, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.052310943603515625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.052310943603515625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.05293846130371094  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06699562072753906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06773662567138672  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06773662567138672  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.06826400756835938  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.0838155746459961  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([496, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.08473443984985352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.08473443984985352  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 496, 128]), torch.Size([1, 496, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.08520746231079102  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10223627090454102  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 496, 128])
m.shape torch.Size([416, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10318994522094727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10318994522094727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.10358667373657227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12064599990844727  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([321, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12151908874511719  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.12151908874511719  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 321, 128]), torch.Size([1, 321, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1218252182006836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1371316909790039  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 321, 128])
m.shape torch.Size([301, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13812685012817383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.13812685012817383  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 301, 128]), torch.Size([1, 301, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.1384139060974121  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15477609634399414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 301, 128])
m.shape torch.Size([234, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15563678741455078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15563678741455078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.15585994720458984  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17014217376708984  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([1791, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17857074737548828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.17857074737548828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 1791, 128]), torch.Size([1, 1791, 128])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.18027877807617188  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.30154895782470703  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 1791, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.28664493560791016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2926139831542969  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2985830307006836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.29256725311279297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([6259, 256])
first layer input nodes number: 16498
first layer output nodes number: 6259
edges number: 36094
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.2987079620361328  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.30467700958251953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3063011169433594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3063011169433594  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([535, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32265138626098633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.32265138626098633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.323671817779541  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3330655097961426  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([466, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3334512710571289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3334512710571289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.33434009552001953  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3500833511352539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([374, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.35085439682006836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.35085439682006836  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.35156774520874023  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3675236701965332  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([279, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3682398796081543  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3682398796081543  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.368772029876709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.3842043876647949  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38502931594848633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38502931594848633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.38546228408813477  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4010491371154785  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([178, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4026002883911133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4026002883911133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4029397964477539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4175386428833008  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41816282272338867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41816282272338867  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.41838788986206055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4296412467956543  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4303746223449707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4303746223449707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4305844306945801  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.44254350662231445  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4432086944580078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4432086944580078  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4433784484863281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4542427062988281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4549555778503418  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4549555778503418  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.45511388778686523  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4663538932800293  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46687746047973633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46687746047973633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.46698617935180664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.475466251373291  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47598886489868164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47598886489868164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.47608423233032227  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4841904640197754  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48471784591674805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.48471784591674805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4848055839538574  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4928774833679199  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4933319091796875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.4933319091796875  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.49340248107910156  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5003890991210938  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5007143020629883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5007143020629883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5007619857788086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5058164596557617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5062079429626465  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5062079429626465  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5062594413757324  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5120787620544434  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5123801231384277  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5123801231384277  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.512418270111084  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.516995906829834  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5172886848449707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5172886848449707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5173230171203613  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5216832160949707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5220131874084473  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5220131874084473  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5220494270324707  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5269055366516113  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5271377563476562  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5271377563476562  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5271625518798828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5306587219238281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5308079719543457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5308079719543457  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5308232307434082  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5330815315246582  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5332012176513672  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5332012176513672  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5332126617431641  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5349864959716797  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5350475311279297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5350475311279297  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5350532531738281  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.535980224609375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5361390113830566  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5361390113830566  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5361523628234863  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5384087562561035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([85, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5404448509216309  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5404448509216309  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5406069755554199  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5691409111022949  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 85, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5561466217041016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5565757751464844  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5570049285888672  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5565543174743652  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([2880, 40])
input nodes number: 6259
output nodes number: 2880
edges number: 16342
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5566153526306152  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.5566158294677734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.015070915222167969  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

pseudo mini batch 20 input nodes size: 32756
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.013871192932128906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.013871192932128906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.029496192932128906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.029517173767089844  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.021628856658935547  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.02252054214477539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.02252054214477539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.02252054214477539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([32756, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.02252054214477539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([706, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.06992483139038086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.06992483139038086  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 706, 128]), torch.Size([1, 706, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.07059812545776367  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.07598447799682617  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 706, 128])
m.shape torch.Size([717, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.07633161544799805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.07633161544799805  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.07701539993286133  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.08727216720581055  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([607, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.0877985954284668  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.0877985954284668  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.08837747573852539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.10138177871704102  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([623, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.1022806167602539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.1022806167602539  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.102874755859375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.12094974517822266  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([579, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.12203311920166016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.12203311920166016  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 579, 128]), torch.Size([1, 579, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.12258529663085938  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.14320993423461914  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 579, 128])
m.shape torch.Size([534, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.14446163177490234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.14446163177490234  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 534, 128]), torch.Size([1, 534, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.14497089385986328  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.16771793365478516  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 534, 128])
m.shape torch.Size([502, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.16913890838623047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.16913890838623047  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.1696176528930664  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.19355487823486328  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([502, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.19523048400878906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.19523048400878906  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.195709228515625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.22299766540527344  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([446, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.2246723175048828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.2246723175048828  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 446, 128]), torch.Size([1, 446, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.22509765625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.2523193359375  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 446, 128])
m.shape torch.Size([7212, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2872629165649414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2872629165649414  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 7212, 128]), torch.Size([1, 7212, 128])
----------------------------------------3
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2941408157348633  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.7833223342895508  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 7212, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.7396917343139648  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.752345085144043  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.7641973495483398  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.7514510154724121  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

torch.Size([12428, 256])
first layer input nodes number: 32756
first layer output nodes number: 12428
edges number: 96216
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.7636423110961914  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.7762956619262695  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.7784576416015625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.7784576416015625  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

m.shape torch.Size([434, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8014822006225586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8014822006225586  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8023099899291992  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8095083236694336  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8097710609436035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8097710609436035  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8104424476623535  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8230023384094238  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([260, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8234167098999023  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8234167098999023  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8239126205444336  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8358850479125977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([192, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8363752365112305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8363752365112305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8367414474487305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8473615646362305  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8480677604675293  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8480677604675293  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8484206199645996  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8611235618591309  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([168, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8619160652160645  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8619160652160645  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.862236499786377  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8760151863098145  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8766694068908691  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8766694068908691  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8769001960754395  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8884396553039551  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8891935348510742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.8891935348510742  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.889409065246582  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9016942977905273  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9022703170776367  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9022703170776367  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9024209976196289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9120645523071289  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9128642082214355  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9128642082214355  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9130377769470215  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.925361156463623  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9261202812194824  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9261202812194824  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9262728691101074  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9381747245788574  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9387216567993164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9387216567993164  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9388246536254883  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9475793838500977  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9480652809143066  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9480652809143066  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9481472969055176  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9556927680969238  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9561095237731934  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9561095237731934  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.956174373626709  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9625945091247559  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9631099700927734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9631099700927734  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9631824493408203  GigaBytes
Max Memory Allocated: 0.9708709716796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9708652496337891  GigaBytes
Max Memory Allocated: 0.9714088439941406  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.971336841583252  GigaBytes
Max Memory Allocated: 0.9714088439941406  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.971336841583252  GigaBytes
Max Memory Allocated: 0.9714088439941406  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9713997840881348  GigaBytes
Max Memory Allocated: 0.9714088439941406  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9785122871398926  GigaBytes
Max Memory Allocated: 0.9790158271789551  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9790854454040527  GigaBytes
Max Memory Allocated: 0.9790878295898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9790854454040527  GigaBytes
Max Memory Allocated: 0.9790878295898438  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9791560173034668  GigaBytes
Max Memory Allocated: 0.9791560173034668  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9876246452331543  GigaBytes
Max Memory Allocated: 0.9882245063781738  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9881258010864258  GigaBytes
Max Memory Allocated: 0.9882245063781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9881258010864258  GigaBytes
Max Memory Allocated: 0.9882245063781738  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.988184928894043  GigaBytes
Max Memory Allocated: 0.9882245063781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9956941604614258  GigaBytes
Max Memory Allocated: 0.9962263107299805  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9961395263671875  GigaBytes
Max Memory Allocated: 0.9962263107299805  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9961395263671875  GigaBytes
Max Memory Allocated: 0.9962263107299805  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.9961891174316406  GigaBytes
Max Memory Allocated: 0.9962263107299805  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0028343200683594  GigaBytes
Max Memory Allocated: 1.003305435180664  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0032711029052734  GigaBytes
Max Memory Allocated: 1.003305435180664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0032711029052734  GigaBytes
Max Memory Allocated: 1.003305435180664  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.003316879272461  GigaBytes
Max Memory Allocated: 1.003316879272461  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0097713470458984  GigaBytes
Max Memory Allocated: 1.0102291107177734  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0102128982543945  GigaBytes
Max Memory Allocated: 1.0102291107177734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0102128982543945  GigaBytes
Max Memory Allocated: 1.0102291107177734  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0102567672729492  GigaBytes
Max Memory Allocated: 1.0102567672729492  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.016749382019043  GigaBytes
Max Memory Allocated: 1.0172100067138672  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0170869827270508  GigaBytes
Max Memory Allocated: 1.0172100067138672  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0170869827270508  GigaBytes
Max Memory Allocated: 1.0172100067138672  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0171194076538086  GigaBytes
Max Memory Allocated: 1.0172100067138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0221452713012695  GigaBytes
Max Memory Allocated: 1.0225019454956055  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0224609375  GigaBytes
Max Memory Allocated: 1.0225019454956055  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0224609375  GigaBytes
Max Memory Allocated: 1.0225019454956055  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0224895477294922  GigaBytes
Max Memory Allocated: 1.0225019454956055  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0271244049072266  GigaBytes
Max Memory Allocated: 1.0274534225463867  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0275945663452148  GigaBytes
Max Memory Allocated: 1.0275964736938477  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0275945663452148  GigaBytes
Max Memory Allocated: 1.0275964736938477  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.027634620666504  GigaBytes
Max Memory Allocated: 1.027634620666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0344038009643555  GigaBytes
Max Memory Allocated: 1.0348844528198242  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([315, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0419530868530273  GigaBytes
Max Memory Allocated: 1.041982650756836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0419530868530273  GigaBytes
Max Memory Allocated: 1.041982650756836  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0425539016723633  GigaBytes
Max Memory Allocated: 1.0425539016723633  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.1538152694702148  GigaBytes
Max Memory Allocated: 1.161325454711914  GigaBytes

rst.shape  torch.Size([1, 315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.133791446685791  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.134206771850586  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.1346220970153809  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.134185791015625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

torch.Size([2786, 40])
input nodes number: 12428
output nodes number: 2786
edges number: 23394
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.1342859268188477  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.1342864036560059  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.024127960205078125  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

pseudo mini batch 21 input nodes size: 28563
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.021615028381347656  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.021615028381347656  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.035286903381347656  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.035307884216308594  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.019661903381347656  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.02030181884765625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.02030181884765625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.02030181884765625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

torch.Size([28563, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.02030181884765625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

m.shape torch.Size([848, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.05479764938354492  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.05479764938354492  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.05560636520385742  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.06207609176635742  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([844, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.06247663497924805  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.06247663497924805  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.06328153610229492  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.0761256217956543  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([717, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.07674884796142578  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.07674884796142578  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.07743263244628906  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.09315729141235352  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([649, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.09405326843261719  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.09405326843261719  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 649, 128]), torch.Size([1, 649, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.09467220306396484  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.11339187622070312  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 649, 128])
m.shape torch.Size([588, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.11448431015014648  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.11448431015014648  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.11504507064819336  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.1358809471130371  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([509, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.13705682754516602  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.13705682754516602  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.1375422477722168  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.1584153175354004  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([410, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.15954113006591797  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.15954113006591797  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 410, 128]), torch.Size([1, 410, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.15993213653564453  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.17948246002197266  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 410, 128])
m.shape torch.Size([408, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.18084335327148438  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.18084335327148438  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.18123245239257812  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.20341110229492188  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([383, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.20486021041870117  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.20486021041870117  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.20522546768188477  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.22860193252563477  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([4560, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.25016307830810547  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.25016307830810547  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 4560, 128]), torch.Size([1, 4560, 128])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.255277156829834  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.564847469329834  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 4560, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5340051651000977  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.543461799621582  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5529184341430664  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5433878898620605  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

torch.Size([9916, 256])
first layer input nodes number: 28563
first layer output nodes number: 9916
edges number: 68458
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5537514686584473  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5632081031799316  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.566190242767334  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.566190242767334  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

m.shape torch.Size([586, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5835309028625488  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5835309028625488  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 586, 256]), torch.Size([1, 586, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.584648609161377  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5944943428039551  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 586, 256])
m.shape torch.Size([445, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5947909355163574  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.5947909355163574  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.595639705657959  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6110033988952637  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([326, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6115193367004395  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6115193367004395  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6121411323547363  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6334118843078613  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([219, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6339430809020996  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6339430809020996  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6343607902526855  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6464743614196777  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6472558975219727  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6472558975219727  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.647648811340332  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6617937088012695  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6624507904052734  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6624507904052734  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6627330780029297  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6748714447021484  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.675504207611084  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.675504207611084  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6757235527038574  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6866908073425293  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6874423027038574  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6874423027038574  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6876559257507324  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.6998324394226074  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.700469970703125  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.700469970703125  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7006340026855469  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7111320495605469  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7116847038269043  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7116847038269043  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7118105888366699  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7207484245300293  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7211718559265137  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7211718559265137  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.721259593963623  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7281031608581543  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7285208702087402  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7285208702087402  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7285971641540527  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7350821495056152  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7354941368103027  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7354941368103027  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.735562801361084  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.741879940032959  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7421689033508301  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7421689033508301  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7422146797180176  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7467465400695801  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7470555305480957  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7470555305480957  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7470993995666504  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7517495155334473  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7519431114196777  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7519431114196777  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7519698143005371  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7549872398376465  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7552189826965332  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7552189826965332  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7552475929260254  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7586808204650879  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.758995532989502  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.758995532989502  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7590317726135254  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.763634204864502  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7640547752380371  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7640547752380371  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7641005516052246  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7702345848083496  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7705769538879395  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7705769538879395  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7706131935119629  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7757229804992676  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7760076522827148  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7760076522827148  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.776036262512207  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7802705764770508  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7805314064025879  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7805314064025879  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7805562019348145  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7843995094299316  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.784630298614502  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.784630298614502  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7846512794494629  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7880501747131348  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7881784439086914  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7881784439086914  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7881898880004883  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7901239395141602  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([166, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7941069602966309  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7941069602966309  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.7944235801696777  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.8501486778259277  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 166, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.8365063667297363  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.8369207382202148  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.8373351097106934  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.8368997573852539  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

torch.Size([2780, 40])
input nodes number: 9916
output nodes number: 2780
edges number: 17323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.8369936943054199  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.8369941711425781  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.021537303924560547  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

pseudo mini batch 22 input nodes size: 39474
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.01966094970703125  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.01966094970703125  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.03919219970703125  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.03921318054199219  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.02552032470703125  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.026763916015625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.026763916015625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.026763916015625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

torch.Size([39474, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 0.026763916015625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

m.shape torch.Size([501, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.0930471420288086  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.0930471420288086  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.09352493286132812  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.09734725952148438  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([587, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.09766817092895508  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.09766817092895508  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.09822797775268555  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.10662508010864258  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([514, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.10708045959472656  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.10708045959472656  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.10757064819335938  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.11844635009765625  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([509, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.1191720962524414  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.1191720962524414  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.11965751647949219  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.13373470306396484  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([495, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.1346721649169922  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.1346721649169922  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.13514423370361328  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.15213871002197266  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([487, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.15329599380493164  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.15329599380493164  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.15376043319702148  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.17373132705688477  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([490, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.17513465881347656  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.17513465881347656  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.17560195922851562  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.19896697998046875  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([478, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.20055675506591797  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.20055675506591797  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 478, 128]), torch.Size([1, 478, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.20101261138916016  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.22699642181396484  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 478, 128])
m.shape torch.Size([501, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.22891855239868164  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.22891855239868164  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.22939634323120117  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5780029296875 GB
    Memory Allocated: 0.25997495651245117  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([11164, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.3129701614379883  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.3129701614379883  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 11164, 128]), torch.Size([1, 11164, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.32361698150634766  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.083165168762207  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 11164, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0205888748168945  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0355863571166992  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.050583839416504  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0354690551757812  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

torch.Size([15726, 256])
first layer input nodes number: 39474
first layer output nodes number: 15726
edges number: 134053
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.050879955291748  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0658774375915527  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.069974422454834  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.069974422454834  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

m.shape torch.Size([307, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.10182523727417  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.10182523727417  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1024107933044434  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1084418296813965  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([285, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1086969375610352  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1086969375610352  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1092405319213867  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1173944473266602  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([225, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1177716255187988  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1177716255187988  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1182007789611816  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1276421546936035  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([151, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1280083656311035  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1280083656311035  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1282963752746582  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1366486549377441  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([132, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1371393203735352  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1371393203735352  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1373910903930664  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1464548110961914  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([113, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1469807624816895  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1469807624816895  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1471962928771973  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1564640998840332  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([99, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.157022476196289  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.157022476196289  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1572113037109375  GigaBytes
Max Memory Allocated: 1.1614933013916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1666526794433594  GigaBytes
Max Memory Allocated: 1.167313575744629  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1670584678649902  GigaBytes
Max Memory Allocated: 1.167313575744629  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1670584678649902  GigaBytes
Max Memory Allocated: 1.167313575744629  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.167182445526123  GigaBytes
Max Memory Allocated: 1.167313575744629  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1742491722106934  GigaBytes
Max Memory Allocated: 1.1747450828552246  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.174818992614746  GigaBytes
Max Memory Allocated: 1.1748218536376953  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.174818992614746  GigaBytes
Max Memory Allocated: 1.1748218536376953  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1749582290649414  GigaBytes
Max Memory Allocated: 1.1749582290649414  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1838693618774414  GigaBytes
Max Memory Allocated: 1.1844959259033203  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([55, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.184328556060791  GigaBytes
Max Memory Allocated: 1.1844959259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.184328556060791  GigaBytes
Max Memory Allocated: 1.1844959259033203  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1844334602355957  GigaBytes
Max Memory Allocated: 1.1844959259033203  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1918816566467285  GigaBytes
Max Memory Allocated: 1.192406177520752  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1925058364868164  GigaBytes
Max Memory Allocated: 1.1925086975097656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1925058364868164  GigaBytes
Max Memory Allocated: 1.1925086975097656  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1926279067993164  GigaBytes
Max Memory Allocated: 1.1926279067993164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2021493911743164  GigaBytes
Max Memory Allocated: 1.2028207778930664  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.202711582183838  GigaBytes
Max Memory Allocated: 1.2028207778930664  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.202711582183838  GigaBytes
Max Memory Allocated: 1.2028207778930664  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2028145790100098  GigaBytes
Max Memory Allocated: 1.2028207778930664  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2115693092346191  GigaBytes
Max Memory Allocated: 1.2121872901916504  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2121176719665527  GigaBytes
Max Memory Allocated: 1.2121872901916504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2121176719665527  GigaBytes
Max Memory Allocated: 1.2121872901916504  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2122092247009277  GigaBytes
Max Memory Allocated: 1.2122092247009277  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2206320762634277  GigaBytes
Max Memory Allocated: 1.2212271690368652  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2212457656860352  GigaBytes
Max Memory Allocated: 1.2212486267089844  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2212457656860352  GigaBytes
Max Memory Allocated: 1.2212486267089844  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.221339225769043  GigaBytes
Max Memory Allocated: 1.221339225769043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2305917739868164  GigaBytes
Max Memory Allocated: 1.231245994567871  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2310209274291992  GigaBytes
Max Memory Allocated: 1.231245994567871  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2310209274291992  GigaBytes
Max Memory Allocated: 1.231245994567871  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.231083869934082  GigaBytes
Max Memory Allocated: 1.231245994567871  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2377557754516602  GigaBytes
Max Memory Allocated: 1.2382278442382812  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2382473945617676  GigaBytes
Max Memory Allocated: 1.2382497787475586  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2382473945617676  GigaBytes
Max Memory Allocated: 1.2382497787475586  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2383122444152832  GigaBytes
Max Memory Allocated: 1.2383122444152832  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2456402778625488  GigaBytes
Max Memory Allocated: 1.2461590766906738  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2461471557617188  GigaBytes
Max Memory Allocated: 1.2461590766906738  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2461471557617188  GigaBytes
Max Memory Allocated: 1.2461590766906738  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2462100982666016  GigaBytes
Max Memory Allocated: 1.2462100982666016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.253763198852539  GigaBytes
Max Memory Allocated: 1.254298210144043  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2543721199035645  GigaBytes
Max Memory Allocated: 1.2543749809265137  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2543721199035645  GigaBytes
Max Memory Allocated: 1.2543749809265137  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2544426918029785  GigaBytes
Max Memory Allocated: 1.2544426918029785  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2634053230285645  GigaBytes
Max Memory Allocated: 1.264040470123291  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.264082431793213  GigaBytes
Max Memory Allocated: 1.264085292816162  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.264082431793213  GigaBytes
Max Memory Allocated: 1.264085292816162  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2641568183898926  GigaBytes
Max Memory Allocated: 1.2641568183898926  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2741246223449707  GigaBytes
Max Memory Allocated: 1.2748312950134277  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.27479887008667  GigaBytes
Max Memory Allocated: 1.2748312950134277  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.27479887008667  GigaBytes
Max Memory Allocated: 1.2748312950134277  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.274869441986084  GigaBytes
Max Memory Allocated: 1.274869441986084  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2848200798034668  GigaBytes
Max Memory Allocated: 1.2855257987976074  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2852492332458496  GigaBytes
Max Memory Allocated: 1.2855257987976074  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2852492332458496  GigaBytes
Max Memory Allocated: 1.2855257987976074  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2852931022644043  GigaBytes
Max Memory Allocated: 1.2855257987976074  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.291785717010498  GigaBytes
Max Memory Allocated: 1.2922463417053223  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.292335033416748  GigaBytes
Max Memory Allocated: 1.292337417602539  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.292335033416748  GigaBytes
Max Memory Allocated: 1.292337417602539  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.292386531829834  GigaBytes
Max Memory Allocated: 1.292386531829834  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3003687858581543  GigaBytes
Max Memory Allocated: 1.3009352684020996  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3008294105529785  GigaBytes
Max Memory Allocated: 1.3009352684020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3008294105529785  GigaBytes
Max Memory Allocated: 1.3009352684020996  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3008713722229004  GigaBytes
Max Memory Allocated: 1.3009352684020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3076691627502441  GigaBytes
Max Memory Allocated: 1.3081517219543457  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3082714080810547  GigaBytes
Max Memory Allocated: 1.308274269104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3082714080810547  GigaBytes
Max Memory Allocated: 1.308274269104004  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3083229064941406  GigaBytes
Max Memory Allocated: 1.3083229064941406  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.317026138305664  GigaBytes
Max Memory Allocated: 1.3176441192626953  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([726, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3344449996948242  GigaBytes
Max Memory Allocated: 1.334512710571289  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.3344449996948242  GigaBytes
Max Memory Allocated: 1.334512710571289  GigaBytes

 h.shape torch.Size([1, 726, 256]), torch.Size([1, 726, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.335829734802246  GigaBytes
Max Memory Allocated: 1.335829734802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.5834741592407227  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 726, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.5541529655456543  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.5545639991760254  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.5549750328063965  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.5545430183410645  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([2758, 40])
input nodes number: 15726
output nodes number: 2758
edges number: 32704
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.554677963256836  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.5546784400939941  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02892589569091797  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

pseudo mini batch 23 input nodes size: 34315
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.025516986846923828  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.04187965393066406  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.041900634765625  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.022348403930664062  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.023220062255859375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.023220062255859375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.023220062255859375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([34315, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.023220062255859375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

m.shape torch.Size([737, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.06978893280029297  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.06978893280029297  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07049179077148438  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07689428329467773  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([800, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07730579376220703  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07730579376220703  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07806873321533203  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08951282501220703  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([681, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09010553359985352  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09010553359985352  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09075498580932617  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.10566282272338867  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([622, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.10652446746826172  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.10652446746826172  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 622, 128]), torch.Size([1, 622, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1071176528930664  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.12432003021240234  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 622, 128])
m.shape torch.Size([560, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.12535858154296875  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.12535858154296875  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.12589263916015625  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.14559173583984375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([511, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.14678668975830078  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.14678668975830078  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.14727401733398438  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1682291030883789  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([491, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.17039918899536133  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.17039918899536133  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1708674430847168  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.19428014755249023  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([445, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.19574356079101562  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.19574356079101562  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1961679458618164  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.22035789489746094  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([381, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.22178077697753906  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.22178077697753906  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.22214412689208984  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.24539852142333984  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([7131, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2792201042175293  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2792201042175293  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 7131, 128]), torch.Size([1, 7131, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.28602075576782227  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.768867015838623  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 7131, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7261152267456055  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7379016876220703  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7496881484985352  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7378091812133789  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([12359, 256])
first layer input nodes number: 34315
first layer output nodes number: 12359
edges number: 94470
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.749946117401123  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7617325782775879  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7646794319152832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7646794319152832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

m.shape torch.Size([475, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7869119644165039  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7869119644165039  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7878179550170898  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7956671714782715  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([396, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7959756851196289  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7959756851196289  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.7967309951782227  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8091545104980469  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8096394538879395  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8096394538879395  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8102097511291504  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8237624168395996  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8244080543518066  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8244080543518066  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8248696327209473  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8382554054260254  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([166, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8388223648071289  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8388223648071289  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8391389846801758  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8505373001098633  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([116, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8510479927062988  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8510479927062988  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8512692451477051  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8607831001281738  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8614597320556641  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8614597320556641  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8616828918457031  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8728408813476562  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8734598159790039  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8734598159790039  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8736410140991211  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8839693069458008  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8844585418701172  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8844585418701172  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8845863342285156  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8927650451660156  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8934416770935059  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8934416770935059  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8935885429382324  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9040160179138184  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9044923782348633  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9044923782348633  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9045915603637695  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.912327766418457  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9128780364990234  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9128780364990234  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9129772186279297  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9214076995849609  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9218330383300781  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9218330383300781  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.921905517578125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9285736083984375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9290084838867188  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9290084838867188  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9290752410888672  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9356842041015625  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9362421035766602  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9362421035766602  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9363203048706055  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9446096420288086  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9450011253356934  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9450011253356934  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9450545310974121  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9510893821716309  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9516839981079102  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9516839981079102  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.951756477355957  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.960453987121582  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.960902214050293  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.960902214050293  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9609556198120117  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.967738151550293  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9681682586669922  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9681682586669922  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9682159423828125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9746055603027344  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.974851131439209  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.974851131439209  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9748778343200684  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9786429405212402  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9791545867919922  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9791545867919922  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9792041778564453  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9865436553955078  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9868149757385254  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9868149757385254  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9868416786193848  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9909806251525879  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9910778999328613  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9910778999328613  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9910874366760254  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9926323890686035  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9929509162902832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9929509162902832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9929776191711426  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.997490406036377  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([329, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0054216384887695  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0054216384887695  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0060491561889648  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1213297843933105  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 329, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1021194458007812  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1025352478027344  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1029510498046875  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1025142669677734  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([2789, 40])
input nodes number: 12359
output nodes number: 2789
edges number: 22288
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1026325225830078  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.102632999420166  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.024828433990478516  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

pseudo mini batch 24 input nodes size: 42878
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.022353172302246094  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.022353172302246094  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.04279899597167969  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.042819976806640625  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.026436328887939453  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.027384281158447266  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.027384281158447266  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.027384281158447266  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([42878, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.027384281158447266  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

m.shape torch.Size([703, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07947969436645508  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07947969436645508  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 703, 128]), torch.Size([1, 703, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08015012741088867  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08572149276733398  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 703, 128])
m.shape torch.Size([790, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08613967895507812  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08613967895507812  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08689308166503906  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09819412231445312  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([715, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09885597229003906  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09885597229003906  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09953784942626953  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11507892608642578  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([672, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11601972579956055  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11601972579956055  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11666059494018555  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.13560819625854492  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([627, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.13678264617919922  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.13678264617919922  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.13738059997558594  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.15918779373168945  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([549, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1604595184326172  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1604595184326172  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.16098308563232422  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18393802642822266  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([518, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18540525436401367  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18540525436401367  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1858992576599121  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.21135568618774414  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([503, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.21388959884643555  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.21388959884643555  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2143692970275879  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.24171209335327148  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([459, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.24344205856323242  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.24344205856323242  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2438797950744629  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2718949317932129  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([8049, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3100566864013672  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.3100566864013672  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 8049, 128]), torch.Size([1, 8049, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.31855106353759766  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8710565567016602  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 8049, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8222970962524414  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8352527618408203  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8482084274291992  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.835151195526123  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([13585, 256])
first layer input nodes number: 42878
first layer output nodes number: 13585
edges number: 105816
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8485298156738281  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.861485481262207  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8656644821166992  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8656644821166992  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

m.shape torch.Size([450, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8867497444152832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8867497444152832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8876080513000488  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8955545425415039  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([383, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8958616256713867  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8958616256713867  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8965921401977539  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9078378677368164  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9082860946655273  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9082860946655273  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9088239669799805  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9214506149291992  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9220662117004395  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9220662117004395  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9225049018859863  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9352269172668457  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9359641075134277  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9359641075134277  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9363436698913574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9500079154968262  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9506373405456543  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9506373405456543  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9509081840515137  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9625544548034668  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9632129669189453  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9632129669189453  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9634380340576172  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9746913909912109  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9754786491394043  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9754786491394043  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9757018089294434  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9884219169616699  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9890890121459961  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9890890121459961  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9892606735229492  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0002470016479492  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0008535385131836  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0008535385131836  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.000990867614746  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0107412338256836  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.011275291442871  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.011275291442871  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0113840103149414  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0198640823364258  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0202713012695312  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0202713012695312  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0203475952148438  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0268325805664062  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0275068283081055  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0275068283081055  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0276155471801758  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0376176834106445  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0380616188049316  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0380616188049316  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0381321907043457  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.045118808746338  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0456891059875488  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0456891059875488  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.045769214630127  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0542607307434082  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.054605484008789  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.054605484008789  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0546531677246094  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0600414276123047  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0603938102722168  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0603938102722168  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0604376792907715  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.065701961517334  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0661821365356445  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0661821365356445  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.066237449645996  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0732622146606445  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.073709487915039  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.073709487915039  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0737590789794922  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.080404281616211  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.080841064453125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.080841064453125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0808868408203125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.08734130859375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.087641716003418  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.087641716003418  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.087672233581543  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.092188835144043  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0924487113952637  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0924487113952637  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0924735069274902  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0963168144226074  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0965919494628906  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0965919494628906  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0966167449951172  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1006336212158203  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1010136604309082  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1010136604309082  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.101046085357666  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1065258979797363  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([265, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.113736629486084  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.113736629486084  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1142420768737793  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.2046561241149902  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 265, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1866016387939453  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.187014102935791  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1874265670776367  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.18699312210083  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([2767, 40])
input nodes number: 13585
output nodes number: 2767
edges number: 21358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1871123313903809  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.187112808227539  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.029144287109375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

pseudo mini batch 25 input nodes size: 40832
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02643299102783203  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02643299102783203  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.04596424102783203  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.04598522186279297  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.025518417358398438  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02646350860595703  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02646350860595703  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02646350860595703  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([40832, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02646350860595703  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

m.shape torch.Size([740, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07792043685913086  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07792043685913086  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 740, 128]), torch.Size([1, 740, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.07862615585327148  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08491086959838867  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 740, 128])
m.shape torch.Size([775, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0852971076965332  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0852971076965332  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.08603620529174805  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.0971226692199707  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([758, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09783744812011719  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09783744812011719  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.09856033325195312  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11529064178466797  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([681, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11622810363769531  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11622810363769531  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 681, 128]), torch.Size([1, 681, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.11687755584716797  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.13666534423828125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 681, 128])
m.shape torch.Size([633, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1378498077392578  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1378498077392578  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.13845348358154297  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.16115045547485352  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([523, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.16234493255615234  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.16234493255615234  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1628437042236328  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18482208251953125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([490, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18620824813842773  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.18620824813842773  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.1866755485534668  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.21004056930541992  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([484, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2116532325744629  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2116532325744629  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.21211481094360352  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.23842477798461914  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([395, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.23988914489746094  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.23988914489746094  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2402658462524414  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.2643747329711914  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([8002, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.30234289169311523  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.30234289169311523  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 8002, 128]), torch.Size([1, 8002, 128])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.30997419357299805  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8620343208312988  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 8002, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8141207695007324  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8269772529602051  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8398337364196777  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8268766403198242  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([13481, 256])
first layer input nodes number: 40832
first layer output nodes number: 13481
edges number: 104468
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8401398658752441  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8529963493347168  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8562107086181641  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8562107086181641  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

m.shape torch.Size([428, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8783984184265137  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8783984184265137  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8792147636413574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8871474266052246  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8874735832214355  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8874735832214355  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8882021903991699  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8993487358093262  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8998122215270996  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.8998122215270996  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9003596305847168  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9139056205749512  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9146943092346191  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9146943092346191  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9151997566223145  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9310059547424316  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9316377639770508  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9316377639770508  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9319887161254883  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9446229934692383  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9452376365661621  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9452376365661621  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9454989433288574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9567351341247559  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([104, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9573044776916504  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9573044776916504  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9575028419494629  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9674210548400879  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9681215286254883  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9681215286254883  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9683198928833008  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9796266555786133  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9802889823913574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9802889823913574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9804568290710449  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9911990165710449  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.991797924041748  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.991797924041748  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.9919333457946777  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0015482902526855  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.00217866897583  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.00217866897583  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0023045539855957  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0121235847473145  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.012671947479248  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.012671947479248  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.012773036956787  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0213656425476074  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0219149589538574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0219149589538574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0220065116882324  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0304293632507324  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0308818817138672  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0308818817138672  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0309524536132812  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0379390716552734  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0383076667785645  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0383076667785645  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0383610725402832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0440220832824707  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0443801879882812  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0443801879882812  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0444278717041016  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0498161315917969  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0502338409423828  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0502338409423828  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0502853393554688  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0564651489257812  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0569586753845215  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0569586753845215  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0570158958435059  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0642828941345215  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0645833015441895  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0645833015441895  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.06461763381958  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0692181587219238  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0694704055786133  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0694704055786133  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0694971084594727  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0732622146606445  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0736327171325684  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0736327171325684  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0736689567565918  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0790324211120605  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.079289436340332  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.079289436340332  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0793142318725586  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0831575393676758  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0835213661193848  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0835213661193848  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0835537910461426  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0888066291809082  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0890674591064453  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0890674591064453  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.089090347290039  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.0929584503173828  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([321, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1016349792480469  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1016349792480469  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1022472381591797  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.212597370147705  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 321, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.193850040435791  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1942644119262695  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.194678783416748  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1942434310913086  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([2778, 40])
input nodes number: 13481
output nodes number: 2778
edges number: 22251
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1943669319152832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.1943674087524414  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.028214454650878906  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

pseudo mini batch 26 input nodes size: 50630
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02552032470703125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.02552032470703125  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.04966259002685547  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.049683570861816406  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.03013134002685547  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.031493186950683594  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.031493186950683594  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.031493186950683594  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([50630, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 0.031493186950683594  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

m.shape torch.Size([605, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.10679388046264648  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.10679388046264648  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.10737085342407227  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.11208105087280273  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([712, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.1124715805053711  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.1124715805053711  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 712, 128]), torch.Size([1, 712, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.11315059661865234  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.1233358383178711  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 712, 128])
m.shape torch.Size([669, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.12395334243774414  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.12395334243774414  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 669, 128]), torch.Size([1, 669, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.12459135055541992  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.13929128646850586  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 669, 128])
m.shape torch.Size([630, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.14017391204833984  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.14017391204833984  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.14077472686767578  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.15819835662841797  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([576, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.159271240234375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.159271240234375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.159820556640625  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.1796703338623047  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([600, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.1818370819091797  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.1818370819091797  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 600, 128]), torch.Size([1, 600, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.18240928649902344  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.2077617645263672  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 600, 128])
m.shape torch.Size([573, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.20938825607299805  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.20938825607299805  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.20993471145629883  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.23792171478271484  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([554, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.2397618293762207  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.2397618293762207  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.24029016494750977  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.2712368965148926  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([530, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.27324724197387695  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.27324724197387695  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.27375268936157227  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.30698204040527344  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([12723, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.3673973083496094  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.3673973083496094  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 12723, 128]), torch.Size([1, 12723, 128])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 0.3795309066772461  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2411890029907227  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 12723, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.1702580451965332  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.1875882148742676  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.204918384552002  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.187452793121338  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

torch.Size([18172, 256])
first layer input nodes number: 50630
first layer output nodes number: 18172
edges number: 153479
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2052979469299316  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.222628116607666  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2269930839538574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2269930839538574  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

m.shape torch.Size([340, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2554068565368652  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2554068565368652  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2560553550720215  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2613449096679688  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([335, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.261664867401123  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.261664867401123  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2623038291931152  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.274763584136963  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([243, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2751450538635254  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2751450538635254  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2756085395812988  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2858052253723145  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([185, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2862849235534668  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2862849235534668  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.286637783050537  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2968707084655762  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2974200248718262  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2974200248718262  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2977080345153809  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3080763816833496  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([115, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3085956573486328  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3085956573486328  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3088150024414062  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.318246841430664  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([96, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3187832832336426  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3187832832336426  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3189663887023926  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3281216621398926  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([82, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3286609649658203  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3286609649658203  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.328817367553711  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3377323150634766  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3383550643920898  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3383550643920898  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3385095596313477  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3483972549438477  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3490605354309082  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3490605354309082  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3492074012756348  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3596348762512207  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3600797653198242  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3600797653198242  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.360173225402832  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3674631118774414  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3679471015930176  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3679471015930176  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.368034839630127  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3754925727844238  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.375898838043213  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.375898838043213  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3759675025939941  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3822846412658691  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3828558921813965  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3828558921813965  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.382941722869873  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3914389610290527  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3920016288757324  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3920016288757324  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3920817375183105  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4005732536315918  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4010100364685059  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4010100364685059  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.401069164276123  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4077506065368652  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4082112312316895  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4082112312316895  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4082684516906738  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4151349067687988  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.415815830230713  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.415815830230713  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4158940315246582  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.425825595855713  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.426225185394287  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.426225185394287  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4262709617614746  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4324049949645996  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4331321716308594  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4331321716308594  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.433206558227539  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.443695068359375  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4441022872924805  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4441022872924805  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4441442489624023  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4503545761108398  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4506721496582031  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4506721496582031  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4507026672363281  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4554328918457031  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4559926986694336  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4559926986694336  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4560422897338867  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.464076042175293  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4644665718078613  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4644665718078613  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.464500904083252  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4703030586242676  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([588, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4844145774841309  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4844145774841309  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4855360984802246  GigaBytes
Max Memory Allocated: 1.600783348083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.683596134185791  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 588, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.657848834991455  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6582598686218262  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6586709022521973  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6582388877868652  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

torch.Size([2758, 40])
input nodes number: 18172
output nodes number: 2758
edges number: 29094
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6583919525146484  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6583924293518066  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.033884525299072266  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

pseudo mini batch 27 input nodes size: 49805
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.030128002166748047  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.030128002166748047  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.05387687683105469  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.053897857666015625  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.02973461151123047  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03109264373779297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03109264373779297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03109264373779297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

torch.Size([49805, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03109264373779297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

m.shape torch.Size([591, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.10629558563232422  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.10629558563232422  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.10685920715332031  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.11188268661499023  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([644, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.11221504211425781  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.11221504211425781  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 644, 128]), torch.Size([1, 644, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.11282920837402344  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.12204170227050781  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 644, 128])
m.shape torch.Size([621, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.12262296676635742  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.12262296676635742  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.1232151985168457  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.13673830032348633  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([544, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.13756084442138672  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.13756084442138672  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.13807964324951172  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.15346431732177734  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([627, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.15469980239868164  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.15469980239868164  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 627, 128]), torch.Size([1, 627, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.15529775619506836  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.1775531768798828  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 627, 128])
m.shape torch.Size([603, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.17897939682006836  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.17897939682006836  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 603, 128]), torch.Size([1, 603, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.17955446243286133  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.20579195022583008  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 603, 128])
m.shape torch.Size([562, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.2073802947998047  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.2073802947998047  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.207916259765625  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.2353658676147461  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([545, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.23785972595214844  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.23785972595214844  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.23837947845458984  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.2680377960205078  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([573, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.2702369689941406  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.2702369689941406  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 573, 128]), torch.Size([1, 573, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.2707834243774414  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.3067746162414551  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 573, 128])
m.shape torch.Size([12718, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.3671455383300781  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.3671455383300781  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 12718, 128]), torch.Size([1, 12718, 128])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.3792743682861328  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2406368255615234  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 12718, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.1697263717651367  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.1869192123413086  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2041120529174805  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.1867847442626953  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

torch.Size([18028, 256])
first layer input nodes number: 49805
first layer output nodes number: 18028
edges number: 153302
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2044854164123535  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2216782569885254  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2265124320983887  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2265124320983887  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

m.shape torch.Size([347, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.254709243774414  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.254709243774414  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.25537109375  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2607088088989258  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([302, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2609586715698242  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2609586715698242  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2615346908569336  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.271285057067871  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([227, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2716517448425293  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2716517448425293  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2720847129821777  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2816100120544434  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([158, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.28200101852417  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.28200101852417  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2823023796081543  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2910418510437012  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2917661666870117  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2917661666870117  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.2921133041381836  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.304610252380371  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3052616119384766  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3052616119384766  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3055343627929688  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3172626495361328  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([94, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3177590370178223  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3177590370178223  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3179383277893066  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3269028663635254  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3274669647216797  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3274669647216797  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3276290893554688  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3368701934814453  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.337446689605713  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.337446689605713  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3375916481018066  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3468689918518066  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3473443984985352  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3473443984985352  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3474531173706055  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3551721572875977  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3559002876281738  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3559002876281738  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.356041431427002  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3670506477355957  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3676724433898926  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3676724433898926  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3677868843078613  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.377514362335205  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3780946731567383  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3780946731567383  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3781919479370117  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.387141227722168  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.387563705444336  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.387563705444336  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3876304626464844  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3942394256591797  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.39485502243042  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.39485502243042  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.3949408531188965  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.404038906097412  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([54, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4048266410827637  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4048266410827637  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4049296379089355  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4165682792663574  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4170889854431152  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4170889854431152  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4171557426452637  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4251666069030762  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4258427619934082  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4258427619934082  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4259209632873535  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4358525276184082  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4363799095153809  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4363799095153809  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.436439037322998  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4443621635437012  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.444967269897461  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.444967269897461  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4450302124023438  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4539051055908203  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4547820091247559  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4547820091247559  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4548678398132324  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4675707817077637  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4680566787719727  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4680566787719727  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.468104362487793  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4754953384399414  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4759140014648438  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4759140014648438  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4759521484375  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4821319580078125  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4827375411987305  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.4907960891723633  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([515, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.5031471252441406  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.5031471252441406  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.504129409790039  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6794013977050781  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 515, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.653947353363037  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6543588638305664  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6547703742980957  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.6543378829956055  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

torch.Size([2760, 40])
input nodes number: 18028
output nodes number: 2760
edges number: 28862
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.654493808746338  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 1.654494285583496  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03347301483154297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

pseudo mini batch 28 input nodes size: 47335
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.029735088348388672  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.029735088348388672  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.05317258834838867  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.05319356918334961  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.02942371368408203  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03089618682861328  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03089618682861328  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03089618682861328  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

torch.Size([47335, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6678466796875 GB
    Memory Allocated: 0.03089618682861328  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

m.shape torch.Size([570, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.11169242858886719  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.11169242858886719  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.11223602294921875  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.11699342727661133  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([598, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.11729192733764648  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.11729192733764648  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.11786222457885742  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.12641668319702148  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([553, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.126922607421875  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.126922607421875  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.12744998931884766  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.13948726654052734  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([506, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.14018869400024414  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.14018869400024414  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.1406712532043457  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.15466547012329102  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([554, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.1557450294494629  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.1557450294494629  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 554, 128]), torch.Size([1, 554, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.15627336502075195  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.17603063583374023  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 554, 128])
m.shape torch.Size([518, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.17724847793579102  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.17724847793579102  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.17774248123168945  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.19966554641723633  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([513, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.20121145248413086  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.20121145248413086  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.20170068740844727  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.2271103858947754  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([509, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.2288074493408203  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.2288074493408203  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.2292928695678711  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.2569618225097656  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([501, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.2588691711425781  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.2588691711425781  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.25934696197509766  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.28992557525634766  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([14130, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.35706377029418945  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.35706377029418945  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 14130, 128]), torch.Size([1, 14130, 128])
----------------------------------------3
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.37064313888549805  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3360419273376465  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 14130, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2593994140625  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2774734497070312  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2955474853515625  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.277331829071045  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

torch.Size([18952, 256])
first layer input nodes number: 47335
first layer output nodes number: 18952
edges number: 164799
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2959022521972656  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3139762878417969  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3184947967529297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3184947967529297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

m.shape torch.Size([344, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3503971099853516  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3503971099853516  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.351053237915039  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3567371368408203  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([263, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.35691499710083  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.35691499710083  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3574166297912598  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3670110702514648  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([200, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3673372268676758  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3673372268676758  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3677186965942383  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3761110305786133  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([148, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3764896392822266  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3764896392822266  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3767719268798828  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.384958267211914  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([128, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.385432243347168  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.385432243347168  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.385676383972168  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.394465446472168  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([112, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3949894905090332  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3949894905090332  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3952031135559082  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4043889045715332  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.404874324798584  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.404874324798584  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4050421714782715  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4134345054626465  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([67, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4138660430908203  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4138660430908203  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4139938354492188  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4212779998779297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4218978881835938  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4218978881835938  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.422048568725586  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.431692123413086  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([63, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4322223663330078  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4322223663330078  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.432342529296875  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4408740997314453  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.441596508026123  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.441596508026123  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4417376518249512  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.452746868133545  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4534029960632324  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4534029960632324  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4535231590270996  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4637370109558105  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4642267227172852  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4642267227172852  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.464310646057129  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.472031593322754  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.472555160522461  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.472555160522461  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.472635269165039  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4805660247802734  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4811172485351562  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4811172485351562  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4811954498291016  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4894847869873047  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4900150299072266  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4900150299072266  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4900856018066406  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4980602264404297  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.498744010925293  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.498744010925293  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4988279342651367  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5088987350463867  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5094971656799316  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5094971656799316  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5095677375793457  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5185303688049316  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5189518928527832  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5189518928527832  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5189995765686035  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5253891944885254  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5259037017822266  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5259037017822266  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5259571075439453  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.533487319946289  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5342683792114258  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5342683792114258  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5343446731567383  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5456361770629883  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5460844039916992  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5460844039916992  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.546128273010254  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5529279708862305  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5534586906433105  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5534586906433105  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5535063743591309  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5612311363220215  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5618762969970703  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5618762969970703  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5619316101074219  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.571279525756836  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([714, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5884079933166504  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5884079933166504  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5897698402404785  GigaBytes
Max Memory Allocated: 1.697615146636963  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.8376336097717285  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 714, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.8083081245422363  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.8087191581726074  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.8091301918029785  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.8086981773376465  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

torch.Size([2758, 40])
input nodes number: 18952
output nodes number: 2758
edges number: 32720
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.8088603019714355  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.8088607788085938  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.033421993255615234  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

pseudo mini batch 29 input nodes size: 41582
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.029423236846923828  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.029423236846923828  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.04925107955932617  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.049273014068603516  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.025814533233642578  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.027297496795654297  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.027297496795654297  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.027297496795654297  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

torch.Size([41582, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.027297496795654297  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

m.shape torch.Size([436, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.10519981384277344  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.10519981384277344  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.10561561584472656  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.10894203186035156  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([456, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.10916900634765625  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.10916900634765625  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.1096038818359375  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.11612701416015625  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([464, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.11657333374023438  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.11657333374023438  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.11701583862304688  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.12675094604492188  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([484, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.12745285034179688  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.12745285034179688  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.1279144287109375  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.14130020141601562  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([459, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.14272594451904297  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.14272594451904297  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.14316368103027344  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.1589221954345703  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([465, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.1600337028503418  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.1600337028503418  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.1604771614074707  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.17954587936401367  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([481, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.18092966079711914  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.18092966079711914  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 481, 128]), torch.Size([1, 481, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.18138837814331055  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.20432424545288086  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 481, 128])
m.shape torch.Size([444, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.20578861236572266  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.20578861236572266  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 444, 128]), torch.Size([1, 444, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.20621204376220703  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.2303476333618164  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 444, 128])
m.shape torch.Size([499, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.23227739334106445  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.23227739334106445  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.23275327682495117  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.26320981979370117  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([13786, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.3287086486816406  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.3287086486816406  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 13786, 128]), torch.Size([1, 13786, 128])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 0.3418560028076172  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2761774063110352  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 13786, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.202000617980957  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.219141960144043  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.236283302307129  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.219007968902588  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

torch.Size([17974, 256])
first layer input nodes number: 41582
first layer output nodes number: 17974
edges number: 159031
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2365951538085938  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2537364959716797  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2581233978271484  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2581233978271484  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

m.shape torch.Size([238, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2967634201049805  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2967634201049805  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.2972173690795898  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3008489608764648  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([197, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3010010719299316  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3010010719299316  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3013768196105957  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3070130348205566  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([157, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3072781562805176  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3072781562805176  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3075776100158691  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3141655921936035  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([148, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3145852088928223  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3145852088928223  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3148674964904785  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3230538368225098  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([123, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3235039710998535  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3235039710998535  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3237385749816895  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3321843147277832  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([107, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3326845169067383  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3326845169067383  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3328886032104492  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3416643142700195  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([102, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3422489166259766  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3422489166259766  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3424434661865234  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3521709442138672  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([74, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3526430130004883  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3526430130004883  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3527841567993164  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3608293533325195  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3614511489868164  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3614511489868164  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3616037368774414  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3713693618774414  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3720431327819824  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3720431327819824  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3721919059753418  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3827548027038574  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.383357048034668  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.383357048034668  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.383479118347168  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.393000602722168  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3937702178955078  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3937702178955078  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.3939075469970703  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4055805206298828  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([80, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.406569004058838  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.406569004058838  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.406721591949463  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.420759677886963  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([57, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4214506149291992  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4214506149291992  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4215593338012695  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4323225021362305  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.433032512664795  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.433032512664795  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.433133602142334  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4438490867614746  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4445676803588867  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4445676803588867  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4446630477905273  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.455439567565918  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4562745094299316  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4562745094299316  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4563775062561035  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4687371253967285  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4695510864257812  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4695510864257812  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4696464538574219  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4817581176757812  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4826784133911133  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4826784133911133  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4827795028686523  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4963254928588867  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4973320960998535  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4973320960998535  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.4974312782287598  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.511415958404541  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5122346878051758  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5122346878051758  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5123167037963867  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5244550704956055  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5251965522766113  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5251965522766113  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5252671241760254  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.536205768585205  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5369000434875488  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5369000434875488  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5369629859924316  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5471596717834473  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5480742454528809  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5480742454528809  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5481524467468262  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.561368465423584  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([870, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5829758644104004  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5829758644104004  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

 h.shape torch.Size([1, 870, 256]), torch.Size([1, 870, 256])
----------------------------------------3
 Nvidia-smi: 4.3104248046875 GB
    Memory Allocated: 1.5846352577209473  GigaBytes
Max Memory Allocated: 1.85465669631958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3280029296875 GB
    Memory Allocated: 1.876706600189209  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 870, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3280029296875 GB
    Memory Allocated: 1.8409147262573242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3280029296875 GB
    Memory Allocated: 1.8413491249084473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3280029296875 GB
    Memory Allocated: 1.8417835235595703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3280029296875 GB
    Memory Allocated: 1.84132719039917  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2913, 40])
input nodes number: 17974
output nodes number: 2913
edges number: 39834
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3280029296875 GB
    Memory Allocated: 1.8415064811706543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3280029296875 GB
    Memory Allocated: 1.8415069580078125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.029846668243408203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 30 input nodes size: 44559
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02583789825439453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02583789825439453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04732227325439453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04734325408935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02749347686767578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.028731346130371094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.028731346130371094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.028731346130371094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([44559, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.028731346130371094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([639, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09668159484863281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09668159484863281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0972909927368164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10216617584228516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([656, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10248708724975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10248708724975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10311269760131836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11249685287475586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([602, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11304521560668945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11304521560668945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11361932754516602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12653446197509766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([609, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1274089813232422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1274089813232422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1279897689819336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14579391479492188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([602, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14693880081176758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14693880081176758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 602, 128]), torch.Size([1, 602, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14751291275024414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16849851608276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 602, 128])
m.shape torch.Size([547, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16977643966674805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16977643966674805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17029809951782227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1932206153869629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([559, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1948256492614746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1948256492614746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1953587532043457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2220139503479004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([493, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.22362804412841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.22362804412841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 493, 128]), torch.Size([1, 493, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.22409820556640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2508974075317383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 493, 128])
m.shape torch.Size([511, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2528553009033203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2528553009033203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2533426284790039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2845315933227539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([11345, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3389754295349121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3389754295349121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11345, 128]), torch.Size([1, 11345, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.349794864654541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1197457313537598  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11345, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.0553388595581055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.0711345672607422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.086930274963379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.0710110664367676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([16563, 256])
first layer input nodes number: 44559
first layer output nodes number: 16563
edges number: 138391
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.0872645378112793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.103060245513916  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1070094108581543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1070094108581543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([374, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.134033203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.134033203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1347465515136719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1417436599731445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([308, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1419792175292969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1419792175292969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1425666809082031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.15354585647583  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([217, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1538782119750977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1538782119750977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.154292106628418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1633977890014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([183, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1638946533203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1638946533203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1642436981201172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1743659973144531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([173, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.175023078918457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.175023078918457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1753530502319336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1872320175170898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([123, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1877765655517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1877765655517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1880111694335938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.198099136352539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1987085342407227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1987085342407227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1989145278930664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.209214210510254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.209780216217041  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.209780216217041  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2099461555480957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.219404697418213  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2201266288757324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2201266288757324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.220304012298584  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.231656551361084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2322602272033691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2322602272033691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2323975563049316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2421479225158691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2427244186401367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2427244186401367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2428407669067383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2519159317016602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2526535987854004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2526535987854004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2527852058410645  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2639718055725098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2645683288574219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2645683288574219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.264669418334961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2739696502685547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.27457857131958  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.27457857131958  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.274672031402588  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2839245796203613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2845268249511719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2845268249511719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2846126556396484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.293710708618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2944674491882324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2944674491882324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2945666313171387  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.305774211883545  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3062806129455566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3062806129455566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3063454627990723  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3141274452209473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.314527988433838  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.314527988433838  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3145756721496582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.320631504058838  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3213019371032715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3213019371032715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3213744163513184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3310866355895996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3315119743347168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3315119743347168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3315577507019043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3380122184753418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3385143280029297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3385143280029297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3385639190673828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3459033966064453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.346364974975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.346364974975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3464088439941406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3532085418701172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3536291122436523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3536291122436523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3536672592163086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.359847068786621  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3601970672607422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3601970672607422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3602275848388672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3653850555419922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([485, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.377023696899414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.377023696899414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3779487609863281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.543978214263916  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 485, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.519740104675293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.520151138305664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.5205621719360352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.5201301574707031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2758, 40])
input nodes number: 16563
output nodes number: 2758
edges number: 27617
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.5202512741088867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.520251750946045  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03088665008544922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 31 input nodes size: 46097
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.027470111846923828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04945087432861328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04947185516357422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02796649932861328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.029280662536621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.029280662536621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.029280662536621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([46097, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.029280662536621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([567, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10118389129638672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10118389129638672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10172462463378906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10642576217651367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([621, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10674762725830078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10674762725830078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 621, 128]), torch.Size([1, 621, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10733985900878906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11622333526611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 621, 128])
m.shape torch.Size([620, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11681413650512695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11681413650512695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 620, 128]), torch.Size([1, 620, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11740541458129883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13106775283813477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 620, 128])
m.shape torch.Size([558, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1318364143371582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1318364143371582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 558, 128]), torch.Size([1, 558, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1323685646057129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1483464241027832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 558, 128])
m.shape torch.Size([578, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1494584083557129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1494584083557129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1500096321105957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1699213981628418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([508, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17109918594360352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17109918594360352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1715836524963379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19241571426391602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([498, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19383573532104492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19383573532104492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 498, 128]), torch.Size([1, 498, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19431066513061523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.21805715560913086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 498, 128])
m.shape torch.Size([456, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2195591926574707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2195591926574707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.21999406814575195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2447819709777832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([509, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2467489242553711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2467489242553711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.24723434448242188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2783012390136719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([12302, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3367190361022949  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3367190361022949  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12302, 128]), torch.Size([1, 12302, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3484511375427246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1814303398132324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12302, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.113555908203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1299753189086914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1463947296142578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1298465728759766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([17217, 256])
first layer input nodes number: 46097
first layer output nodes number: 17217
edges number: 146574
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.146740436553955  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1631598472595215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1672649383544922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1672649383544922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([351, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1961469650268555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1961469650268555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.1968164443969727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2033586502075195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([310, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2036199569702148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2036199569702148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2042112350463867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.217543601989746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([229, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2179083824157715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2179083824157715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2183451652526855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.227954387664795  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([177, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.228416919708252  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.228416919708252  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2287545204162598  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2385449409484863  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([161, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.239150047302246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.239150047302246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.239457130432129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2505121231079102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([116, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2510275840759277  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2510275840759277  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.251248836517334  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2607626914978027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([95, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.26129150390625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.26129150390625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2614727020263672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2705326080322266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2710494995117188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2710494995117188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.271200180053711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2797889709472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2803974151611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2803974151611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.280548095703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.290191650390625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2907991409301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2907991409301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.2909345626831055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3005495071411133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3011374473571777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3011374473571777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.301255702972412  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3104796409606934  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3111357688903809  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3111357688903809  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3112540245056152  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.321305751800537  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3217840194702148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3217840194702148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3218660354614258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.329411506652832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3297743797302246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3297743797302246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.329831600189209  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.335496425628662  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3360157012939453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3360157012939453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3360881805419922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.343770980834961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.344334602355957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.344334602355957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3444089889526367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3528146743774414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3533005714416504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3533005714416504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3533616065979004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3606858253479004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3611397743225098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3611397743225098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3611931800842285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3679757118225098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.368478775024414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.368478775024414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3685340881347656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.375946044921875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.376495361328125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.376495361328125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3765525817871094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3846206665039062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3852181434631348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3852181434631348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.385277271270752  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3940281867980957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3943796157836914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.3943796157836914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.394413948059082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.399735450744629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.4001383781433105  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.4001383781433105  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.400174617767334  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.4060454368591309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.4065117835998535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.4065117835998535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.4065518379211426  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.4133210182189941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([608, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.427910327911377  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.427910327911377  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.429069995880127  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6428256034851074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 608, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6172709465026855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6176819801330566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6180930137634277  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6176609992980957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2758, 40])
input nodes number: 17217
output nodes number: 2758
edges number: 29571
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6178107261657715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6178112030029297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes
[05:35:37] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28447620 edges into 32 parts and get 9072207 edge cuts

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03157758712768555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03712797164916992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03712797164916992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010320901870727539 |0.011781476438045502 |0.13164731115102768 |8.906424045562744e-05 |0.07551010698080063 |0.005881309509277344 |
----------------------------------------------------------pseudo_mini_loss sum 5.329353332519531
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1141980
Number of first layer input nodes during this epoch:  819511
Number of first layer output nodes during this epoch:  322469
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03712749481201172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020979642868041992
global_2_local spend time (sec) 0.04737591743469238
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0043070316314697266
A = g.adjacency_matrix() spent  0.0076656341552734375
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08405113220214844
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3336355686187744
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1733355522155762

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432})
Convert a graph into a bidirected graph: 1.306 seconds
Metis partitioning: 5.840 seconds
Split the graph: 0.697 seconds
Construct subgraphs: 0.077 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.934830665588379
2927
2918
2924
2918
2878
2874
2912
2909
2789
2906
2927
2845
2795
2874
2893
2764
2911
2818
2846
2773
2784
2758
2892
2762
2884
2758
2758
2758
2825
2758
2820
2783
total k batches seeds list generation spend  18.90842866897583
after graph partition
graph partition algorithm spend time 18.993911504745483
2927
2918
2924
2918
2878
2874
2912
2909
2789
2906
2927
2845
2795
2874
2893
2764
2911
2818
2846
2773
2784
2758
2892
2762
2884
2758
2758
2758
2825
2758
2820
2783
partition_len_list
[8811, 7168, 7116, 7025, 5898, 5697, 5668, 5287, 7520, 6898, 8071, 6940, 6709, 6098, 5452, 5582, 8052, 8316, 8857, 7650, 11851, 12828, 7662, 11911, 17138, 19650, 16476, 16425, 18075, 16443, 16924, 15446]
shared_neighbor_graph_partition_s0 selection method  spend 19.098215341567993
time for parepare:  0.019753217697143555
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.001050710678100586
mini_batch_src_global generation:  0.0012018680572509766
r_  generation:  0.0073664188385009766
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0009050369262695312
mini_batch_src_global generation:  0.0011260509490966797
r_  generation:  0.007271289825439453
local_output_nid generation:  0.0008676052093505859
local_in_edges_tensor generation:  0.0008065700531005859
mini_batch_src_global generation:  0.0007662773132324219
r_  generation:  0.006473064422607422
local_output_nid generation:  0.0008823871612548828
local_in_edges_tensor generation:  0.0007977485656738281
mini_batch_src_global generation:  0.0008375644683837891
r_  generation:  0.009415626525878906
local_output_nid generation:  0.001321554183959961
local_in_edges_tensor generation:  0.0011444091796875
mini_batch_src_global generation:  0.001131296157836914
r_  generation:  0.0064547061920166016
local_output_nid generation:  0.0009319782257080078
local_in_edges_tensor generation:  0.0009157657623291016
mini_batch_src_global generation:  0.0006158351898193359
r_  generation:  0.005060672760009766
local_output_nid generation:  0.0009131431579589844
local_in_edges_tensor generation:  0.0008664131164550781
mini_batch_src_global generation:  0.0007402896881103516
r_  generation:  0.006358146667480469
local_output_nid generation:  0.0008780956268310547
local_in_edges_tensor generation:  0.0007541179656982422
mini_batch_src_global generation:  0.0006020069122314453
r_  generation:  0.005256175994873047
local_output_nid generation:  0.0008189678192138672
local_in_edges_tensor generation:  0.0008392333984375
mini_batch_src_global generation:  0.0008029937744140625
r_  generation:  0.006660938262939453
local_output_nid generation:  0.0008733272552490234
local_in_edges_tensor generation:  0.0007433891296386719
mini_batch_src_global generation:  0.0007042884826660156
r_  generation:  0.006226062774658203
local_output_nid generation:  0.0008809566497802734
local_in_edges_tensor generation:  0.0007991790771484375
mini_batch_src_global generation:  0.0009093284606933594
r_  generation:  0.008066415786743164
local_output_nid generation:  0.000888824462890625
local_in_edges_tensor generation:  0.0007956027984619141
mini_batch_src_global generation:  0.0008556842803955078
r_  generation:  0.0072040557861328125
local_output_nid generation:  0.0008349418640136719
local_in_edges_tensor generation:  0.0007064342498779297
mini_batch_src_global generation:  0.0007293224334716797
r_  generation:  0.006399393081665039
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0007367134094238281
mini_batch_src_global generation:  0.0008137226104736328
r_  generation:  0.0074138641357421875
local_output_nid generation:  0.0008902549743652344
local_in_edges_tensor generation:  0.000736236572265625
mini_batch_src_global generation:  0.0007207393646240234
r_  generation:  0.0062694549560546875
local_output_nid generation:  0.0008475780487060547
local_in_edges_tensor generation:  0.0006921291351318359
mini_batch_src_global generation:  0.0006678104400634766
r_  generation:  0.005923271179199219
local_output_nid generation:  0.0008876323699951172
local_in_edges_tensor generation:  0.0007014274597167969
mini_batch_src_global generation:  0.0006680488586425781
r_  generation:  0.0056247711181640625
local_output_nid generation:  0.0008428096771240234
local_in_edges_tensor generation:  0.0006589889526367188
mini_batch_src_global generation:  0.0006494522094726562
r_  generation:  0.005605220794677734
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0007045269012451172
mini_batch_src_global generation:  0.0007531642913818359
r_  generation:  0.006869316101074219
local_output_nid generation:  0.0008153915405273438
local_in_edges_tensor generation:  0.0006725788116455078
mini_batch_src_global generation:  0.0006425380706787109
r_  generation:  0.0055484771728515625
local_output_nid generation:  0.0008251667022705078
local_in_edges_tensor generation:  0.0006995201110839844
mini_batch_src_global generation:  0.0008058547973632812
r_  generation:  0.006994009017944336
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.0006840229034423828
mini_batch_src_global generation:  0.0008106231689453125
r_  generation:  0.00663304328918457
local_output_nid generation:  0.000885009765625
local_in_edges_tensor generation:  0.000690460205078125
mini_batch_src_global generation:  0.0006570816040039062
r_  generation:  0.005877494812011719
local_output_nid generation:  0.0008251667022705078
local_in_edges_tensor generation:  0.0006618499755859375
mini_batch_src_global generation:  0.0006632804870605469
r_  generation:  0.005476236343383789
local_output_nid generation:  0.0008721351623535156
local_in_edges_tensor generation:  0.0008296966552734375
mini_batch_src_global generation:  0.0013370513916015625
r_  generation:  0.012288331985473633
local_output_nid generation:  0.0008859634399414062
local_in_edges_tensor generation:  0.0009272098541259766
mini_batch_src_global generation:  0.0011665821075439453
r_  generation:  0.011117219924926758
local_output_nid generation:  0.00090789794921875
local_in_edges_tensor generation:  0.0008444786071777344
mini_batch_src_global generation:  0.0011463165283203125
r_  generation:  0.008388996124267578
local_output_nid generation:  0.0009205341339111328
local_in_edges_tensor generation:  0.0008578300476074219
mini_batch_src_global generation:  0.0010929107666015625
r_  generation:  0.011579751968383789
local_output_nid generation:  0.000965118408203125
local_in_edges_tensor generation:  0.0008137226104736328
mini_batch_src_global generation:  0.0012373924255371094
r_  generation:  0.009154796600341797
local_output_nid generation:  0.0009350776672363281
local_in_edges_tensor generation:  0.0008544921875
mini_batch_src_global generation:  0.0011515617370605469
r_  generation:  0.00995945930480957
local_output_nid generation:  0.0009868144989013672
local_in_edges_tensor generation:  0.0007810592651367188
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.009399890899658203
local_output_nid generation:  0.0009546279907226562
local_in_edges_tensor generation:  0.0007364749908447266
mini_batch_src_global generation:  0.0009708404541015625
r_  generation:  0.0077381134033203125
----------------------check_connections_block total spend ----------------------------- 0.40832066535949707
generate_one_block  0.019504547119140625
generate_one_block  0.011835575103759766
generate_one_block  0.010164976119995117
generate_one_block  0.010018348693847656
generate_one_block  0.008799552917480469
generate_one_block  0.011199474334716797
generate_one_block  0.009306907653808594
generate_one_block  0.007505655288696289
generate_one_block  0.01029205322265625
generate_one_block  0.009067058563232422
generate_one_block  0.012032032012939453
generate_one_block  0.010606050491333008
generate_one_block  0.009540319442749023
generate_one_block  0.010669946670532227
generate_one_block  0.009222030639648438
generate_one_block  0.008750438690185547
generate_one_block  0.014306783676147461
generate_one_block  0.009222745895385742
generate_one_block  0.01067662239074707
generate_one_block  0.008281946182250977
generate_one_block  0.011435985565185547
generate_one_block  0.010442972183227539
generate_one_block  0.00850367546081543
generate_one_block  0.009042501449584961
generate_one_block  0.018442392349243164
generate_one_block  0.018323183059692383
generate_one_block  0.014737606048583984
generate_one_block  0.016085147857666016
generate_one_block  0.01641082763671875
generate_one_block  0.01624464988708496
generate_one_block  0.01501321792602539
generate_one_block  0.012076139450073242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03700399398803711
gen group dst list time:  0.009840250015258789
time for parepare:  0.024822473526000977
local_output_nid generation:  0.0022430419921875
local_in_edges_tensor generation:  0.010288238525390625
mini_batch_src_global generation:  0.002196788787841797
r_  generation:  0.022385835647583008
local_output_nid generation:  0.0037474632263183594
local_in_edges_tensor generation:  0.0021855831146240234
mini_batch_src_global generation:  0.001979351043701172
r_  generation:  0.01730799674987793
local_output_nid generation:  0.00264739990234375
local_in_edges_tensor generation:  0.0017571449279785156
mini_batch_src_global generation:  0.0013396739959716797
r_  generation:  0.016176223754882812
local_output_nid generation:  0.0023751258850097656
local_in_edges_tensor generation:  0.0016078948974609375
mini_batch_src_global generation:  0.001371622085571289
r_  generation:  0.0159604549407959
local_output_nid generation:  0.0020537376403808594
local_in_edges_tensor generation:  0.0014214515686035156
mini_batch_src_global generation:  0.0010657310485839844
r_  generation:  0.012661933898925781
local_output_nid generation:  0.0019347667694091797
local_in_edges_tensor generation:  0.0014290809631347656
mini_batch_src_global generation:  0.0012280941009521484
r_  generation:  0.010250091552734375
local_output_nid generation:  0.0018520355224609375
local_in_edges_tensor generation:  0.0012822151184082031
mini_batch_src_global generation:  0.0010039806365966797
r_  generation:  0.012145280838012695
local_output_nid generation:  0.0016939640045166016
local_in_edges_tensor generation:  0.0012264251708984375
mini_batch_src_global generation:  0.001081228256225586
r_  generation:  0.009209871292114258
local_output_nid generation:  0.0024306774139404297
local_in_edges_tensor generation:  0.0017633438110351562
mini_batch_src_global generation:  0.0012841224670410156
r_  generation:  0.017695903778076172
local_output_nid generation:  0.0021276473999023438
local_in_edges_tensor generation:  0.0016124248504638672
mini_batch_src_global generation:  0.0014045238494873047
r_  generation:  0.029031038284301758
local_output_nid generation:  0.004110574722290039
local_in_edges_tensor generation:  0.0036878585815429688
mini_batch_src_global generation:  0.0020308494567871094
r_  generation:  0.021822214126586914
local_output_nid generation:  0.0030171871185302734
local_in_edges_tensor generation:  0.001949310302734375
mini_batch_src_global generation:  0.0016140937805175781
r_  generation:  0.017303943634033203
local_output_nid generation:  0.002946615219116211
local_in_edges_tensor generation:  0.0017032623291015625
mini_batch_src_global generation:  0.0022804737091064453
r_  generation:  0.016056060791015625
local_output_nid generation:  0.0022575855255126953
local_in_edges_tensor generation:  0.0015134811401367188
mini_batch_src_global generation:  0.003662109375
r_  generation:  0.015230178833007812
local_output_nid generation:  0.002015829086303711
local_in_edges_tensor generation:  0.0012516975402832031
mini_batch_src_global generation:  0.0012426376342773438
r_  generation:  0.01035308837890625
local_output_nid generation:  0.0019145011901855469
local_in_edges_tensor generation:  0.0012662410736083984
mini_batch_src_global generation:  0.0010323524475097656
r_  generation:  0.014694452285766602
local_output_nid generation:  0.0029397010803222656
local_in_edges_tensor generation:  0.002111673355102539
mini_batch_src_global generation:  0.00145721435546875
r_  generation:  0.017467498779296875
local_output_nid generation:  0.0028836727142333984
local_in_edges_tensor generation:  0.002197742462158203
mini_batch_src_global generation:  0.0015673637390136719
r_  generation:  0.020671844482421875
local_output_nid generation:  0.0030078887939453125
local_in_edges_tensor generation:  0.0024356842041015625
mini_batch_src_global generation:  0.0020303726196289062
r_  generation:  0.02261209487915039
local_output_nid generation:  0.0027511119842529297
local_in_edges_tensor generation:  0.001987457275390625
mini_batch_src_global generation:  0.0015130043029785156
r_  generation:  0.017345190048217773
local_output_nid generation:  0.004192352294921875
local_in_edges_tensor generation:  0.0029556751251220703
mini_batch_src_global generation:  0.0026845932006835938
r_  generation:  0.03209805488586426
local_output_nid generation:  0.0045206546783447266
local_in_edges_tensor generation:  0.0047876834869384766
mini_batch_src_global generation:  0.0034990310668945312
r_  generation:  0.035713911056518555
local_output_nid generation:  0.002780914306640625
local_in_edges_tensor generation:  0.0021071434020996094
mini_batch_src_global generation:  0.0019402503967285156
r_  generation:  0.017688274383544922
local_output_nid generation:  0.004229307174682617
local_in_edges_tensor generation:  0.0031404495239257812
mini_batch_src_global generation:  0.0024118423461914062
r_  generation:  0.031790971755981445
local_output_nid generation:  0.005867958068847656
local_in_edges_tensor generation:  0.007132291793823242
mini_batch_src_global generation:  0.005944490432739258
r_  generation:  0.05049705505371094
local_output_nid generation:  0.006418943405151367
local_in_edges_tensor generation:  0.005536794662475586
mini_batch_src_global generation:  0.006059885025024414
r_  generation:  0.06171250343322754
local_output_nid generation:  0.0058972835540771484
local_in_edges_tensor generation:  0.005075693130493164
mini_batch_src_global generation:  0.005882740020751953
r_  generation:  0.049555063247680664
local_output_nid generation:  0.00550532341003418
local_in_edges_tensor generation:  0.004471540451049805
mini_batch_src_global generation:  0.005709409713745117
r_  generation:  0.04888606071472168
local_output_nid generation:  0.006197452545166016
local_in_edges_tensor generation:  0.0045316219329833984
mini_batch_src_global generation:  0.006303071975708008
r_  generation:  0.054978132247924805
local_output_nid generation:  0.005583286285400391
local_in_edges_tensor generation:  0.004412412643432617
mini_batch_src_global generation:  0.005301952362060547
r_  generation:  0.04893779754638672
local_output_nid generation:  0.005687713623046875
local_in_edges_tensor generation:  0.004216194152832031
mini_batch_src_global generation:  0.005232572555541992
r_  generation:  0.0487980842590332
local_output_nid generation:  0.005522012710571289
local_in_edges_tensor generation:  0.0046100616455078125
mini_batch_src_global generation:  0.004606008529663086
r_  generation:  0.047348737716674805
----------------------check_connections_block total spend ----------------------------- 1.3875434398651123
generate_one_block  0.04153180122375488
generate_one_block  0.03311634063720703
generate_one_block  0.022526025772094727
generate_one_block  0.021494388580322266
generate_one_block  0.01660752296447754
generate_one_block  0.015039920806884766
generate_one_block  0.014555931091308594
generate_one_block  0.01284480094909668
generate_one_block  0.022884368896484375
generate_one_block  0.02048969268798828
generate_one_block  0.0263826847076416
generate_one_block  0.022128582000732422
generate_one_block  0.02087259292602539
generate_one_block  0.01961994171142578
generate_one_block  0.015350580215454102
generate_one_block  0.015149831771850586
generate_one_block  0.02410101890563965
generate_one_block  0.04541754722595215
generate_one_block  0.028956174850463867
generate_one_block  0.0231320858001709
generate_one_block  0.043680429458618164
generate_one_block  0.04862213134765625
generate_one_block  0.023092031478881836
generate_one_block  0.04878044128417969
generate_one_block  0.07047009468078613
generate_one_block  0.08082032203674316
generate_one_block  0.0641944408416748
generate_one_block  0.06406116485595703
generate_one_block  0.07266855239868164
generate_one_block  0.06550192832946777
generate_one_block  0.06560564041137695
generate_one_block  0.058258771896362305
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03712749481201172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

connection checking time:  1.3875434398651123
block generation total time  1.1679577827453613
average batch blocks generation time:  0.03649868071079254
block dataloader generation time/epoch 22.69308876991272
pseudo mini batch 0 input nodes size: 22966
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03351593017578125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03351593017578125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04446697235107422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04448890686035156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.022487163543701172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02314138412475586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02314138412475586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02314138412475586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([22966, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02314138412475586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([585, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.054140567779541016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.054140567779541016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05469846725463867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05965089797973633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([605, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05994892120361328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05994892120361328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06052589416503906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06918048858642578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([606, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06975889205932617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06975889205932617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 606, 128]), torch.Size([1, 606, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07033681869506836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08401823043823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 606, 128])
m.shape torch.Size([578, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08483171463012695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08483171463012695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 578, 128]), torch.Size([1, 578, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08538293838500977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10139894485473633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 578, 128])
m.shape torch.Size([583, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10251331329345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10251331329345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10306930541992188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12399530410766602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([506, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12516498565673828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12516498565673828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 506, 128]), torch.Size([1, 506, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12564754486083984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14639759063720703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 506, 128])
m.shape torch.Size([465, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14770841598510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14770841598510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14815187454223633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17032480239868164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([427, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17173194885253906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17173194885253906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17213916778564453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19535064697265625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([367, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19672203063964844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19672203063964844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19707202911376953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.21947193145751953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([4089, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.23882818222045898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.23882818222045898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 4089, 128]), torch.Size([1, 4089, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.24272775650024414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5199780464172363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 4089, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4921088218688965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.500511646270752  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5089144706726074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5004458427429199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([8811, 256])
first layer input nodes number: 22966
first layer output nodes number: 8811
edges number: 62740
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5090875625610352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5174903869628906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5202159881591797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5202159881591797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([376, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5446047782897949  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5446047782897949  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5453219413757324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5523295402526855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([332, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5526094436645508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5526094436645508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5532426834106445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5630083084106445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([266, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5634589195251465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5634589195251465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5639662742614746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5760188102722168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5766534805297852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5766534805297852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5770940780639648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5898714065551758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5906171798706055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5906171798706055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5910005569458008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.604802131652832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([183, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6056661605834961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6056661605834961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6060152053833008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6210241317749023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6218118667602539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6218118667602539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6220846176147461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6357221603393555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6370043754577637  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6370043754577637  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6372714042663574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6524920463562012  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([112, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.653327465057373  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.653327465057373  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.653541088104248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.667212963104248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6680288314819336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6680288314819336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6682119369506836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6812124252319336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6818504333496094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6818504333496094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6819820404052734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6922473907470703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([77, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6930699348449707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6930699348449707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6932168006896973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7057003974914551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7062892913818359  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7062892913818359  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.706390380859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7156906127929688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7165012359619141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7165012359619141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7166233062744141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7287082672119141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7293972969055176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7293972969055176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7294964790344238  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7400097846984863  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7406830787658691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7406830787658691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7407727241516113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7509026527404785  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7515769004821777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7515769004821777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7516608238220215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7617316246032715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.762174129486084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.762174129486084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7622275352478027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.769010066986084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7693305015563965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7693305015563965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7693667411804199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7742228507995605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.774627685546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.774627685546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7746696472167969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7805862426757812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7811508178710938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7811508178710938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7812061309814453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7893924713134766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.789851188659668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.789851188659668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7898950576782227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7966947555541992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7970929145812988  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7970929145812988  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7971291542053223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8029999732971191  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.803443431854248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.803443431854248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8034815788269043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8099284172058105  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8166613578796387  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8166613578796387  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.817197322845459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.9127006530761719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8914375305175781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.891873836517334  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8923101425170898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8918519020080566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2927, 40])
input nodes number: 8811
output nodes number: 2927
edges number: 24864
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8919649124145508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8919658660888672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02440929412841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 1 input nodes size: 18031
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.022513389587402344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.022513389587402344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03111124038696289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.031133174896240234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020160198211669922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02070474624633789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02070474624633789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02070474624633789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([18031, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02070474624633789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([535, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04503965377807617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04503965377807617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.045549869537353516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.049631595611572266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([590, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04993915557861328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04993915557861328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05050182342529297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0598292350769043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([590, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.060391902923583984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.060391902923583984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 590, 128]), torch.Size([1, 590, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06095457077026367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0735011100769043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 590, 128])
m.shape torch.Size([513, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07419824600219727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07419824600219727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07468748092651367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08952951431274414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([482, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09043407440185547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09043407440185547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09089374542236328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10744190216064453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([397, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10834789276123047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10834789276123047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10872650146484375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12500667572021484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([335, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12593555450439453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12593555450439453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12625503540039062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1422290802001953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([351, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14340829849243164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14340829849243164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14374303817749023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16282320022583008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([277, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16384458541870117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16384458541870117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1641087532043457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1810154914855957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 277, 128])
m.shape torch.Size([3098, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19650840759277344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19650840759277344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 3098, 128]), torch.Size([1, 3098, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.199462890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41556358337402344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 3098, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3935966491699219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4004325866699219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4072685241699219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4003791809082031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([7168, 256])
first layer input nodes number: 18031
first layer output nodes number: 7168
edges number: 48955
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40740489959716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41424083709716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41594982147216797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41594982147216797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([359, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44004058837890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44004058837890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44072532653808594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44654273986816406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44686365127563477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44686365127563477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4475216865539551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45847558975219727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([302, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4590177536010742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4590177536010742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4595937728881836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47282886505126953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4735560417175293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4735560417175293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4740595817565918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4888758659362793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4896383285522461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4896383285522461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49004077911376953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5045289993286133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5052046775817871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5052046775817871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5054945945739746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5179610252380371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5187649726867676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5187649726867676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5190339088439941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5324807167053223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5332155227661133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5332155227661133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5334310531616211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5457162857055664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5465083122253418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5465083122253418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5467066764831543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5594019889831543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([105, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5603122711181641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5603122711181641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5605125427246094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5747318267822266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5754566192626953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5754566192626953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5756053924560547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5872097015380859  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5880579948425293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5880579948425293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5882105827331543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6011805534362793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6019291877746582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6019291877746582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6020550727844238  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6136364936828613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6144213676452637  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6144213676452637  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6145415306091309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6264376640319824  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6271853446960449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6271853446960449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6272921562194824  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6386141777038574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6389608383178711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6389608383178711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6390104293823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6446142196655273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6452107429504395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6452107429504395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6452832221984863  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6539807319641113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6544809341430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6544809341430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6545400619506836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6620492935180664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6625313758850098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6625313758850098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6625847816467285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.669741153717041  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6702337265014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6702337265014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6702852249145508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.677546501159668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6779446601867676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6779446601867676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6779847145080566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6839127540588379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6844639778137207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6844639778137207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6845154762268066  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.692497730255127  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6927151679992676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6927151679992676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6927361488342285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6961350440979004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6965861320495605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6965861320495605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6966242790222168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.703071117401123  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([250, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7095446586608887  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7095446586608887  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7100214958190918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7939448356628418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 250, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7729778289794922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7734127044677734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7738475799560547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7733907699584961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2918, 40])
input nodes number: 7168
output nodes number: 2918
edges number: 23963
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7734646797180176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7734651565551758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.021755695343017578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 2 input nodes size: 15635
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020158767700195312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020158767700195312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.027614116668701172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.027636051177978516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019016265869140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01950836181640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01950836181640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01950836181640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([15635, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01950836181640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([637, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.041904449462890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.041904449462890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.042511940002441406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.047371864318847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([678, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0477147102355957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0477147102355957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04836130142211914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0580601692199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([671, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.058696746826171875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.058696746826171875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05933666229248047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07422161102294922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([571, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0751800537109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0751800537109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07572460174560547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09222030639648438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([564, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0932927131652832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0932927131652832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09383058547973633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1134495735168457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([460, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11449670791625977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11449670791625977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 460, 128]), torch.Size([1, 460, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11493539810180664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13379907608032227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 460, 128])
m.shape torch.Size([411, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13495159149169922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13495159149169922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1353435516357422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15494155883789062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([363, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15613031387329102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15613031387329102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15647649765014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1762089729309082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([307, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1773533821105957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1773533821105957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 307, 128]), torch.Size([1, 307, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17764616012573242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19638395309448242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 307, 128])
m.shape torch.Size([2454, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.20793914794921875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.20793914794921875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 2454, 128]), torch.Size([1, 2454, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2102794647216797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3827085494995117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 2454, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3633084297180176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37009477615356445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37688112258911133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3700413703918457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([7116, 256])
first layer input nodes number: 15635
first layer output nodes number: 7116
edges number: 44954
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3769998550415039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3837862014770508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3863515853881836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3863515853881836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([424, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4070596694946289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4070596694946289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4078683853149414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41449642181396484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([392, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41484594345092773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41484594345092773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41559362411499023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42680883407592773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([325, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42737245559692383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42737245559692383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4279923439025879  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4421677589416504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44283056259155273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44283056259155273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4433131217956543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4573073387145996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([220, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4582810401916504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4582810401916504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45870065689086914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47380685806274414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47461795806884766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47461795806884766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47495555877685547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4894723892211914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([150, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4903130531311035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4903130531311035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4905991554260254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5049042701721191  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5056920051574707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5056920051574707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.505922794342041  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5190777778625488  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([110, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5199141502380371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5199141502380371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5201239585876465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5335516929626465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5342926979064941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5342926979064941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5344605445861816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5463776588439941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5472135543823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5472135543823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5473794937133789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5603227615356445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5609087944030762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5609087944030762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5610194206237793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5704226493835449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5711669921875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5711669921875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5712890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.58251953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5830779075622559  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5830779075622559  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5831656455993652  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5918517112731934  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5924134254455566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5924134254455566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5924935340881348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.600985050201416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6015448570251465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6015448570251465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6016192436218262  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6100249290466309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.61041259765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.61041259765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6104621887207031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6164131164550781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6167516708374023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6167516708374023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6167917251586914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6218786239624023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6224613189697266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6224613189697266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6225242614746094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6309585571289062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.631446361541748  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.631446361541748  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.631497859954834  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6387591361999512  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.639096736907959  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.639096736907959  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6391310691833496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6442122459411621  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.644533634185791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.644533634185791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.644564151763916  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.649294376373291  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6495003700256348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6495003700256348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6495194435119629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6526093482971191  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6528768539428711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6528768539428711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6528997421264648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6567678451538086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([165, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6607213020324707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6607213020324707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6610360145568848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7164254188537598  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 165, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.698967456817627  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6994032859802246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6998391151428223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6993813514709473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2924, 40])
input nodes number: 7116
output nodes number: 2924
edges number: 20988
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6994576454162598  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.699458122253418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020467758178710938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 3 input nodes size: 15482
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01901721954345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01901721954345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.026399612426757812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.026421546936035156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018944263458251953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019436359405517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019436359405517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019436359405517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([15482, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019436359405517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([662, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.041837215423583984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.041837215423583984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 662, 128]), torch.Size([1, 662, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04246854782104492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04751920700073242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 662, 128])
m.shape torch.Size([672, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04784440994262695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04784440994262695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 672, 128]), torch.Size([1, 672, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04848527908325195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05809831619262695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 672, 128])
m.shape torch.Size([677, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.058746337890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.058746337890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 677, 128]), torch.Size([1, 677, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05939197540283203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0744028091430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 677, 128])
m.shape torch.Size([588, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07529973983764648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07529973983764648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 588, 128]), torch.Size([1, 588, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07586050033569336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09248876571655273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 588, 128])
m.shape torch.Size([500, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09340047836303711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09340047836303711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 500, 128]), torch.Size([1, 500, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09387731552124023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11104345321655273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 500, 128])
m.shape torch.Size([395, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11193513870239258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11193513870239258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11231184005737305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1285099983215332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([372, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1295633316040039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1295633316040039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 372, 128]), torch.Size([1, 372, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12991809844970703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14765644073486328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 372, 128])
m.shape torch.Size([401, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14900875091552734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14900875091552734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 401, 128]), torch.Size([1, 401, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14939117431640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1711893081665039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 401, 128])
m.shape torch.Size([292, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17225122451782227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17225122451782227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 292, 128]), torch.Size([1, 292, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1725296974182129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1903519630432129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 292, 128])
m.shape torch.Size([2466, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.20197153091430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.20197153091430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 2466, 128]), torch.Size([1, 2466, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.20432329177856445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37698984146118164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 2466, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3568234443664551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.363523006439209  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3702225685119629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36347055435180664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([7025, 256])
first layer input nodes number: 15482
first layer output nodes number: 7025
edges number: 44359
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37033987045288086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37703943252563477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37893247604370117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37893247604370117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([460, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4011507034301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4011507034301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40202808380126953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40904712677001953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4093179702758789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4093179702758789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4100217819213867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4210052490234375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([334, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4216165542602539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4216165542602539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4222536087036133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43717098236083984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([256, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4378366470336914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4378366470336914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4383249282836914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4524850845336914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([211, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4533877372741699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4533877372741699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45379018783569336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4682784080505371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46886157989501953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46886157989501953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46912097930908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48027515411376953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4810810089111328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4810810089111328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48134613037109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4946022033691406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([151, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49563074111938477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49563074111938477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49591875076293945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5123353004455566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5128750801086426  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5128750801086426  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5130257606506348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5226693153381348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5233149528503418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5233149528503418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5234580039978027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5336146354675293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([86, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5344524383544922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5344524383544922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5346164703369141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5474109649658203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5480442047119141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5480442047119141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5481624603271484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5582141876220703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5588674545288086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5588674545288086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5589761734008789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5689783096313477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.569610595703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.569610595703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5697078704833984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5793380737304688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5798664093017578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5798664093017578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5799427032470703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5880298614501953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5885300636291504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5885300636291504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5885968208312988  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5961403846740723  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5964832305908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5964832305908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.596527099609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6017913818359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6022195816040039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6022195816040039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.602269172668457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6085672378540039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6090903282165527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6090903282165527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6091475486755371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6168150901794434  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6172671318054199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6172671318054199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6173148155212402  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6240382194519043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6244382858276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6244382858276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6244783401489258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.630406379699707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6308307647705078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6308307647705078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6308708190917969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6370792388916016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.637479305267334  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.637479305267334  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6375155448913574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6433863639831543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6435990333557129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6435990333557129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.643618106842041  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6468415260314941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([202, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6516857147216797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6516857147216797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6520709991455078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7198810577392578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7011280059814453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7015628814697266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7019977569580078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7015409469604492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2918, 40])
input nodes number: 7025
output nodes number: 2918
edges number: 21601
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7016143798828125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7016148567199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020394325256347656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 4 input nodes size: 11928
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018943309783935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018943309783935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.025232791900634766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.025254249572753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01784992218017578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018247604370117188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018247604370117188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018247604370117188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([11928, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018247604370117188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([651, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0353093147277832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0353093147277832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 651, 128]), torch.Size([1, 651, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03593015670776367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04167795181274414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 651, 128])
m.shape torch.Size([689, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04202461242675781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04202461242675781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 689, 128]), torch.Size([1, 689, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04268169403076172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.053421974182128906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 689, 128])
m.shape torch.Size([612, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05396890640258789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05396890640258789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 612, 128]), torch.Size([1, 612, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.054552555084228516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06793069839477539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 612, 128])
m.shape torch.Size([575, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06873559951782227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06873559951782227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06928396224975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08518648147583008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([452, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08627986907958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08627986907958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08671092987060547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10222911834716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([397, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1031494140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1031494140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10352802276611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11980819702148438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([351, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12079048156738281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12079048156738281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1211252212524414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1378622055053711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([298, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13883161544799805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13883161544799805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 298, 128]), torch.Size([1, 298, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1391158103942871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15531492233276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 298, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15630578994750977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15630578994750977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15655755996704102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17267084121704102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([1609, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.18021726608276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.18021726608276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 1609, 128]), torch.Size([1, 1609, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.18175172805786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2921266555786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 1609, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2777862548828125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.28341102600097656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2890357971191406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.28336668014526367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([5898, 256])
first layer input nodes number: 11928
first layer output nodes number: 5898
edges number: 34114
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2891268730163574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2947516441345215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.29663896560668945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.29663896560668945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([437, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3156294822692871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3156294822692871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.31646299362182617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.32313108444213867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([408, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3234987258911133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3234987258911133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3242769241333008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3362283706665039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.33674192428588867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.33674192428588867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.337338924407959  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3505120277404785  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([265, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35133934020996094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35133934020996094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35184478759765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3666372299194336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([191, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36730241775512695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36730241775512695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36766672134399414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3807816505432129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([187, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38167810440063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38167810440063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3820347785949707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.397371768951416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([162, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3982834815979004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3982834815979004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.398592472076416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41404199600219727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([135, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41492557525634766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41492557525634766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41518306732177734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42986011505126953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([123, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43138790130615234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43138790130615234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4316225051879883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4466371536254883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4474043846130371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4474043846130371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44757986068725586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4600386619567871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46062755584716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46062755584716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46074962615966797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47027111053466797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4709482192993164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4709482192993164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4710702896118164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4814462661743164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4821476936340332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4821476936340332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48226404190063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4929680824279785  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49356937408447266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49356937408447266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49366283416748047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5029153823852539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.503575325012207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.503575325012207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5036687850952148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.513575553894043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5140209197998047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5140209197998047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5140819549560547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5209789276123047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5212917327880859  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5212917327880859  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.521331787109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5261383056640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5265164375305176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5265164375305176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5265603065490723  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5321316719055176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5325665473937988  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5325665473937988  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5326142311096191  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.539003849029541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5394415855407715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5394415855407715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.539487361907959  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5459418296813965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5461611747741699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5461611747741699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5461840629577637  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5495715141296387  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.549898624420166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.549898624420166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.549929141998291  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.554659366607666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5548872947692871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5548872947692871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.554908275604248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5583071708679199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5585508346557617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5585508346557617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5585718154907227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5621175765991211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([103, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.564582347869873  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.564582347869873  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5647788047790527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5993552207946777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 103, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5836281776428223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5840573310852051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5844864845275879  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5840358734130859  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2878, 40])
input nodes number: 5898
output nodes number: 2878
edges number: 19190
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5840959548950195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5840964317321777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019037723541259766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 5 input nodes size: 11944
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017844200134277344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017844200134277344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02353954315185547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02356100082397461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01725006103515625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017586708068847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017586708068847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017586708068847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([11944, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017586708068847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([751, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.032633304595947266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.032633304595947266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 751, 128]), torch.Size([1, 751, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03334951400756836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03907918930053711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 751, 128])
m.shape torch.Size([824, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03950691223144531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03950691223144531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04029273986816406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.052616119384765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([693, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05360126495361328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05360126495361328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 693, 128]), torch.Size([1, 693, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05426216125488281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06957817077636719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 693, 128])
m.shape torch.Size([560, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07031583786010742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07031583786010742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07084989547729492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08706235885620117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([468, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08791112899780273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08791112899780273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08835744857788086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10442495346069336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([364, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10524320602416992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10524320602416992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1055903434753418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12051725387573242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([318, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12140512466430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12140512466430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12170839309692383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1368718147277832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 318, 128])
m.shape torch.Size([272, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1377577781677246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1377577781677246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 272, 128]), torch.Size([1, 272, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1380171775817871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1528029441833496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 272, 128])
m.shape torch.Size([236, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1536860466003418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1536860466003418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15391111373901367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16831541061401367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([1211, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1742863655090332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1742863655090332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17544126510620117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.25743913650512695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.24522018432617188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2506532669067383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2560863494873047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2506103515625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([5697, 256])
first layer input nodes number: 11944
first layer output nodes number: 5697
edges number: 29878
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2561774253845215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2616105079650879  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.26337671279907227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.26337671279907227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([535, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27863502502441406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27863502502441406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27965545654296875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.28859615325927734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([482, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2890129089355469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2890129089355469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2899322509765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3037223815917969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([385, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.30442380905151367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.30442380905151367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3051581382751465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.32190847396850586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([283, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3226504325866699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3226504325866699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.32319021224975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.33907461166381836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([242, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3399677276611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3399677276611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.34042930603027344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35704612731933594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3577556610107422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3577556610107422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3580665588378906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37143516540527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37234067916870117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37234067916870117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3726210594177246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3866400718688965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38739967346191406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38739967346191406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3876228332519531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4003429412841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40105342864990234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40105342864990234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40123462677001953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41283130645751953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4134521484375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4134521484375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4135932922363281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.423614501953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42415714263916016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42415714263916016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4242677688598633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43289661407470703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43332576751708984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43332576751708984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43340587615966797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4402151107788086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44063758850097656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44063758850097656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4407081604003906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4472007751464844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44759607315063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44759607315063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44765710830688477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45369958877563477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4540586471557617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4540586471557617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45411014556884766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45956897735595703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.459928035736084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.459928035736084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4599757194519043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4653639793395996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4656343460083008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4656343460083008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4656686782836914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4697885513305664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47022151947021484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47022151947021484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47027111053466797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47656917572021484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4766726493835449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4766726493835449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4766860008239746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47847509384155273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4786224365234375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4786224365234375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4786376953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4807891845703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48090267181396484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48090267181396484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4809141159057617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4826078414916992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.482666015625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.482666015625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48267173767089844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48355865478515625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4836444854736328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4836444854736328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48365211486816406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48488807678222656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4850459098815918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4850459098815918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4850592613220215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48731565475463867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([51, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48941469192504883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48941469192504883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48951196670532227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5066323280334473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 51, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4947481155395508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4951767921447754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49560546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49515533447265625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2874, 40])
input nodes number: 5697
output nodes number: 2874
edges number: 15204
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49521923065185547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49521970748901367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018286705017089844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 6 input nodes size: 11841
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017249584197998047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017249584197998047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02289581298828125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.022917747497558594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017200946807861328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01760244369506836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01760244369506836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01760244369506836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([11841, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01760244369506836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([617, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.034064292907714844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.034064292907714844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0346527099609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03936004638671875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([735, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.039766788482666016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.039766788482666016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 735, 128]), torch.Size([1, 735, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04046773910522461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05113983154296875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 735, 128])
m.shape torch.Size([576, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05161333084106445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05161333084106445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05216264724731445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06430244445800781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([503, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0649871826171875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0649871826171875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06546688079833984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07937812805175781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([435, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08017539978027344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08017539978027344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 435, 128]), torch.Size([1, 435, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08059024810791016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09552478790283203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 435, 128])
m.shape torch.Size([364, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0963587760925293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0963587760925293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09670591354370117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1116328239440918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([297, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11286163330078125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11286163330078125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 297, 128]), torch.Size([1, 297, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1131448745727539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12730693817138672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 297, 128])
m.shape torch.Size([252, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1281266212463379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1281266212463379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12836694717407227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14206552505493164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 252, 128])
m.shape torch.Size([234, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14294958114624023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14294958114624023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 234, 128]), torch.Size([1, 234, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1431727409362793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1574549674987793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 234, 128])
m.shape torch.Size([1655, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16523504257202148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16523504257202148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 1655, 128]), torch.Size([1, 1655, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16681337356567383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27988195419311523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 1655, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2665715217590332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27197694778442383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27738237380981445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27193450927734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([5668, 256])
first layer input nodes number: 11841
first layer output nodes number: 5668
edges number: 32937
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27747297286987305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.28287839889526367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.28422975540161133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.28422975540161133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3047170639038086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3047170639038086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.30550670623779297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3119239807128906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([416, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3123288154602051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3123288154602051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3131222724914551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.32515811920166016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3255949020385742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3255949020385742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.32614612579345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.33924198150634766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([267, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3400301933288574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3400301933288574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.34053945541381836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35530805587768555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([231, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35616397857666016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35616397857666016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35660457611083984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3724660873413086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3731803894042969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3731803894042969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3734893798828125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3867759704589844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([152, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3884272575378418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3884272575378418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3887171745300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4032130241394043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40398311614990234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40398311614990234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40421009063720703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4171476364135742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([112, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4180030822753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4180030822753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4182167053222656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4318885803222656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([108, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43281984329223633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43281984329223633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4330258369445801  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44765138626098633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4482889175415039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4482889175415039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4484224319458008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45883655548095703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4594850540161133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4594850540161133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45960330963134766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46965503692626953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47029590606689453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47029590606689453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47040271759033203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48022937774658203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4808626174926758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4808626174926758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4809598922729492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49059009552001953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4911327362060547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4911327362060547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4912109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4995002746582031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4999074935913086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4999074935913086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49996280670166016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5062131881713867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5068068504333496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5068068504333496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5068793296813965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5155768394470215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5160598754882812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5160598754882812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5161170959472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5233840942382812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5239400863647461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5239400863647461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5240011215209961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5321798324584961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5326495170593262  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5326495170593262  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5326991081237793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5396914482116699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5399899482727051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5399899482727051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5400204658508301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5445370674133301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5448813438415527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5448813438415527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5449137687683105  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5499396324157715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5502996444702148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5502996444702148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5503320693969727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5555849075317383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5560302734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5560302734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5560684204101562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5625152587890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([137, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5657882690429688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5657882690429688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5660495758056641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6120395660400391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 137, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5948071479797363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5952410697937012  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.595674991607666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5952191352844238  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2912, 40])
input nodes number: 5668
output nodes number: 2912
edges number: 20767
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5952887535095215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5952892303466797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018414020538330078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 7 input nodes size: 8817
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017206192016601562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.017206192016601562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.021410465240478516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02143239974975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.015764236450195312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.016078948974609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.016078948974609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.016078948974609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([8817, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.016078948974609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([736, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02929830551147461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02929830551147461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 736, 128]), torch.Size([1, 736, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03000020980834961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03561544418334961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 736, 128])
m.shape torch.Size([818, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03604459762573242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.03604459762573242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.036824703216552734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.049101829528808594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([674, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.049675941467285156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.049675941467285156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 674, 128]), torch.Size([1, 674, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05031871795654297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06511974334716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 674, 128])
m.shape torch.Size([542, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06600046157836914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06600046157836914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06651735305786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08150720596313477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([495, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08318281173706055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08318281173706055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08365488052368164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10064935684204102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([375, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1014862060546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1014862060546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 375, 128]), torch.Size([1, 375, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10184383392333984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11722183227539062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 375, 128])
m.shape torch.Size([305, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11806106567382812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11806106567382812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11835193634033203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13289546966552734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([242, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13367319107055664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13367319107055664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 242, 128]), torch.Size([1, 242, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13390398025512695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14705896377563477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 242, 128])
m.shape torch.Size([207, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14783191680908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14783191680908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 207, 128]), torch.Size([1, 207, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14802932739257812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16066360473632812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 207, 128])
m.shape torch.Size([893, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16482305526733398  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16482305526733398  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16567468643188477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2274913787841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 893, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.21701288223266602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.22205495834350586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2270970344543457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.222015380859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([5287, 256])
first layer input nodes number: 8817
first layer output nodes number: 5287
edges number: 26151
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.22716474533081055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2322068214416504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.23346757888793945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.23346757888793945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([505, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2494058609008789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2494058609008789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2503690719604492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.25914525985717773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([476, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2595787048339844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2595787048339844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2604866027832031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.27487850189208984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([359, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2755575180053711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2755575180053711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2762422561645508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.2913475036621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([274, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.29219484329223633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.29219484329223633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.29271745681762695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3086361885070801  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([257, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.30961036682128906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.30961036682128906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3101005554199219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.32788753509521484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([188, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.32872676849365234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.32872676849365234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3290853500366211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.34450435638427734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([153, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3453545570373535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3453545570373535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.34564638137817383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36023759841918945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36110687255859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36110687255859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.361358642578125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37570953369140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37645769119262695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37645769119262695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.376650333404541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.388979434967041  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38961362838745117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38961362838745117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3897585868835449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40005064010620117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40054941177368164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40054941177368164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4006524085998535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40868616104125977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4093613624572754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4093613624572754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4094815254211426  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4196953773498535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42016029357910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42016029357910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4202404022216797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4276103973388672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42809534072875977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42809534072875977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42816972732543945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4355340003967285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4360017776489258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4360017776489258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4360685348510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4431447982788086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4435882568359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4435882568359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4436473846435547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4503288269042969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4506101608276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4506101608276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45064640045166016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45499515533447266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4553060531616211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4553060531616211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45534229278564453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4599447250366211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46010923385620117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46010923385620117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4601283073425293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46268415451049805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.462770938873291  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.462770938873291  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4627804756164551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4641251564025879  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4643425941467285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4643425941467285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46436357498168945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4674687385559082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46762752532958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46762752532958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46764278411865234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47000789642333984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47017717361450195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47017717361450195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47019243240356445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47266435623168945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47281837463378906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47281837463378906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47283172607421875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47508811950683594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([37, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4759707450866699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4759707450866699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.476041316986084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.488461971282959  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 37, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4759221076965332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47635602951049805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4767899513244629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4763340950012207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2909, 40])
input nodes number: 5287
output nodes number: 2909
edges number: 15941
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4763956069946289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4763960838317871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.016730785369873047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 8 input nodes size: 16179
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.015764236450195312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.015764236450195312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.023478984832763672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02349996566772461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019273757934570312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01981830596923828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01981830596923828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01981830596923828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([16179, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01981830596923828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([580, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04498624801635742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04498624801635742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04553937911987305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05067110061645508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([633, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05099821090698242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05099821090698242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05160188674926758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06134033203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([582, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06187105178833008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06187105178833008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.062426090240478516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07463693618774414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([541, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07543134689331055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07543134689331055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 541, 128]), torch.Size([1, 541, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07594728469848633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09090948104858398  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 541, 128])
m.shape torch.Size([545, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09195089340209961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09195089340209961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09247064590454102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11199378967285156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([479, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11310434341430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11310434341430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 479, 128]), torch.Size([1, 479, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11356115341186523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13320398330688477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 479, 128])
m.shape torch.Size([392, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13428401947021484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13428401947021484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1346578598022461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1533498764038086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([345, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1544790267944336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1544790267944336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 345, 128]), torch.Size([1, 345, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15480804443359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17356204986572266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 345, 128])
m.shape torch.Size([287, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17462921142578125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17462921142578125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 287, 128]), torch.Size([1, 287, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17490291595458984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19242000579833984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 287, 128])
m.shape torch.Size([3136, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.20790815353393555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.20790815353393555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 3136, 128]), torch.Size([1, 3136, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.21089887619018555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42624950408935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 3136, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40396785736083984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41113948822021484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41831111907958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4110832214355469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([7520, 256])
first layer input nodes number: 16179
first layer output nodes number: 7520
edges number: 50802
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41843366622924805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42560529708862305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4273982048034668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4273982048034668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44956254959106445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44956254959106445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45033693313598633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45677614212036133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([362, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45708513259887695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45708513259887695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4577755928039551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4688420295715332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4693303108215332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4693303108215332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.469881534576416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4827752113342285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4833688735961914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4833688735961914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48379993438720703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49630069732666016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4971156120300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4971156120300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49750661849975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5115828514099121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5123391151428223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5123391151428223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5126538276672363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.526186466217041  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5268702507019043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5268702507019043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5271086692810059  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.539029598236084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.539741039276123  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.539741039276123  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5399470329284668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5516886711120605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5524940490722656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5524940490722656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5526943206787109  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5655117034912109  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5662384033203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5662384033203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5664024353027344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5780487060546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5785379409790039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5785379409790039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5786409378051758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.586674690246582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5872807502746582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5872807502746582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5873894691467285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5966305732727051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5971636772155762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5971636772155762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5972533226013184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6055006980895996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6061019897460938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6061019897460938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6061935424804688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6152572631835938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6157450675964355  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6157450675964355  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6158156394958496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6232962608337402  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6235685348510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6235685348510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6236066818237305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6279172897338867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6284866333007812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6284866333007812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6285552978515625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6367950439453125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6372451782226562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6372451782226562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.637298583984375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6440811157226562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6444745063781738  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6444745063781738  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6445183753967285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6503968238830566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6509900093078613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6509900093078613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6510510444641113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6596570014953613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6601314544677734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6601314544677734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6601791381835938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.667236328125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6675510406494141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6675510406494141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6675815582275391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6723117828369141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6726727485656738  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6726727485656738  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6727051734924316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6779580116271973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6782188415527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6782188415527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6782417297363281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6821098327636719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([260, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6883459091186523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6883459091186523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6888418197631836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7791852951049805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 260, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7600417137145996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7604575157165527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7608733177185059  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7604365348815918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2789, 40])
input nodes number: 7520
output nodes number: 2789
edges number: 22145
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.760495662689209  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7604961395263672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020831584930419922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 9 input nodes size: 16372
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019255638122558594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019255638122558594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.027062416076660156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0270843505859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019348621368408203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01981210708618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01981210708618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01981210708618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([16372, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01981210708618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([755, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04093360900878906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04093360900878906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 755, 128]), torch.Size([1, 755, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04165363311767578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04741382598876953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 755, 128])
m.shape torch.Size([748, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04776716232299805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04776716232299805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04848051071166992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05929899215698242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([643, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05986213684082031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05986213684082031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 643, 128]), torch.Size([1, 643, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06047534942626953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0744481086730957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 643, 128])
m.shape torch.Size([567, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07522296905517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07522296905517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07576370239257812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09149456024169922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([463, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09232807159423828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09232807159423828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09276962280273438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10866546630859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([443, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10971212387084961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10971212387084961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11013460159301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12830114364624023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([326, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12917804718017578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12917804718017578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12948894500732422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1450338363647461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([320, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14609909057617188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14609909057617188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14640426635742188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16379928588867188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([268, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1647968292236328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1647968292236328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 268, 128]), torch.Size([1, 268, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1650524139404297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1814098358154297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 268, 128])
m.shape torch.Size([2365, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19255924224853516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19255924224853516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 2365, 128]), torch.Size([1, 2365, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19481468200683594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36147499084472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 2365, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3433194160461426  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3498978614807129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3564763069152832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.34984636306762695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([6898, 256])
first layer input nodes number: 16372
first layer output nodes number: 6898
edges number: 42325
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.356600284576416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36317873001098633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36519908905029297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36519908905029297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([533, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38551902770996094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38551902770996094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38653564453125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.39543867111206055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([430, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.39575719833374023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.39575719833374023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3965773582458496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40889692306518555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([329, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4094357490539551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4094357490539551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4100632667541504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42386960983276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.424532413482666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.424532413482666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4250168800354004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43906641006469727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4396843910217285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4396843910217285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44002580642700195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4523167610168457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4532146453857422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4532146453857422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45355224609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46806907653808594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46865415573120117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46865415573120117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46886777877807617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47954893112182617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48024988174438477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48024988174438477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4804501533508301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4918656349182129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4925961494445801  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4925961494445801  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4927792549133301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5044980049133301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5051851272583008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5051851272583008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5053396224975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5163087844848633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5169825553894043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5169825553894043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.517117977142334  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5276808738708496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5283513069152832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5283513069152832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5284733772277832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5388493537902832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5393257141113281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5393257141113281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5394077301025391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5469532012939453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5473966598510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5473966598510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5474653244018555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5542631149291992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5547189712524414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5547189712524414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.554783821105957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5616579055786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5620718002319336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5620718002319336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5621271133422852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5683774948120117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5688729286193848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5688729286193848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5689339637756348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5762581825256348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5767121315002441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5767121315002441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5767655372619629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5835480690002441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5839962959289551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5839962959289551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5840458869934082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.590691089630127  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5909547805786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5909547805786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5909833908081055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5950174331665039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5953264236450195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5953264236450195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5953569412231445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5998735427856445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6000490188598633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6000490188598633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6000661849975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.602726936340332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6030721664428711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6030721664428711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6031026840209961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6080465316772461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6082854270935059  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6082854270935059  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6083064079284668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6118521690368652  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([180, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6161670684814453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6161670684814453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6165103912353516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6769351959228516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 180, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6599302291870117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6603636741638184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.660797119140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.660341739654541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2906, 40])
input nodes number: 6898
output nodes number: 2906
edges number: 19745
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6604328155517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.660433292388916  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02075052261352539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 10 input nodes size: 16655
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01936626434326172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01936626434326172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.027307987213134766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02732992172241211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019501209259033203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020148754119873047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020148754119873047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020148754119873047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([16655, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020148754119873047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([428, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04938459396362305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04938459396362305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04979276657104492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05305814743041992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([512, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.053342342376708984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.053342342376708984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.053830623626708984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.061154842376708984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([562, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06171464920043945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06171464920043945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.062250614166259766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07504701614379883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([488, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07570981979370117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07570981979370117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07617521286010742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08967161178588867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([492, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09061193466186523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09061193466186523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 492, 128]), torch.Size([1, 492, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09108114242553711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10797262191772461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 492, 128])
m.shape torch.Size([422, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10894536972045898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10894536972045898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10934782028198242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12665319442749023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([429, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1278839111328125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1278839111328125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12829303741455078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14874935150146484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([404, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1500859260559082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1500859260559082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15047121047973633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17243242263793945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([348, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17373323440551758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17373323440551758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 348, 128]), torch.Size([1, 348, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17406511306762695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19530534744262695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 348, 128])
m.shape torch.Size([3986, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.21467065811157227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.21467065811157227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 3986, 128]), torch.Size([1, 3986, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.21847200393676758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.494661808013916  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 3986, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4681248664855957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47582197189331055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4835190773010254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47576141357421875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([8071, 256])
first layer input nodes number: 16655
first layer output nodes number: 8071
edges number: 59309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4836454391479492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49134254455566406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49361562728881836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49361562728881836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([294, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5203700065612793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5203700065612793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5209307670593262  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5255031585693359  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([289, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5257787704467773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5257787704467773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5263299942016602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5362386703491211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5367560386657715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5367560386657715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5372805595397949  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5490260124206543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([202, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5495405197143555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5495405197143555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5499258041381836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5610990524291992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([178, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5617618560791016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5617618560791016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5621013641357422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5743236541748047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.575019359588623  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.575019359588623  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5753054618835449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5876078605651855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([156, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5885148048400879  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5885148048400879  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5888123512268066  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6036896705627441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6045947074890137  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6045947074890137  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.604856014251709  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6197504997253418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([122, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6206755638122559  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6206755638122559  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.620908260345459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.635800838470459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([105, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6366939544677734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6366939544677734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6368942260742188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6511135101318359  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6524863243103027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6524863243103027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6526885032653809  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6684584617614746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([83, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6693148612976074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6693148612976074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6694731712341309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.682929515838623  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6837253570556641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6837253570556641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6838588714599609  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6961421966552734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([74, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6970715522766113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6970715522766113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6972126960754395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7111859321594238  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7120528221130371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7120528221130371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7121767997741699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.725318431854248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7261791229248047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7261791229248047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7262935638427734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7392253875732422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7400178909301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7400178909301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.740117073059082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.752018928527832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7525925636291504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7525925636291504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7526612281799316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7613816261291504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7618041038513184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7618041038513184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7618517875671387  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7682414054870605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.768986701965332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.768986701965332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7690629959106445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.779820442199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7805294990539551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7805294990539551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7806000709533691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7910447120666504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7913904190063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7913904190063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7914247512817383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7967462539672852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7972817420959473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7972817420959473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7973294258117676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8050541877746582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8055381774902344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8055381774902344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8055801391601562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8126716613769531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8200035095214844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.8200035095214844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.820587158203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.9274692535400391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.9037570953369141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.9041934013366699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.9046297073364258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.9041714668273926  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2927, 40])
input nodes number: 8071
output nodes number: 2927
edges number: 27407
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.9042568206787109  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.9042572975158691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.021343708038330078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 11 input nodes size: 14864
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019504070281982422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019504070281982422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.026591777801513672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.026613235473632812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018649578094482422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019187450408935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019187450408935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019187450408935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([14864, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019187450408935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([504, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04349040985107422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04349040985107422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04397106170654297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04781627655029297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([515, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04806709289550781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04806709289550781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 515, 128]), torch.Size([1, 515, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04855823516845703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05661582946777344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 515, 128])
m.shape torch.Size([532, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.057131290435791016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.057131290435791016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05763864517211914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06880044937133789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([514, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06952714920043945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06952714920043945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 514, 128]), torch.Size([1, 514, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07001733779907227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08485078811645508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 514, 128])
m.shape torch.Size([488, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0857691764831543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0857691764831543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08623456954956055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10298871994018555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([383, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1038517951965332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1038517951965332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1042170524597168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.11992311477661133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([374, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12098884582519531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12098884582519531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12134552001953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.13917922973632812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([346, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1403207778930664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1403207778930664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14065074920654297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15945911407470703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([263, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1612682342529297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1612682342529297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 263, 128]), torch.Size([1, 263, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16151905059814453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17757129669189453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 263, 128])
m.shape torch.Size([3021, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19185113906860352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19185113906860352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 3021, 128]), torch.Size([1, 3021, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1947321891784668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40572214126586914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 3021, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.383211612701416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3898301124572754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.39644861221313477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.38977813720703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([6940, 256])
first layer input nodes number: 14864
first layer output nodes number: 6940
edges number: 47887
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3965616226196289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4031801223754883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4048347473144531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4048347473144531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([379, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4289422035217285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4289422035217285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42966508865356445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4358658790588379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([297, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43607568740844727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43607568740844727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4366421699523926  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4457707405090332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44632387161254883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44632387161254883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44687700271606445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4598360061645508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4604363441467285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4604363441467285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46087121963500977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.473482608795166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4742603302001953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4742603302001953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4746551513671875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48886871337890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48957109451293945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48957109451293945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4898686408996582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5026631355285645  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5034699440002441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5034699440002441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5037407875061035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5172829627990723  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5180320739746094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5180320739746094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5182514190673828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5307540893554688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.531440258026123  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.531440258026123  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5316157341003418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5428462028503418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([100, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5437197685241699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5437197685241699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5439105033874512  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5574526786804199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5582351684570312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5582351684570312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5583934783935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5707416534423828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5713200569152832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5713200569152832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5714287757873535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5806698799133301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5814027786254883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5814027786254883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5815229415893555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5925779342651367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5932044982910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5932044982910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5933017730712891  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6029319763183594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6036477088928223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6036477088928223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6037487983703613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.614464282989502  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.615013599395752  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.615013599395752  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6150879859924316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6234936714172363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6242246627807617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6242246627807617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6243143081665039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6350717544555664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6355113983154297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6355113983154297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6355648040771484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6423473358154297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6429233551025391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6429233551025391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6429862976074219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6514205932617188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6520428657531738  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6520428657531738  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6521077156066895  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6612515449523926  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6618046760559082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6618046760559082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6618599891662598  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.670046329498291  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6704206466674805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6704206466674805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6704568862915039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6760740280151367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6763877868652344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6763877868652344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6764163970947266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6810512542724609  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6815447807312012  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6815447807312012  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.681586742401123  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6886782646179199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([266, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6950488090515137  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6950488090515137  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6955561637878418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7864632606506348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 266, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.765413761138916  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7658381462097168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7662625312805176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7658166885375977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2845, 40])
input nodes number: 6940
output nodes number: 2845
edges number: 24177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7658782005310059  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.7658786773681641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02019357681274414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 12 input nodes size: 16195
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018637657165527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018637657165527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.026360034942626953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.02638101577758789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0192718505859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019754409790039062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019754409790039062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019754409790039062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([16195, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.019754409790039062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([519, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04207563400268555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04207563400268555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 519, 128]), torch.Size([1, 519, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04257059097290039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04653024673461914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 519, 128])
m.shape torch.Size([608, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04686260223388672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04686260223388672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04744243621826172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05680036544799805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([609, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.057381629943847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.057381629943847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05796241760253906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07164192199707031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([529, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07236051559448242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07236051559448242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 529, 128]), torch.Size([1, 529, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07286500930786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08768033981323242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 529, 128])
m.shape torch.Size([464, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08853435516357422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08853435516357422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08897686004638672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10490703582763672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([397, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10582160949707031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10582160949707031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 397, 128]), torch.Size([1, 397, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1062002182006836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12248039245605469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 397, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12348270416259766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12348270416259766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12382316589355469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14084625244140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([317, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14188528060913086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14188528060913086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 317, 128]), torch.Size([1, 317, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14218759536743164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.15941953659057617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 317, 128])
m.shape torch.Size([264, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1604013442993164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1604013442993164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 264, 128]), torch.Size([1, 264, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16065311431884766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17676639556884766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 264, 128])
m.shape torch.Size([2645, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1892528533935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.1892528533935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 2645, 128]), torch.Size([1, 2645, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.19226551055908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37589502334594727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 2645, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35560178756713867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3619999885559082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36839818954467773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3619499206542969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([6709, 256])
first layer input nodes number: 16195
first layer output nodes number: 6709
edges number: 44241
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36852121353149414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3752560615539551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37651920318603516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.37651920318603516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([360, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.39667367935180664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.39667367935180664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.39736032485961914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4030156135559082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40336084365844727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40336084365844727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.40404367446899414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41457033157348633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([330, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41518068313598633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41518068313598633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.41581010818481445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4296708106994629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43033647537231445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43033647537231445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.43082284927368164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4449276924133301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44559288024902344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44559288024902344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.445953369140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45893096923828125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45972537994384766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.45972537994384766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46004772186279297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4739084243774414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([149, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47477054595947266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.47477054595947266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4750547409057617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48926448822021484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.490328311920166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.490328311920166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49058961868286133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5054841041564941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5061235427856445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5061235427856445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5062932968139648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5171575546264648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5178804397583008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5178804397583008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.518040657043457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5294160842895508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([93, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5303192138671875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5303192138671875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5304965972900391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5443325042724609  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5450396537780762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5450396537780762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5451712608337402  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5563578605651855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.557004451751709  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.557004451751709  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5571131706237793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.567115306854248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5677070617675781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5677070617675781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5677986145019531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5768623352050781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5773215293884277  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5773215293884277  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5773882865905762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5844645500183105  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5852770805358887  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5852770805358887  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5853819847106934  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.597236156463623  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5977396965026855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5977396965026855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5978045463562012  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6055865287780762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.606142520904541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.606142520904541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6062073707580566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.614443302154541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6147947311401367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6147947311401367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6148347854614258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6202020645141602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6207590103149414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6207590103149414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6208162307739258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6288843154907227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6293001174926758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6293001174926758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6293420791625977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6355524063110352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6359543800354004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6359543800354004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6359925270080566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6419053077697754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6421074867248535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6421074867248535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6421265602111816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6452164649963379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6455531120300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6455531120300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6455817222595215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6504168510437012  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([132, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6535744667053223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6535744667053223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6538262367248535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6981377601623535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 132, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6810741424560547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6814908981323242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6819076538085938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6814699172973633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2795, 40])
input nodes number: 6709
output nodes number: 2795
edges number: 20475
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6815333366394043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6815338134765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.020685195922851562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 13 input nodes size: 13064
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01926422119140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01926422119140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.025493621826171875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.025515079498291016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.01777172088623047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018280982971191406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018280982971191406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018280982971191406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([13064, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.018280982971191406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([329, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04047966003417969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04047966003417969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 329, 128]), torch.Size([1, 329, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.040793418884277344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.043303489685058594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 329, 128])
m.shape torch.Size([430, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04355669021606445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04355669021606445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 430, 128]), torch.Size([1, 430, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.04396677017211914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05011796951293945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 430, 128])
m.shape torch.Size([425, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.050520896911621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.050520896911621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05092620849609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.05984306335449219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([440, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06047964096069336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06047964096069336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.06089925765991211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07306814193725586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([420, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07385969161987305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07385969161987305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.07426023483276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.08867979049682617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([413, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0896611213684082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.0896611213684082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 413, 128]), torch.Size([1, 413, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.09005498886108398  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10699129104614258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 413, 128])
m.shape torch.Size([369, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10802602767944336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10802602767944336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 369, 128]), torch.Size([1, 369, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.10837793350219727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12597322463989258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 369, 128])
m.shape torch.Size([327, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.127044677734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.127044677734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.12735652923583984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14513206481933594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([256, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14607477188110352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14607477188110352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.14631891250610352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.16194391250610352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([2689, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17549371719360352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17549371719360352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 2689, 128]), torch.Size([1, 2689, 128])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.17845773696899414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3628568649291992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 2689, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3428773880004883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3486928939819336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3545083999633789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3486471176147461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([6098, 256])
first layer input nodes number: 13064
first layer output nodes number: 6098
edges number: 43195
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.35460805892944336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36042356491088867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36250829696655273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.36250829696655273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([264, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3869032859802246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3869032859802246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3874068260192871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.39222288131713867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([282, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3925132751464844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3925132751464844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.3930511474609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4028615951538086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([247, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4033050537109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4033050537109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4037761688232422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4141407012939453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4147319793701172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4147319793701172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4151420593261719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4270343780517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([231, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42793989181518555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42793989181518555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.42838048934936523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.444242000579834  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([217, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44527339935302734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44527339935302734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.44568729400634766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4634847640991211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([180, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46460819244384766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.46460819244384766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4649515151977539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4821176528930664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([133, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.482968807220459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.482968807220459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.48322248458862305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4976820945739746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4984898567199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.4984898567199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.49869585037231445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5118794441223145  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([131, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.513035774230957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.513035774230957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5132856369018555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5310258865356445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5320219993591309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5320219993591309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.532224178314209  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5479941368103027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5486888885498047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5486888885498047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5488204956054688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5600070953369141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5608534812927246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5608534812927246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5609927177429199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5738024711608887  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5746617317199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5746617317199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5747933387756348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.587822437286377  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5884346961975098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5884346961975098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.588524341583252  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5980267524719238  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.598628044128418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.598628044128418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.5987081527709961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6077604293823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6085867881774902  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6085867881774902  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6086878776550293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6208186149597168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6214256286621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6214256286621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6214981079101562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6307029724121094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6311054229736328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6311054229736328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6311511993408203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6372852325439453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6380505561828613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6380505561828613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6381287574768066  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6491551399230957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6497621536254883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6497621536254883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6498231887817383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6588563919067383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6593122482299805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6593122482299805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6593561172485352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6661558151245117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.666532039642334  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.666532039642334  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6665663719177246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6721282005310059  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6726417541503906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6726417541503906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6726856231689453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6800994873046875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([208, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6850757598876953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6850757598876953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 0.6854724884033203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 0.7552967071533203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 208, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 0.7339391708374023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 0.734367847442627  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 0.7347965240478516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 0.7343463897705078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2874, 40])
input nodes number: 6098
output nodes number: 2874
edges number: 24983
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 0.7344255447387695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 0.7344260215759277  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.019256591796875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 14 input nodes size: 10888
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017783641815185547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017783641815185547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.022975444793701172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.022997379302978516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.01674652099609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017139434814453125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017139434814453125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017139434814453125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([10888, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017139434814453125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([699, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03354501724243164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03354501724243164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 699, 128]), torch.Size([1, 699, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03421163558959961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04046201705932617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 699, 128])
m.shape torch.Size([655, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04075336456298828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04075336456298828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.041378021240234375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05074787139892578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([565, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05124378204345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05124378204345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05178260803222656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.063690185546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([454, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06428670883178711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06428670883178711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06471967697143555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07727575302124023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([368, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07793664932250977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07793664932250977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 368, 128]), torch.Size([1, 368, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07828760147094727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09092187881469727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 368, 128])
m.shape torch.Size([300, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09160470962524414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09160470962524414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 300, 128]), torch.Size([1, 300, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09189081192016602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10419321060180664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 300, 128])
m.shape torch.Size([256, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1049046516418457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1049046516418457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 256, 128]), torch.Size([1, 256, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1051487922668457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1173558235168457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 256, 128])
m.shape torch.Size([245, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11816835403442383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11816835403442383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 245, 128]), torch.Size([1, 245, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11840200424194336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13172006607055664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 245, 128])
m.shape torch.Size([193, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1324315071105957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1324315071105957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 193, 128]), torch.Size([1, 193, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1326155662536621  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1443953514099121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 193, 128])
m.shape torch.Size([1717, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15249061584472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15249061584472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 1717, 128]), torch.Size([1, 1717, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1541280746459961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2703876495361328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 1717, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2574787139892578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2626781463623047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.26787757873535156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2626371383666992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([5452, 256])
first layer input nodes number: 10888
first layer output nodes number: 5452
edges number: 31819
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2679610252380371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.27318716049194336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2744603157043457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2744603157043457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([517, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29508256912231445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29508256912231445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2960686683654785  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3056168556213379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.30590248107910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.30590248107910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3066749572753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.31842899322509766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([329, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.31899166107177734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.31899166107177734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.31961917877197266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3335866928100586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.33425331115722656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.33425331115722656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.33473968505859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3488445281982422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.34953880310058594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.34953880310058594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3499107360839844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3633003234863281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.36391639709472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.36391639709472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3641815185546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3755817413330078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.37621641159057617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.37621641159057617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3764338493347168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.38730573654174805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3880124092102051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3880124092102051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3882145881652832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39973878860473633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.40053749084472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.40053749084472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.40073585510253906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41343116760253906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41399526596069336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41399526596069336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4141268730163574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.42347097396850586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4239659309387207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4239659309387207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.42406702041625977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.43195199966430664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4326744079589844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4326744079589844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4328022003173828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44366455078125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44411325454711914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44411325454711914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44419145584106445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4513859748840332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45191240310668945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45191240310668945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4519925117492676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45992326736450195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46028709411621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46028709411621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4603404998779297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4660015106201172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46652841567993164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46652841567993164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4665970802307129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47435617446899414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47487783432006836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47487783432006836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.474942684173584  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.482724666595459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4832634925842285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4832634925842285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.48332643508911133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4913201332092285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49169063568115234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49169063568115234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4917325973510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49735546112060547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4976038932800293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4976038932800293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49763059616088867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5013957023620605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5019879341125488  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5019879341125488  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5020451545715332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5105137825012207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5108661651611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5108661651611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5109004974365234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5162220001220703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5167574882507324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5167574882507324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5168051719665527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5245299339294434  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5247831344604492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5247831344604492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.524806022644043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5286741256713867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([205, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5335888862609863  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5335888862609863  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5339798927307129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6027970314025879  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 205, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5854458808898926  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5858774185180664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5863089561462402  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5858554840087891  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2893, 40])
input nodes number: 5452
output nodes number: 2893
edges number: 20803
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5859212875366211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5859217643737793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017928123474121094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 15 input nodes size: 12083
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.01674938201904297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.01674938201904297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.022978782653808594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02299976348876953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017786026000976562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0181884765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0181884765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0181884765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([12083, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0181884765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([559, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03539705276489258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03539705276489258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03593015670776367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.041124820709228516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([599, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04142951965332031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04142951965332031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.042000770568847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05123329162597656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([546, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05172872543334961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05172872543334961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05224943161010742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0637049674987793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([473, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0643467903137207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0643467903137207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06479787826538086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07787942886352539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([373, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07854318618774414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07854318618774414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 373, 128]), torch.Size([1, 373, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07889890670776367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0917048454284668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 373, 128])
m.shape torch.Size([335, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09248542785644531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09248542785644531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 335, 128]), torch.Size([1, 335, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0928049087524414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10654258728027344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 335, 128])
m.shape torch.Size([274, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10729742050170898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10729742050170898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 274, 128]), torch.Size([1, 274, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1075587272644043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12062406539916992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 274, 128])
m.shape torch.Size([260, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12148523330688477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12148523330688477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 260, 128]), torch.Size([1, 260, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12173318862915039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13586664199829102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 260, 128])
m.shape torch.Size([252, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1368241310119629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1368241310119629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 252, 128]), torch.Size([1, 252, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13706445693969727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15244531631469727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 252, 128])
m.shape torch.Size([1911, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1614375114440918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1614375114440918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 1911, 128]), torch.Size([1, 1911, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16325998306274414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29265546798706055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 1911, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2780323028564453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.283355712890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.28917789459228516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2838125228881836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([5582, 256])
first layer input nodes number: 12083
first layer output nodes number: 5582
edges number: 34538
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.28926992416381836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29459333419799805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29592418670654297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29592418670654297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.31502723693847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.31502723693847656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.31581687927246094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.32259607315063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([389, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3229494094848633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3229494094848633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.32369136810302734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.33559703826904297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3361058235168457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3361058235168457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3366875648498535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3505854606628418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.351259708404541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.351259708404541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.35173845291137695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.36562204360961914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.36633920669555664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.36633920669555664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.36671876907348633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3803830146789551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3811335563659668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3811335563659668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.38144445419311523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39481306076049805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39551210403442383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39551210403442383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.395754337310791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4078660011291504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4086446762084961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4086446762084961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.40886783599853516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4215879440307617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([113, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4224538803100586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4224538803100586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4226694107055664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4364633560180664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.43712472915649414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.43712472915649414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.43727731704711914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44811105728149414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([87, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44895458221435547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44895458221435547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44912052154541016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4620637893676758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46282291412353516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46282291412353516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46296215057373047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47479724884033203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47544002532958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47544002532958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47554874420166016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4855508804321289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.48595428466796875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.48595428466796875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4860191345214844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49243927001953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4929695129394531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4929695129394531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4930438995361328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5009288787841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5011839866638184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5011839866638184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5012202262878418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5053153038024902  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5056896209716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5056896209716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5057353973388672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5112285614013672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5116386413574219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5116386413574219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5116863250732422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5177421569824219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.518120288848877  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.518120288848877  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5181622505187988  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5237851142883301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5242066383361816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5242066383361816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5242505073547363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5304360389709473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5307168960571289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5307168960571289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5307455062866211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5349798202514648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5353250503540039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5353250503540039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5353574752807617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5403833389282227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.54058837890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.54058837890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5406074523925781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5436973571777344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.544011116027832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.544011116027832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5440378189086914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5485506057739258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([147, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5520696640014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5520696640014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5523500442504883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6016969680786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 147, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5856852531433105  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.586097240447998  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5865092277526855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5860762596130371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2764, 40])
input nodes number: 5582
output nodes number: 2764
edges number: 19331
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5861196517944336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5861201286315918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.01896381378173828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 16 input nodes size: 20147
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017766475677490234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.017766475677490234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.027373313903808594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.027395248413085938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.021144866943359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.021640777587890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.021640777587890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.021640777587890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([20147, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.021640777587890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([857, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.046158790588378906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.046158790588378906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04697608947753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05431032180786133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([828, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.054691314697265625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.054691314697265625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05548095703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06732559204101562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([819, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06810235977172852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06810235977172852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06888341903686523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08606672286987305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([680, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0870661735534668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0870661735534668  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 680, 128]), torch.Size([1, 680, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08771467208862305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10679006576538086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 680, 128])
m.shape torch.Size([647, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10800838470458984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10800838470458984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 647, 128]), torch.Size([1, 647, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10862541198730469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1314702033996582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 647, 128])
m.shape torch.Size([530, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13267803192138672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13267803192138672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 530, 128]), torch.Size([1, 530, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13318347930908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15521526336669922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 530, 128])
m.shape torch.Size([427, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1563878059387207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1563878059387207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 427, 128]), torch.Size([1, 427, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15679502487182617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1771559715270996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 427, 128])
m.shape torch.Size([395, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.17845916748046875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.17845916748046875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.17883586883544922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20030784606933594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([285, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20134258270263672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20134258270263672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 285, 128]), torch.Size([1, 285, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2016143798828125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2190093994140625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 285, 128])
m.shape torch.Size([2584, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.23119497299194336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.23119497299194336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 2584, 128]), torch.Size([1, 2584, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2344985008239746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4103817939758301  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 2584, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3912053108215332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39888429641723633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.40656328201293945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39882421493530273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([8052, 256])
first layer input nodes number: 20147
first layer output nodes number: 8052
edges number: 48659
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.40671539306640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4143943786621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41631412506103516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41631412506103516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([544, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4340033531188965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4340033531188965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4350409507751465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44407224655151367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([417, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44435548782348633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44435548782348633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44515085220336914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45758867263793945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([341, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4581742286682129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4581742286682129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45882463455200195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4745450019836426  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([270, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4752769470214844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4752769470214844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47579193115234375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49082183837890625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([270, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49186229705810547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49186229705810547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49237728118896484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5118684768676758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([182, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5126609802246094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5126609802246094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5130081176757812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5279350280761719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5285625457763672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5285625457763672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5287895202636719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5401382446289062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([124, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5409784317016602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5409784317016602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5412149429321289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5546960830688477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5552873611450195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5552873611450195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5554437637329102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5654535293579102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5660195350646973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5660195350646973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5661473274230957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5752205848693848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5756959915161133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5756959915161133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5757932662963867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5833806991577148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5840473175048828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5840473175048828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5841655731201172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5942173004150391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.594820499420166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.594820499420166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5949215888977051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6042218208312988  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6048307418823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6048307418823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.604924201965332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6141767501831055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6145772933959961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6145772933959961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6146364212036133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6209039688110352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6212434768676758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6212434768676758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6212892532348633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6264619827270508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6268153190612793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6268153190612793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.626859188079834  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6321234703063965  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6324305534362793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6324305534362793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6324667930603027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6370692253112793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6374163627624512  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6374163627624512  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6374545097351074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6425662040710449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.642758846282959  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.642758846282959  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6427798271179199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6457381248474121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.645869255065918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.645869255065918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6458826065063477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6478586196899414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6480636596679688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6480636596679688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6480827331542969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6510391235351562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6513395309448242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6513395309448242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6513662338256836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6556921005249023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6558403968811035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6558403968811035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6558537483215332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6581101417541504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([114, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6608428955078125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6608428955078125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6610603332519531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6993293762207031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 114, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6850180625915527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6854519844055176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6858859062194824  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6854300498962402  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2911, 40])
input nodes number: 8052
output nodes number: 2911
edges number: 17725
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6855340003967285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6855344772338867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02265453338623047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 17 input nodes size: 25324
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02116680145263672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02116680145263672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.033242225646972656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0332636833190918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.023634910583496094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.024166107177734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.024166107177734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.024166107177734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([25324, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.024166107177734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([785, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05092620849609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05092620849609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.051674842834472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.057941436767578125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([861, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05838823318481445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05838823318481445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.059209346771240234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07152605056762695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([702, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07211971282958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07211971282958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 702, 128]), torch.Size([1, 702, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07278919219970703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08751773834228516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 702, 128])
m.shape torch.Size([615, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0885000228881836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0885000228881836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08908653259277344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10615062713623047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([540, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10714483261108398  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10714483261108398  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10765981674194336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12688970565795898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([448, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1279139518737793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1279139518737793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 448, 128]), torch.Size([1, 448, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1283411979675293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1467127799987793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 448, 128])
m.shape torch.Size([420, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1484827995300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1484827995300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14888334274291992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16891050338745117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([370, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1701216697692871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1701216697692871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 370, 128]), torch.Size([1, 370, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.17047452926635742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.19058752059936523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 370, 128])
m.shape torch.Size([281, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.19161701202392578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.19161701202392578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 281, 128]), torch.Size([1, 281, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.19188499450683594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20903587341308594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 281, 128])
m.shape torch.Size([3294, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2246088981628418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2246088981628418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 3294, 128]), torch.Size([1, 3294, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22843313217163086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4587430953979492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 3294, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.43462562561035156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44255638122558594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4504871368408203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44249439239501953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([8316, 256])
first layer input nodes number: 25324
first layer output nodes number: 8316
edges number: 53830
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45067787170410156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45860862731933594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46059131622314453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46059131622314453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([509, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47792673110961914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47792673110961914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4788975715637207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4866642951965332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([459, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4870615005493164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4870615005493164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.48793697357177734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5015764236450195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([331, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5020933151245117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5020933151245117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5027246475219727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5178108215332031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([269, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5185294151306152  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5185294151306152  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5190424919128418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5341753959655762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([229, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5350193977355957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5350193977355957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5354561805725098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.551180362701416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5517983436584473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5517983436584473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5520749092102051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.563967227935791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5645895004272461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5645895004272461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5648050308227539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5755815505981445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5762119293212891  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5762119293212891  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5763950347900391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5868320465087891  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5875105857849121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5875105857849121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5876803398132324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5985445976257324  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5992288589477539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5992288589477539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5993814468383789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6102151870727539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6108369827270508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6108369827270508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6109628677368164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6207818984985352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6212959289550781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6212959289550781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6213912963867188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6294975280761719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6300497055053711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6300497055053711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6301412582397461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6385641098022461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6388955116271973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6388955116271973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.638948917388916  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6442360877990723  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.64471435546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.64471435546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6447811126708984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6518573760986328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6523470878601074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6523470878601074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.652411937713623  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6597399711608887  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6601324081420898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6601324081420898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.660181999206543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.666132926940918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6664199829101562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6664199829101562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6664543151855469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6708145141601562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6712174415588379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6712174415588379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6712613105773926  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6771397590637207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6773295402526855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6773295402526855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6773505210876465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6803088188171387  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6805205345153809  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6805205345153809  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6805415153503418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6836466789245605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6837635040283203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6837635040283203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6837749481201172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6855487823486328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6856980323791504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6856980323791504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6857113838195801  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6878743171691895  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6880984306335449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6880984306335449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.688117504119873  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6913409233093262  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([125, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6943349838256836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6943349838256836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6945734024047852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7365350723266602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 125, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7224407196044922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7228608131408691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7232809066772461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.72283935546875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2818, 40])
input nodes number: 8316
output nodes number: 2818
edges number: 17394
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7229089736938477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7229094505310059  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.025220394134521484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 18 input nodes size: 22949
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.023621082305908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.023621082305908203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03456401824951172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03458547592163086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02248859405517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.023103713989257812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.023103713989257812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.023103713989257812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([22949, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.023103713989257812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([666, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05282115936279297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05282115936279297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05345630645751953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.058725833892822266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([750, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05912351608276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05912351608276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05983877182006836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07102394104003906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([721, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07169771194458008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07169771194458008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 721, 128]), torch.Size([1, 721, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07238531112670898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.087554931640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 721, 128])
m.shape torch.Size([642, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08843564987182617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08843564987182617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08904790878295898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1071314811706543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([575, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10819625854492188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10819625854492188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 575, 128]), torch.Size([1, 575, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10874462127685547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12894010543823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 575, 128])
m.shape torch.Size([565, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13028240203857422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13028240203857422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13082122802734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15545272827148438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([431, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15662193298339844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15662193298339844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.15703296661376953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.17758464813232422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([429, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1790156364440918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1790156364440918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.17942476272583008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2027449607849121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([380, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20417118072509766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20417118072509766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20453357696533203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22772693634033203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([3698, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2451791763305664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2451791763305664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 3698, 128]), torch.Size([1, 3698, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.24884033203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5005154609680176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 3698, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47405433654785156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4825010299682617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4909477233886719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4824347496032715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([8857, 256])
first layer input nodes number: 22949
first layer output nodes number: 8857
edges number: 60011
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4911208152770996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49956750869750977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5022053718566895  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5022053718566895  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5244007110595703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5244007110595703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5252323150634766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5322198867797852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5325117111206055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5325117111206055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5332136154174805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5448102951049805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5453071594238281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5453071594238281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.545867919921875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5593938827514648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5600247383117676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5600247383117676  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5604767799377441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5735859870910645  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5743260383605957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5743260383605957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.574709415435791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5885109901428223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5892305374145508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5892305374145508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5895318984985352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6024904251098633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6031002998352051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6031002998352051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6033158302307129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6140923500061035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6148457527160645  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6148457527160645  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6150593757629395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6272358894348145  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6279854774475098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6279854774475098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6281743049621582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6402592658996582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6409435272216797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6409435272216797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6410980224609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6520671844482422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6526665687561035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6526665687561035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6527886390686035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6623101234436035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6629643440246582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6629643440246582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6630825996398926  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6731343269348145  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6737003326416016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6737003326416016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6737957000732422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6825695037841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6830601692199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6830601692199707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6831364631652832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6906895637512207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6914157867431641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6914157867431641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6915168762207031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7022323608398438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7027201652526855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7027201652526855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.702786922454834  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7103304862976074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7107710838317871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7107710838317871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7108263969421387  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7174639701843262  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7180938720703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7180938720703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7181663513183594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7273712158203125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.727755069732666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.727755069732666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7277989387512207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7336773872375488  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7342133522033691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7342133522033691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7342686653137207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.742067813873291  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7424440383911133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7424440383911133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7424821853637695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7481279373168945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7486166954040527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7486166954040527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7486624717712402  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7557578086853027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7562437057495117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7562437057495117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7562875747680664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7633943557739258  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7637186050415039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7637186050415039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7637472152709961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7685823440551758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([242, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7743830680847168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7743830680847168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7748446464538574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8560824394226074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 242, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8374786376953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8379030227661133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8383274078369141  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8378815650939941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2846, 40])
input nodes number: 8857
output nodes number: 2846
edges number: 22437
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8379735946655273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8379740715026855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.024293899536132812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 19 input nodes size: 20468
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02249288558959961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02249288558959961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03225278854370117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03227376937866211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.021309375762939453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02177572250366211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02177572250366211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02177572250366211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([20468, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02177572250366211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04488372802734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04488372802734375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.045676231384277344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.052758216857910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([827, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05315065383911133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05315065383911133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0539393424987793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06576967239379883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([784, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06673765182495117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06673765182495117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06748533248901367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08393430709838867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([636, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08477354049682617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08477354049682617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08538007736206055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10299253463745117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([570, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10404825210571289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10404825210571289  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 570, 128]), torch.Size([1, 570, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10459184646606445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12420129776000977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 570, 128])
m.shape torch.Size([443, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12542104721069336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12542104721069336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 443, 128]), torch.Size([1, 443, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12584352493286133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14401006698608398  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 443, 128])
m.shape torch.Size([412, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1451740264892578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1451740264892578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 412, 128]), torch.Size([1, 412, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1455669403076172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16521263122558594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 412, 128])
m.shape torch.Size([327, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16626358032226562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16626358032226562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16657543182373047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18435096740722656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([294, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1854567527770996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1854567527770996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 294, 128]), torch.Size([1, 294, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18573713302612305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20368146896362305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 294, 128])
m.shape torch.Size([2526, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21558618545532227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21558618545532227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 2526, 128]), torch.Size([1, 2526, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21799516677856445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39174890518188477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 2526, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.37170934677124023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.37900495529174805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.38630056381225586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.37894773483276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([7650, 256])
first layer input nodes number: 20468
first layer output nodes number: 7650
edges number: 46295
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.38645505905151367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3937506675720215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3963503837585449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3963503837585449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([566, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41263341903686523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41263341903686523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4137129783630371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4228243827819824  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([425, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.42310190200805664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.42310190200805664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.42391252517700195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.43640756607055664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([347, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4370584487915039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4370584487915039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.43772029876708984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45258617401123047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([284, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45343494415283203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.45343494415283203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4539766311645508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46978187561035156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4704437255859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4704437255859375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4708137512207031  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4841346740722656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.48476314544677734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.48476314544677734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4850320816040039  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4965963363647461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4973435401916504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4973435401916504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49759340286254883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5100865364074707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5106229782104492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5106229782104492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5107870101928711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.520136833190918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5207729339599609  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5207729339599609  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5209312438964844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5310630798339844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5315990447998047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5315990447998047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5317211151123047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5403881072998047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5409722328186035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5409722328186035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5410885810852051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.550163745880127  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5505557060241699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5505557060241699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5506300926208496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.556952953338623  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5574908256530762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5574908256530762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5575785636901855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.565650463104248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5661582946777344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5661582946777344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5662364959716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5739784240722656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5743288993835449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5743288993835449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5743803977966309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5798392295837402  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.580136775970459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.580136775970459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.580176830291748  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5847029685974121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5850915908813477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5850915908813477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.585139274597168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5908613204956055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5911836624145508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5911836624145508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.591221809387207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5960664749145508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5963034629821777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5963034629821777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5963301658630371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5999083518981934  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6001834869384766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6001834869384766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6002120971679688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6042461395263672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6045951843261719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6045951843261719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6046295166015625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.609710693359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6099262237548828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6099262237548828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6099472045898438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6131992340087891  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6134319305419922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6134319305419922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6134529113769531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.616851806640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6170258522033691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6170258522033691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6170411109924316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6196198463439941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([95, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6218953132629395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6218953132629395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6220765113830566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6539673805236816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 95, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.640955924987793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6413693428039551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6417827606201172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6413483619689941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2773, 40])
input nodes number: 7650
output nodes number: 2773
edges number: 16244
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6414155960083008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.641416072845459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02270793914794922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 20 input nodes size: 30824
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02129840850830078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02129840850830078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03692340850830078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03694438934326172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02716350555419922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.028018951416015625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.028018951416015625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.028018951416015625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([30824, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.028018951416015625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([642, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07313823699951172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07313823699951172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 642, 128]), torch.Size([1, 642, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07375049591064453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07939529418945312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 642, 128])
m.shape torch.Size([678, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07973575592041016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07973575592041016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 678, 128]), torch.Size([1, 678, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0803823471069336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09008121490478516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 678, 128])
m.shape torch.Size([617, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09064054489135742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09064054489135742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 617, 128]), torch.Size([1, 617, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09122896194458008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10417413711547852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 617, 128])
m.shape torch.Size([596, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10503768920898438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10503768920898438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1056060791015625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.123016357421875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([551, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12404584884643555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12404584884643555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 551, 128]), torch.Size([1, 551, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12457132339477539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14353656768798828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 551, 128])
m.shape torch.Size([525, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1447758674621582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1447758674621582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14527654647827148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1674647331237793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([525, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16896677017211914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16896677017211914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16946744918823242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.19596099853515625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([476, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1975264549255371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1975264549255371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.19798040390014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22385549545288086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([429, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22546958923339844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22546958923339844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22587871551513672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2520627975463867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([6812, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2850613594055176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2850613594055176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 6812, 128]), torch.Size([1, 6812, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29155778884887695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7532658576965332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 6812, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7134928703308105  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.724794864654541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7360968589782715  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7247061729431152  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([11851, 256])
first layer input nodes number: 30824
first layer output nodes number: 11851
edges number: 91602
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7363286018371582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7476305961608887  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7509207725524902  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7509207725524902  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7736110687255859  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7736110687255859  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7743949890136719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7808089256286621  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([341, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7810726165771484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7810726165771484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7817230224609375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.79241943359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7928929328918457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7928929328918457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7934212684631348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8057656288146973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.806328296661377  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.806328296661377  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8067383766174316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8186306953430176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([170, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8192429542541504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8192429542541504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8195672035217285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.831240177154541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([182, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8321280479431152  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8321280479431152  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8324751853942871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8474020957946777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8481435775756836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8481435775756836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8484029769897461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8613729476928711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8621125221252441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8621125221252441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.862328052520752  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8746132850646973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8752670288085938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8752670288085938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8754348754882812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8861770629882812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8869009017944336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8869009017944336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8870611190795898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8984365463256836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8991284370422363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8991284370422363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8992676734924316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.910128116607666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9107160568237305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9107160568237305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9108247756958008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9200658798217773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9205489158630371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9205489158630371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.920630931854248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9281764030456543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9286065101623535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9286065101623535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.928673267364502  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9352822303771973  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9358835220336914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9358835220336914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9359674453735352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9448633193969727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9454059600830078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9454059600830078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9454784393310547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9536685943603516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.954139232635498  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.954139232635498  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9541983604431152  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9612936973571777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9617486000061035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9617486000061035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9618020057678223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9685845375061035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.968904972076416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.968904972076416  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9689412117004395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9737973213195801  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9741830825805664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9741830825805664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9742231369018555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9798707962036133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9803757667541504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9803757667541504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9804253578186035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.987764835357666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9881844520568848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9881844520568848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9882245063781738  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9944329261779785  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9947004318237305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9947004318237305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.994725227355957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9987421035766602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9992141723632812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9992141723632812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9992542266845703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0060234069824219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0131402015686035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0131402015686035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0137066841125488  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.12141752243042  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1017193794250488  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1021342277526855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1025490760803223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1021132469177246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2784, 40])
input nodes number: 11851
output nodes number: 2784
edges number: 23066
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.102224349975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1022248268127441  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.029575824737548828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 21 input nodes size: 37161
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.027164936065673828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.027164936065673828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.044884681701660156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.044905662536621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.029259681701660156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03013896942138672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03013896942138672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03013896942138672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([37161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03013896942138672  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([757, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07858753204345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07858753204345703  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07930946350097656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08545255661010742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([836, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08588886260986328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08588886260986328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0866861343383789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09864521026611328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([723, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09946346282958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09946346282958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10015296936035156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11532211303710938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([685, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11628389358520508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11628389358520508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 685, 128]), torch.Size([1, 685, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11693716049194336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13588190078735352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 685, 128])
m.shape torch.Size([641, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1370835304260254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1370835304260254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 641, 128]), torch.Size([1, 641, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1376948356628418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16025066375732422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 641, 128])
m.shape torch.Size([545, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16150426864624023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16150426864624023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16202402114868164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18523263931274414  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([503, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18665170669555664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18665170669555664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 503, 128]), torch.Size([1, 503, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18713140487670898  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21111631393432617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 503, 128])
m.shape torch.Size([497, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21277236938476562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21277236938476562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 497, 128]), torch.Size([1, 497, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21324634552001953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2402629852294922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 497, 128])
m.shape torch.Size([395, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.24172115325927734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.24172115325927734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2420978546142578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2662067413330078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([7246, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3011746406555176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3011746406555176  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 7246, 128]), torch.Size([1, 7246, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.30808496475219727  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7987179756164551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 7246, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7542576789855957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7664914131164551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7787251472473145  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7663955688476562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([12828, 256])
first layer input nodes number: 37161
first layer output nodes number: 12828
edges number: 97325
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7790040969848633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7912378311157227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7942962646484375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7942962646484375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([472, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8145885467529297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8145885467529297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8154888153076172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8232717514038086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([406, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8236021995544434  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8236021995544434  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8243765830993652  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8396320343017578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8400726318359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8400726318359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8406200408935547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.853764533996582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([248, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8544445037841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8544445037841797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8549175262451172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8686351776123047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8693695068359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8693695068359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8697547912597656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8836250305175781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([127, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8841648101806641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8841648101806641  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8844070434570312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8948230743408203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.895503044128418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.895503044128418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8957300186157227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.907078742980957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([90, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9076576232910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9076576232910156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9078292846679688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9176139831542969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.918306827545166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.918306827545166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9184784889221191  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9294648170471191  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9300136566162109  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9300136566162109  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9301395416259766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9390773773193359  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9396910667419434  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9396910667419434  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9398131370544434  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9493346214294434  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([45, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9497928619384766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9497928619384766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9498786926269531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9571743011474609  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.957643985748291  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.957643985748291  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9577221870422363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9649167060852051  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9652681350708008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9652681350708008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9653234481811523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.970799446105957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9711179733276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9711179733276367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9711637496948242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9760160446166992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9765467643737793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9765467643737793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9766154289245605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9843745231628418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.984830379486084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.984830379486084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9848875999450684  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9917540550231934  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9921064376831055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9921064376831055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9921483993530273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9974775314331055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9980592727661133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9980592727661133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9981222152709961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.006556510925293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0069098472595215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0069098472595215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0069479942321777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.012326717376709  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0126709938049316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0126709938049316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0127053260803223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0177865028381348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0180869102478027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0180869102478027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.018115520477295  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.022550106048584  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0227127075195312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0227127075195312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0227279663085938  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0251998901367188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0255155563354492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0255155563354492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0255422592163086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.030055046081543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([252, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0360970497131348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0360970497131348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.0365777015686035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1211724281311035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 252, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1039519309997559  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.104362964630127  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.104773998260498  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.104341983795166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2758, 40])
input nodes number: 12828
output nodes number: 2758
edges number: 20512
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1044549942016602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1044554710388184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03176450729370117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 22 input nodes size: 18706
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02925586700439453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.02925586700439453  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03817558288574219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03819751739501953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.020456790924072266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.020931720733642578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.020931720733642578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.020931720733642578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([18706, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.020931720733642578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([807, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04404640197753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.04404640197753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.044816017150878906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05110740661621094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([859, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.051541805267333984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.051541805267333984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05236101150512695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06464910507202148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([748, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06558465957641602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06558465957641602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 748, 128]), torch.Size([1, 748, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.06629800796508789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08199167251586914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 748, 128])
m.shape torch.Size([652, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08287858963012695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08287858963012695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08350038528442383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10219621658325195  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([574, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10325384140014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10325384140014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 574, 128]), torch.Size([1, 574, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10380125045776367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12438249588012695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 574, 128])
m.shape torch.Size([466, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12550115585327148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12550115585327148  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 466, 128]), torch.Size([1, 466, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1259455680847168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14505529403686523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 466, 128])
m.shape torch.Size([404, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14618158340454102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14618158340454102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 404, 128]), torch.Size([1, 404, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14656686782836914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1658310890197754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 404, 128])
m.shape torch.Size([371, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1670536994934082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1670536994934082  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 371, 128]), torch.Size([1, 371, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16740751266479492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1875748634338379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 371, 128])
m.shape torch.Size([318, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18876266479492188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18876266479492188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 318, 128]), torch.Size([1, 318, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18906593322753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20847511291503906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 318, 128])
m.shape torch.Size([2463, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22006797790527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22006797790527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 2463, 128]), torch.Size([1, 2463, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.22241687774658203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39674997329711914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 2463, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3762474060058594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.38355445861816406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39086151123046875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3834972381591797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([7662, 256])
first layer input nodes number: 18706
first layer output nodes number: 7662
edges number: 46331
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3910031318664551  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.39831018447875977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.40100860595703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.40100860595703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([555, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41835927963256836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.41835927963256836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4194178581237793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.428743839263916  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([490, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4291567802429199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4291567802429199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.43009138107299805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4450411796569824  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([359, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44576072692871094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.44576072692871094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4464454650878906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4620065689086914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46257925033569336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46257925033569336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.46303319931030273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4761977195739746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47704267501831055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47704267501831055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.47746801376342773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4927802085876465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49351930618286133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.49351930618286133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.4938340187072754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5073666572570801  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5081043243408203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5081043243408203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5083580017089844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5210418701171875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5217146873474121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5217146873474121  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5219130516052246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5332198143005371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5338993072509766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5338993072509766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5340709686279297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5450572967529297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5456252098083496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5456252098083496  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5457549095153809  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5549635887145996  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5554594993591309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5554594993591309  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5555605888366699  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5634455680847168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5640063285827637  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5640063285827637  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5641074180603027  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.572700023651123  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5731368064880371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5731368064880371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5732111930847168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.580054759979248  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.580380916595459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.580380916595459  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5804324150085449  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5855307579040527  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.585822582244873  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.585822582244873  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5858645439147949  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5903124809265137  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.590630054473877  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.590630054473877  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5906720161437988  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5954136848449707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5956707000732422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5956707000732422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.595703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.5995941162109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.600010871887207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.600010871887207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6000585556030273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.606114387512207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6064743995666504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6064743995666504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6065144538879395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6118817329406738  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6121888160705566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6121888160705566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6122212409973145  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.616793155670166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6169791221618652  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6169791221618652  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6169981956481934  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6198210716247559  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.620023250579834  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.620023250579834  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6200423240661621  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6229987144470215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6231884956359863  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6231884956359863  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6232056617736816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6259865760803223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6262550354003906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6262550354003906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6262779235839844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6301460266113281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([130, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6332583427429199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6332583427429199  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6335062980651855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6771464347839355  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 130, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6631479263305664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.663578987121582  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6640100479125977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6635570526123047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2892, 40])
input nodes number: 7662
output nodes number: 2892
edges number: 17361
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6636562347412109  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6636567115783691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.021900653839111328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 23 input nodes size: 40128
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.020476818084716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.020476818084716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0400080680847168  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.040029048919677734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.031087398529052734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.031855106353759766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.031855106353759766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.031855106353759766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([40128, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.031855106353759766  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([859, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07410383224487305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07410383224487305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.07492303848266602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08147668838500977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([924, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08194828033447266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08194828033447266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.08282947540283203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09604740142822266  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([819, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0968174934387207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0968174934387207  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.09759855270385742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11478185653686523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([712, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11592674255371094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11592674255371094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 712, 128]), torch.Size([1, 712, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11660575866699219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13698387145996094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 712, 128])
m.shape torch.Size([676, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13825607299804688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.13825607299804688  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1389007568359375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.162109375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([555, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1633749008178711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1633749008178711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 555, 128]), torch.Size([1, 555, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16390419006347656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18677997589111328  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 555, 128])
m.shape torch.Size([518, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18824434280395508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18824434280395508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18873834609985352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21453142166137695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([467, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2160658836364746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2160658836364746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 467, 128]), torch.Size([1, 467, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.21651124954223633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2418971061706543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 467, 128])
m.shape torch.Size([437, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.24354982376098633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.24354982376098633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.24396657943725586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.27063894271850586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([5944, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29877376556396484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.29877376556396484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 5944, 128]), torch.Size([1, 5944, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3044424057006836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7074170112609863  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 5944, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.669283390045166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6806426048278809  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6920018196105957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6805534362792969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([11911, 256])
first layer input nodes number: 40128
first layer output nodes number: 11911
edges number: 85457
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.6923027038574219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7036619186401367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7065019607543945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7065019607543945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([529, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7238855361938477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7238855361938477  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7248945236206055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7339668273925781  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([459, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7343449592590332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7343449592590332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7352204322814941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7529988288879395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([329, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7535099983215332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7535099983215332  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7541375160217285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7679886817932129  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7685785293579102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7685785293579102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7690267562866211  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7820253372192383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7827482223510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7827482223510742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7831239700317383  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7966508865356445  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7972588539123535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7972588539123535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.7975220680236816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.808840274810791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8096237182617188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8096237182617188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8098831176757812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8228530883789062  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8234539031982422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8234539031982422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8236351013183594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8339633941650391  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8345565795898438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8345565795898438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8347072601318359  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8443508148193359  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([61, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8448619842529297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8448619842529297  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8449783325195312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8532390594482422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8538050651550293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8538050651550293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8539175987243652  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8626952171325684  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8631119728088379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8631119728088379  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8631901741027832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8698372840881348  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8703980445861816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8703980445861816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8704895973205566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8789124488830566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8793511390686035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8793511390686035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8794198036193848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8862175941467285  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8864717483520508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8864717483520508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.886509895324707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8905534744262695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8908882141113281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8908882141113281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8909320831298828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8958892822265625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8961782455444336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.8961782455444336  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.896214485168457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9005632400512695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9008569717407227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9008569717407227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9008913040161133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9052515029907227  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9056730270385742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9056730270385742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9057188034057617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9118528366088867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9122529029846191  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9122529029846191  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.912294864654541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9182114601135254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9184932708740234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9184932708740234  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9185218811035156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9227561950683594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9229536056518555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9229536056518555  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9229726791381836  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.925929069519043  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.926185131072998  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.926185131072998  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9262080192565918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9299159049987793  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9301815032958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9301815032958984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9302043914794922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9340724945068359  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([145, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9375452995300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9375452995300293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9378218650817871  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9864974021911621  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 145, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9725933074951172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9730052947998047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9734172821044922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9729843139648438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2762, 40])
input nodes number: 11911
output nodes number: 2762
edges number: 17424
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9730753898620605  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.9730758666992188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03333282470703125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 24 input nodes size: 41161
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05069541931152344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05071735382080078  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.031165122985839844  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03256797790527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03256797790527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03256797790527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([41161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03256797790527344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([449, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10628080368041992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10628080368041992  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.10670900344848633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11013460159301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([482, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11038017272949219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11038017272949219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 482, 128]), torch.Size([1, 482, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11083984375  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11773490905761719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 482, 128])
m.shape torch.Size([468, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11817455291748047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.11817455291748047  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 468, 128]), torch.Size([1, 468, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1186208724975586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12843990325927734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 468, 128])
m.shape torch.Size([474, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1291208267211914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.1291208267211914  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.12957286834716797  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14268207550048828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([476, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14431333541870117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14431333541870117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.14476728439331055  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16110944747924805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([452, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16217565536499023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16217565536499023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.16260671615600586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18114233016967773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([464, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18247556686401367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18247556686401367  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 464, 128]), torch.Size([1, 464, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.18291807174682617  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20504331588745117  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 464, 128])
m.shape torch.Size([439, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2064967155456543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2064967155456543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.20691537857055664  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.23077917098999023  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([475, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.23260831832885742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.23260831832885742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2330613136291504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.2620530128479004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([12959, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3243265151977539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3243265151977539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 12959, 128]), torch.Size([1, 12959, 128])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.3366851806640625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2296361923217773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 12959, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1595711708068848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.175915241241455  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1922593116760254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.1757874488830566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([17138, 256])
first layer input nodes number: 41161
first layer output nodes number: 17138
edges number: 150430
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.192568302154541  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2089123725891113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.212998390197754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.212998390197754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([281, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2495803833007812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2495803833007812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2501163482666016  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2547683715820312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([225, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2549333572387695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2549333572387695  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2553625106811523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2617998123168945  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([164, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2620582580566406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2620582580566406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2623710632324219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2692527770996094  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([145, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2696542739868164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2696542739868164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2699308395385742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2779512405395508  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([127, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2784233093261719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2784233093261719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.278665542602539  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2873859405517578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([94, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2878069877624512  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2878069877624512  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2879862785339355  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2956957817077637  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([85, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2961783409118652  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2961783409118652  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.2963404655456543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3044466972351074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.305065631866455  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.305065631866455  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.305239200592041  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3151326179504395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3157811164855957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3157811164855957  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3159432411193848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3263192176818848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3270263671875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3270263671875  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3271827697753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.338287353515625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3389496803283691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3389496803283691  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.339083194732666  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3494973182678223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3502840995788574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3502840995788574  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3504252433776855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3624224662780762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.363114356994629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.363114356994629  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3632307052612305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3739347457885742  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3747377395629883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3747377395629883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3748598098754883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3869447708129883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.387662410736084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.387662410736084  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3877654075622559  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3986830711364746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3992929458618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3992929458618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.3993749618530273  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4086427688598633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4093208312988281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4093208312988281  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4094047546386719  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4194755554199219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([44, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4201951026916504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4201951026916504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4202790260314941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4309372901916504  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([58, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4320626258850098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4320626258850098  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.432173252105713  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4469971656799316  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4478073120117188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4478073120117188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4478931427001953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4599952697753906  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4606995582580566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4606995582580566  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4607701301574707  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.471214771270752  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4718561172485352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4718561172485352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4719171524047852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4813776016235352  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.482076644897461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.482076644897461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4821395874023438  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4923362731933594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4931817054748535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4931817054748535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.4932541847229004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.5055031776428223  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([808, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.525148868560791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.525148868560791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.5266900062561035  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.799424648284912  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 808, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.7654290199279785  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.7658591270446777  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.766289234161377  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.7658371925354004  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([2884, 40])
input nodes number: 17138
output nodes number: 2884
edges number: 37649
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.766005039215088  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.766005516052246  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.034993648529052734  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

pseudo mini batch 25 input nodes size: 48225
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.031183242797851562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.031183242797851562  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.05462074279785156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.0546417236328125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03499269485473633  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03653383255004883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03653383255004883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03653383255004883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([48225, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 0.03653383255004883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([559, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.12092018127441406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.12092018127441406  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 559, 128]), torch.Size([1, 559, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.12145328521728516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1265411376953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 559, 128])
m.shape torch.Size([564, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.12681245803833008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.12681245803833008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1273503303527832  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.13541841506958008  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([517, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.13588905334472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.13588905334472656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1363821029663086  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1473836898803711  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([553, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1481919288635254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1481919288635254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.14871931076049805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.16424798965454102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([548, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.16529083251953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.16529083251953125  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.16581344604492188  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1853199005126953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([517, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1865377426147461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.1865377426147461  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.18703079223632812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.20920372009277344  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([484, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.2105727195739746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.2105727195739746  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.21103429794311523  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.23411321640014648  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([533, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.2359156608581543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.2359156608581543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.23642396926879883  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.2658858299255371  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([528, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.2678976058959961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.2678976058959961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.2684011459350586  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.30133724212646484  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([14847, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.37188148498535156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.37188148498535156  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 14847, 128]), torch.Size([1, 14847, 128])
----------------------------------------3
 Nvidia-smi: 4.4588623046875 GB
    Memory Allocated: 0.38604068756103516  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3920807838439941  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 14847, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3119020462036133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3314332962036133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3509645462036133  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3312864303588867  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

torch.Size([19650, 256])
first layer input nodes number: 48225
first layer output nodes number: 19650
edges number: 172166
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3513259887695312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3708572387695312  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.375741958618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.375741958618164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

m.shape torch.Size([334, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4093027114868164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4093027114868164  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4099397659301758  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4159107208251953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([251, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4160747528076172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4160747528076172  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4165534973144531  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4237346649169922  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([175, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4240002632141113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4240002632141113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4243340492248535  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4316773414611816  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([158, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4321179389953613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4321179389953613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4324193000793457  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4411587715148926  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([118, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.441575527191162  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.441575527191162  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.441800594329834  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4499030113220215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([106, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.450401782989502  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.450401782989502  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.45060396194458  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4592976570129395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([79, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4597282409667969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4597282409667969  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.459878921508789  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4674129486083984  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([78, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4679374694824219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4679374694824219  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4680862426757812  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4765663146972656  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.477071762084961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.477071762084961  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4771995544433594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4853782653808594  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([64, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4859294891357422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4859294891357422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4860515594482422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4947185516357422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4952497482299805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4952497482299805  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.495356559753418  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.503687858581543  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5042228698730469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5042228698730469  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5043201446533203  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5125885009765625  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5130648612976074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5130648612976074  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5131449699401855  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.520514965057373  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5209193229675293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5209193229675293  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.520982265472412  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5272135734558105  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5279173851013184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5279173851013184  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5280146598815918  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5383257865905762  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5388922691345215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5388922691345215  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.538968563079834  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5475897789001465  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5480585098266602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5480585098266602  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5481176376342773  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5552129745483398  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5558757781982422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5558757781982422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5559520721435547  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5656414031982422  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5662426948547363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5662426948547363  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5663094520568848  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5752549171447754  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5759906768798828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5759906768798828  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5760669708251953  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5868244171142578  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5873517990112305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5873517990112305  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5874052047729492  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5953092575073242  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.595705509185791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.595705509185791  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5957436561584473  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.601656436920166  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6023449897766113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6023449897766113  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6024060249328613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6122937202453613  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6128168106079102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6128168106079102  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6128625869750977  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6205987930297852  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([805, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6402573585510254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6402573585510254  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6417927742004395  GigaBytes
Max Memory Allocated: 1.898190975189209  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.915316104888916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 805, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.884411334991455  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8848223686218262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8852334022521973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8848013877868652  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2758, 40])
input nodes number: 19650
output nodes number: 2758
edges number: 34457
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8849501609802246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.8849506378173828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03914499282836914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 26 input nodes size: 45850
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.056836605072021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05685758590698242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.033399105072021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03462362289428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03462362289428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03462362289428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([45850, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03462362289428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([653, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10212898254394531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10212898254394531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1027517318725586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10805225372314453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([665, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10837507247924805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10837507247924805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 665, 128]), torch.Size([1, 665, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1090092658996582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11852216720581055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 665, 128])
m.shape torch.Size([610, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11907768249511719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11907768249511719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 610, 128]), torch.Size([1, 610, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.119659423828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13280677795410156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 610, 128])
m.shape torch.Size([571, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1336050033569336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1336050033569336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13414955139160156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15032100677490234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([599, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15147686004638672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15147686004638672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15204811096191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17331361770629883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([553, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17461013793945312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17461013793945312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 553, 128]), torch.Size([1, 553, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17513751983642578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19858646392822266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 553, 128])
m.shape torch.Size([561, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20023584365844727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20023584365844727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 561, 128]), torch.Size([1, 561, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20077085494995117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2281661033630371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 561, 128])
m.shape torch.Size([502, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2298135757446289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2298135757446289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23029232025146484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2575807571411133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([505, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2595086097717285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2595086097717285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.25999021530151367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.29081296920776367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([11257, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3442497253417969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3442497253417969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 11257, 128]), torch.Size([1, 11257, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35498523712158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1174602508544922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 11257, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0550260543823242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0707387924194336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.086451530456543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0706157684326172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([16476, 256])
first layer input nodes number: 45850
first layer output nodes number: 16476
edges number: 137468
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0867953300476074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1025080680847168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1065607070922852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1065607070922852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([395, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1328082084655762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1328082084655762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.133561611175537  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1403403282165527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([295, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.140531063079834  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.140531063079834  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1410937309265137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1503815650939941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([243, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.150801181793213  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.150801181793213  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1512646675109863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.161461353302002  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([184, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1619372367858887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1619372367858887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1622881889343262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1724658012390137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1731700897216797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1731700897216797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1735191345214844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1860847473144531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.186631202697754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.186631202697754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1868696212768555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1971216201782227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([105, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.197709083557129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.197709083557129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1979093551635742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2079229354858398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([86, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.208484172821045  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.208484172821045  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2086482048034668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2179980278015137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2186083793640137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2186083793640137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2187609672546387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2285265922546387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.229248046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.229248046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2294063568115234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2406463623046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.241117000579834  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.241117000579834  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2412161827087402  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2489523887634277  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2497334480285645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2497334480285645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.249870777130127  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2615437507629395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.262125015258789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.262125015258789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2622241973876953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2713489532470703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2718377113342285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2718377113342285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.271914005279541  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2794671058654785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2801213264465332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2801213264465332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2802128791809082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2899174690246582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2905945777893066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2905945777893066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2906842231750488  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.300814151763916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3014721870422363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3014721870422363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3015542030334473  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3113961219787598  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3119783401489258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3119783401489258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.312047004699707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3207674026489258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3212995529174805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3212995529174805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3213586807250977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3292818069458008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3299059867858887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3299059867858887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3299708366394043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3391146659851074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3396272659301758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3396272659301758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3396787643432617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3473005294799805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3475708961486816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3475708961486816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.347597599029541  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3517365455627441  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3520550727844238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3520550727844238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.352083683013916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3567185401916504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.357027530670166  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.357027530670166  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3570542335510254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3615670204162598  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([454, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3733134269714355  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3733134269714355  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3741793632507324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5341296195983887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 454, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5107121467590332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5111231803894043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5115342140197754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5111021995544434  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2758, 40])
input nodes number: 16476
output nodes number: 2758
edges number: 26786
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5112462043762207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.511246681213379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03679084777832031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 27 input nodes size: 37442
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.033399105072021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.033399105072021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05125284194946289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05127382278442383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02938985824584961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03071451187133789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03071451187133789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03071451187133789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([37442, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03071451187133789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([463, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1009831428527832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1009831428527832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1014246940612793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10495710372924805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([528, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1052398681640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1052398681640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.105743408203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1139669418334961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([528, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1144704818725586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1144704818725586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1149740219116211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1266317367553711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([451, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12724018096923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12724018096923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1276702880859375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14014339447021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([406, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14089632034301758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14089632034301758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 406, 128]), torch.Size([1, 406, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14128351211547852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15522241592407227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 406, 128])
m.shape torch.Size([450, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15631628036499023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15631628036499023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 450, 128]), torch.Size([1, 450, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15674543380737305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17519903182983398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 450, 128])
m.shape torch.Size([445, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1764698028564453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1764698028564453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 445, 128]), torch.Size([1, 445, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1768941879272461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19811344146728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 445, 128])
m.shape torch.Size([398, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19941949844360352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19941949844360352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 398, 128]), torch.Size([1, 398, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1997990608215332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2214341163635254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 398, 128])
m.shape torch.Size([428, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.22308111190795898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.22308111190795898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.22348928451538086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24961233139038086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([12328, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.30819272994995117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.30819272994995117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12328, 128]), torch.Size([1, 12328, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32060813903808594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1553478240966797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12328, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0886263847351074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.10429048538208  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1199545860290527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1041679382324219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([16425, 256])
first layer input nodes number: 37442
first layer output nodes number: 16425
edges number: 143068
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1202359199523926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1359000205993652  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1398162841796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1398162841796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([288, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1736760139465332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1736760139465332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1742253303527832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1809544563293457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([251, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1811623573303223  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1811623573303223  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1816411018371582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1888222694396973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([209, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.189185619354248  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.189185619354248  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1895842552185059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1983542442321777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([146, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.198716640472412  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.198716640472412  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1989951133728027  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2070708274841309  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([114, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.207479476928711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.207479476928711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2076969146728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.215524673461914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([119, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2161026000976562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2161026000976562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.216329574584961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2260894775390625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.226588249206543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.226588249206543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.226761817932129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2354402542114258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.235853672027588  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.235853672027588  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2359776496887207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.243044376373291  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2436747550964355  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2436747550964355  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2438273429870605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2535929679870605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2540841102600098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2540841102600098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2541966438293457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2621865272521973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.262796401977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.262796401977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2629165649414062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2722892761230469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2729673385620117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2729673385620117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2730894088745117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2834653854370117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2840042114257812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2840042114257812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2840957641601562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2925186157226562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2930784225463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2930784225463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2931642532348633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.301661491394043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3020944595336914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3020944595336914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3021574020385742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3088293075561523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3093209266662598  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3093209266662598  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3093857765197754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.316713809967041  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3173027038574219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3173027038574219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3173751831054688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3260726928710938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3265728950500488  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3265728950500488  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.326632022857666  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3341412544250488  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3346595764160156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3346595764160156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.334716796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3423843383789062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.342951774597168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.342951774597168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3430109024047852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3513479232788086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3520450592041016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3520450592041016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3521137237548828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3622760772705078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3627071380615234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3627071380615234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3627490997314453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.369253158569336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3697409629821777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3697409629821777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3697848320007324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3768916130065918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3775620460510254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3775620460510254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3776192665100098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3872895240783691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([808, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4069428443908691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4069428443908691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4084839820861816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6926608085632324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 808, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6612486839294434  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6616597175598145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6620707511901855  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6616387367248535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2758, 40])
input nodes number: 16425
output nodes number: 2758
edges number: 34589
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6617822647094727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6617827415466309  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.032976627349853516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 28 input nodes size: 49370
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02938985824584961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02938985824584961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05293130874633789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05295276641845703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03507804870605469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03644084930419922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03644084930419922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03644084930419922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([49370, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03644084930419922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([582, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11139678955078125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11139678955078125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11195182800292969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11738204956054688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([723, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11779403686523438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11779403686523438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 723, 128]), torch.Size([1, 723, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1184835433959961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12882614135742188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 723, 128])
m.shape torch.Size([626, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12937688827514648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12937688827514648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1299738883972168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1438136100769043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([607, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14467287063598633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14467287063598633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 607, 128]), torch.Size([1, 607, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14525175094604492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16275835037231445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 607, 128])
m.shape torch.Size([637, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1639876365661621  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1639876365661621  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 637, 128]), torch.Size([1, 637, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1645951271057129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18646478652954102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 637, 128])
m.shape torch.Size([577, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18781185150146484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18781185150146484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18836212158203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2128901481628418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([586, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2145709991455078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2145709991455078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.21512985229492188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24341487884521484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([527, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2451457977294922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2451457977294922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24564838409423828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2748603820800781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([605, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2772054672241211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2772054672241211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2777824401855469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3147087097167969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([12605, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3745255470275879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3745255470275879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12605, 128]), torch.Size([1, 12605, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3871331214904785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.240628719329834  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1700348854064941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.187272548675537  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.20451021194458  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1871376037597656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([18075, 256])
first layer input nodes number: 49370
first layer output nodes number: 18075
edges number: 152794
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2048802375793457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2221179008483887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2270197868347168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2270197868347168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([319, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2569713592529297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2569713592529297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2575798034667969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2628421783447266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([323, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2631592750549316  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2631592750549316  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.26377534866333  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.273714542388916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([221, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2740440368652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2740440368652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.274465560913086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2837390899658203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([192, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.284266471862793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.284266471862793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.284632682800293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.295252799987793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([161, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2958436012268066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2958436012268066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2961506843566895  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3072056770324707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([126, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3077788352966309  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3077788352966309  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3080191612243652  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3183531761169434  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([101, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3189129829406738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3189129829406738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.319105625152588  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.328737735748291  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3293566703796387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3293566703796387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3295340538024902  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3396449089050293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.340230941772461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.340230941772461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3403797149658203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3499011993408203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3505096435546875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3505096435546875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3506450653076172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.360260009765625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3609962463378906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3609962463378906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3611412048339844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3724479675292969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3730101585388184  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3730101585388184  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.373115062713623  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3820319175720215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.382704257965088  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.382704257965088  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.382814884185791  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3929924964904785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3935565948486328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3935565948486328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3936443328857422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4023303985595703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4029788970947266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4029788970947266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4030704498291016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4127750396728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4134521484375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4134521484375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4135417938232422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4236717224121094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4242644309997559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4242644309997559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4243388175964355  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.433265209197998  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4340415000915527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4340415000915527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.434131145477295  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4455161094665527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4461655616760254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4461655616760254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4462380409240723  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4559502601623535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.456606388092041  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.456606388092041  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4566750526428223  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4663567543029785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4672107696533203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4672107696533203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.467294692993164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.479715347290039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4802446365356445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4802446365356445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4802961349487305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4882783889770508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4889602661132812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4889602661132812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4890213012695312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4989089965820312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4995017051696777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4995017051696777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.4995532035827637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.508256435394287  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([520, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5207257270812988  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5207257270812988  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5217175483703613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6986727714538574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 520, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.671504020690918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6719250679016113  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6723461151123047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6719036102294922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2825, 40])
input nodes number: 18075
output nodes number: 2825
edges number: 30039
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.672070026397705  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6720705032348633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.038843631744384766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 29 input nodes size: 41326
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03508806228637695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03508806228637695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0547938346862793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.054814815521240234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03125190734863281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.032543182373046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.032543182373046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.032543182373046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([41326, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.032543182373046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([511, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10154485702514648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10154485702514648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 511, 128]), torch.Size([1, 511, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10203218460083008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10593080520629883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 511, 128])
m.shape torch.Size([582, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10624217987060547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10624217987060547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1067972183227539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1159520149230957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([535, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1164398193359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1164398193359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11695003509521484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12822246551513672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([512, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12894392013549805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12894392013549805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12943220138549805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14359235763549805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([535, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1446237564086914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1446237564086914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14513397216796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16365289688110352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([476, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16475963592529297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16475963592529297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 476, 128]), torch.Size([1, 476, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16521358489990234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18473339080810547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 476, 128])
m.shape torch.Size([516, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18622875213623047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18622875213623047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 516, 128]), torch.Size([1, 516, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1867208480834961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.21194744110107422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 516, 128])
m.shape torch.Size([508, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2136392593383789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2136392593383789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 508, 128]), torch.Size([1, 508, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.21412372589111328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24173831939697266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 508, 128])
m.shape torch.Size([520, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2437276840209961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2437276840209961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24422359466552734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2773466110229492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([11748, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3331174850463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3331174850463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 11748, 128]), torch.Size([1, 11748, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3452005386352539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1406679153442383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 11748, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.075991153717041  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.091672420501709  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.107353687286377  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0915498733520508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([16443, 256])
first layer input nodes number: 41326
first layer output nodes number: 16443
edges number: 140695
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.107663631439209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.123344898223877  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1277661323547363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1277661323547363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([318, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1594185829162598  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1594185829162598  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1600251197814941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1651768684387207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([271, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1653947830200195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1653947830200195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1659116744995117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1756391525268555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([210, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1759862899780273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1759862899780273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.176386833190918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1851987838745117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([154, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1855907440185547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1855907440185547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1858844757080078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1944026947021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([152, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.194986343383789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.194986343383789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1952762603759766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2057132720947266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([108, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2061915397644043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2061915397644043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.206397533416748  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2152552604675293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([99, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2158184051513672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2158184051513672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2160072326660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2254486083984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([72, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.225907802581787  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.225907802581787  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2260451316833496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.233872890472412  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2344880104064941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2344880104064941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2346386909484863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2442822456359863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2448415756225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2448415756225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2449674606323242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2539052963256836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.25445556640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.25445556640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2545661926269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2631950378417969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2639126777648926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2639126777648926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.264040470123291  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2749028205871582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2754015922546387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2754015922546387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2754874229431152  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.283383846282959  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.283933162689209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.283933162689209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2840170860290527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.292325496673584  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.292773723602295  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.292773723602295  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2928385734558105  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2997126579284668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.300157070159912  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.300157070159912  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3002161979675293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3068976402282715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.307309627532959  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.307309627532959  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.307361125946045  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3135409355163574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3142075538635254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3142075538635254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.314283847808838  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3239731788635254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3245744705200195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3245744705200195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.324641227722168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3335866928100586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3340535163879395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3340535163879395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3341031074523926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3410954475402832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.341555118560791  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.341555118560791  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3416008949279785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3483757972717285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.348881721496582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.348881721496582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3489294052124023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3563203811645508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.356672763824463  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.356672763824463  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3567051887512207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3619580268859863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.362565040588379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.362565040588379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3626165390014648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3713197708129883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([729, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.388810634613037  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.388810634613037  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 729, 256]), torch.Size([1, 729, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3902010917663574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6398959159851074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 729, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6108741760253906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6112852096557617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6116962432861328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6112642288208008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2758, 40])
input nodes number: 16443
output nodes number: 2758
edges number: 32485
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6113977432250977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6113982200622559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0347743034362793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 30 input nodes size: 44472
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.031241893768310547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.031241893768310547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05272626876831055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05274772644042969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03429698944091797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03429698944091797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03429698944091797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([44472, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03429698944091797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([652, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10326528549194336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10326528549194336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 652, 128]), torch.Size([1, 652, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10388708114624023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10900688171386719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 652, 128])
m.shape torch.Size([709, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10937213897705078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10937213897705078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 709, 128]), torch.Size([1, 709, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11004829406738281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12019062042236328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 709, 128])
m.shape torch.Size([697, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.120849609375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.120849609375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12151432037353516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13688230514526367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([657, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1378030776977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1378030776977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 657, 128]), torch.Size([1, 657, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1384296417236328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15713024139404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 657, 128])
m.shape torch.Size([605, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15865755081176758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15865755081176758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 605, 128]), torch.Size([1, 605, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15923452377319336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18062925338745117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 605, 128])
m.shape torch.Size([545, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1819000244140625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1819000244140625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1824197769165039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2050924301147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([532, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20660829544067383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20660829544067383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20711565017700195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23337221145629883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([566, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23527765274047852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23527765274047852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23581743240356445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.26709604263305664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([499, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2689676284790039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2689676284790039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 499, 128]), torch.Size([1, 499, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2694435119628906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2999000549316406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 499, 128])
m.shape torch.Size([11462, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35434961318969727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35434961318969727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 11462, 128]), torch.Size([1, 11462, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3652806282043457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1414799690246582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 11462, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0767579078674316  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.092897891998291  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1090378761291504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0927715301513672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([16924, 256])
first layer input nodes number: 44472
first layer output nodes number: 16924
edges number: 140447
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1093711853027344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1255111694335938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.129946231842041  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.129946231842041  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([364, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1599459648132324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1599459648132324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1606402397155762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1667389869689941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([311, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.166989803314209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.166989803314209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1675829887390137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1787667274475098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([239, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1791596412658691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1791596412658691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1796154975891113  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1896443367004395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([171, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1900739669799805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1900739669799805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1904001235961914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1998586654663086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([151, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2004213333129883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2004213333129883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.200709342956543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2110776901245117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([116, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2116026878356934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2116026878356934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2118239402770996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2213377952575684  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([86, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2218060493469238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2218060493469238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2219700813293457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2301716804504395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2308125495910645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2308125495910645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2309918403625488  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2412114143371582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([69, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2417187690734863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2417187690734863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2418503761291504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2502732276916504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2509188652038574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2509188652038574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2510600090026855  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2610812187194824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2615604400634766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2615604400634766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2616596221923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2693958282470703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2700037956237793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2700037956237793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2701125144958496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2793536186218262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2799115180969238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2799115180969238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2800049781799316  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2886033058166504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2891759872436523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2891759872436523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2892637252807617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2979497909545898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.298482894897461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.298482894897461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2985591888427734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3066463470458984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3073005676269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3073005676269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3073863983154297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3170852661132812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3176469802856445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3176469802856445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3177175521850586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.326186180114746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3269295692443848  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3269295692443848  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3270153999328613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3379158973693848  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3383665084838867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3383665084838867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3384180068969727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3453187942504883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3458123207092285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3458123207092285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3458638191223145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3531250953674316  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3538260459899902  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3538260459899902  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3538947105407715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3640570640563965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.364445686340332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.364445686340332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3644838333129883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.370396614074707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3707976341247559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3707976341247559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3708338737487793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3767046928405762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3771018981933594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3771018981933594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.37713623046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3829383850097656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([627, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.397986888885498  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.397986888885498  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3991827964782715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.6141314506530762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 627, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5868558883666992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5872764587402344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5876970291137695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5872550010681152  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2820, 40])
input nodes number: 16924
output nodes number: 2820
edges number: 30642
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5874123573303223  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.5874128341674805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.036554813385009766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 31 input nodes size: 46188
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03303050994873047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03303050994873047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.055054664611816406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.055075645446777344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0335698127746582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03466939926147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03466939926147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03466939926147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([46188, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03466939926147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([716, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0954289436340332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0954289436340332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 716, 128]), torch.Size([1, 716, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09611177444458008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1024770736694336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 716, 128])
m.shape torch.Size([795, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10289382934570312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10289382934570312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1036520004272461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11502456665039062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([741, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11570549011230469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11570549011230469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 741, 128]), torch.Size([1, 741, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11641216278076172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1326460838317871  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 741, 128])
m.shape torch.Size([661, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13355350494384766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13355350494384766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 661, 128]), torch.Size([1, 661, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1341838836669922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1524648666381836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 661, 128])
m.shape torch.Size([656, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15390634536743164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15390634536743164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15453195571899414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17767000198364258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([599, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17907094955444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17907094955444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1796422004699707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20420598983764648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([547, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20574617385864258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20574617385864258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2062678337097168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2328205108642578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([565, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23471498489379883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23471498489379883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 565, 128]), torch.Size([1, 565, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23525381088256836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.26660776138305664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 565, 128])
m.shape torch.Size([505, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2685055732727051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2685055732727051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.26898717880249023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.29980993270874023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([9661, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.34644412994384766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.34644412994384766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 9661, 128]), torch.Size([1, 9661, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35565757751464844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.009812355041504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 9661, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.9536614418029785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.9683918952941895  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.9831223487854004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.9682765007019043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([15446, 256])
first layer input nodes number: 46188
first layer output nodes number: 15446
edges number: 123551
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.9834685325622559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.9981989860534668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0028057098388672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0028057098388672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0262727737426758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0262727737426758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0270929336547852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0336542129516602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0339784622192383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0339784622192383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0347070693969727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.046065330505371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0465202331542969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0465202331542969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0470619201660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0591678619384766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([195, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0596470832824707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0596470832824707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0600190162658691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0708050727844238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0714988708496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0714988708496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.071847915649414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0844135284423828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.085115909576416  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.085115909576416  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.0854058265686035  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.097872257232666  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.098447322845459  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.098447322845459  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.09865140914917  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1088557243347168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1094226837158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1094226837158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.109588623046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1190471649169922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.119596004486084  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.119596004486084  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1197352409362793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1286463737487793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1293363571166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1293363571166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1294870376586914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1401853561401367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.14080810546875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.14080810546875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1409339904785156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1507530212402344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.151163101196289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.151163101196289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1512413024902344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.157888412475586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1584243774414062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1584243774414062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1585121154785156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1665840148925781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1669979095458984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1669979095458984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.167062759399414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.173482894897461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1740994453430176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1740994453430176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1741852760314941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1832833290100098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1836557388305664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1836557388305664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1837072372436523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1895265579223633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1900238990783691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1900238990783691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1900849342346191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1974091529846191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1977767944335938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1977767944335938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.1978206634521484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2033920288085938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.203826904296875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.203826904296875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2038745880126953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2102642059326172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2107982635498047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2107982635498047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2108535766601562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2186527252197266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2190289497375488  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2190289497375488  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.219067096710205  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.22471284866333  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2250747680664062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2250747680664062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2251091003417969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2304306030273438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes
[05:36:06] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28452268 edges into 32 parts and get 8844544 edge cuts

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2307672500610352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2307672500610352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2307977676391602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2357416152954102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.235957145690918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.235957145690918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.235976219177246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2391996383666992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([379, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2482972145080566  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2482972145080566  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.2490200996398926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3817811012268066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 379, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.361250877380371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3616657257080078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3620805740356445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3616447448730469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2783, 40])
input nodes number: 15446
output nodes number: 2783
edges number: 23856
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3617753982543945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 1.3617758750915527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03666353225708008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03666353225708008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03666353225708008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007829278707504272 |0.0017526820302009583 |0.11663312464952469 |8.492916822433472e-05 |0.07456590980291367 |0.004827260971069336 |
----------------------------------------------------------pseudo_mini_loss sum 4.880469799041748
Total (block generation + training)time/epoch 29.292149543762207
Training time/epoch 6.59876275062561
Training time without block to device /epoch 6.54267692565918
Training time without total dataloading part /epoch 6.125914096832275
load block tensor time/epoch 0.2505369186401367
block to device time/epoch 0.056085824966430664
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1122329
Number of first layer input nodes during this epoch:  802685
Number of first layer output nodes during this epoch:  319644
----------------------------------------before generate dataloader block 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.036663055419921875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.023184776306152344
global_2_local spend time (sec) 0.05143928527832031
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004616737365722656
A = g.adjacency_matrix() spent  0.01587200164794922
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08513689041137695
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3113420009613037
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.173302412033081

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096})
Convert a graph into a bidirected graph: 1.188 seconds
Metis partitioning: 5.756 seconds
Split the graph: 0.616 seconds
Construct subgraphs: 0.094 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.668355703353882
2895
2901
2783
2927
2891
2899
2838
2884
2847
2876
2924
2913
2848
2921
2760
2927
2762
2778
2858
2769
2760
2758
2758
2853
2867
2894
2852
2792
2786
2863
2765
2792
total k batches seeds list generation spend  18.502383708953857
after graph partition
graph partition algorithm spend time 18.592772483825684
2895
2901
2783
2927
2891
2899
2838
2884
2847
2876
2924
2913
2848
2921
2760
2927
2762
2778
2858
2769
2760
2758
2758
2853
2867
2894
2852
2792
2786
2863
2765
2792
partition_len_list
[7534, 5306, 7032, 7531, 5912, 6932, 5525, 5267, 6529, 5886, 6193, 6675, 7275, 7203, 7869, 7872, 15518, 16966, 19537, 15908, 16230, 16536, 19219, 17378, 7750, 9116, 6653, 8974, 10550, 7319, 12095, 12074]
shared_neighbor_graph_partition_s0 selection method  spend 18.702775716781616
time for parepare:  0.018220901489257812
local_output_nid generation:  0.0008351802825927734
local_in_edges_tensor generation:  0.0010042190551757812
mini_batch_src_global generation:  0.0011284351348876953
r_  generation:  0.007031917572021484
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.000827789306640625
mini_batch_src_global generation:  0.0008528232574462891
r_  generation:  0.0058405399322509766
local_output_nid generation:  0.0007851123809814453
local_in_edges_tensor generation:  0.0007481575012207031
mini_batch_src_global generation:  0.0006651878356933594
r_  generation:  0.005585670471191406
local_output_nid generation:  0.0008215904235839844
local_in_edges_tensor generation:  0.0007917881011962891
mini_batch_src_global generation:  0.0008575916290283203
r_  generation:  0.007290840148925781
local_output_nid generation:  0.000843048095703125
local_in_edges_tensor generation:  0.0007295608520507812
mini_batch_src_global generation:  0.0007078647613525391
r_  generation:  0.006264209747314453
local_output_nid generation:  0.0008628368377685547
local_in_edges_tensor generation:  0.0007472038269042969
mini_batch_src_global generation:  0.0007457733154296875
r_  generation:  0.006948947906494141
local_output_nid generation:  0.0008521080017089844
local_in_edges_tensor generation:  0.0006954669952392578
mini_batch_src_global generation:  0.0006132125854492188
r_  generation:  0.005171298980712891
local_output_nid generation:  0.0008606910705566406
local_in_edges_tensor generation:  0.0006906986236572266
mini_batch_src_global generation:  0.0005216598510742188
r_  generation:  0.004888296127319336
local_output_nid generation:  0.00084686279296875
local_in_edges_tensor generation:  0.0007166862487792969
mini_batch_src_global generation:  0.0007376670837402344
r_  generation:  0.006925344467163086
local_output_nid generation:  0.0008645057678222656
local_in_edges_tensor generation:  0.0007085800170898438
mini_batch_src_global generation:  0.0007236003875732422
r_  generation:  0.00664210319519043
local_output_nid generation:  0.0008525848388671875
local_in_edges_tensor generation:  0.0007381439208984375
mini_batch_src_global generation:  0.0008275508880615234
r_  generation:  0.00757145881652832
local_output_nid generation:  0.0008561611175537109
local_in_edges_tensor generation:  0.0008058547973632812
mini_batch_src_global generation:  0.0008151531219482422
r_  generation:  0.00724339485168457
local_output_nid generation:  0.0008661746978759766
local_in_edges_tensor generation:  0.0007805824279785156
mini_batch_src_global generation:  0.0007781982421875
r_  generation:  0.0068705081939697266
local_output_nid generation:  0.0008833408355712891
local_in_edges_tensor generation:  0.000774383544921875
mini_batch_src_global generation:  0.0007190704345703125
r_  generation:  0.006467103958129883
local_output_nid generation:  0.0008265972137451172
local_in_edges_tensor generation:  0.0006678104400634766
mini_batch_src_global generation:  0.0006690025329589844
r_  generation:  0.005798816680908203
local_output_nid generation:  0.0009000301361083984
local_in_edges_tensor generation:  0.0007719993591308594
mini_batch_src_global generation:  0.0008213520050048828
r_  generation:  0.007933378219604492
local_output_nid generation:  0.0008361339569091797
local_in_edges_tensor generation:  0.0007462501525878906
mini_batch_src_global generation:  0.001146554946899414
r_  generation:  0.009025096893310547
local_output_nid generation:  0.0008776187896728516
local_in_edges_tensor generation:  0.0007390975952148438
mini_batch_src_global generation:  0.0011553764343261719
r_  generation:  0.008745670318603516
local_output_nid generation:  0.0009317398071289062
local_in_edges_tensor generation:  0.0010371208190917969
mini_batch_src_global generation:  0.0012733936309814453
r_  generation:  0.011360406875610352
local_output_nid generation:  0.0009486675262451172
local_in_edges_tensor generation:  0.0007796287536621094
mini_batch_src_global generation:  0.0011670589447021484
r_  generation:  0.0087890625
local_output_nid generation:  0.0009558200836181641
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  0.0010023117065429688
r_  generation:  0.008310556411743164
local_output_nid generation:  0.0009493827819824219
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.0010693073272705078
r_  generation:  0.009070396423339844
local_output_nid generation:  0.0009310245513916016
local_in_edges_tensor generation:  0.00098419189453125
mini_batch_src_global generation:  0.0011179447174072266
r_  generation:  0.010919570922851562
local_output_nid generation:  0.0010144710540771484
local_in_edges_tensor generation:  0.0009315013885498047
mini_batch_src_global generation:  0.0011425018310546875
r_  generation:  0.012301206588745117
local_output_nid generation:  0.001028299331665039
local_in_edges_tensor generation:  0.0007331371307373047
mini_batch_src_global generation:  0.0008935928344726562
r_  generation:  0.00592041015625
local_output_nid generation:  0.0010483264923095703
local_in_edges_tensor generation:  0.0007662773132324219
mini_batch_src_global generation:  0.0007948875427246094
r_  generation:  0.006516933441162109
local_output_nid generation:  0.0009639263153076172
local_in_edges_tensor generation:  0.0007290840148925781
mini_batch_src_global generation:  0.0006515979766845703
r_  generation:  0.005529642105102539
local_output_nid generation:  0.0009319782257080078
local_in_edges_tensor generation:  0.0006985664367675781
mini_batch_src_global generation:  0.0006911754608154297
r_  generation:  0.006052970886230469
local_output_nid generation:  0.0009200572967529297
local_in_edges_tensor generation:  0.0006875991821289062
mini_batch_src_global generation:  0.0006985664367675781
r_  generation:  0.0055904388427734375
local_output_nid generation:  0.0009336471557617188
local_in_edges_tensor generation:  0.0006799697875976562
mini_batch_src_global generation:  0.0006403923034667969
r_  generation:  0.005898952484130859
local_output_nid generation:  0.0008742809295654297
local_in_edges_tensor generation:  0.0006747245788574219
mini_batch_src_global generation:  0.000698089599609375
r_  generation:  0.005924701690673828
local_output_nid generation:  0.0008738040924072266
local_in_edges_tensor generation:  0.0007903575897216797
mini_batch_src_global generation:  0.0008280277252197266
r_  generation:  0.007374763488769531
----------------------check_connections_block total spend ----------------------------- 0.4004642963409424
generate_one_block  0.01759624481201172
generate_one_block  0.009365081787109375
generate_one_block  0.008844137191772461
generate_one_block  0.011496543884277344
generate_one_block  0.009146928787231445
generate_one_block  0.010140419006347656
generate_one_block  0.007436513900756836
generate_one_block  0.007103443145751953
generate_one_block  0.010242223739624023
generate_one_block  0.00953817367553711
generate_one_block  0.011048316955566406
generate_one_block  0.010448694229125977
generate_one_block  0.014734745025634766
generate_one_block  0.009777307510375977
generate_one_block  0.008971691131591797
generate_one_block  0.011820793151855469
generate_one_block  0.021292924880981445
generate_one_block  0.015080928802490234
generate_one_block  0.01738882064819336
generate_one_block  0.014115571975708008
generate_one_block  0.01426839828491211
generate_one_block  0.01428842544555664
generate_one_block  0.01579904556274414
generate_one_block  0.019387006759643555
generate_one_block  0.00932931900024414
generate_one_block  0.010252952575683594
generate_one_block  0.008021831512451172
generate_one_block  0.009173393249511719
generate_one_block  0.008644819259643555
generate_one_block  0.0084381103515625
generate_one_block  0.009570121765136719
generate_one_block  0.010976552963256836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039498090744018555
gen group dst list time:  0.009714365005493164
time for parepare:  0.020732879638671875
local_output_nid generation:  0.0020618438720703125
local_in_edges_tensor generation:  0.005380392074584961
mini_batch_src_global generation:  0.0017175674438476562
r_  generation:  0.017753124237060547
local_output_nid generation:  0.0017192363739013672
local_in_edges_tensor generation:  0.0015821456909179688
mini_batch_src_global generation:  0.001371622085571289
r_  generation:  0.00943756103515625
local_output_nid generation:  0.0021529197692871094
local_in_edges_tensor generation:  0.0017769336700439453
mini_batch_src_global generation:  0.0011353492736816406
r_  generation:  0.015524625778198242
local_output_nid generation:  0.002221345901489258
local_in_edges_tensor generation:  0.002447366714477539
mini_batch_src_global generation:  0.0016078948974609375
r_  generation:  0.018009185791015625
local_output_nid generation:  0.001779794692993164
local_in_edges_tensor generation:  0.0014700889587402344
mini_batch_src_global generation:  0.0011527538299560547
r_  generation:  0.012798309326171875
local_output_nid generation:  0.0020644664764404297
local_in_edges_tensor generation:  0.0016052722930908203
mini_batch_src_global generation:  0.0011320114135742188
r_  generation:  0.015871763229370117
local_output_nid generation:  0.0016925334930419922
local_in_edges_tensor generation:  0.001260995864868164
mini_batch_src_global generation:  0.0012040138244628906
r_  generation:  0.009834766387939453
local_output_nid generation:  0.0015473365783691406
local_in_edges_tensor generation:  0.0011866092681884766
mini_batch_src_global generation:  0.0009660720825195312
r_  generation:  0.008852720260620117
local_output_nid generation:  0.0019347667694091797
local_in_edges_tensor generation:  0.0016522407531738281
mini_batch_src_global generation:  0.0011458396911621094
r_  generation:  0.015419721603393555
local_output_nid generation:  0.001676797866821289
local_in_edges_tensor generation:  0.0013461112976074219
mini_batch_src_global generation:  0.0010805130004882812
r_  generation:  0.012939453125
local_output_nid generation:  0.0017614364624023438
local_in_edges_tensor generation:  0.0014259815216064453
mini_batch_src_global generation:  0.0011970996856689453
r_  generation:  0.015163421630859375
local_output_nid generation:  0.001968860626220703
local_in_edges_tensor generation:  0.0015316009521484375
mini_batch_src_global generation:  0.0013644695281982422
r_  generation:  0.0159757137298584
local_output_nid generation:  0.002132892608642578
local_in_edges_tensor generation:  0.0017397403717041016
mini_batch_src_global generation:  0.0015208721160888672
r_  generation:  0.016993999481201172
local_output_nid generation:  0.0019276142120361328
local_in_edges_tensor generation:  0.0018181800842285156
mini_batch_src_global generation:  0.0013065338134765625
r_  generation:  0.01582646369934082
local_output_nid generation:  0.002198457717895508
local_in_edges_tensor generation:  0.0018935203552246094
mini_batch_src_global generation:  0.0013463497161865234
r_  generation:  0.01761651039123535
local_output_nid generation:  0.0021131038665771484
local_in_edges_tensor generation:  0.0020666122436523438
mini_batch_src_global generation:  0.0016617774963378906
r_  generation:  0.019325971603393555
local_output_nid generation:  0.00432133674621582
local_in_edges_tensor generation:  0.0045430660247802734
mini_batch_src_global generation:  0.004395246505737305
r_  generation:  0.04371786117553711
local_output_nid generation:  0.004771709442138672
local_in_edges_tensor generation:  0.0058596134185791016
mini_batch_src_global generation:  0.0057086944580078125
r_  generation:  0.05296063423156738
local_output_nid generation:  0.005443096160888672
local_in_edges_tensor generation:  0.009255647659301758
mini_batch_src_global generation:  0.0067768096923828125
r_  generation:  0.0626671314239502
local_output_nid generation:  0.004903554916381836
local_in_edges_tensor generation:  0.004744052886962891
mini_batch_src_global generation:  0.0054056644439697266
r_  generation:  0.049299001693725586
local_output_nid generation:  0.005020618438720703
local_in_edges_tensor generation:  0.005164384841918945
mini_batch_src_global generation:  0.005004167556762695
r_  generation:  0.04765009880065918
local_output_nid generation:  0.004866600036621094
local_in_edges_tensor generation:  0.00457000732421875
mini_batch_src_global generation:  0.005291938781738281
r_  generation:  0.048459529876708984
local_output_nid generation:  0.005464076995849609
local_in_edges_tensor generation:  0.004690647125244141
mini_batch_src_global generation:  0.006569623947143555
r_  generation:  0.06004834175109863
local_output_nid generation:  0.005078315734863281
local_in_edges_tensor generation:  0.004526853561401367
mini_batch_src_global generation:  0.006003141403198242
r_  generation:  0.05242419242858887
local_output_nid generation:  0.0026092529296875
local_in_edges_tensor generation:  0.0021500587463378906
mini_batch_src_global generation:  0.0031936168670654297
r_  generation:  0.01840996742248535
local_output_nid generation:  0.0029168128967285156
local_in_edges_tensor generation:  0.0023097991943359375
mini_batch_src_global generation:  0.0018105506896972656
r_  generation:  0.022350549697875977
local_output_nid generation:  0.0021321773529052734
local_in_edges_tensor generation:  0.0018024444580078125
mini_batch_src_global generation:  0.0014522075653076172
r_  generation:  0.014656543731689453
local_output_nid generation:  0.0026798248291015625
local_in_edges_tensor generation:  0.002294778823852539
mini_batch_src_global generation:  0.0015332698822021484
r_  generation:  0.021832704544067383
local_output_nid generation:  0.003100156784057617
local_in_edges_tensor generation:  0.0024738311767578125
mini_batch_src_global generation:  0.0021703243255615234
r_  generation:  0.0268557071685791
local_output_nid generation:  0.0022482872009277344
local_in_edges_tensor generation:  0.0017948150634765625
mini_batch_src_global generation:  0.0016226768493652344
r_  generation:  0.016585111618041992
local_output_nid generation:  0.0035490989685058594
local_in_edges_tensor generation:  0.003055572509765625
mini_batch_src_global generation:  0.0023522377014160156
r_  generation:  0.03172636032104492
local_output_nid generation:  0.003487110137939453
local_in_edges_tensor generation:  0.002958059310913086
mini_batch_src_global generation:  0.0034720897674560547
r_  generation:  0.036995887756347656
----------------------check_connections_block total spend ----------------------------- 1.3337395191192627
generate_one_block  0.02397894859313965
generate_one_block  0.02239227294921875
generate_one_block  0.020671844482421875
generate_one_block  0.025861024856567383
generate_one_block  0.016582250595092773
generate_one_block  0.021207571029663086
generate_one_block  0.014217615127563477
generate_one_block  0.011719703674316406
generate_one_block  0.01941704750061035
generate_one_block  0.017254114151000977
generate_one_block  0.020119905471801758
generate_one_block  0.02129983901977539
generate_one_block  0.022924423217773438
generate_one_block  0.020688772201538086
generate_one_block  0.023510456085205078
generate_one_block  0.02646613121032715
generate_one_block  0.06326079368591309
generate_one_block  0.06713438034057617
generate_one_block  0.0802149772644043
generate_one_block  0.0622859001159668
generate_one_block  0.0628671646118164
generate_one_block  0.06628537178039551
generate_one_block  0.08340096473693848
generate_one_block  0.07103133201599121
generate_one_block  0.024151325225830078
generate_one_block  0.02953481674194336
generate_one_block  0.019433975219726562
generate_one_block  0.028126239776611328
generate_one_block  0.03638124465942383
generate_one_block  0.021771907806396484
generate_one_block  0.04329705238342285
generate_one_block  0.04344511032104492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.036663055419921875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

connection checking time:  1.3337395191192627
block generation total time  1.130934476852417
average batch blocks generation time:  0.03534170240163803
block dataloader generation time/epoch 22.442161560058594
pseudo mini batch 0 input nodes size: 18006
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03356313705444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03356313705444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04214906692504883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04217100143432617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020125865936279297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020678997039794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020678997039794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020678997039794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([18006, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020678997039794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([599, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.045623779296875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.045623779296875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 599, 128]), torch.Size([1, 599, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.046195030212402344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05101776123046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 599, 128])
m.shape torch.Size([668, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05136919021606445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05136919021606445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 668, 128]), torch.Size([1, 668, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05200624465942383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06181478500366211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 668, 128])
m.shape torch.Size([635, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.062404632568359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.062404632568359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 635, 128]), torch.Size([1, 635, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06301021575927734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0764303207397461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 635, 128])
m.shape torch.Size([556, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07718801498413086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07718801498413086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 556, 128]), torch.Size([1, 556, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07771825790405273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09357213973999023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 556, 128])
m.shape torch.Size([480, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0944514274597168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0944514274597168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 480, 128]), torch.Size([1, 480, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0949091911315918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1113886833190918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 480, 128])
m.shape torch.Size([463, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11248445510864258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11248445510864258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 463, 128]), torch.Size([1, 463, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11292600631713867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1319127082824707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 463, 128])
m.shape torch.Size([377, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1329503059387207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1329503059387207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 377, 128]), torch.Size([1, 377, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13330984115600586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15128660202026367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 377, 128])
m.shape torch.Size([393, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15260601043701172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15260601043701172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 393, 128]), torch.Size([1, 393, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15298080444335938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17434406280517578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 393, 128])
m.shape torch.Size([333, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17558574676513672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17558574676513672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 333, 128]), torch.Size([1, 333, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1759033203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19622802734375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 333, 128])
m.shape torch.Size([3030, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.21051740646362305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.21051740646362305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 3030, 128]), torch.Size([1, 3030, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.21340703964233398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4252448081970215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 3030, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40254688262939453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4097318649291992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4169168472290039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40967559814453125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([7534, 256])
first layer input nodes number: 18006
first layer output nodes number: 7534
edges number: 50322
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41705322265625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4242382049560547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42643165588378906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42643165588378906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([388, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4505481719970703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4505481719970703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45128822326660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4578838348388672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([342, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45817136764526367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45817136764526367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45882368087768555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46860837936401367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4690871238708496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4690871238708496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4696192741394043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4824843406677246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.483187198638916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.483187198638916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48366785049438477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4976067543029785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4982795715332031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4982795715332031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4986419677734375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.511688232421875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5124011039733887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5124011039733887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5126967430114746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5254092216491699  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5262103080749512  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5262103080749512  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5264792442321777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5399260520935059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([151, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5409526824951172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5409526824951172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5412406921386719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5576572418212891  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5583438873291016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5583438873291016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5585269927978516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5702457427978516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([97, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5710868835449219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5710868835449219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5712718963623047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5844078063964844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([82, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5851826667785645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5851826667785645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5853390693664551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5975384712219238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5982680320739746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5982680320739746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5984015464782715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6097502708435059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6103835105895996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6103835105895996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6104903221130371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6203169822692871  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6209769248962402  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6209769248962402  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6210780143737793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6310858726501465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6317133903503418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6317133903503418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.631803035736084  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6413054466247559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6418914794921875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6418914794921875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6419696807861328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6508064270019531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6512575149536133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6512575149536133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6513147354125977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6581811904907227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6587238311767578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6587238311767578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6587867736816406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6667804718017578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6672968864440918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6672968864440918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6673541069030762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6750216484069824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6753392219543457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6753392219543457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6753735542297363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6802144050598145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6807022094726562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6807022094726562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6807498931884766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6878070831298828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6883964538574219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6883964538574219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6884517669677734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6970252990722656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6976609230041504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6976609230041504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6977181434631348  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7069878578186035  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7073979377746582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7073979377746582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7074341773986816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7135586738586426  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([241, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7193317413330078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7193317413330078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7197914123535156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.8006935119628906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 241, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7797136306762695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7801451683044434  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7805767059326172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.780123233795166  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2895, 40])
input nodes number: 7534
output nodes number: 2895
edges number: 23767
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7802181243896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7802190780639648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.021763324737548828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 1 input nodes size: 9288
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020143508911132812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020143508911132812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.025229454040527344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.025251388549804688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016643524169921875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01699352264404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01699352264404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01699352264404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([9288, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01699352264404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([671, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.031402587890625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.031402587890625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 671, 128]), torch.Size([1, 671, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.032042503356933594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.037161827087402344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 671, 128])
m.shape torch.Size([742, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.037549495697021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.037549495697021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 742, 128]), torch.Size([1, 742, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03825712203979492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.049372196197509766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 742, 128])
m.shape torch.Size([632, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04992246627807617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04992246627807617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05052518844604492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0643153190612793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([518, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0650019645690918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0650019645690918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 518, 128]), torch.Size([1, 518, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06549596786499023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07982206344604492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 518, 128])
m.shape torch.Size([451, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08065032958984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08065032958984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08108043670654297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09656429290771484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([340, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09732198715209961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09732198715209961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 340, 128]), torch.Size([1, 340, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09764623641967773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11158895492553711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 340, 128])
m.shape torch.Size([351, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11313247680664062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11313247680664062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11346721649169922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1302042007446289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([236, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1309370994567871  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1309370994567871  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13116216659545898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14399099349975586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([205, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1447582244873047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1447582244873047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 205, 128]), torch.Size([1, 205, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14495372772216797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15746593475341797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 205, 128])
m.shape torch.Size([1160, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16289949417114258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16289949417114258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16400575637817383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24296236038208008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2320384979248047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23709869384765625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2421588897705078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2370591163635254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([5306, 256])
first layer input nodes number: 9288
first layer output nodes number: 5306
edges number: 28208
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24223041534423828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24729061126708984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24855566024780273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24855566024780273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([460, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2670111656188965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2670111656188965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.26788854598999023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.27493906021118164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([416, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2753000259399414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2753000259399414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2760934829711914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.28833675384521484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([348, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.28919172286987305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.28919172286987305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2898554801940918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.30512571334838867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([250, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3057551383972168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3057551383972168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3062319755554199  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32006025314331055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([241, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32109594345092773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32109594345092773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32155561447143555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3381037712097168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.33881425857543945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.33881425857543945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3391251564025879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3524937629699707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([179, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3535428047180176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3535428047180176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.353884220123291  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3709549903869629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([104, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3715839385986328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3715839385986328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3717823028564453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3830890655517578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38390684127807617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38390684127807617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3841090202331543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3970484733581543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3978128433227539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3978128433227539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39798450469970703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4101724624633789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41077423095703125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41077423095703125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41089820861816406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42056846618652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42129087448120117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42129087448120117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4214205741882324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43244504928588867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4330301284790039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4330301284790039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43312931060791016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44225406646728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4428238868713379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4428238868713379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44291162490844727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4515976905822754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45217418670654297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45217418670654297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4522562026977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4609498977661133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46149349212646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46149349212646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4615659713745117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4697561264038086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47027587890625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47027587890625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4703407287597656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4781227111816406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47850561141967773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47850561141967773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47855138778686523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48436498641967773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48467111587524414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48467111587524414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48470544815063477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4893059730529785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4895772933959961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4895772933959961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4896059036254883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4936399459838867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4938678741455078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4938678741455078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49389076232910156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49727821350097656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4976053237915039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4976053237915039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4976358413696289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5023660659790039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5026164054870605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5026164054870605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5026392936706543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5063471794128418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5066127777099609  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5066127777099609  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5066356658935547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5105037689208984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([89, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5126309394836426  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5126309394836426  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5128006935119629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5426774024963379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 89, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5275402069091797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5279726982116699  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5284051895141602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5279507637023926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2901, 40])
input nodes number: 5306
output nodes number: 2901
edges number: 18607
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5280132293701172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5280137062072754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017705440521240234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 2 input nodes size: 17508
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01664447784423828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01664447784423828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02523040771484375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.025251388549804688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020143508911132812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02060413360595703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02060413360595703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02060413360595703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([17508, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02060413360595703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([715, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.043027400970458984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.043027400970458984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 715, 128]), torch.Size([1, 715, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04370927810668945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0491642951965332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 715, 128])
m.shape torch.Size([752, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04954051971435547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04954051971435547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05025768280029297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06101512908935547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([628, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.061554908752441406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.061554908752441406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 628, 128]), torch.Size([1, 628, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06215381622314453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07560443878173828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 628, 128])
m.shape torch.Size([539, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07633304595947266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07633304595947266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07684707641601562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09213733673095703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([513, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09310340881347656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09310340881347656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09359264373779297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11172628402709961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([416, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1126718521118164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1126718521118164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1130685806274414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1301279067993164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([357, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13112115859985352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13112115859985352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 357, 128]), torch.Size([1, 357, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13146162033081055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1484847068786621  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 357, 128])
m.shape torch.Size([322, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14954280853271484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14954280853271484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 322, 128]), torch.Size([1, 322, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14984989166259766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16735363006591797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 322, 128])
m.shape torch.Size([254, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1682901382446289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1682901382446289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1685323715209961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1840353012084961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([2536, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19600677490234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19600677490234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 2536, 128]), torch.Size([1, 2536, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19842529296875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37238645553588867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 2536, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3527250289916992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35943126678466797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3661375045776367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3593788146972656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([7032, 256])
first layer input nodes number: 17508
first layer output nodes number: 7032
edges number: 44041
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3662700653076172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37297630310058594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3746528625488281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3746528625488281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([504, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3922238349914551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3922238349914551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3931851387023926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40165281295776367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([410, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4019603729248047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4019603729248047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4027423858642578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4144725799560547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41497278213500977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41497278213500977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41556215286254883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4295792579650879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([270, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4303607940673828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4303607940673828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4308757781982422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4464397430419922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([217, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44722509384155273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44722509384155273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44763898849487305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4625391960144043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46329545974731445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46329545974731445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46361398696899414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4773106575012207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47791194915771484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47791194915771484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47812747955322266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4889039993286133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48966550827026367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48966550827026367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4898810386657715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5021662712097168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5028805732727051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5028805732727051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5030617713928223  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5146584510803223  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5152311325073242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5152311325073242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5153627395629883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5247068405151367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5253176689147949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5253176689147949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5254397392272949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5349612236022949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.535557746887207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.535557746887207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5356664657592773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5449075698852539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5453906059265137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5453906059265137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5454726219177246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5530180931091309  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5534348487854004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5534348487854004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.553499698638916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5599198341369629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5603632926940918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5603632926940918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5604262351989746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5670981407165527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5674972534179688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5674972534179688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5675506591796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5735855102539062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5741634368896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5741634368896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5742340087890625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.58270263671875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5829272270202637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5829272270202637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5829558372497559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5865893363952637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5869402885437012  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5869402885437012  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5869784355163574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5920901298522949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5925326347351074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5925326347351074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5925784111022949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5990328788757324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5994338989257812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5994338989257812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5994739532470703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6054019927978516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6056361198425293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6056361198425293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.605659008026123  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6092066764831543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6095271110534668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6095271110534668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.609555721282959  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6141905784606934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6143841743469238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6143841743469238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6144013404846191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.617302417755127  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([104, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6197929382324219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6197929382324219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6199913024902344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6549034118652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 104, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6405558586120605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6409707069396973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.641385555267334  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6409497261047363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2783, 40])
input nodes number: 7032
output nodes number: 2783
edges number: 17649
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6410055160522461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6410059928894043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02149820327758789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 3 input nodes size: 19509
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020125865936279297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020125865936279297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.029428482055664062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.029450416564941406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020843505859375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.021424293518066406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.021424293518066406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.021424293518066406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([19509, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.021424293518066406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([520, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.047748565673828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.047748565673828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 520, 128]), torch.Size([1, 520, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.048244476318359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.052211761474609375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 520, 128])
m.shape torch.Size([581, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05251789093017578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05251789093017578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 581, 128]), torch.Size([1, 581, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05307197570800781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06166887283325195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 581, 128])
m.shape torch.Size([549, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.062177181243896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.062177181243896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06270074844360352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07502031326293945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([513, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07573699951171875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07573699951171875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07622623443603516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09122467041015625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([470, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09210062026977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09210062026977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 470, 128]), torch.Size([1, 470, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09254884719848633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10868501663208008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 470, 128])
m.shape torch.Size([392, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10958242416381836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10958242416381836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 392, 128]), torch.Size([1, 392, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10995626449584961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12603139877319336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 392, 128])
m.shape torch.Size([367, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12706947326660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12706947326660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 367, 128]), torch.Size([1, 367, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12741947174072266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14491939544677734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 367, 128])
m.shape torch.Size([347, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14606809616088867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14606809616088867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14639902114868164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16526174545288086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([305, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16640520095825195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16640520095825195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 305, 128]), torch.Size([1, 305, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16669607162475586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18531179428100586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 305, 128])
m.shape torch.Size([3487, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20179367065429688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20179367065429688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 3487, 128]), torch.Size([1, 3487, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20511913299560547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44386863708496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 3487, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4212327003479004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42841482162475586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43559694290161133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4283585548400879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([7531, 256])
first layer input nodes number: 19509
first layer output nodes number: 7531
edges number: 53043
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4357442855834961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44292640686035156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44556474685668945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44556474685668945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([359, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46987438201904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46987438201904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47055912017822266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4767012596130371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([331, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47699546813964844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47699546813964844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4776268005371094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4871063232421875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4876561164855957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4876561164855957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48822832107543945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5016026496887207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([249, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5022740364074707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5022740364074707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.502748966217041  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5165219306945801  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([203, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5172600746154785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5172600746154785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5176472663879395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5315861701965332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5323214530944824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5323214530944824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5326285362243652  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5458331108093262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.546628475189209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.546628475189209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5468974113464355  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5603442192077637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5612635612487793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5612635612487793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5615248680114746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5764193534851074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.577110767364502  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.577110767364502  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5772919654846191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5888886451721191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5897784233093262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5897784233093262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.589972972869873  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6037859916687012  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6044712066650391  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6044712066650391  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6046123504638672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6156215667724609  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.616358757019043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.616358757019043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6164922714233398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6278409957885742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6285367012023926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6285367012023926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6286530494689941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6393570899963379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6401200294494629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6401200294494629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6402363777160645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6517548561096191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([59, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6525473594665527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6525473594665527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6526598930358887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.664588451385498  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6651320457458496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6651320457458496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6652064323425293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.673612117767334  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6741795539855957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6741795539855957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6742501258850098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6827187538146973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6831855773925781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6831855773925781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6832408905029297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6902656555175781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.690767765045166  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.690767765045166  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6908230781555176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.698235034942627  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6986689567565918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6986689567565918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6987147331237793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7051692008972168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7056307792663574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7056307792663574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7056765556335449  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7124514579772949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7128515243530273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7128515243530273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7128896713256836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7188024520874023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7190489768981934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7190489768981934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7190718650817871  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7227797508239746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7232069969177246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7232069969177246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.723243236541748  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.729367733001709  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7365860939025879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7365860939025879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7371411323547363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.8401989936828613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.8189883232116699  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.8194246292114258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.8198609352111816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.8194026947021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2927, 40])
input nodes number: 7531
output nodes number: 2927
edges number: 24799
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.8195023536682129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.8195028305053711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02255868911743164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 4 input nodes size: 11249
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02086496353149414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02086496353149414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.026228904724121094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.026250839233398438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016926288604736328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017334461212158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017334461212158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017334461212158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([11249, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017334461212158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([584, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.034627437591552734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.034627437591552734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 584, 128]), torch.Size([1, 584, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.035184383392333984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04041767120361328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 584, 128])
m.shape torch.Size([666, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04077434539794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04077434539794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04140949249267578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05177927017211914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([615, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.052341461181640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.052341461181640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 615, 128]), torch.Size([1, 615, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05292797088623047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06583118438720703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 615, 128])
m.shape torch.Size([586, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0673823356628418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0673823356628418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06794118881225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08414793014526367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([472, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08499383926391602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08499383926391602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 472, 128]), torch.Size([1, 472, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08544397354125977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10164880752563477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 472, 128])
m.shape torch.Size([420, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10262537002563477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10262537002563477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10302591323852539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12024927139282227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([363, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1212606430053711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1212606430053711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 363, 128]), torch.Size([1, 363, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12160682678222656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.138916015625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 363, 128])
m.shape torch.Size([326, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13998651504516602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13998651504516602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 326, 128]), torch.Size([1, 326, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14029741287231445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1580185890197754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 326, 128])
m.shape torch.Size([277, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15905189514160156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15905189514160156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 277, 128]), torch.Size([1, 277, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1593160629272461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1762228012084961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 277, 128])
m.shape torch.Size([1603, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18373441696166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18373441696166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 1603, 128]), torch.Size([1, 1603, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18526315689086914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.29523229598999023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 1603, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.280642032623291  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.28628015518188477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2919182777404785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2862358093261719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([5912, 256])
first layer input nodes number: 11249
first layer output nodes number: 5912
edges number: 34657
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2920041084289551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.29764223098754883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2995438575744629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2995438575744629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([363, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3197035789489746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3197035789489746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32039594650268555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32598447799682617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3263826370239258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3263826370239258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3271207809448242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3391580581665039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.33968591690063477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.33968591690063477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.34027910232543945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35414600372314453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35494470596313477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35494470596313477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35544824600219727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37005090713500977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37087106704711914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37087106704711914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37129640579223633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3866086006164551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([183, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3874516487121582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3874516487121582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3878006935119629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40280961990356445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([187, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40389347076416016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40389347076416016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4042501449584961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42208385467529297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([140, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4236288070678711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4236288070678711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42389583587646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4391164779663086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([130, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4401078224182129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4401078224182129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4403557777404785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4562249183654785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45699501037597656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45699501037597656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4571723937988281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46976661682128906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([89, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47061920166015625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47061920166015625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47078895568847656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48402976989746094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([64, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4846830368041992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4846830368041992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4848051071166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4951810836791992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49600744247436523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49600744247436523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4961428642272949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5086016654968262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5092206001281738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5092206001281738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5093178749084473  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5189480781555176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5196495056152344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5196495056152344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5197486877441406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5302619934082031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5307660102844238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5307660102844238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5308346748352051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5385937690734863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5389842987060547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5389842987060547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5390338897705078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5449848175048828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5453410148620605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5453410148620605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5453829765319824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5507121086120605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5511112213134766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5511112213134766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5511550903320312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5570335388183594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5574345588684082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5574345588684082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5574765205383301  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5633931159973145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5635943412780762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5635943412780762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5636153221130371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5667204856872559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5670695304870605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5670695304870605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5671019554138184  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5721278190612793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5723772048950195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5723772048950195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5724000930786133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5761079788208008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5763273239135742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5763273239135742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5763463973999023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5795698165893555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([104, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.582059383392334  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.582059383392334  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5822577476501465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6171698570251465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 104, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6002216339111328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6006526947021484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6010837554931641  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6006307601928711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2891, 40])
input nodes number: 5912
output nodes number: 2891
edges number: 20044
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6006917953491211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6006922721862793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018137454986572266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 5 input nodes size: 15222
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016921043395996094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016921043395996094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.024179458618164062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.024201393127441406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01881551742553711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.019320964813232422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.019320964813232422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.019320964813232422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([15222, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.019320964813232422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([598, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04169273376464844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04169273376464844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 598, 128]), torch.Size([1, 598, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.042263031005859375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.046825408935546875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 598, 128])
m.shape torch.Size([608, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.047120094299316406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.047120094299316406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.047699928283691406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.057179927825927734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([591, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.057735443115234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.057735443115234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05829906463623047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07069873809814453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([557, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07152700424194336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07152700424194336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 557, 128]), torch.Size([1, 557, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07205820083618164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08801984786987305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 557, 128])
m.shape torch.Size([531, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0890202522277832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0890202522277832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08952665328979492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10792398452758789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([447, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10894966125488281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10894966125488281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1093759536743164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12770652770996094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([381, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12876510620117188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12876510620117188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 381, 128]), torch.Size([1, 381, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12912845611572266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14729595184326172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 381, 128])
m.shape torch.Size([388, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14859437942504883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14859437942504883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 388, 128]), torch.Size([1, 388, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14896440505981445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17005586624145508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 388, 128])
m.shape torch.Size([304, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17117547988891602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17117547988891602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 304, 128]), torch.Size([1, 304, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17146539688110352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.19002008438110352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 304, 128])
m.shape torch.Size([2527, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20192480087280273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20192480087280273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 2527, 128]), torch.Size([1, 2527, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.20433473587036133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3777928352355957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 2527, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3582725524902344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3648834228515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3714942932128906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.36483144760131836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([6932, 256])
first layer input nodes number: 15222
first layer output nodes number: 6932
edges number: 44929
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3716096878051758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3782205581665039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37987327575683594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37987327575683594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40225696563720703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40225696563720703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4030485153198242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40968894958496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([331, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4099297523498535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4099297523498535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41056108474731445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4201984405517578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42069339752197266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42069339752197266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42122936248779297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4338693618774414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4345359802246094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4345359802246094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4349994659423828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4484405517578125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4491891860961914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4491891860961914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44957828521728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46358585357666016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4643893241882324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4643893241882324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.464719295501709  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47890806198120117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([146, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47972536087036133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47972536087036133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48000383377075195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4939274787902832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49480342864990234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49480342864990234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4950551986694336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5094060897827148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5101628303527832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5101628303527832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5103573799133301  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5228085517883301  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([112, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5241179466247559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5241179466247559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5243315696716309  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5394988059997559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([91, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5403542518615723  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5403542518615723  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5405278205871582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5540661811828613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5548214912414551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5548214912414551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5549607276916504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.566795825958252  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5674886703491211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5674886703491211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5676050186157227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5783090591430664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5788836479187012  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5788836479187012  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5789732933044434  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5878481864929199  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5884523391723633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5884523391723633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5885381698608398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5976362228393555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([51, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5983777046203613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5983777046203613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5984749794006348  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6094670295715332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6098761558532715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6098761558532715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6099295616149902  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6163382530212402  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6167788505554199  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6167788505554199  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6168303489685059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6233706474304199  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6239843368530273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6239843368530273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6240510940551758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6329965591430664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.633540153503418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.633540153503418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6335973739624023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6416654586791992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6420407295227051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6420407295227051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6420788764953613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6477246284484863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6480441093444824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6480441093444824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6480746269226074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6528048515319824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6531434059143066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6531434059143066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6531739234924316  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6581177711486816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6584024429321289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6584024429321289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6584272384643555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6626176834106445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([207, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.667579174041748  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.667579174041748  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6679739952087402  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7374625205993652  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 207, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7182698249816895  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7187018394470215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7191338539123535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7186799049377441  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2899, 40])
input nodes number: 6932
output nodes number: 2899
edges number: 22739
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.718754768371582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7187552452087402  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.020299911499023438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 6 input nodes size: 11118
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018816471099853516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018816471099853516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02418041229248047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02420186996459961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016921520233154297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([11118, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017255306243896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([757, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0318150520324707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0318150520324707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.032536983489990234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03872346878051758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([801, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03912639617919922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03912639617919922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.039890289306640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0521855354309082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([676, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05277061462402344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05277061462402344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 676, 128]), torch.Size([1, 676, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05341529846191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06766128540039062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 676, 128])
m.shape torch.Size([525, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06834030151367188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06834030151367188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 525, 128]), torch.Size([1, 525, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06884098052978516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0833892822265625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 525, 128])
m.shape torch.Size([433, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08417129516601562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08417129516601562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 433, 128]), torch.Size([1, 433, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08458423614501953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09945011138916016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 433, 128])
m.shape torch.Size([361, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10027647018432617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10027647018432617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10062074661254883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11542463302612305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([313, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11629724502563477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11629724502563477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 313, 128]), torch.Size([1, 313, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11659574508666992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13152074813842773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 313, 128])
m.shape torch.Size([243, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13229846954345703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13229846954345703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 243, 128]), torch.Size([1, 243, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13253021240234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14573955535888672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 243, 128])
m.shape torch.Size([235, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14663219451904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14663219451904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 235, 128]), torch.Size([1, 235, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14685630798339844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16119956970214844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 235, 128])
m.shape torch.Size([1181, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1667189598083496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1667189598083496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 1181, 128]), torch.Size([1, 1181, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1678452491760254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24781179428100586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 1181, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.23600387573242188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2412729263305664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24654197692871094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24123144149780273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([5525, 256])
first layer input nodes number: 11118
first layer output nodes number: 5525
edges number: 28878
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2466268539428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2518959045410156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2532658576965332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2532658576965332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([522, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2691011428833008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2691011428833008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2700967788696289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.27841663360595703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([486, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2788534164428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2788534164428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.27978038787841797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.29520177841186523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([371, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2961249351501465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2961249351501465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2968325614929199  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.313079833984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([273, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.31377601623535156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.31377601623535156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3142967224121094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32996082305908203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3307533264160156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3307533264160156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.33117103576660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3462085723876953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.34699201583862305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.34699201583862305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3473200798034668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.36142683029174805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.36209726333618164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.36209726333618164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3623337745666504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3741593360900879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3748178482055664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3748178482055664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37501049041748047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38599109649658203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38670825958251953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38670825958251953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3868875503540039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3983621597290039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3990321159362793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3990321159362793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3991827964782715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4098811149597168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([49, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4103240966796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4103240966796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4104175567626953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4177074432373047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41815710067749023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41815710067749023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41823911666870117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42521047592163086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4257068634033203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4257068634033203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42578887939453125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4333343505859375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43371057510375977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43371057510375977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43376970291137695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4396233558654785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4401850700378418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4401850700378418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4402632713317871  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44855260848999023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4487752914428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4487752914428711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4488077163696289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4524717330932617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45274972915649414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45274972915649414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45278406143188477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45690393447875977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45738887786865234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45738887786865234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4574441909790039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46446895599365234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46471548080444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46471548080444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46474409103393555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46857786178588867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4688138961791992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4688138961791992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4688386917114258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4723348617553711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47246408462524414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47246408462524414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47247743606567383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4744534492492676  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47457408905029297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47457408905029297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47458553314208984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47635936737060547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47655296325683594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47655296325683594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47657012939453125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4793510437011719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47961950302124023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47961950302124023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.479642391204834  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48351049423217773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([64, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48503684997558594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48503684997558594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48515892028808594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5066432952880859  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 64, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4941277503967285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4945507049560547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49497365951538086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49452924728393555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2838, 40])
input nodes number: 5525
output nodes number: 2838
edges number: 15820
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4945831298828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4945836067199707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017938613891601562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 7 input nodes size: 9935
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016912460327148438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016912460327148438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.021649837493896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.021671772003173828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016286373138427734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016588687896728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016588687896728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016588687896728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([9935, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.016588687896728516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.029744625091552734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.029744625091552734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03051900863647461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03718709945678711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([819, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03758096694946289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03758096694946289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03836202621459961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05076885223388672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([673, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05134105682373047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05134105682373047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.051982879638671875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06651067733764648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([505, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0671529769897461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0671529769897461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06763458251953125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08160114288330078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([440, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08240938186645508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08240938186645508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 440, 128]), torch.Size([1, 440, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08282899856567383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09793519973754883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 440, 128])
m.shape torch.Size([365, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0987696647644043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0987696647644043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 365, 128]), torch.Size([1, 365, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09911775588989258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11408567428588867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 365, 128])
m.shape torch.Size([269, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11480951309204102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11480951309204102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 269, 128]), torch.Size([1, 269, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1150660514831543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12789297103881836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 269, 128])
m.shape torch.Size([227, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1286306381225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1286306381225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 227, 128]), torch.Size([1, 227, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1288471221923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14118671417236328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 227, 128])
m.shape torch.Size([203, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14194965362548828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14194965362548828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 203, 128]), torch.Size([1, 203, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14214324951171875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15453338623046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 203, 128])
m.shape torch.Size([954, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15898561477661133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15898561477661133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1598954200744629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.22491216659545898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 954, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2144927978515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.21951580047607422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.22453880310058594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.21947622299194336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([5267, 256])
first layer input nodes number: 9935
first layer output nodes number: 5267
edges number: 25945
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.22461509704589844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.22963809967041016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2308940887451172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2308940887451172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([565, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2455577850341797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2455577850341797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.24663543701171875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2557535171508789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([488, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2561531066894531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2561531066894531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2570838928222656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.27111244201660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([399, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2719559669494629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2719559669494629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2727169990539551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2894730567932129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([276, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.29016923904418945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.29016923904418945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2906956672668457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.30600929260253906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([225, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3068275451660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3068275451660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.30725669860839844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3227062225341797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([195, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32361650466918945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.32361650466918945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3239884376525879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3399815559387207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3407106399536133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3407106399536133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3409700393676758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3539400100708008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([128, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3547945022583008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3547945022583008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3550386428833008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3689546585083008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3695335388183594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3695335388183594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3696880340576172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3795757293701172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3802194595336914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3802194595336914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.38036251068115234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3905191421508789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([50, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3909764289855957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3909764289855957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39107179641723633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3985104560852051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3990163803100586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3990163803100586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3991079330444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4068899154663086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40729427337646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40729427337646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4073629379272461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4136800765991211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41413021087646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41413021087646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4141988754272461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42099666595458984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4213376045227051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4213376045227051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4213871955871582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42664384841918945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4268808364868164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4268808364868164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4269132614135742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43057727813720703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4307737350463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4307737350463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4307985305786133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4337739944458008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43395233154296875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43395233154296875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4339733123779297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43663787841796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43688344955444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43688344955444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43691015243530273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.440488338470459  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44059038162231445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44059038162231445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44060182571411133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4422154426574707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44245195388793945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44245195388793945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4424748420715332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4458622932434082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4459567070007324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4459567070007324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4459662437438965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44744443893432617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44755029678344727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44755029678344727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44755983352661133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44910478591918945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4492154121398926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4492154121398926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44922494888305664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4508366584777832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([32, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4516010284423828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4516010284423828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4516620635986328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4624042510986328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 32, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45116710662841797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4515972137451172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4520273208618164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45157527923583984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2884, 40])
input nodes number: 5267
output nodes number: 2884
edges number: 14554
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4516439437866211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4516444206237793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01723337173461914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 8 input nodes size: 15481
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01629352569580078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01629352569580078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02367544174194336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0236968994140625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01893758773803711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.019444942474365234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.019444942474365234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.019444942474365234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([15481, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.019444942474365234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([490, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.041747093200683594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.041747093200683594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.042214393615722656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.045952796936035156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([544, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.046237945556640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.046237945556640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 544, 128]), torch.Size([1, 544, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.046756744384765625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05460309982299805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 544, 128])
m.shape torch.Size([527, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05509757995605469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05509757995605469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 527, 128]), torch.Size([1, 527, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05560016632080078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06665706634521484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 527, 128])
m.shape torch.Size([474, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06730985641479492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06730985641479492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 474, 128]), torch.Size([1, 474, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06776189804077148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0808711051940918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 474, 128])
m.shape torch.Size([408, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08161783218383789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08161783218383789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 408, 128]), torch.Size([1, 408, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08200693130493164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09601449966430664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 408, 128])
m.shape torch.Size([382, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09691286087036133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09691286087036133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09727716445922852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11294221878051758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([323, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11383819580078125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11383819580078125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11414623260498047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1295480728149414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([346, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13071393966674805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.13071393966674805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 346, 128]), torch.Size([1, 346, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1310439109802246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14985227584838867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 346, 128])
m.shape torch.Size([299, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.150970458984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.150970458984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 299, 128]), torch.Size([1, 299, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15125560760498047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16950511932373047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 299, 128])
m.shape torch.Size([2736, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18240880966186523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18240880966186523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 2736, 128]), torch.Size([1, 2736, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.18501806259155273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.37027502059936523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 2736, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35047006607055664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35669660568237305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.36377477645874023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3574991226196289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([6529, 256])
first layer input nodes number: 15481
first layer output nodes number: 6529
edges number: 44467
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3638920783996582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3701186180114746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3721933364868164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3721933364868164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([362, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39519453048706055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39519453048706055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39588499069213867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40151453018188477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([328, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40180015563964844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40180015563964844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40242576599121094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41190147399902344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4124021530151367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4124021530151367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41294002532958984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4263148307800293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42694950103759766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.42694950103759766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4273977279663086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4403963088989258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44107580184936523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44107580184936523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.441434383392334  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.454343318939209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4550175666809082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4550175666809082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45529985427856445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4674382209777832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4682121276855469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4682121276855469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4684715270996094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4814414978027344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48305177688598633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48305177688598633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48331117630004883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49809694290161133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([114, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49895381927490234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49895381927490234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49917125701904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.513087272644043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([100, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5139398574829102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5139398574829102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5141305923461914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5276727676391602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([103, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5286664962768555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5286664962768555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5288629531860352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5441865921020508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([95, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5451841354370117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5451841354370117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5453653335571289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5607671737670898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5615887641906738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5615887641906738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5617280006408691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5745377540588379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5751547813415527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5751547813415527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5752520561218262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5848822593688965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5854825973510742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5854825973510742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5855684280395508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5946664810180664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5949773788452148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5949773788452148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5950212478637695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5999784469604492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6005287170410156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6005287170410156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6005954742431641  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6086063385009766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6090059280395508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6090059280395508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6090536117553711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6151094436645508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6155424118041992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6155424118041992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6155900955200195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6219797134399414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6224751472473145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6224751472473145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6225266456604004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6297879219055176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6301255226135254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6301255226135254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.630159854888916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6352410316467285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6357951164245605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6357951164245605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6358466148376465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6438288688659668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6441569328308105  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6441569328308105  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6441874504089355  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6491312980651855  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6494851112365723  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6494851112365723  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6495156288146973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6546730995178223  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([239, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6604008674621582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6604008674621582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6608567237854004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7410874366760254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 239, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7215161323547363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7219405174255371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7223649024963379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.721919059753418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2847, 40])
input nodes number: 6529
output nodes number: 2847
edges number: 23436
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7219839096069336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.7219843864440918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02041769027709961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 9 input nodes size: 13179
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018931865692138672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018931865692138672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.025221824645996094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.025243282318115234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017839908599853516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01827096939086914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01827096939086914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01827096939086914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([13179, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01827096939086914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([585, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03618812561035156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03618812561035156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 585, 128]), torch.Size([1, 585, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.03674602508544922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04136514663696289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 585, 128])
m.shape torch.Size([655, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.041710853576660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.041710853576660156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04233551025390625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.051724910736083984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([609, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05228376388549805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05228376388549805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 609, 128]), torch.Size([1, 609, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05286455154418945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06564188003540039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 609, 128])
m.shape torch.Size([523, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06731986999511719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06731986999511719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06781864166259766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08228302001953125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([382, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08294439315795898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08294439315795898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 382, 128]), torch.Size([1, 382, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08330869674682617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09642362594604492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 382, 128])
m.shape torch.Size([347, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09723424911499023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09723424911499023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 347, 128]), torch.Size([1, 347, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0975651741027832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11179494857788086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 347, 128])
m.shape torch.Size([315, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11268091201782227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11268091201782227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 315, 128]), torch.Size([1, 315, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11298131942749023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12800168991088867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 315, 128])
m.shape torch.Size([261, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12946176528930664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12946176528930664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 261, 128]), torch.Size([1, 261, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12971067428588867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14389848709106445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 261, 128])
m.shape torch.Size([236, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14478683471679688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14478683471679688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 236, 128]), torch.Size([1, 236, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14501190185546875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.15941619873046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 236, 128])
m.shape torch.Size([1973, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16871166229248047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16871166229248047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 1973, 128]), torch.Size([1, 1973, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17059326171875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3079061508178711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 1973, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2925114631652832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2981247901916504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3037381172180176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.2980809211730957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([5886, 256])
first layer input nodes number: 13179
first layer output nodes number: 5886
edges number: 35953
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.30383825302124023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3097553253173828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.31089258193969727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.31089258193969727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([398, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3330521583557129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3330521583557129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.33381128311157227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.34076452255249023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.34116172790527344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.34116172790527344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3419322967529297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35349082946777344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([330, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35405731201171875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35405731201171875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3546867370605469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3687624931335449  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([279, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3695206642150879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3695206642150879  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3700528144836426  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3854851722717285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3861083984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3861083984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3864612579345703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39916419982910156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3998126983642578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3998126983642578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40008544921875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41181373596191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4126262664794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4126262664794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41289520263671875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4263420104980469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4270305633544922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4270305633544922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4272346496582031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43886756896972656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([111, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4397258758544922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4397258758544922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4399375915527344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4534873962402344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4540257453918457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4540257453918457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.45415353775024414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4632267951965332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4638080596923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4638080596923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4639244079589844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.47299957275390625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4737720489501953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4737720489501953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4739093780517578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4855823516845703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4861135482788086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4861135482788086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4862051010131836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4946279525756836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4952821731567383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4952821731567383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.49538135528564453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5052003860473633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5055837631225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5055837631225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.505640983581543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5117063522338867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5122776031494141  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5122776031494141  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5123519897460938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5207576751708984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5212273597717285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5212273597717285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5212864875793457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5283818244934082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5289754867553711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5289754867553711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5290441513061523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5377645492553711  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5381870269775391  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5381870269775391  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5382347106933594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5446243286132812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5449080467224121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5449080467224121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5449385643005371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5492415428161621  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5498924255371094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5498924255371094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5499553680419922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5592708587646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5596413612365723  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5596413612365723  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5596776008605957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5652947425842285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5658516883850098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5658516883850098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5659012794494629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5739350318908691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5742335319519043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5742335319519043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5742602348327637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.578773021697998  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([209, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5837817192077637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5837817192077637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5841803550720215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6543402671813965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6353240013122559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6357526779174805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6361813545227051  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6357312202453613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2876, 40])
input nodes number: 5886
output nodes number: 2876
edges number: 21808
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.635800838470459  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6358013153076172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.01913166046142578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 10 input nodes size: 13018
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017844200134277344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017844200134277344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.024051666259765625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.02407360076904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.017762184143066406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018280982971191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018280982971191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018280982971191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([13018, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.018280982971191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([351, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0404973030090332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0404973030090332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 351, 128]), torch.Size([1, 351, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.0408320426940918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04350996017456055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 351, 128])
m.shape torch.Size([421, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04374408721923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04374408721923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 421, 128]), torch.Size([1, 421, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.04414558410644531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05016803741455078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 421, 128])
m.shape torch.Size([441, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05059814453125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.05059814453125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 441, 128]), torch.Size([1, 441, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.051018714904785156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.060271263122558594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 441, 128])
m.shape torch.Size([459, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06093645095825195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06093645095825195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.06137418746948242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07406854629516602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([420, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07485103607177734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07485103607177734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 420, 128]), torch.Size([1, 420, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.07525157928466797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.08967113494873047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 420, 128])
m.shape torch.Size([428, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09069538116455078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09069538116455078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.09110355377197266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10865497589111328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([383, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10972929000854492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.10972929000854492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 383, 128]), torch.Size([1, 383, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.11009454727172852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1283574104309082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 383, 128])
m.shape torch.Size([314, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12937259674072266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12937259674072266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 314, 128]), torch.Size([1, 314, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.12967205047607422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14674091339111328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 314, 128])
m.shape torch.Size([257, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14769411087036133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14769411087036133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 257, 128]), torch.Size([1, 257, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.14793920516967773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.16362524032592773  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 257, 128])
m.shape torch.Size([2719, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17717456817626953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.17717456817626953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 2719, 128]), torch.Size([1, 2719, 128])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.1801304817199707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3648872375488281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 2719, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3449368476867676  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3508429527282715  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3567490577697754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3507966995239258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([6193, 256])
first layer input nodes number: 13018
first layer output nodes number: 6193
edges number: 43716
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.35684823989868164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.36275434494018555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.36456727981567383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.36456727981567383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([274, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39054298400878906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39054298400878906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3910655975341797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.39610910415649414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([266, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3963594436645508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3963594436645508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.3968667984008789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4053807258605957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([248, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40584230422973633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40584230422973633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.40631532669067383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41672182083129883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([227, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4173583984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4173583984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.41779136657714844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4303474426269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([223, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43120288848876953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.43120288848876953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4316282272338867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44694042205810547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([218, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44853639602661133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44853639602661133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.44895219802856445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46683168411254883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([173, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4677877426147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4677877426147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.46811771392822266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.4846162796020508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([144, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48555850982666016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48555850982666016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.48583316802978516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5014886856079102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([108, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5022859573364258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5022859573364258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5024919509887695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5156755447387695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([132, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5168414115905762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5168414115905762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5170931816101074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5349688529968262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([111, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5360169410705566  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5360169410705566  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5362286567687988  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5527424812316895  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5534787178039551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5534787178039551  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5536179542541504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.565453052520752  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5663084983825684  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5663084983825684  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5664496421813965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.579434871673584  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([77, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5804004669189453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5804004669189453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5805473327636719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5950870513916016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5956768989562988  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5956768989562988  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.5957646369934082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.605064868927002  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6057438850402832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6057438850402832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6058335304260254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6159634590148926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.616948127746582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.616948127746582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6170682907104492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6314878463745117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6320333480834961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6320333480834961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6321001052856445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6405782699584961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6410746574401855  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6410746574401855  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6411299705505371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6485419273376465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6493024826049805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6493024826049805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6493806838989258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6604070663452148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6610140800476074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6610140800476074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6610751152038574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6701083183288574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6705641746520996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6705641746520996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6706080436706543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6774077415466309  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6778059005737305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6778059005737305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6778421401977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6837129592895508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6842255592346191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6842255592346191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6842694282531738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.691683292388916  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([218, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6968998908996582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6968998908996582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 4.9705810546875 GB
    Memory Allocated: 0.6973156929016113  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 0.7704968452453613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 218, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 0.7476129531860352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 0.7480487823486328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7484846115112305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7480268478393555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2924, 40])
input nodes number: 6193
output nodes number: 2924
edges number: 25804
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7481021881103516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7481026649475098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01926898956298828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 11 input nodes size: 14940
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.017769336700439453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.017769336700439453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.025233745574951172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.025255680084228516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01902627944946289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019546985626220703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019546985626220703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019546985626220703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([14940, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019546985626220703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([434, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.042111873626708984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.042111873626708984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 434, 128]), torch.Size([1, 434, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0425257682800293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0458369255065918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 434, 128])
m.shape torch.Size([537, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0461421012878418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0461421012878418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04665422439575195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.054990291595458984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([546, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.055515289306640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.055515289306640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 546, 128]), torch.Size([1, 546, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05603599548339844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0675363540649414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 546, 128])
m.shape torch.Size([521, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06826972961425781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06826972961425781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 521, 128]), torch.Size([1, 521, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06876659393310547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08354759216308594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 521, 128])
m.shape torch.Size([457, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08438873291015625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08438873291015625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 457, 128]), torch.Size([1, 457, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0848245620727539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10051441192626953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 457, 128])
m.shape torch.Size([395, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10142660140991211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10142660140991211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 395, 128]), torch.Size([1, 395, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10180330276489258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11800146102905273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 395, 128])
m.shape torch.Size([364, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11902809143066406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11902809143066406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 364, 128]), torch.Size([1, 364, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11937522888183594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1367321014404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 364, 128])
m.shape torch.Size([361, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13793563842773438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13793563842773438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 361, 128]), torch.Size([1, 361, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13827991485595703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15790367126464844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 361, 128])
m.shape torch.Size([289, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15897178649902344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15897178649902344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15924739837646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17688655853271484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([2771, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18996191024780273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18996191024780273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 2771, 128]), torch.Size([1, 2771, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19290637969970703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.38053321838378906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 2771, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3605027198791504  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3668684959411621  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.37323427200317383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3668184280395508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([6675, 256])
first layer input nodes number: 14940
first layer output nodes number: 6675
edges number: 45632
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.37334775924682617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.38014745712280273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.38158512115478516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.38158512115478516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([305, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4052548408508301  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4052548408508301  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4058365821838379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4108414649963379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([322, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41117000579833984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41117000579833984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41178417205810547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42192888259887695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42247819900512695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42247819900512695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42304468154907227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4355320930480957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([244, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4361872673034668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4361872673034668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.43665266036987305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4501490592956543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4509572982788086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4509572982788086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.45135021209716797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46549510955810547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4663395881652832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4663395881652832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4666714668273926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4809422492980957  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([156, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4818754196166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4818754196166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48217296600341797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49705028533935547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([132, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4979424476623535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4979424476623535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49819421768188477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.512545108795166  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([120, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5134601593017578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5134601593017578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5136890411376953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5283374786376953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([101, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5291938781738281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5291938781738281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5293865203857422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5430641174316406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([112, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5441522598266602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5441522598266602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5443658828735352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5610284805297852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5617871284484863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5617871284484863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5619301795959473  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.574089527130127  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5749177932739258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5749177932739258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5750551223754883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5876893997192383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5883746147155762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5883746147155762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5884814262390137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5990557670593262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5997524261474609  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5997524261474609  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5998516082763672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6103649139404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6112227439880371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6112227439880371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.611335277557373  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.624051570892334  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6246490478515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6246490478515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.624725341796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.633880615234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6346211433410645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6346211433410645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.634706974029541  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6456074714660645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6461124420166016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6461124420166016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6461696624755859  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6538372039794922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6546163558959961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6546163558959961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6546964645385742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6659917831420898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.666597843170166  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.666597843170166  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.666658878326416  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.675692081451416  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6761269569396973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6761269569396973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6761689186096191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6826729774475098  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6829395294189453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6829395294189453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6829643249511719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.686981201171875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6874074935913086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6874074935913086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.687443733215332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.693568229675293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([187, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6980438232421875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6980438232421875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6984004974365234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7611751556396484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 187, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.740633487701416  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7410678863525391  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7415022850036621  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7410459518432617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2913, 40])
input nodes number: 6675
output nodes number: 2913
edges number: 24190
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7411165237426758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.741117000579834  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020541667938232422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 12 input nodes size: 15717
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01902484893798828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01902484893798828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.026519298553466797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.026540756225585938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019054412841796875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01959228515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01959228515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01959228515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([15717, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01959228515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([571, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0440831184387207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0440831184387207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04462766647338867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0497136116027832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([583, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04999732971191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04999732971191406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.050553321838378906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05955648422241211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([597, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.060132503509521484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.060132503509521484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 597, 128]), torch.Size([1, 597, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.060701847076416016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07331514358520508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 597, 128])
m.shape torch.Size([504, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07399177551269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07399177551269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 504, 128]), torch.Size([1, 504, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07447242736816406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08841133117675781  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 504, 128])
m.shape torch.Size([495, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08935117721557617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08935117721557617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 495, 128]), torch.Size([1, 495, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08982324600219727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10681772232055664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 495, 128])
m.shape torch.Size([431, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10781478881835938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10781478881835938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 431, 128]), torch.Size([1, 431, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10822582244873047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1259002685546875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 431, 128])
m.shape torch.Size([380, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12696313858032227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12696313858032227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12732553482055664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1454453468322754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([341, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14656496047973633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14656496047973633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 341, 128]), torch.Size([1, 341, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14689016342163086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16542673110961914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 341, 128])
m.shape torch.Size([289, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1665043830871582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1665043830871582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 289, 128]), torch.Size([1, 289, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1667799949645996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1844191551208496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 289, 128])
m.shape torch.Size([3084, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1999063491821289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1999063491821289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 3084, 128]), torch.Size([1, 3084, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20284748077392578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4188213348388672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 3084, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3971061706542969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40404415130615234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4109821319580078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4039897918701172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([7275, 256])
first layer input nodes number: 15717
first layer output nodes number: 7275
edges number: 49434
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4111013412475586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41803932189941406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41981077194213867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41981077194213867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.44208335876464844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.44208335876464844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.44284820556640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4496932029724121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([331, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4499473571777344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4499473571777344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4505786895751953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46065330505371094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([302, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4612088203430176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4612088203430176  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46178483963012695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.475308895111084  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([251, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4759860038757324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4759860038757324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47646474838256836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49034833908081055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4910750389099121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4910750389099121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4914584159851074  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5052599906921387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5060663223266602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5060663223266602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5063962936401367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5205850601196289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5213489532470703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5213489532470703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5216121673583984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5347728729248047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([131, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5356488227844238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5356488227844238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5358986854553223  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5501408576965332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.550898551940918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.550898551940918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5510931015014648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5635442733764648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5643315315246582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5643315315246582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.564507007598877  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5769658088684082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5774598121643066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5774598121643066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5775647163391113  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.585747241973877  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5864100456237793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5864100456237793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5865283012390137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5965800285339355  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5971083641052246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5971083641052246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5971980094909668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.605445384979248  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6061944961547852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6061944961547852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6063070297241211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6174478530883789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6179971694946289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6179971694946289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.618077278137207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6265687942504883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6268057823181152  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6268057823181152  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6268401145935059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6307196617126465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6313071250915527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6313071250915527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6313776969909668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6398463249206543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6403303146362305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6403303146362305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6403875350952148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6476545333862305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6481008529663086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6481008529663086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6481504440307617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6547956466674805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6553668975830078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6553668975830078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.655426025390625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6637630462646484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.664238452911377  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.664238452911377  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6642861366271973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6713433265686035  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6715946197509766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6715946197509766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6716194152832031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6754627227783203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6758484840393066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6758484840393066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6758828163146973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6814446449279785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6817736625671387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6817736625671387  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6818022727966309  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6866374015808105  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([248, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6925821304321289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6925821304321289  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6930551528930664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7763071060180664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 248, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7571225166320801  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7575469017028809  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7579712867736816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7575254440307617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2848, 40])
input nodes number: 7275
output nodes number: 2848
edges number: 22640
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7575912475585938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.757591724395752  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020601749420166016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 13 input nodes size: 15977
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01904439926147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01904439926147461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.026662826538085938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02668476104736328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019168853759765625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0196533203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0196533203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0196533203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([15977, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0196533203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([804, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04212522506713867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04212522506713867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0428919792175293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0490260124206543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([789, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.049395084381103516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.049395084381103516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05014753341674805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.061434268951416016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([670, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06201648712158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06201648712158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 670, 128]), torch.Size([1, 670, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06265544891357422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07769632339477539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 670, 128])
m.shape torch.Size([608, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0785365104675293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0785365104675293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 608, 128]), torch.Size([1, 608, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0791163444519043  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0959315299987793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 608, 128])
m.shape torch.Size([507, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09685039520263672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09685039520263672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 507, 128]), torch.Size([1, 507, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09733390808105469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11474037170410156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 507, 128])
m.shape torch.Size([409, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11566877365112305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11566877365112305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 409, 128]), torch.Size([1, 409, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1160588264465332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13283109664916992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 409, 128])
m.shape torch.Size([359, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1338343620300293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1338343620300293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 359, 128]), torch.Size([1, 359, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13417673110961914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15129518508911133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 359, 128])
m.shape torch.Size([327, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15237140655517578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15237140655517578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 327, 128]), torch.Size([1, 327, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15268325805664062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17045879364013672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 327, 128])
m.shape torch.Size([254, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17142057418823242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17142057418823242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 254, 128]), torch.Size([1, 254, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1716628074645996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1871657371520996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 254, 128])
m.shape torch.Size([2476, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1988511085510254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1988511085510254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 2476, 128]), torch.Size([1, 2476, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20121240615844727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3741164207458496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 2476, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.35549306869506836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3627915382385254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3696608543395996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3623085021972656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([7203, 256])
first layer input nodes number: 15977
first layer output nodes number: 7203
edges number: 43988
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3693528175354004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3766512870788574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.37793970108032227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.37793970108032227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([543, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3987555503845215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3987555503845215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.39979124069213867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40807676315307617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([426, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40837812423706055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40837812423706055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40919065475463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4218473434448242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4223322868347168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4223322868347168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42292165756225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.436185359954834  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([236, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.436798095703125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.436798095703125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.43724822998046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4503021240234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4510335922241211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4510335922241211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4514131546020508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46507740020751953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4657588005065918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4657588005065918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4660468101501465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47843122482299805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4790949821472168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4790949821472168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4793238639831543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4907679557800293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49146127700805664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49146127700805664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49166154861450195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5030770301818848  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5036778450012207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5036778450012207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5038323402404785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5137200355529785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5144023895263672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5144023895263672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5145530700683594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5252513885498047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.525937557220459  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.525937557220459  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5260748863220215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5367865562438965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([44, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5372257232666016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5372257232666016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5373096466064453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5444431304931641  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5449137687683105  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5449137687683105  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5449919700622559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5521864891052246  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5526590347290039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5526590347290039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5527315139770508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5599069595336914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5605630874633789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5605630874633789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5606546401977539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5703592300415039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5708365440368652  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5708365440368652  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5709013938903809  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5782294273376465  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5788345336914062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5788345336914062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5789089202880859  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5878353118896484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5882482528686523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5882482528686523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5882978439331055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5945959091186523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5950098037719727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5950098037719727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5950555801391602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6011896133422852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6016092300415039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6016092300415039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6016530990600586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6078386306762695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6082005500793457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6082005500793457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6082367897033691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6136002540588379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6138572692871094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6138572692871094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6138820648193359  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6177253723144531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6180667877197266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6180667877197266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6180973052978516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6230411529541016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6232566833496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6232566833496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6232757568359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6264991760253906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([225, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6318960189819336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6318960189819336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6323251724243164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7078561782836914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 225, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6903448104858398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6907801628112793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6912155151367188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.690758228302002  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2921, 40])
input nodes number: 7203
output nodes number: 2921
edges number: 20980
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6908450126647949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6908454895019531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02061939239501953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 14 input nodes size: 18946
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019179821014404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019179821014404297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028213977813720703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02823495864868164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02059459686279297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021109580993652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021109580993652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021109580993652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([18946, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021109580993652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([772, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04616069793701172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04616069793701172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.046896934509277344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05300712585449219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([778, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05338096618652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05338096618652344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 778, 128]), torch.Size([1, 778, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0541229248046875  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06525230407714844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 778, 128])
m.shape torch.Size([692, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06626510620117188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06626510620117188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 692, 128]), torch.Size([1, 692, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.066925048828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08225250244140625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 692, 128])
m.shape torch.Size([592, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08305168151855469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08305168151855469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 592, 128]), torch.Size([1, 592, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08361625671386719  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10091972351074219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 592, 128])
m.shape torch.Size([576, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10201072692871094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10201072692871094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10256004333496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12318992614746094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([447, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12419414520263672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12419414520263672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 447, 128]), torch.Size([1, 447, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12462043762207031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14295101165771484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 447, 128])
m.shape torch.Size([376, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14399290084838867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14399290084838867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 376, 128]), torch.Size([1, 376, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14435148239135742  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16228055953979492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 376, 128])
m.shape torch.Size([334, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16420602798461914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16420602798461914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 334, 128]), torch.Size([1, 334, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16452455520629883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18268060684204102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 334, 128])
m.shape torch.Size([312, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18386030197143555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18386030197143555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 312, 128]), torch.Size([1, 312, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1841578483581543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2032008171081543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 312, 128])
m.shape torch.Size([2990, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21733808517456055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21733808517456055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 2990, 128]), torch.Size([1, 2990, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22018957138061523  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42264509201049805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 2990, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40081119537353516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40831565856933594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4158201217651367  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40825700759887695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([7869, 256])
first layer input nodes number: 18946
first layer output nodes number: 7869
edges number: 50346
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41596364974975586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42346811294555664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42534446716308594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42534446716308594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([523, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4438314437866211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4438314437866211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.44482898712158203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4533414840698242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([434, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4536771774291992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4536771774291992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.45450496673583984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.468170166015625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([327, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46869945526123047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46869945526123047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46932315826416016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48332786560058594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([253, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48398876190185547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48398876190185547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48447132110595703  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49846553802490234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.499176025390625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.499176025390625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4995536804199219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5131492614746094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5136814117431641  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5136814117431641  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5139198303222656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5241718292236328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([112, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5248064994812012  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5248064994812012  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5250201225280762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5357012748718262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5361714363098145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5361714363098145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5363144874572754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5444684028625488  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5451498031616211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5451498031616211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5453157424926758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5559358596801758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5565066337585449  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5565066337585449  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5566363334655762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5658450126647949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5663514137268066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5663514137268066  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5664544105529785  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5744881629943848  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5750250816345215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5750250816345215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5751223564147949  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5833907127380371  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5838546752929688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5838546752929688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5839328765869141  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5911273956298828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5914249420166016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5914249420166016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5914726257324219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5961933135986328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5965733528137207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5965733528137207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5966267585754395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.602287769317627  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6026458740234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6026458740234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6026935577392578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6080818176269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6083688735961914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6083688735961914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6084051132202148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6127538681030273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6130647659301758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6130647659301758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6131010055541992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6177034378051758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6181421279907227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6181421279907227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.618189811706543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6245794296264648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6249208450317383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6249208450317383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6249570846557617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6300668716430664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6303515434265137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6303515434265137  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6303801536560059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6346144676208496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6347484588623047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6347484588623047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6347618103027344  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6368312835693359  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6371345520019531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6371345520019531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6371612548828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6414871215820312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6417279243469238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6417279243469238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6417489051818848  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6452946662902832  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([205, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6502103805541992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6502103805541992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6506013870239258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7194185256958008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 205, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7045731544494629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7049846649169922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7053961753845215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7049636840820312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2760, 40])
input nodes number: 7869
output nodes number: 2760
edges number: 18580
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.705019474029541  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7050199508666992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.022089481353759766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 15 input nodes size: 15642
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020570755004882812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020570755004882812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028029441833496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028051376342773438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.018996238708496094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019628524780273438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019628524780273438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019628524780273438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([15642, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019628524780273438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([422, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04800224304199219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04800224304199219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.048404693603515625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.051624298095703125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([509, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05190849304199219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05190849304199219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 509, 128]), torch.Size([1, 509, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05239391326904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05967521667480469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 509, 128])
m.shape torch.Size([543, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06020927429199219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06020927429199219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 543, 128]), torch.Size([1, 543, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06072711944580078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0729374885559082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 543, 128])
m.shape torch.Size([475, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07358455657958984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07358455657958984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 475, 128]), torch.Size([1, 475, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07403755187988281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0871744155883789  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 475, 128])
m.shape torch.Size([502, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08814477920532227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08814477920532227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0886235237121582  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10585832595825195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([437, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10686922073364258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10686922073364258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 437, 128]), torch.Size([1, 437, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10728597640991211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12520647048950195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 437, 128])
m.shape torch.Size([425, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12641668319702148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12641668319702148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12682199478149414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14708757400512695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([394, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14838790893554688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14838790893554688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 394, 128]), torch.Size([1, 394, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14876365661621094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1701812744140625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 394, 128])
m.shape torch.Size([325, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1713881492614746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1713881492614746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 325, 128]), torch.Size([1, 325, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17169809341430664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19153451919555664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 325, 128])
m.shape torch.Size([3840, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20969009399414062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20969009399414062  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 3840, 128]), torch.Size([1, 3840, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21349143981933594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47936058044433594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 3840, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4536867141723633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4611940383911133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4687013626098633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4611353874206543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([7872, 256])
first layer input nodes number: 15642
first layer output nodes number: 7872
edges number: 57553
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46882009506225586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47632741928100586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47820425033569336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47820425033569336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([304, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.504767894744873  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.504767894744873  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.505347728729248  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.510169506072998  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([290, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5104374885559082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5104374885559082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5109906196594238  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5197911262512207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([276, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5203104019165039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5203104019165039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5208368301391602  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5336084365844727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([201, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5341181755065918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5341181755065918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5345015525817871  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5456194877624512  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5463123321533203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5463123321533203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5466632843017578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5592975616455078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([160, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5600447654724121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5600447654724121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5603499412536621  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5734724998474121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([145, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5742955207824707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5742955207824707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5745720863342285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5884003639221191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5893077850341797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5893077850341797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5895671844482422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6043529510498047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([126, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6059713363647461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6059713363647461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6062116622924805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6215925216674805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6223950386047363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6223950386047363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6225781440734863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6355786323547363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([104, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6365866661071777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6365866661071777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6367850303649902  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6522574424743652  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6530351638793945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6530351638793945  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6531801223754883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.665501594543457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6664719581604004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6664719581604004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6666226387023926  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6804852485656738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([69, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6813387870788574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6813387870788574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6814703941345215  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6944994926452637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([61, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6953134536743164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6953134536743164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.695429801940918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7077627182006836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7086272239685059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7086272239685059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7087416648864746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7216734886169434  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7224826812744141  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7224826812744141  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7225837707519531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7347145080566406  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7353215217590332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7353215217590332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7353940010070801  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7445988655090332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7450742721557617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7450742721557617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7451276779174805  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.752284049987793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7529687881469727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7529687881469727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7530393600463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7629899978637695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7636008262634277  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7636008262634277  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7636618614196777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7726950645446777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.773193359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.773193359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7732410430908203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7806320190429688  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7810726165771484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7810726165771484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7811126708984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7876014709472656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7882504463195801  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7882504463195801  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7883057594299316  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7976536750793457  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8051891326904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8051891326904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.805755615234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9069328308105469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.883427619934082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8838639259338379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8843002319335938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8838419914245605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2927, 40])
input nodes number: 7872
output nodes number: 2927
edges number: 27200
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8839473724365234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8839478492736816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020814895629882812  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 16 input nodes size: 39398
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019021034240722656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019021034240722656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.038552284240722656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.038573265075683594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03109264373779297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03230094909667969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03230094909667969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03230094909667969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([39398, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03230094909667969  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([560, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09662866592407227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09662866592407227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 560, 128]), torch.Size([1, 560, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09716272354125977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10143518447875977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 560, 128])
m.shape torch.Size([616, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10175561904907227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10175561904907227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 616, 128]), torch.Size([1, 616, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10234308242797852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11115503311157227  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 616, 128])
m.shape torch.Size([564, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11166810989379883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11166810989379883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 564, 128]), torch.Size([1, 564, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11220598220825195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12422990798950195  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 564, 128])
m.shape torch.Size([532, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12497568130493164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12497568130493164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12548303604125977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14031076431274414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([502, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14125394821166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14125394821166992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14173269271850586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1589674949645996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([465, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16005849838256836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16005849838256836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 465, 128]), torch.Size([1, 465, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16050195693969727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17957067489624023  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 465, 128])
m.shape torch.Size([485, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1809678077697754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1809678077697754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 485, 128]), torch.Size([1, 485, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18143033981323242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20455694198608398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 485, 128])
m.shape torch.Size([487, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20618343353271484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20618343353271484  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 487, 128]), torch.Size([1, 487, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2066478729248047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23312091827392578  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 487, 128])
m.shape torch.Size([513, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2350902557373047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2350902557373047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2355794906616211  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2681913375854492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([10794, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.31941652297973633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.31941652297973633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 10794, 128]), torch.Size([1, 10794, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3297104835510254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0781664848327637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 10794, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.017622947692871  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0324220657348633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0472211837768555  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.03230619430542  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([15518, 256])
first layer input nodes number: 39398
first layer output nodes number: 15518
edges number: 130760
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0475168228149414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0623159408569336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.06640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.06640625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([348, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0969538688659668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0969538688659668  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0976176261901855  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1031222343444824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([295, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1033577919006348  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1033577919006348  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1039204597473145  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1138396263122559  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([219, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1141901016235352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1141901016235352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.114607810974121  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1237974166870117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([176, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.124265193939209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.124265193939209  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.124600887298584  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.134335994720459  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([129, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1347885131835938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1347885131835938  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1350345611572266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1438922882080078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([99, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1443405151367188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1443405151367188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1445293426513672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.15264892578125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.153146743774414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.153146743774414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1533145904541016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1617069244384766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1622304916381836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1622304916381836  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1623811721801758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1709699630737305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1716647148132324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1716647148132324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1718344688415527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1826987266540527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1832771301269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1832771301269531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1834087371826172  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1927528381347656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.193321704864502  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.193321704864502  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1934361457824707  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2023625373840332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2028822898864746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2028822898864746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2029776573181152  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2110838890075684  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2116236686706543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2116236686706543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2117133140563965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2199606895446777  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2205352783203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2205352783203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2206230163574219  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.22930908203125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2296833992004395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2296833992004395  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.229738712310791  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2356019020080566  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.236158847808838  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.236158847808838  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2362313270568848  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2444214820861816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.244859218597412  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.244859218597412  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2449145317077637  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2515521049499512  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2521648406982422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2521648406982422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2522354125976562  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2611980438232422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2617473602294922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2617473602294922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2618083953857422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2699871063232422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2704949378967285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2704949378967285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2705483436584473  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.278078556060791  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2785768508911133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2785768508911133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2786264419555664  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.285965919494629  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2864065170288086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2864065170288086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2864484786987305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.292952537536621  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.29339599609375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.29339599609375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.293436050415039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2999248504638672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3003435134887695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3003435134887695  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.300379753112793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.306504249572754  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([687, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3229937553405762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3229937553405762  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 687, 256]), torch.Size([1, 687, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3243041038513184  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5554566383361816  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 687, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5275087356567383  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5279207229614258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5283327102661133  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5278997421264648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2762, 40])
input nodes number: 15518
output nodes number: 2762
edges number: 31306
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5280122756958008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.528012752532959  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03439188003540039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 17 input nodes size: 45747
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03106832504272461  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05288219451904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.052903175354003906  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03335094451904297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03461456298828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03461456298828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03461456298828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([45747, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03461456298828125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([629, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1034855842590332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1034855842590332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 629, 128]), torch.Size([1, 629, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10408544540405273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10958194732666016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 629, 128])
m.shape torch.Size([750, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10999727249145508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10999727249145508  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 750, 128]), torch.Size([1, 750, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11071252822875977  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12144136428833008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 750, 128])
m.shape torch.Size([705, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12209224700927734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12209224700927734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 705, 128]), torch.Size([1, 705, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12276458740234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13774728775024414  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 705, 128])
m.shape torch.Size([653, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1386566162109375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1386566162109375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 653, 128]), torch.Size([1, 653, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13927936553955078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15786170959472656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 653, 128])
m.shape torch.Size([633, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1590595245361328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1590595245361328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 633, 128]), torch.Size([1, 633, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15966320037841797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18184900283813477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 633, 128])
m.shape torch.Size([591, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18323802947998047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18323802947998047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 591, 128]), torch.Size([1, 591, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18380165100097656  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20829391479492188  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 591, 128])
m.shape torch.Size([576, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20993471145629883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20993471145629883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21048402786254883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23851251602172852  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([540, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24029779434204102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24029779434204102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2408127784729004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.270205020904541  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([539, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2722606658935547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2722606658935547  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 539, 128]), torch.Size([1, 539, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.27277469635009766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.30641698837280273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 539, 128])
m.shape torch.Size([11350, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.36084747314453125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.36084747314453125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 11350, 128]), torch.Size([1, 11350, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3716716766357422  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1421728134155273  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 11350, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.077075481414795  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0932555198669434  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1094355583190918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0931286811828613  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([16966, 256])
first layer input nodes number: 45747
first layer output nodes number: 16966
edges number: 140270
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1097784042358398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1259584426879883  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1300034523010254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1300034523010254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([339, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1586127281188965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1586127281188965  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.15925931930542  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1648521423339844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([330, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.165163516998291  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.165163516998291  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1657929420471191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1775660514831543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([227, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1779060363769531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1779060363769531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1783390045166016  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1878643035888672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([173, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1883130073547363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1883130073547363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.188642978668213  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1982121467590332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1989316940307617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1989316940307617  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1992826461791992  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2119169235229492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([121, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2124395370483398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2124395370483398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2126703262329102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2225942611694336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([100, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.223151683807373  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.223151683807373  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2233424186706543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2328791618347168  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([79, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.233391284942627  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.233391284942627  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2335419654846191  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2421307563781738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([67, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2426352500915527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2426352500915527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2427630424499512  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2509417533874512  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.251570224761963  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.251570224761963  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2517075538635254  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.261457920074463  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([55, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2619709968566895  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2619709968566895  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2620759010314941  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2702584266662598  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2709674835205078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2709674835205078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2710933685302734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2817935943603516  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2823805809020996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2823805809020996  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2824797630310059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2916045188903809  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2921876907348633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2921876907348633  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2922773361206055  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.301152229309082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3016986846923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3016986846923828  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3017768859863281  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3100662231445312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3106884956359863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3106884956359863  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3107705116271973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3200383186340332  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3204874992370605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3204874992370605  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.320544719696045  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.32741117477417  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3280229568481445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3280229568481445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3280935287475586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3370561599731445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.337568759918213  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.337568759918213  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3376259803771973  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3452935218811035  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3456878662109375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3456878662109375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3457298278808594  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3516464233398438  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3520092964172363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3520092964172363  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3520455360412598  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3574090003967285  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.357686996459961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.357686996459961  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3577136993408203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3618526458740234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3621711730957031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3621711730957031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3621997833251953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3668346405029297  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.36732816696167  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.36732816696167  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3673701286315918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3744616508483887  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([593, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3886895179748535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3886895179748535  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 593, 256]), torch.Size([1, 593, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3898205757141113  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5900168418884277  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 593, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5640883445739746  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5645027160644531  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5649170875549316  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5644817352294922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([2778, 40])
input nodes number: 16966
output nodes number: 2778
edges number: 29298
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5646319389343262  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5646324157714844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03685188293457031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

pseudo mini batch 18 input nodes size: 49104
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.033353328704833984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.033353328704833984  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.056767940521240234  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.056789398193359375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03495454788208008  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.036493778228759766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.036493778228759766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.036493778228759766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([49104, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.036493778228759766  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([512, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12025690078735352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12025690078735352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 512, 128]), torch.Size([1, 512, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12074518203735352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12465143203735352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 512, 128])
m.shape torch.Size([535, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12491750717163086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12491750717163086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 535, 128]), torch.Size([1, 535, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1254277229309082  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13447141647338867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 535, 128])
m.shape torch.Size([567, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13502740859985352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13502740859985352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 567, 128]), torch.Size([1, 567, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13556814193725586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14834165573120117  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 567, 128])
m.shape torch.Size([547, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14911460876464844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14911460876464844  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14963626861572266  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1648731231689453  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([566, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16596174240112305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16596174240112305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 566, 128]), torch.Size([1, 566, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16650152206420898  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18617486953735352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 566, 128])
m.shape torch.Size([549, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18747568130493164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18747568130493164  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 549, 128]), torch.Size([1, 549, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18799924850463867  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21088933944702148  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 549, 128])
m.shape torch.Size([528, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21238994598388672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21238994598388672  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 528, 128]), torch.Size([1, 528, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21289348602294922  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23907947540283203  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 528, 128])
m.shape torch.Size([548, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24091815948486328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24091815948486328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 548, 128]), torch.Size([1, 548, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2414407730102539  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.27122974395751953  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 548, 128])
m.shape torch.Size([589, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2740507125854492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2740507125854492  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2746124267578125  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.31099510192871094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([14596, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3803133964538574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3803133964538574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 14596, 128]), torch.Size([1, 14596, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.39423322677612305  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3832545280456543  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 14596, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3046298027038574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3241610527038574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3436923027038574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3240151405334473  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

torch.Size([19537, 256])
first layer input nodes number: 49104
first layer output nodes number: 19537
edges number: 170936
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3440604209899902  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3635916709899902  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3687071800231934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3687071800231934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

m.shape torch.Size([275, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4032630920410156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4032630920410156  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.403787612915039  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.409088134765625  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([230, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4092683792114258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4092683792114258  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4097070693969727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4162874221801758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([207, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4166650772094727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4166650772094727  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4170598983764648  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.425745964050293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([148, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4261178970336914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4261178970336914  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4264001846313477  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.434586524963379  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([160, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4352145195007324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4352145195007324  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4355196952819824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4465060234069824  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([120, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4470458030700684  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4470458030700684  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4472746849060059  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4571166038513184  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([81, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4575471878051758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4575471878051758  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4577016830444336  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4654264450073242  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4660029411315918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4660029411315918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4661650657653809  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4754061698913574  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([84, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4760518074035645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4760518074035645  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4762120246887207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4864659309387207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4870109558105469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4870109558105469  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4871349334716797  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4959373474121094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4965839385986328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4965839385986328  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4967117309570312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5066795349121094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5072846412658691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5072846412658691  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5073952674865723  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.516798496246338  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([57, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5174555778503418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5174555778503418  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.517564296722412  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5275664329528809  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5282526016235352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5282526016235352  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5283575057983398  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.538743019104004  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([55, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5394835472106934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5394835472106934  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.539588451385498  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.550708293914795  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([55, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.551501750946045  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.551501750946045  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5516066551208496  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5634608268737793  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5640621185302734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5640621185302734  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.564138412475586  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.573293685913086  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5742073059082031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5742073059082031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5743122100830078  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5876350402832031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([44, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5883865356445312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5883865356445312  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.588470458984375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5997161865234375  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6005778312683105  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6005778312683105  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6006674766540527  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6133074760437012  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([55, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6147289276123047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6147289276123047  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6148338317871094  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6303596496582031  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6310052871704102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6310052871704102  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.631068229675293  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.640824317932129  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6415448188781738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6415448188781738  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6416096687316895  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6521153450012207  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6527981758117676  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6527981758117676  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6528573036193848  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6628499031066895  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([717, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.680048942565918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.680048942565918  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6814165115356445  GigaBytes
Max Memory Allocated: 1.9345088005065918  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.9260435104370117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 717, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8941130638122559  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8945393562316895  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.894965648651123  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8945178985595703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2858, 40])
input nodes number: 19537
output nodes number: 2858
edges number: 35548
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8946971893310547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.894697666168213  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03914642333984375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 19 input nodes size: 45591
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.034966468811035156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.034966468811035156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05670595169067383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.056726932525634766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.033290863037109375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.034458160400390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.034458160400390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.034458160400390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([45591, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.034458160400390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([673, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09885644912719727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09885644912719727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 673, 128]), torch.Size([1, 673, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09949827194213867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10504722595214844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 673, 128])
m.shape torch.Size([734, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10542631149291992  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10542631149291992  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 734, 128]), torch.Size([1, 734, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10612630844116211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11662626266479492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 734, 128])
m.shape torch.Size([655, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11721324920654297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11721324920654297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 655, 128]), torch.Size([1, 655, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11783790588378906  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13178634643554688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 655, 128])
m.shape torch.Size([614, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1326451301574707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1326451301574707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13323068618774414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15045404434204102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([582, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1515488624572754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1515488624572754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 582, 128]), torch.Size([1, 582, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15210390090942383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17245244979858398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 582, 128])
m.shape torch.Size([536, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17447900772094727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17447900772094727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 536, 128]), torch.Size([1, 536, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17499017715454102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19726037979125977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 536, 128])
m.shape torch.Size([531, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1987771987915039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1987771987915039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19928359985351562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22526121139526367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([532, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2270374298095703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2270374298095703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22754478454589844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.257293701171875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([469, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25905275344848633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25905275344848633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 469, 128]), torch.Size([1, 469, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25950002670288086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.28812551498413086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 469, 128])
m.shape torch.Size([10582, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3383607864379883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3383607864379883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 10582, 128]), torch.Size([1, 10582, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.34877634048461914  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0669045448303223  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 10582, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0063161849975586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0214872360229492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0366582870483398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0213685035705566  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([15908, 256])
first layer input nodes number: 45591
first layer output nodes number: 15908
edges number: 130702
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0370001792907715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.052171230316162  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0563998222351074  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0563998222351074  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([393, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0824871063232422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0824871063232422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0832366943359375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0892333984375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([366, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0895624160766602  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0895624160766602  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0902605056762695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1009721755981445  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([259, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1013703346252441  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1013703346252441  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1018643379211426  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1155476570129395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([189, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1160273551940918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1160273551940918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1163878440856934  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1268420219421387  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([169, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.127474308013916  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.127474308013916  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1277966499328613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1394009590148926  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1400299072265625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1400299072265625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1402912139892578  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1515274047851562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1521639823913574  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1521639823913574  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.152381420135498  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1632533073425293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([89, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1638293266296387  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1638293266296387  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.163999080657959  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1736750602722168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1742477416992188  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1742477416992188  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1743927001953125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1836700439453125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([61, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1841840744018555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1841840744018555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.184300422668457  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.192561149597168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1932220458984375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1932220458984375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1933517456054688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2034683227539062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2042112350463867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2042112350463867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2043447494506836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.215693473815918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([29, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.215989112854004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.215989112854004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2160444259643555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2211332321166992  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2216172218322754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2216172218322754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2216897010803223  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.228865146636963  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2294201850891113  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2294201850891113  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2294983863830566  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2377877235412598  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.238163948059082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.238163948059082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.238215446472168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.244034767150879  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.244466781616211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.244466781616211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2445201873779297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2509288787841797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2514557838439941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2514557838439941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2515168190002441  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2592682838439941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2597126960754395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2597126960754395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2597622871398926  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2664074897766113  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2668442726135254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2668442726135254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.266890048980713  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2733445167541504  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2738265991210938  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2738265991210938  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.273874282836914  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2809314727783203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2813520431518555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2813520431518555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2813920974731445  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2876005172729492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2879786491394043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2879786491394043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.288012981414795  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2935748100280762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2939729690551758  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2939729690551758  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2940073013305664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.299809455871582  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([451, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3106293678283691  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3106293678283691  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3114895820617676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.468308925628662  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 451, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4450554847717285  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4454684257507324  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4458813667297363  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4454474449157715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2769, 40])
input nodes number: 15908
output nodes number: 2769
edges number: 25807
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4455738067626953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4455742835998535  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03653287887573242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 20 input nodes size: 44446
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03327751159667969  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03327751159667969  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05476188659667969  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.054782867431640625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.033022403717041016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03423452377319336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03423452377319336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03423452377319336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([44446, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03423452377319336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([587, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10060405731201172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10060405731201172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 587, 128]), torch.Size([1, 587, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10116386413574219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10617256164550781  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 587, 128])
m.shape torch.Size([636, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10649919509887695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10649919509887695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 636, 128]), torch.Size([1, 636, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10710573196411133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11620378494262695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 636, 128])
m.shape torch.Size([697, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1168975830078125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1168975830078125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11756229400634766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1322646141052246  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([580, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13303852081298828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13303852081298828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 580, 128]), torch.Size([1, 580, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1335916519165039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15001964569091797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 580, 128])
m.shape torch.Size([601, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15117597579956055  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15117597579956055  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 601, 128]), torch.Size([1, 601, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1517491340637207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17309951782226562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 601, 128])
m.shape torch.Size([571, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17444658279418945  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17444658279418945  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 571, 128]), torch.Size([1, 571, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17499113082885742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19913434982299805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 571, 128])
m.shape torch.Size([537, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2006545066833496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2006545066833496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20116662979125977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22716045379638672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([488, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22876596450805664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22876596450805664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 488, 128]), torch.Size([1, 488, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2292313575744629  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25575876235961914  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 488, 128])
m.shape torch.Size([490, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2576289176940918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2576289176940918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 490, 128]), torch.Size([1, 490, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25809621810913086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.28800344467163086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 490, 128])
m.shape torch.Size([11043, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3404269218444824  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3404269218444824  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 11043, 128]), torch.Size([1, 11043, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.35095834732055664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1062769889831543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 11043, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0439715385437012  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0594496726989746  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.074927806854248  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.059328556060791  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([16230, 256])
first layer input nodes number: 44446
first layer output nodes number: 16230
edges number: 135204
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.075261116027832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0907392501831055  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.094792366027832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.094792366027832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([361, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1215124130249023  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1215124130249023  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1222009658813477  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.128403663635254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([296, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1286287307739258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1286287307739258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1291933059692383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1383070945739746  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([249, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1387429237365723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1387429237365723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1392178535461426  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1496663093566895  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([179, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1501173973083496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1501173973083496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.150458812713623  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1603598594665527  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([169, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1610016822814941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1610016822814941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1613240242004395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1729283332824707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([134, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1735401153564453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1735401153564453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1737957000732422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1847858428955078  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1854724884033203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1854724884033203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1857032775878906  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1972427368164062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([96, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1978654861450195  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1978654861450195  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1980485916137695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2084856033325195  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2090864181518555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2090864181518555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2092390060424805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2190046310424805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2197165489196777  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2197165489196777  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2198729515075684  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2309775352478027  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2315654754638672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2315654754638672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2316856384277344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.241058349609375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.241724967956543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.241724967956543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2418451309204102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.252058982849121  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2526988983154297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2526988983154297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2528057098388672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2626323699951172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.26310396194458  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.26310396194458  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2631783485412598  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2705426216125488  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2710824012756348  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2710824012756348  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2711586952209473  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2792458534240723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2798843383789062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2798843383789062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.27996826171875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2894515991210938  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2900309562683105  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2900309562683105  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2901034355163574  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2988009452819824  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2993183135986328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2993183135986328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2993793487548828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3071308135986328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3077030181884766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3077030181884766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3077659606933594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3162002563476562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3167457580566406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3167457580566406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.316802978515625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3248710632324219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3255085945129395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3255085945129395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3255715370178223  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3348870277404785  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3353633880615234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3353633880615234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.335409164428711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3425045013427734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3429017066955566  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3429017066955566  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.34293794631958  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.348808765411377  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3491597175598145  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3491597175598145  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3491902351379395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3543477058410645  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([463, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3662109375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3662109375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 463, 256]), torch.Size([1, 463, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3670940399169922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5342650413513184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 463, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5103392601013184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5107507705688477  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.511162281036377  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5107297897338867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2760, 40])
input nodes number: 16230
output nodes number: 2760
edges number: 27313
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5108704566955566  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5108709335327148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03637552261352539  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 21 input nodes size: 41489
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05280447006225586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0528254508972168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03132009506225586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03258943557739258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03258943557739258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03258943557739258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([41489, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03258943557739258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([583, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10132026672363281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10132026672363281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 583, 128]), torch.Size([1, 583, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10187625885009766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1073770523071289  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 583, 128])
m.shape torch.Size([626, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1076960563659668  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1076960563659668  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 626, 128]), torch.Size([1, 626, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10829305648803711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1172480583190918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 626, 128])
m.shape torch.Size([596, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11780214309692383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11780214309692383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 596, 128]), torch.Size([1, 596, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11837053298950195  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13172388076782227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 596, 128])
m.shape torch.Size([568, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1325230598449707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1325230598449707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 568, 128]), torch.Size([1, 568, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13306474685668945  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14917802810668945  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 568, 128])
m.shape torch.Size([517, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15013980865478516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15013980865478516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 517, 128]), torch.Size([1, 517, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1506328582763672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16838598251342773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 517, 128])
m.shape torch.Size([523, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16963577270507812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16963577270507812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 523, 128]), torch.Size([1, 523, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1701345443725586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19182491302490234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 523, 128])
m.shape torch.Size([491, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19321441650390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19321441650390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 491, 128]), torch.Size([1, 491, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19368267059326172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21709537506103516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 491, 128])
m.shape torch.Size([449, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21857404708862305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21857404708862305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 449, 128]), torch.Size([1, 449, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21900224685668945  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2434096336364746  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 449, 128])
m.shape torch.Size([422, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24500656127929688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24500656127929688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2454090118408203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2711658477783203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([11761, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3270454406738281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3270454406738281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 11761, 128]), torch.Size([1, 11761, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.33907270431518555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.135420322418213  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 11761, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0705976486206055  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0863676071166992  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.102137565612793  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0862441062927246  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([16536, 256])
first layer input nodes number: 41489
first layer output nodes number: 16536
edges number: 140055
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1024489402770996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1182188987731934  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1226277351379395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1226277351379395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([366, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1526241302490234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1526241302490234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1533222198486328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1589069366455078  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([295, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1591253280639648  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1591253280639648  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1596879959106445  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1692066192626953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([226, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1695771217346191  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1695771217346191  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1700081825256348  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1794915199279785  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([162, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1798992156982422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1798992156982422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1802082061767578  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.189168930053711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([146, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1897163391113281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1897163391113281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1899948120117188  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2000198364257812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([121, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2005786895751953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2005786895751953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2008094787597656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.210733413696289  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2114391326904297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2114391326904297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2116718292236328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.223306655883789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([72, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2237439155578613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2237439155578613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2238812446594238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2317090034484863  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([62, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2321767807006836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2321767807006836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.232295036315918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.239863395690918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2404870986938477  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2404870986938477  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2406225204467773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2502374649047852  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2508044242858887  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2508044242858887  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2509188652038574  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.25984525680542  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2605032920837402  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2605032920837402  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2606215476989746  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2706732749938965  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2713017463684082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2713017463684082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.271406650543213  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2810578346252441  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2815170288085938  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2815170288085938  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2815895080566406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2887649536132812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2892913818359375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2892913818359375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2893657684326172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.297250747680664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.297567367553711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.297567367553711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2976112365722656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3025684356689453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3030204772949219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3030204772949219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3030757904052734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.309713363647461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3100838661193848  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3100838661193848  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3101277351379395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3156991004943848  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3161520957946777  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3161520957946777  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3162016868591309  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3228468894958496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3233604431152344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3233604431152344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3234138488769531  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3309440612792969  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3314018249511719  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3314018249511719  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3314476013183594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3382225036621094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3386225700378418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3386225700378418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.338660717010498  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3445734977722168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3450188636779785  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3450188636779785  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3450589179992676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3515477180480957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3520355224609375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3520355224609375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3520774841308594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3591690063476562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([645, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3746461868286133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3746461868286133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3758764266967773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.605532169342041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 645, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5781803131103516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5785913467407227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5790023803710938  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5785703659057617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2758, 40])
input nodes number: 16536
output nodes number: 2758
edges number: 30081
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.578714370727539  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5787148475646973  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.034795284271240234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 22 input nodes size: 48284
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.031319618225097656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.031319618225097656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.054757118225097656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.054778099060058594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03646707534790039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03646707534790039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03646707534790039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([48284, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03646707534790039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([576, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11878728866577148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11878728866577148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 576, 128]), torch.Size([1, 576, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11933660507202148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12373113632202148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 576, 128])
m.shape torch.Size([632, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12405920028686523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12405920028686523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 632, 128]), torch.Size([1, 632, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12466192245483398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13370275497436523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 632, 128])
m.shape torch.Size([537, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1341695785522461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1341695785522461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 537, 128]), torch.Size([1, 537, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13468170166015625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14601898193359375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 537, 128])
m.shape torch.Size([532, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14677762985229492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14677762985229492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 532, 128]), torch.Size([1, 532, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14728498458862305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16242170333862305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 532, 128])
m.shape torch.Size([562, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16350793838500977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16350793838500977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 562, 128]), torch.Size([1, 562, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16404390335083008  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18403196334838867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 562, 128])
m.shape torch.Size([545, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18532323837280273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18532323837280273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 545, 128]), torch.Size([1, 545, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18584299087524414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20848512649536133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 545, 128])
m.shape torch.Size([501, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21033668518066406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21033668518066406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 501, 128]), torch.Size([1, 501, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2108144760131836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23470401763916016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 501, 128])
m.shape torch.Size([538, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23651742935180664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23651742935180664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 538, 128]), torch.Size([1, 538, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2370305061340332  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2665085792541504  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 538, 128])
m.shape torch.Size([542, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.26857805252075195  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.26857805252075195  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 542, 128]), torch.Size([1, 542, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.26909494400024414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3022942543029785  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 542, 128])
m.shape torch.Size([14254, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3703951835632324  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3703951835632324  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 14254, 128]), torch.Size([1, 14254, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3839888572692871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3519549369812012  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 14254, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2738795280456543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.292208194732666  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3105368614196777  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2920646667480469  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([19219, 256])
first layer input nodes number: 48284
first layer output nodes number: 19219
edges number: 166888
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.310898780822754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3292274475097656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3338098526000977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3338098526000977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([338, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3664608001708984  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3664608001708984  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.367105484008789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3732223510742188  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([286, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3734498023986816  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3734498023986816  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.373995304107666  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3826708793640137  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([185, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3829317092895508  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3829317092895508  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.383284568786621  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.391047477722168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([142, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3914170265197754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3914170265197754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3916878700256348  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3995423316955566  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([125, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.400007724761963  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.400007724761963  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4002461433410645  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4088292121887207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([95, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4092578887939453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4092578887939453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4094390869140625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4172306060791016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([77, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4176583290100098  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4176583290100098  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4178051948547363  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4251484870910645  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([74, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4256443977355957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4256443977355957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4257855415344238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.433830738067627  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4344091415405273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4344091415405273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4345521926879883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4437074661254883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4443187713623047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4443187713623047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4444541931152344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4540691375732422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([44, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4544668197631836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4544668197631836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4545507431030273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4610967636108398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.461723804473877  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.461723804473877  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.46183443069458  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4712376594543457  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.471832275390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.471832275390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4719314575195312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4810562133789062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4815855026245117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4815855026245117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4816675186157227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4897871017456055  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4903087615966797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4903087615966797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4903831481933594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4982681274414062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4988923072814941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4988923072814941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.498974323272705  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.508242130279541  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5087242126464844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5087242126464844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5087852478027344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5161094665527344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.516857624053955  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.516857624053955  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5169434547424316  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.527843952178955  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.528550148010254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.528550148010254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5286283493041992  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.539107322692871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5396065711975098  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5396065711975098  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5396599769592285  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5471901893615723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5478501319885254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5478501319885254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.547914981842041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5575127601623535  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.557882308959961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.557882308959961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5579185485839844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5635356903076172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5642914772033691  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5642914772033691  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5643582344055176  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5751729011535645  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.575693130493164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.575693130493164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5757389068603516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.583475112915039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([753, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.601545810699463  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.601545810699463  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.6029820442199707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8581905364990234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 753, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8280792236328125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8284902572631836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8289012908935547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8284692764282227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2758, 40])
input nodes number: 19219
output nodes number: 2758
edges number: 33506
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8286337852478027  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.828634262084961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.039032936096191406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 23 input nodes size: 39117
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0349736213684082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0545048713684082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.054526329040527344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.031067848205566406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.032501220703125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.032501220703125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.032501220703125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([39117, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.032501220703125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([419, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10872459411621094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10872459411621094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 419, 128]), torch.Size([1, 419, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10912418365478516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1123208999633789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 419, 128])
m.shape torch.Size([416, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1125178337097168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1125178337097168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 416, 128]), torch.Size([1, 416, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1129145622253418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1188654899597168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 416, 128])
m.shape torch.Size([451, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11931228637695312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11931228637695312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 451, 128]), torch.Size([1, 451, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11974239349365234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12920475006103516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 451, 128])
m.shape torch.Size([456, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12985944747924805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12985944747924805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 456, 128]), torch.Size([1, 456, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1302943229675293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14290571212768555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 456, 128])
m.shape torch.Size([436, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14372777938842773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14372777938842773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 436, 128]), torch.Size([1, 436, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14414358139038086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15911245346069336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 436, 128])
m.shape torch.Size([452, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16019773483276367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16019773483276367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 452, 128]), torch.Size([1, 452, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1606287956237793  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17916440963745117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 452, 128])
m.shape torch.Size([454, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1804642677307129  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1804642677307129  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 454, 128]), torch.Size([1, 454, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18089723587036133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2025456428527832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 454, 128])
m.shape torch.Size([459, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20408010482788086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20408010482788086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 459, 128]), torch.Size([1, 459, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20451784133911133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22946882247924805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 459, 128])
m.shape torch.Size([473, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23127985000610352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23127985000610352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23173093795776367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.26060056686401367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([13362, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3248281478881836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3248281478881836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 13362, 128]), torch.Size([1, 13362, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3385000228881836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2445030212402344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 13362, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.171450138092041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1880230903625488  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2045960426330566  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1878933906555176  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([17378, 256])
first layer input nodes number: 39117
first layer output nodes number: 17378
edges number: 154047
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2048897743225098  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2214627265930176  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2263360023498535  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2263360023498535  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([256, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2634649276733398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2634649276733398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2639532089233398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2678594589233398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([182, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.267965316772461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.267965316772461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2683124542236328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.273519515991211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([181, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2738680839538574  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2738680839538574  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2742133140563965  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2818083763122559  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([159, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2822470664978027  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2822470664978027  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.28255033493042  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2913451194763184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([113, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2917366027832031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2917366027832031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.291952133178711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.2997112274169922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([110, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3002381324768066  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3002381324768066  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.300447940826416  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3094696998596191  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([82, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3099164962768555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3099164962768555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.310072898864746  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3178930282592773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([68, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3183379173278809  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3183379173278809  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.318467617034912  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3258605003356934  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3266263008117676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3266263008117676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3268094062805176  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3385281562805176  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3390617370605469  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3390617370605469  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3391857147216797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3479881286621094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3486666679382324  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3486666679382324  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3488001823425293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3592143058776855  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3599319458007812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3599319458007812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3600616455078125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3710861206054688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3717584609985352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3717584609985352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.371870994567871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3822240829467773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([67, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3830695152282715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3830695152282715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.38319730758667  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3958487510681152  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3965058326721191  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3965058326721191  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.3966012001037598  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.406710147857666  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4074006080627441  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4074006080627441  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4074921607971191  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4178376197814941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([53, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4186582565307617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4186582565307617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4187593460083008  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4308900833129883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([57, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4327054023742676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4327054023742676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.432814121246338  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4466214179992676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4472613334655762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4472613334655762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.447333812713623  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4570460319519043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4579901695251465  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4579901695251465  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.45808744430542  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4718031883239746  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4726629257202148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4726629257202148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4727487564086914  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4854516983032227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4861912727355957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4861912727355957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4862618446350098  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4972004890441895  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.497828483581543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.497828483581543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.4978857040405273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.507155418395996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5079803466796875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5079803466796875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5080509185791016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5199775695800781  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([831, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.539909839630127  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.539909839630127  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 831, 256]), torch.Size([1, 831, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.5414948463439941  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.8332266807556152  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 831, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.798924446105957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.7993497848510742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.7997751235961914  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.799328327178955  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2853, 40])
input nodes number: 17378
output nodes number: 2853
edges number: 38246
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.7994937896728516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.7994942665100098  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03494739532470703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 24 input nodes size: 19735
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0310821533203125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0310821533203125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04049253463745117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04051399230957031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020961284637451172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021438121795654297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021438121795654297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021438121795654297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([19735, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021438121795654297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([824, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04478597640991211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04478597640991211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04557180404663086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05185842514038086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([833, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05225992202758789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05225992202758789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0530543327331543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06497049331665039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([771, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06569147109985352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06569147109985352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06642675399780273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08260297775268555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([646, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08346748352050781  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08346748352050781  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 646, 128]), torch.Size([1, 646, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08408355712890625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10211372375488281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 646, 128])
m.shape torch.Size([614, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10326957702636719  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10326957702636719  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 614, 128]), torch.Size([1, 614, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10385513305664062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12600421905517578  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 614, 128])
m.shape torch.Size([502, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12714767456054688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12714767456054688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 502, 128]), torch.Size([1, 502, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1276264190673828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14821243286132812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 502, 128])
m.shape torch.Size([428, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14940166473388672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14940166473388672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 428, 128]), torch.Size([1, 428, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1498098373413086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17021846771240234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 428, 128])
m.shape torch.Size([355, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17136859893798828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17136859893798828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 355, 128]), torch.Size([1, 355, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1717071533203125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19100475311279297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 355, 128])
m.shape torch.Size([290, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19208002090454102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19208002090454102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 290, 128]), torch.Size([1, 290, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19235658645629883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21005678176879883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 290, 128])
m.shape torch.Size([2487, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22177743911743164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22177743911743164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 2487, 128]), torch.Size([1, 2487, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22414922714233398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3975505828857422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 2487, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3770427703857422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3844337463378906  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.39182472229003906  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.38437557220458984  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([7750, 256])
first layer input nodes number: 19735
first layer output nodes number: 7750
edges number: 46785
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.39197397232055664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3993649482727051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40201807022094727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40201807022094727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([551, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4190845489501953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4190845489501953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.420135498046875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.429232120513916  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 551, 256])
m.shape torch.Size([421, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4295163154602051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4295163154602051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.43031930923461914  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4425010681152344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([333, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.44305992126464844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.44305992126464844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.443695068359375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4592294692993164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([255, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.45989227294921875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.45989227294921875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46037864685058594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4744834899902344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([252, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4754514694213867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4754514694213867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47593212127685547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49323558807373047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49395275115966797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49395275115966797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49426937103271484  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5078840255737305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5088305473327637  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5088305473327637  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5091109275817871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.523129940032959  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5238895416259766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5238895416259766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5241127014160156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5368328094482422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5375866889953613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5375866889953613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5377774238586426  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5499844551086426  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5506100654602051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5506100654602051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.550753116607666  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5609097480773926  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5613245964050293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5613245964050293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5614123344421387  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5682559013366699  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5688118934631348  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5688118934631348  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.568911075592041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5773415565490723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5779170989990234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5779170989990234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5780124664306641  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5867862701416016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5873713493347168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5873713493347168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.587460994720459  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5963358879089355  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5966663360595703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5966663360595703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5967159271240234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6019725799560547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6023478507995605  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6023478507995605  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6023974418640137  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6080012321472168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6083197593688965  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6083197593688965  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6083598136901855  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.613166332244873  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6134753227233887  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6134753227233887  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6135115623474121  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6181139945983887  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6183700561523438  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6183700561523438  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6183986663818359  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6222324371337891  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6225066184997559  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6225066184997559  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.622535228729248  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6265692710876465  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6266560554504395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6266560554504395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6266655921936035  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6280770301818848  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.628199577331543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.628199577331543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6282110214233398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6299848556518555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6301784515380859  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6301784515380859  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6301956176757812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6329765319824219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6331524848937988  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6331524848937988  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6331677436828613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6357464790344238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([105, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6382622718811035  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6382622718811035  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6384625434875488  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6737103462219238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 105, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6599893569946289  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6604166030883789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6608438491821289  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6603951454162598  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2867, 40])
input nodes number: 7750
output nodes number: 2867
edges number: 17072
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6604766845703125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6604771614074707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.022398948669433594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 25 input nodes size: 24882
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020963191986083984  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020963191986083984  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03282785415649414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.032849788665771484  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.023417949676513672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.024024486541748047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.024024486541748047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.024024486541748047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([24882, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.024024486541748047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([738, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05447530746459961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05447530746459961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 738, 128]), torch.Size([1, 738, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05517911911010742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06120920181274414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 738, 128])
m.shape torch.Size([798, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06161832809448242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06161832809448242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06237936019897461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07379484176635742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([787, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07513856887817383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07513856887817383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07588911056518555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09240102767944336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([667, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09414100646972656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09414100646972656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 667, 128]), torch.Size([1, 667, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09477710723876953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11358261108398438  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 667, 128])
m.shape torch.Size([623, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11474990844726562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11474990844726562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 623, 128]), torch.Size([1, 623, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11534404754638672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1367330551147461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 623, 128])
m.shape torch.Size([540, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13798093795776367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13798093795776367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 540, 128]), torch.Size([1, 540, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13849592208862305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.160736083984375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 540, 128])
m.shape torch.Size([439, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16194391250610352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16194391250610352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 439, 128]), torch.Size([1, 439, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16236257553100586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18329572677612305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 439, 128])
m.shape torch.Size([422, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18469619750976562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18469619750976562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 422, 128]), torch.Size([1, 422, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18509864807128906  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.208038330078125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 422, 128])
m.shape torch.Size([374, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.209442138671875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.209442138671875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 374, 128]), torch.Size([1, 374, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20979881286621094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23262596130371094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 374, 128])
m.shape torch.Size([3728, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25022411346435547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25022411346435547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 3728, 128]), torch.Size([1, 3728, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25470685958862305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5071330070495605  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 3728, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48215436935424805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4908480644226074  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4995417594909668  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4907798767089844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([9116, 256])
first layer input nodes number: 24882
first layer output nodes number: 9116
edges number: 60813
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4997291564941406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5084228515625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5105962753295898  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5105962753295898  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([482, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5308742523193359  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5308742523193359  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5317935943603516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5394535064697266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([407, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5397763252258301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5397763252258301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5405526161193848  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5530867576599121  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([322, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5536274909973145  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5536274909973145  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5542416572570801  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5714383125305176  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([266, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5721540451049805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5721540451049805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5726613998413086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5888471603393555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([224, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5896701812744141  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5896701812744141  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5900974273681641  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6054782867431641  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6062450408935547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6062450408935547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6065692901611328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6205120086669922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6212248802185059  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6212248802185059  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6214728355407715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6338706016540527  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6344928741455078  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6344928741455078  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6346778869628906  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6452236175537109  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6459360122680664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6459360122680664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.646113395690918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.657465934753418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6581077575683594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6581077575683594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6582527160644531  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6685447692871094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6690750122070312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6690750122070312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6691837310791016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6776638031005859  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.678255558013916  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.678255558013916  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6783623695373535  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.687441349029541  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6879377365112305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6879377365112305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6880216598510742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6957426071166992  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6962523460388184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6962523460388184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6963305473327637  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7040724754333496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7046680450439453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7046680450439453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7047519683837891  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7136478424072266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7140364646911621  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7140364646911621  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7140898704528809  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7201247215270996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7204904556274414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7204904556274414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7205362319946289  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7260293960571289  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7264738082885742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7264738082885742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7265253067016602  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7330656051635742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7334599494934082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7334599494934082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7335038185119629  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.739382266998291  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7397642135620117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7397642135620117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7398042678833008  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7454519271850586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7457952499389648  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7457952499389648  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7458295822143555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.750910758972168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7511262893676758  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7511262893676758  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7511472702026367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.754399299621582  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7545881271362305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7545881271362305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7546052932739258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7573862075805664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.757631778717041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.757631778717041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.757652759552002  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7611985206604004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([213, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7663064002990723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7663064002990723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7667126655578613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8382153511047363  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 213, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8211650848388672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.821596622467041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8220281600952148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8215746879577637  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2894, 40])
input nodes number: 9116
output nodes number: 2894
edges number: 20469
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8216691017150879  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8216695785522461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.025211334228515625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 26 input nodes size: 16971
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0234222412109375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0234222412109375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.031514644622802734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.031536102294921875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019649505615234375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02005767822265625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02005767822265625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02005767822265625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([16971, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02005767822265625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([749, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03928041458129883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03928041458129883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03999471664428711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04570913314819336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([809, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.046123504638671875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.046123504638671875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04689502716064453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.058467864990234375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([718, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05929088592529297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05929088592529297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 718, 128]), torch.Size([1, 718, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.059975624084472656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07534503936767578  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 718, 128])
m.shape torch.Size([586, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07629632949829102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07629632949829102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 586, 128]), torch.Size([1, 586, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07685518264770508  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09376382827758789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 586, 128])
m.shape torch.Size([533, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09475517272949219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09475517272949219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 533, 128]), torch.Size([1, 533, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09526348114013672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11409425735473633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 533, 128])
m.shape torch.Size([426, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11505889892578125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11505889892578125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 426, 128]), torch.Size([1, 426, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11546516418457031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1329345703125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 426, 128])
m.shape torch.Size([352, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13390636444091797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13390636444091797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 352, 128]), torch.Size([1, 352, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13424205780029297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15102672576904297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 352, 128])
m.shape torch.Size([323, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15209102630615234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15209102630615234  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 323, 128]), torch.Size([1, 323, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15239906311035156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16995716094970703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 323, 128])
m.shape torch.Size([279, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17100048065185547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17100048065185547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 279, 128]), torch.Size([1, 279, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1712665557861328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1882953643798828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 279, 128])
m.shape torch.Size([1878, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19711732864379883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19711732864379883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 1878, 128]), torch.Size([1, 1878, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19890832901000977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.32606935501098633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 1878, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3098917007446289  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.31632375717163086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.32266855239868164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.31618690490722656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([6653, 256])
first layer input nodes number: 16971
first layer output nodes number: 6653
edges number: 38425
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3227100372314453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.32914209365844727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3306760787963867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3306760787963867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([522, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.346921443939209  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.346921443939209  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3479170799255371  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.35655975341796875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([464, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.35695409774780273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.35695409774780273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.35783910751342773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3719348907470703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([358, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.37259721755981445  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.37259721755981445  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.37328004837036133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3896341323852539  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([273, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.39048242568969727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.39048242568969727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3910031318664551  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40737295150756836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([246, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4082951545715332  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4082951545715332  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4087643623352051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4256558418273926  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42644214630126953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42644214630126953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.42677974700927734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4412965774536133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.44191503524780273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.44191503524780273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4421381950378418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4532961845397949  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.454007625579834  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.454007625579834  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4542117118835449  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46584463119506836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4665818214416504  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4665818214416504  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4667668342590332  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4786076545715332  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47919797897338867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47919797897338867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.47933340072631836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48894834518432617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48952579498291016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48952579498291016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4896421432495117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4987173080444336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4991321563720703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4991321563720703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4992103576660156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5058574676513672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5064306259155273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5064306259155273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5065240859985352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5151224136352539  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5154929161071777  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5154929161071777  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5155520439147949  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5214056968688965  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5216937065124512  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5216937065124512  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.521735668182373  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5261836051940918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5265779495239258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5265779495239258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5266294479370117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5324487686157227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5328478813171387  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5328478813171387  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5328974723815918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5388484001159668  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5391526222229004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5391526222229004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5391888618469238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5437912940979004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5441384315490723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5441384315490723  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5441765785217285  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.549288272857666  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5496344566345215  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5496344566345215  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5496706962585449  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5547804832458496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5550251007080078  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5550251007080078  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5550498962402344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5587196350097656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5588130950927734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5588130950927734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5588226318359375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5603008270263672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5604066848754883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5604066848754883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5604162216186523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5619611740112305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.562140941619873  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.562140941619873  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5621562004089355  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.564734935760498  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([74, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5665054321289062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5665054321289062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5666465759277344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5914878845214844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 74, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5785689353942871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5789942741394043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5794196128845215  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5789728164672852  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2852, 40])
input nodes number: 6653
output nodes number: 2852
edges number: 16246
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5790376663208008  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.579038143157959  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020888805389404297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 27 input nodes size: 24991
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019643306732177734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019643306732177734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03155994415283203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03158092498779297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.023467063903808594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02406024932861328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02406024932861328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02406024932861328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([24991, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02406024932861328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([710, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0544886589050293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0544886589050293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 710, 128]), torch.Size([1, 710, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.055165767669677734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06098365783691406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 710, 128])
m.shape torch.Size([840, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.061446189880371094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.061446189880371094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.062247276306152344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0742635726928711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([737, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07521343231201172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07521343231201172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 737, 128]), torch.Size([1, 737, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07591629028320312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09137916564941406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 737, 128])
m.shape torch.Size([658, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09228277206420898  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09228277206420898  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 658, 128]), torch.Size([1, 658, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0929102897644043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1115717887878418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 658, 128])
m.shape torch.Size([547, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11307764053344727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11307764053344727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 547, 128]), torch.Size([1, 547, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11359930038452148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13237905502319336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 547, 128])
m.shape torch.Size([489, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13351726531982422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13351726531982422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 489, 128]), torch.Size([1, 489, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13398361206054688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1540365219116211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 489, 128])
m.shape torch.Size([429, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15523529052734375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15523529052734375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 429, 128]), torch.Size([1, 429, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15564441680908203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1761007308959961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 429, 128])
m.shape torch.Size([423, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17750978469848633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17750978469848633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 423, 128]), torch.Size([1, 423, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17791318893432617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20090723037719727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 423, 128])
m.shape torch.Size([379, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2023320198059082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2023320198059082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 379, 128]), torch.Size([1, 379, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20269346237182617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22582578659057617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 379, 128])
m.shape torch.Size([3762, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24358367919921875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24358367919921875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 3762, 128]), torch.Size([1, 3762, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24717140197753906  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5018997192382812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 3762, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4767160415649414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4852743148803711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4938325881958008  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48520708084106445  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([8974, 256])
first layer input nodes number: 24991
first layer output nodes number: 8974
edges number: 60320
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.494020938873291  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5025792121887207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5049939155578613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5049939155578613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([475, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5239787101745605  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5239787101745605  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5248847007751465  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5327353477478027  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([422, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5330939292907715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5330939292907715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5338988304138184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.546323299407959  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([329, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5468697547912598  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5468697547912598  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5474972724914551  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5630898475646973  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([264, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5638027191162109  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5638027191162109  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5643062591552734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5831298828125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5838298797607422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5838298797607422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5842075347900391  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5978031158447266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5984392166137695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5984392166137695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5987119674682617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6104402542114258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6110372543334961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6110372543334961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6112451553344727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6216402053833008  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6223130226135254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6223130226135254  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6225056648254395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.633486270904541  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6341948509216309  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6341948509216309  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6343722343444824  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6457247734069824  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6463475227355957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6463475227355957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6464886665344238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6565098762512207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6569890975952148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6569890975952148  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6570882797241211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6648244857788086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.665398120880127  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.665398120880127  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6655011177062988  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6742558479309082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6747918128967285  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6747918128967285  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6748814582824707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.683128833770752  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6835956573486328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6835956573486328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6836681365966797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6908435821533203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6913266181945801  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6913266181945801  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6913952827453613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6986737251281738  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6990547180175781  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6990547180175781  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6991062164306641  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.704925537109375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.705357551574707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.705357551574707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7054109573364258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7118196487426758  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7122950553894043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7122950553894043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7123503684997559  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7193751335144043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7197675704956055  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7197675704956055  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7198114395141602  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7256898880004883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7259564399719238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7259564399719238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.725985050201416  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7300190925598145  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7304086685180664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7304086685180664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7304468154907227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7360925674438477  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7363276481628418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7363276481628418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7363505363464355  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7398982048034668  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.740196704864502  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.740196704864502  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7402234077453613  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7445492744445801  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7448358535766602  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7448358535766602  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7448606491088867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7490510940551758  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([176, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.753267765045166  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.753267765045166  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.753603458404541  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.812685489654541  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 176, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7968478202819824  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7972640991210938  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7976803779602051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7972431182861328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2792, 40])
input nodes number: 8974
output nodes number: 2792
edges number: 19146
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7973222732543945  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7973227500915527  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02520751953125  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 28 input nodes size: 34225
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.023458003997802734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.023458003997802734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03977775573730469  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.039798736572265625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02786111831665039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028534412384033203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028534412384033203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028534412384033203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([34225, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028534412384033203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([907, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06506824493408203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06506824493408203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0659332275390625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07285308837890625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([915, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07329320907592773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07329320907592773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07416582107543945  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08725500106811523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([776, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08830022811889648  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08830022811889648  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08904027938842773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10541296005249023  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([666, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10631322860717773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10631322860717773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 666, 128]), torch.Size([1, 666, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1069483757019043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1257491111755371  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 666, 128])
m.shape torch.Size([639, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1269550323486328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1269550323486328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 639, 128]), torch.Size([1, 639, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1275644302368164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1501460075378418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 639, 128])
m.shape torch.Size([513, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15130901336669922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15130901336669922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15179824829101562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17307090759277344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([471, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17439842224121094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17439842224121094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 471, 128]), torch.Size([1, 471, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17484760284423828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19730663299560547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 471, 128])
m.shape torch.Size([380, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1985316276550293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1985316276550293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 380, 128]), torch.Size([1, 380, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19889402389526367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21955060958862305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 380, 128])
m.shape torch.Size([320, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22074270248413086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22074270248413086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22104787826538086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.24057912826538086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([4963, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.26409196853637695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.26409196853637695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 4963, 128]), torch.Size([1, 4963, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.26882505416870117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6144566535949707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 4963, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5817599296569824  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5918211936950684  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6018824577331543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5917425155639648  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([10550, 256])
first layer input nodes number: 34225
first layer output nodes number: 10550
edges number: 72849
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6021394729614258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6122007369995117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6147160530090332  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6147160530090332  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([566, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6321048736572266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6321048736572266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6331844329833984  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6430168151855469  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([468, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6433768272399902  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6433768272399902  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6442694664001465  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6577978134155273  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6582684516906738  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6582684516906738  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6588749885559082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6741142272949219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6747531890869141  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6747531890869141  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6752204895019531  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6887722015380859  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6895432472229004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6895432472229004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6899418830871582  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7042927742004395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7049589157104492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7049589157104492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7052450180053711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7175474166870117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7181715965270996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7181715965270996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7183890342712402  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7292609214782715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7299213409423828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7299213409423828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7301120758056641  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7409839630126953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([61, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7414164543151855  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7414164543151855  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7415328025817871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7489790916442871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7495169639587402  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7495169639587402  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7496352195739746  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7580313682556152  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7584695816040039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7584695816040039  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7585592269897461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7655515670776367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.766014575958252  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.766014575958252  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7660984992980957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7732319831848145  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7737150192260742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7737150192260742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7737951278686523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7811651229858398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7814884185791016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7814884185791016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7815399169921875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7866382598876953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7869443893432617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7869443893432617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7869882583618164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7916383743286133  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7919397354125977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7919397354125977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7919797897338867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7965059280395508  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7967801094055176  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7967801094055176  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7968144416809082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8009343147277832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8013153076171875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8013153076171875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8013591766357422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8069305419921875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8072376251220703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8072376251220703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8072719573974609  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8118724822998047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8122591972351074  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8122591972351074  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8122992515563965  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8179469108581543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8181085586547852  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8181085586547852  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8181257247924805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8206663131713867  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8209328651428223  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8209328651428223  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8209576606750488  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.824800968170166  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.825009822845459  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.825009822845459  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8250288963317871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8281188011169434  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8284091949462891  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8284091949462891  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8284339904785156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8326244354248047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([164, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8365530967712402  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8365530967712402  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8368659019470215  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8919196128845215  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 164, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.878450870513916  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8788661956787109  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8792815208435059  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.87884521484375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2786, 40])
input nodes number: 10550
output nodes number: 2786
edges number: 17397
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.878943920135498  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8789443969726562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.029859542846679688  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 29 input nodes size: 17170
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.027860164642333984  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.027860164642333984  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03604745864868164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03606891632080078  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.01972818374633789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020187854766845703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020187854766845703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020187854766845703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([17170, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.020187854766845703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([753, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04263925552368164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04263925552368164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 753, 128]), torch.Size([1, 753, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04335737228393555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0491023063659668  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 753, 128])
m.shape torch.Size([802, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.049508094787597656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.049508094787597656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.05027294158935547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.061745643615722656  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([717, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06253910064697266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06253910064697266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 717, 128]), torch.Size([1, 717, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.06322288513183594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07865715026855469  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 717, 128])
m.shape torch.Size([630, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07951688766479492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07951688766479492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 630, 128]), torch.Size([1, 630, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08011770248413086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09775114059448242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 630, 128])
m.shape torch.Size([625, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09894084930419922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09894084930419922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 625, 128]), torch.Size([1, 625, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09953689575195312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12194967269897461  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 625, 128])
m.shape torch.Size([484, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12303638458251953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12303638458251953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 484, 128]), torch.Size([1, 484, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12349796295166016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14334583282470703  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 484, 128])
m.shape torch.Size([389, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14441347122192383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14441347122192383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 389, 128]), torch.Size([1, 389, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14478445053100586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16333341598510742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 389, 128])
m.shape torch.Size([407, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16470050811767578  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16470050811767578  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 407, 128]), torch.Size([1, 407, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16508865356445312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18721294403076172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 407, 128])
m.shape torch.Size([320, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18839216232299805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18839216232299805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 320, 128]), torch.Size([1, 320, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18869733810424805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20822858810424805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 320, 128])
m.shape torch.Size([2192, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21947669982910156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.21947669982910156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 2192, 128]), torch.Size([1, 2192, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.221649169921875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3743743896484375  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 2192, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3551912307739258  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3621711730957031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.36915111541748047  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.36211633682250977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([7319, 256])
first layer input nodes number: 17170
first layer output nodes number: 7319
edges number: 43836
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3692812919616699  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.37626123428344727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3780064582824707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3780064582824707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([528, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3956742286682129  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3956742286682129  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.3966813087463379  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40535688400268555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([430, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40568017959594727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40568017959594727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.40650033950805664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41936445236206055  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([333, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41991472244262695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.41991472244262695  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4205498695373535  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4351515769958496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([259, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4358339309692383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4358339309692383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4363279342651367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.45069026947021484  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([235, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.45157289505004883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.45157289505004883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.45202112197875977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4681572914123535  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46886777877807617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.46886777877807617  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4691767692565918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.48246335983276367  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4832038879394531  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4832038879394531  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4834575653076172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4961414337158203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4969296455383301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.4969296455383301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.49715662002563477  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.510094165802002  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5108027458190918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5108027458190918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.510983943939209  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.522580623626709  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5232686996459961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5232686996459961  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5234231948852539  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5343923568725586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5349812507629395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5349812507629395  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5351014137268066  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5444741249084473  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5450253486633301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5450253486633301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5451264381408691  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5537190437316895  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5542311668395996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5542311668395996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5543169975280762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5622134208679199  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5624804496765137  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5624804496765137  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5625243186950684  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5668673515319824  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5673356056213379  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5673356056213379  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5674004554748535  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5742745399475098  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5747036933898926  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5747036933898926  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.574760913848877  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5812268257141113  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5815253257751465  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5815253257751465  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5815634727478027  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5861411094665527  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5865201950073242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5865201950073242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5865640640258789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5921354293823242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.592442512512207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.592442512512207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5924768447875977  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5970773696899414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5973873138427734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5973873138427734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.5974197387695312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6019916534423828  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6021976470947266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6021976470947266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6022186279296875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6053237915039062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.605567455291748  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.605567455291748  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6055903434753418  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.609138011932373  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6093258857727051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6093258857727051  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6093430519104004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.612123966217041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6124153137207031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6124153137207031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6124401092529297  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6166305541992188  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([117, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6194295883178711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6194295883178711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6196527481079102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6589288711547852  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 117, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6445741653442383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6450009346008301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6454277038574219  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6449794769287109  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2863, 40])
input nodes number: 7319
output nodes number: 2863
edges number: 17719
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6450672149658203  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.6450676918029785  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.021117210388183594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 30 input nodes size: 37250
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019739627838134766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.019739627838134766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03750181198120117  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.03752279281616211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.029314041137695312  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.030132293701171875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.030132293701171875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.030132293701171875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([37250, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.030132293701171875  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([758, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07481527328491211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07481527328491211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 758, 128]), torch.Size([1, 758, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.07553815841674805  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08243846893310547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 758, 128])
m.shape torch.Size([831, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0828695297241211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0828695297241211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08366203308105469  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0955495834350586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([708, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09616613388061523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09616613388061523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 708, 128]), torch.Size([1, 708, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09684133529663086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11214399337768555  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 708, 128])
m.shape torch.Size([695, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11313199996948242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11313199996948242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 695, 128]), torch.Size([1, 695, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.11379480361938477  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13325834274291992  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 695, 128])
m.shape torch.Size([589, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13529586791992188  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13529586791992188  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 589, 128]), torch.Size([1, 589, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.13585758209228516  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15607929229736328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 589, 128])
m.shape torch.Size([505, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1572432518005371  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1572432518005371  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 505, 128]), torch.Size([1, 505, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.15772485733032227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17843389511108398  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 505, 128])
m.shape torch.Size([477, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17978525161743164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.17978525161743164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 477, 128]), torch.Size([1, 477, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.18024015426635742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20298528671264648  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 477, 128])
m.shape torch.Size([486, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20461177825927734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20461177825927734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 486, 128]), torch.Size([1, 486, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.20507526397705078  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23149394989013672  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 486, 128])
m.shape torch.Size([411, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23302602767944336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23302602767944336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 411, 128]), torch.Size([1, 411, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.23341798782348633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25850343704223633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 411, 128])
m.shape torch.Size([6635, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2899456024169922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2899456024169922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 6635, 128]), torch.Size([1, 6635, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.29666900634765625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7517685890197754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 6635, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.710597038269043  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7221317291259766  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7336664199829102  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7220416069030762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([12095, 256])
first layer input nodes number: 37250
first layer output nodes number: 12095
edges number: 90575
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7339463233947754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.745481014251709  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.748450756072998  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.748450756072998  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([512, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7675161361694336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7675161361694336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7684926986694336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7763051986694336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([444, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7766704559326172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7766704559326172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7775173187255859  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7903213500976562  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([307, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7907834053039551  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7907834053039551  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7913689613342285  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8046994209289551  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8053255081176758  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8053255081176758  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.805781364440918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8190011978149414  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([172, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8196001052856445  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8196001052856445  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8199281692504883  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8317384719848633  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([133, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8323416709899902  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8323416709899902  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8325953483581543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.843503475189209  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([105, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.844083309173584  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.844083309173584  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8442835807800293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8542971611022949  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8550124168395996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8550124168395996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8552145957946777  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8667387962341309  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8673038482666016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8673038482666016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8674507141113281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8768501281738281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([65, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8774018287658691  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8774018287658691  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.877525806427002  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8863282203674316  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8870806694030762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8870806694030762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8872275352478027  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8986830711364746  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8990941047668457  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8990941047668457  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8991742134094238  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9059834480285645  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9063935279846191  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9063935279846191  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9064621925354004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9127793312072754  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9131894111633301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9131894111633301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9132523536682129  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9194836616516113  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9198851585388184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9198851585388184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9199423789978027  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9260077476501465  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9263482093811035  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9263482093811035  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.926393985748291  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9315667152404785  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9321484565734863  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9321484565734863  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9322190284729004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9406876564025879  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.940981388092041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.940981388092041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9410176277160645  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.945620059967041  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9460768699645996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9460768699645996  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9461264610290527  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9527716636657715  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9531698226928711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9531698226928711  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.953211784362793  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9591283798217773  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9595112800598145  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9595112800598145  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9595494270324707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9651951789855957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9655570983886719  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9655570983886719  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9655914306640625  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9709129333496094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9710507392883301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9710507392883301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9710640907287598  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9732270240783691  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9735202789306641  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9735202789306641  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9735450744628906  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9777355194091797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([201, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9825530052185059  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9825530052185059  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9829363822937012  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0504107475280762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 201, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0344781875610352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0348906517028809  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0353031158447266  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.03486967086792  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2765, 40])
input nodes number: 12095
output nodes number: 2765
edges number: 19195
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0349664688110352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0349669456481934  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.031659603118896484  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

pseudo mini batch 31 input nodes size: 32278
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02929973602294922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.02929973602294922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.04492473602294922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.044945716857910156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.027162551879882812  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028037071228027344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028037071228027344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028037071228027344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([32278, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.028037071228027344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([656, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0743565559387207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0743565559387207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 656, 128]), torch.Size([1, 656, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0749821662902832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0807642936706543  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 656, 128])
m.shape torch.Size([697, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0811161994934082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0811161994934082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 697, 128]), torch.Size([1, 697, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.08178091049194336  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.0917515754699707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 697, 128])
m.shape torch.Size([572, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09223747253417969  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09223747253417969  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 572, 128]), torch.Size([1, 572, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.09278297424316406  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10478401184082031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 572, 128])
m.shape torch.Size([577, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10561180114746094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10561180114746094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 577, 128]), torch.Size([1, 577, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.10616207122802734  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12265205383300781  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 577, 128])
m.shape torch.Size([550, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1236882209777832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1236882209777832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 550, 128]), torch.Size([1, 550, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.12421274185180664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14335966110229492  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 550, 128])
m.shape torch.Size([531, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14461660385131836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14461660385131836  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 531, 128]), torch.Size([1, 531, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.14512300491333008  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1679081916809082  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 531, 128])
m.shape torch.Size([473, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1692337989807129  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1692337989807129  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 473, 128]), torch.Size([1, 473, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.16968488693237305  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.19223928451538086  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 473, 128])
m.shape torch.Size([513, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1939706802368164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1939706802368164  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 513, 128]), torch.Size([1, 513, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.1944599151611328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22272634506225586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 513, 128])
m.shape torch.Size([425, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2243056297302246  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2243056297302246  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 425, 128]), torch.Size([1, 425, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.22471094131469727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.25065088272094727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 425, 128])
m.shape torch.Size([7080, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2842082977294922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.2842082977294922  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 7080, 128]), torch.Size([1, 7080, 128])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.29096031188964844  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7703533172607422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 7080, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7279243469238281  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7394390106201172  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7509536743164062  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7393488883972168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([12074, 256])
first layer input nodes number: 32278
first layer output nodes number: 12074
edges number: 94050
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7511963844299316  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7627110481262207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7657489776611328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7657489776611328  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7886624336242676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7886624336242676  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.789482593536377  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7966265678405762  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([378, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.796943187713623  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.796943187713623  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.7976641654968262  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.808478832244873  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([255, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8088536262512207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8088536262512207  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8093400001525879  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.820040225982666  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([188, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8205199241638184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8205199241638184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8208785057067871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8312773704528809  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8319873809814453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8319873809814453  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8323402404785156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8450431823730469  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8458414077758789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8458414077758789  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8461637496948242  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8600244522094727  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8606505393981934  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8606505393981934  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8608736991882324  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8720316886901855  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8727736473083496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8727736473083496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8729853630065918  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8850531578063965  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8856654167175293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8856654167175293  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8858237266540527  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8959555625915527  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8967127799987793  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.8967127799987793  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.896878719329834  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9086604118347168  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9093918800354004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9093918800354004  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.909538745880127  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9209942817687988  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9216017723083496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9216017723083496  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9217143058776855  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9312796592712402  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9316983222961426  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9316983222961426  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9317708015441895  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.938438892364502  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9388737678527832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9388737678527832  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9389405250549316  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.945549488067627  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9461216926574707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9461216926574707  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9462018013000488  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9546933174133301  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9551916122436523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9551916122436523  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9552583694458008  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9628019332885742  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9633731842041016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9633731842041016  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9634437561035156  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9719123840332031  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9723443984985352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9723443984985352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9723958969116211  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9789361953735352  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9794039726257324  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9794039726257324  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9794554710388184  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.986356258392334  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9869265556335449  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9869265556335449  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9869856834411621  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9953227043151855  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9957375526428223  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9957375526428223  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.9957795143127441  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0019898414611816  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.002370834350586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.002370834350586  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0024070739746094  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0080242156982422  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0082054138183594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0082054138183594  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0082225799560547  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0110034942626953  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.011479377746582  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.011479377746582  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.011519432067871  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0182886123657227  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([310, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0263071060180664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0263071060180664  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.0268983840942383  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.141097068786621  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

rst.shape  torch.Size([1, 310, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.121190071105957  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1216063499450684  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1220226287841797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1215853691101074  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

torch.Size([2792, 40])
input nodes number: 12074
output nodes number: 2792
edges number: 23284
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1217002868652344  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 1.1217007637023926  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.029632091522216797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.029632091522216797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 0.029632091522216797  GigaBytes
Max Memory Allocated: 1.9431381225585938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008326731622219086 |0.001367226243019104 |0.11670949310064316 |8.474290370941162e-05 |0.07411716133356094 |0.004725456237792969 |
----------------------------------------------------------pseudo_mini_loss sum 3.9637515544891357Using backend: pytorch

Total (block generation + training)time/epoch 29.040906071662903
Training time/epoch 6.598083019256592
Training time without block to device /epoch 6.5543317794799805
Training time without total dataloading part /epoch 6.113890171051025
load block tensor time/epoch 0.26645541191101074
block to device time/epoch 0.04375123977661133
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1113777
Number of first layer input nodes during this epoch:  795413
Number of first layer output nodes during this epoch:  318364
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
