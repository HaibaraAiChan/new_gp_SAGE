main start at this time 1651556807.634826
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03542065620422363
number of batches is  32
batch size is  2842
range selection method spend 0.01718425750732422
time for parepare:  0.017345428466796875
local_output_nid generation:  0.0008122920989990234
local_in_edges_tensor generation:  0.002827882766723633
mini_batch_src_global generation:  0.0016012191772460938
r_  generation:  0.010262012481689453
local_output_nid generation:  0.0008122920989990234
local_in_edges_tensor generation:  0.0006196498870849609
mini_batch_src_global generation:  0.0011692047119140625
r_  generation:  0.007065296173095703
local_output_nid generation:  0.0008618831634521484
local_in_edges_tensor generation:  0.0005083084106445312
mini_batch_src_global generation:  0.0007407665252685547
r_  generation:  0.006954669952392578
local_output_nid generation:  0.00075531005859375
local_in_edges_tensor generation:  0.0005059242248535156
mini_batch_src_global generation:  0.00067901611328125
r_  generation:  0.0066416263580322266
local_output_nid generation:  0.0007262229919433594
local_in_edges_tensor generation:  0.0004591941833496094
mini_batch_src_global generation:  0.0006518363952636719
r_  generation:  0.006868124008178711
local_output_nid generation:  0.0007281303405761719
local_in_edges_tensor generation:  0.00046133995056152344
mini_batch_src_global generation:  0.0006947517395019531
r_  generation:  0.007018089294433594
local_output_nid generation:  0.0008046627044677734
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.0006563663482666016
r_  generation:  0.0069732666015625
local_output_nid generation:  0.0007042884826660156
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.0006575584411621094
r_  generation:  0.007066965103149414
local_output_nid generation:  0.0007135868072509766
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.0006690025329589844
r_  generation:  0.0072040557861328125
local_output_nid generation:  0.0007824897766113281
local_in_edges_tensor generation:  0.00043964385986328125
mini_batch_src_global generation:  0.0006885528564453125
r_  generation:  0.007068157196044922
local_output_nid generation:  0.0007116794586181641
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0006957054138183594
r_  generation:  0.007264137268066406
local_output_nid generation:  0.0007889270782470703
local_in_edges_tensor generation:  0.0004551410675048828
mini_batch_src_global generation:  0.0006844997406005859
r_  generation:  0.0072290897369384766
local_output_nid generation:  0.0007851123809814453
local_in_edges_tensor generation:  0.00043320655822753906
mini_batch_src_global generation:  0.0006954669952392578
r_  generation:  0.0071010589599609375
local_output_nid generation:  0.0007109642028808594
local_in_edges_tensor generation:  0.00043773651123046875
mini_batch_src_global generation:  0.0007104873657226562
r_  generation:  0.007315158843994141
local_output_nid generation:  0.0007965564727783203
local_in_edges_tensor generation:  0.0004343986511230469
mini_batch_src_global generation:  0.0007109642028808594
r_  generation:  0.007462024688720703
local_output_nid generation:  0.0007061958312988281
local_in_edges_tensor generation:  0.0004303455352783203
mini_batch_src_global generation:  0.0006937980651855469
r_  generation:  0.007201433181762695
local_output_nid generation:  0.0007889270782470703
local_in_edges_tensor generation:  0.0004341602325439453
mini_batch_src_global generation:  0.0007078647613525391
r_  generation:  0.007448673248291016
local_output_nid generation:  0.0007016658782958984
local_in_edges_tensor generation:  0.0004367828369140625
mini_batch_src_global generation:  0.0006976127624511719
r_  generation:  0.007182121276855469
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0004425048828125
mini_batch_src_global generation:  0.0006859302520751953
r_  generation:  0.007046937942504883
local_output_nid generation:  0.0007979869842529297
local_in_edges_tensor generation:  0.00043082237243652344
mini_batch_src_global generation:  0.0007736682891845703
r_  generation:  0.00707697868347168
local_output_nid generation:  0.0007932186126708984
local_in_edges_tensor generation:  0.00043129920959472656
mini_batch_src_global generation:  0.0006918907165527344
r_  generation:  0.007136106491088867
local_output_nid generation:  0.0007038116455078125
local_in_edges_tensor generation:  0.00043582916259765625
mini_batch_src_global generation:  0.000705718994140625
r_  generation:  0.007289886474609375
local_output_nid generation:  0.0007109642028808594
local_in_edges_tensor generation:  0.00043487548828125
mini_batch_src_global generation:  0.0007507801055908203
r_  generation:  0.007582187652587891
local_output_nid generation:  0.0007848739624023438
local_in_edges_tensor generation:  0.0038039684295654297
mini_batch_src_global generation:  0.0009088516235351562
r_  generation:  0.007442951202392578
local_output_nid generation:  0.0007469654083251953
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.0008158683776855469
r_  generation:  0.0071866512298583984
local_output_nid generation:  0.0007541179656982422
local_in_edges_tensor generation:  0.0004520416259765625
mini_batch_src_global generation:  0.000766754150390625
r_  generation:  0.007310390472412109
local_output_nid generation:  0.0007929801940917969
local_in_edges_tensor generation:  0.0004458427429199219
mini_batch_src_global generation:  0.0007357597351074219
r_  generation:  0.007231950759887695
local_output_nid generation:  0.0007207393646240234
local_in_edges_tensor generation:  0.0004367828369140625
mini_batch_src_global generation:  0.0007076263427734375
r_  generation:  0.007070779800415039
local_output_nid generation:  0.0007483959197998047
local_in_edges_tensor generation:  0.0004367828369140625
mini_batch_src_global generation:  0.0007181167602539062
r_  generation:  0.007285118103027344
local_output_nid generation:  0.0008041858673095703
local_in_edges_tensor generation:  0.00044465065002441406
mini_batch_src_global generation:  0.0007078647613525391
r_  generation:  0.007138252258300781
local_output_nid generation:  0.0007092952728271484
local_in_edges_tensor generation:  0.0004336833953857422
mini_batch_src_global generation:  0.0007228851318359375
r_  generation:  0.007418632507324219
local_output_nid generation:  0.0007193088531494141
local_in_edges_tensor generation:  0.00043272972106933594
mini_batch_src_global generation:  0.0007207393646240234
r_  generation:  0.007324934005737305
----------------------check_connections_block total spend ----------------------------- 0.37732362747192383
generate_one_block  0.012422323226928711
generate_one_block  0.01190328598022461
generate_one_block  0.011791467666625977
generate_one_block  0.011592626571655273
generate_one_block  0.011582374572753906
generate_one_block  0.011664628982543945
generate_one_block  0.011562108993530273
generate_one_block  0.011838912963867188
generate_one_block  0.012004852294921875
generate_one_block  0.011669635772705078
generate_one_block  0.011835813522338867
generate_one_block  0.011648416519165039
generate_one_block  0.011521100997924805
generate_one_block  0.011826515197753906
generate_one_block  0.011910200119018555
generate_one_block  0.011578559875488281
generate_one_block  0.011820554733276367
generate_one_block  0.011498689651489258
generate_one_block  0.011584758758544922
generate_one_block  0.011470317840576172
generate_one_block  0.011485815048217773
generate_one_block  0.01192164421081543
generate_one_block  0.012088537216186523
generate_one_block  0.011838197708129883
generate_one_block  0.01151275634765625
generate_one_block  0.01185464859008789
generate_one_block  0.011471271514892578
generate_one_block  0.011444091796875
generate_one_block  0.01171112060546875
generate_one_block  0.011827707290649414
generate_one_block  0.012138605117797852
generate_one_block  0.012134075164794922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026134014129638672
gen group dst list time:  0.019489049911499023
time for parepare:  0.018465518951416016
local_output_nid generation:  0.0034742355346679688
local_in_edges_tensor generation:  0.00827789306640625
mini_batch_src_global generation:  0.005050182342529297
r_  generation:  0.05579328536987305
local_output_nid generation:  0.005583047866821289
local_in_edges_tensor generation:  0.0058612823486328125
mini_batch_src_global generation:  0.006471395492553711
r_  generation:  0.058290719985961914
local_output_nid generation:  0.005755424499511719
local_in_edges_tensor generation:  0.005072832107543945
mini_batch_src_global generation:  0.005506753921508789
r_  generation:  0.06137800216674805
local_output_nid generation:  0.0057604312896728516
local_in_edges_tensor generation:  0.005703926086425781
mini_batch_src_global generation:  0.005792140960693359
r_  generation:  0.059888362884521484
local_output_nid generation:  0.005532503128051758
local_in_edges_tensor generation:  0.006205558776855469
mini_batch_src_global generation:  0.00626826286315918
r_  generation:  0.061998605728149414
local_output_nid generation:  0.005730390548706055
local_in_edges_tensor generation:  0.006418704986572266
mini_batch_src_global generation:  0.006583452224731445
r_  generation:  0.06304788589477539
local_output_nid generation:  0.0057408809661865234
local_in_edges_tensor generation:  0.005959749221801758
mini_batch_src_global generation:  0.006463289260864258
r_  generation:  0.06237506866455078
local_output_nid generation:  0.005828142166137695
local_in_edges_tensor generation:  0.005152463912963867
mini_batch_src_global generation:  0.006913423538208008
r_  generation:  0.06397676467895508
local_output_nid generation:  0.005942821502685547
local_in_edges_tensor generation:  0.006620168685913086
mini_batch_src_global generation:  0.00687098503112793
r_  generation:  0.06434082984924316
local_output_nid generation:  0.0058476924896240234
local_in_edges_tensor generation:  0.005133390426635742
mini_batch_src_global generation:  0.006662845611572266
r_  generation:  0.06270575523376465
local_output_nid generation:  0.005963802337646484
local_in_edges_tensor generation:  0.005690574645996094
mini_batch_src_global generation:  0.006632328033447266
r_  generation:  0.06397175788879395
local_output_nid generation:  0.005970478057861328
local_in_edges_tensor generation:  0.005650997161865234
mini_batch_src_global generation:  0.0068285465240478516
r_  generation:  0.06359601020812988
local_output_nid generation:  0.005926847457885742
local_in_edges_tensor generation:  0.005583286285400391
mini_batch_src_global generation:  0.006566762924194336
r_  generation:  0.06867337226867676
local_output_nid generation:  0.006081104278564453
local_in_edges_tensor generation:  0.00623631477355957
mini_batch_src_global generation:  0.006978750228881836
r_  generation:  0.06406879425048828
local_output_nid generation:  0.006140470504760742
local_in_edges_tensor generation:  0.006271839141845703
mini_batch_src_global generation:  0.006991863250732422
r_  generation:  0.06975269317626953
local_output_nid generation:  0.0060787200927734375
local_in_edges_tensor generation:  0.005876779556274414
mini_batch_src_global generation:  0.006844282150268555
r_  generation:  0.06362056732177734
local_output_nid generation:  0.006124973297119141
local_in_edges_tensor generation:  0.005802154541015625
mini_batch_src_global generation:  0.006840944290161133
r_  generation:  0.06455802917480469
local_output_nid generation:  0.005942821502685547
local_in_edges_tensor generation:  0.006620645523071289
mini_batch_src_global generation:  0.006896018981933594
r_  generation:  0.06627082824707031
local_output_nid generation:  0.005973100662231445
local_in_edges_tensor generation:  0.006134510040283203
mini_batch_src_global generation:  0.0066547393798828125
r_  generation:  0.06357669830322266
local_output_nid generation:  0.0059659481048583984
local_in_edges_tensor generation:  0.005682945251464844
mini_batch_src_global generation:  0.006697177886962891
r_  generation:  0.06620025634765625
local_output_nid generation:  0.006000041961669922
local_in_edges_tensor generation:  0.005686283111572266
mini_batch_src_global generation:  0.006769657135009766
r_  generation:  0.06372356414794922
local_output_nid generation:  0.006043672561645508
local_in_edges_tensor generation:  0.00622105598449707
mini_batch_src_global generation:  0.007239818572998047
r_  generation:  0.06457638740539551
local_output_nid generation:  0.006239175796508789
local_in_edges_tensor generation:  0.006426334381103516
mini_batch_src_global generation:  0.007047176361083984
r_  generation:  0.0657198429107666
local_output_nid generation:  0.006227016448974609
local_in_edges_tensor generation:  0.008718490600585938
mini_batch_src_global generation:  0.006954193115234375
r_  generation:  0.06568741798400879
local_output_nid generation:  0.006033658981323242
local_in_edges_tensor generation:  0.0057451725006103516
mini_batch_src_global generation:  0.006866931915283203
r_  generation:  0.06647872924804688
local_output_nid generation:  0.0062940120697021484
local_in_edges_tensor generation:  0.005934238433837891
mini_batch_src_global generation:  0.00735783576965332
r_  generation:  0.06552720069885254
local_output_nid generation:  0.006097316741943359
local_in_edges_tensor generation:  0.005765676498413086
mini_batch_src_global generation:  0.006875514984130859
r_  generation:  0.06694293022155762
local_output_nid generation:  0.006076335906982422
local_in_edges_tensor generation:  0.00569462776184082
mini_batch_src_global generation:  0.006629228591918945
r_  generation:  0.06358480453491211
local_output_nid generation:  0.006215572357177734
local_in_edges_tensor generation:  0.005881547927856445
mini_batch_src_global generation:  0.006865024566650391
r_  generation:  0.0666971206665039
local_output_nid generation:  0.006175994873046875
local_in_edges_tensor generation:  0.00674748420715332
mini_batch_src_global generation:  0.0070133209228515625
r_  generation:  0.06345319747924805
local_output_nid generation:  0.006257295608520508
local_in_edges_tensor generation:  0.009006977081298828
mini_batch_src_global generation:  0.008282184600830078
r_  generation:  0.06549668312072754
local_output_nid generation:  0.007151603698730469
local_in_edges_tensor generation:  0.006525754928588867
mini_batch_src_global generation:  0.007122993469238281
r_  generation:  0.07148098945617676
----------------------check_connections_block total spend ----------------------------- 3.165609836578369
generate_one_block  0.08503913879394531
generate_one_block  0.10668349266052246
generate_one_block  0.08361530303955078
generate_one_block  0.08450818061828613
generate_one_block  0.08305501937866211
generate_one_block  0.0835103988647461
generate_one_block  0.08222556114196777
generate_one_block  0.0843045711517334
generate_one_block  0.08483386039733887
generate_one_block  0.0826563835144043
generate_one_block  0.08377933502197266
generate_one_block  0.08430743217468262
generate_one_block  0.0840005874633789
generate_one_block  0.08474469184875488
generate_one_block  0.0863792896270752
generate_one_block  0.08378338813781738
generate_one_block  0.08457255363464355
generate_one_block  0.08194994926452637
generate_one_block  0.08131217956542969
generate_one_block  0.0822305679321289
generate_one_block  0.0822455883026123
generate_one_block  0.0855252742767334
generate_one_block  0.08713769912719727
generate_one_block  0.08747577667236328
generate_one_block  0.08637166023254395
generate_one_block  0.08931660652160645
generate_one_block  0.08604860305786133
generate_one_block  0.08560585975646973
generate_one_block  0.08609628677368164
generate_one_block  0.08816242218017578
generate_one_block  0.08952951431274414
generate_one_block  0.11656761169433594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  3.165609836578369
block generation total time  2.7675747871398926
average batch blocks generation time:  0.08648671209812164
pseudo mini batch 0 input nodes size: 69374
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.0359807014465332  GigaBytes
Max Memory Allocated: 0.0359807014465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.036002159118652344  GigaBytes
Max Memory Allocated: 0.036002159118652344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.036002159118652344  GigaBytes
Max Memory Allocated: 0.036002159118652344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03738594055175781  GigaBytes
Max Memory Allocated: 0.03738594055175781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03738594055175781  GigaBytes
Max Memory Allocated: 0.03738594055175781  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03738594055175781  GigaBytes
Max Memory Allocated: 0.03738594055175781  GigaBytes

torch.Size([69374, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.03738594055175781  GigaBytes
Max Memory Allocated: 0.03738594055175781  GigaBytes

m.shape torch.Size([865, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.1179208755493164  GigaBytes
Max Memory Allocated: 0.11999320983886719  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.1179208755493164  GigaBytes
Max Memory Allocated: 0.11999320983886719  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.11874580383300781  GigaBytes
Max Memory Allocated: 0.11999320983886719  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12534523010253906  GigaBytes
Max Memory Allocated: 0.12575769424438477  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([1073, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12595605850219727  GigaBytes
Max Memory Allocated: 0.12598037719726562  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12595605850219727  GigaBytes
Max Memory Allocated: 0.12598037719726562  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.12697935104370117  GigaBytes
Max Memory Allocated: 0.12697935104370117  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.14232873916625977  GigaBytes
Max Memory Allocated: 0.14360761642456055  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1174, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.14349651336669922  GigaBytes
Max Memory Allocated: 0.14360761642456055  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.14349651336669922  GigaBytes
Max Memory Allocated: 0.14360761642456055  GigaBytes

 h.shape torch.Size([1, 1174, 128]), torch.Size([1, 1174, 128])
----------------------------------------3
 Nvidia-smi: 1.3514404296875 GB
    Memory Allocated: 0.14461612701416016  GigaBytes
Max Memory Allocated: 0.14461612701416016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.16924762725830078  GigaBytes
Max Memory Allocated: 0.17142486572265625  GigaBytes

rst.shape  torch.Size([1, 1174, 128])
m.shape torch.Size([1086, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.17086505889892578  GigaBytes
Max Memory Allocated: 0.17142486572265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.17086505889892578  GigaBytes
Max Memory Allocated: 0.17142486572265625  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.17190074920654297  GigaBytes
Max Memory Allocated: 0.17190074920654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20248889923095703  GigaBytes
Max Memory Allocated: 0.2045602798461914  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([1013, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20438623428344727  GigaBytes
Max Memory Allocated: 0.2045602798461914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.20438623428344727  GigaBytes
Max Memory Allocated: 0.2045602798461914  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 1.4022216796875 GB
    Memory Allocated: 0.2053523063659668  GigaBytes
Max Memory Allocated: 0.2053523063659668  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.2413034439086914  GigaBytes
Max Memory Allocated: 0.24371862411499023  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([977, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.24361562728881836  GigaBytes
Max Memory Allocated: 0.24371862411499023  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.24361562728881836  GigaBytes
Max Memory Allocated: 0.24371862411499023  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.24454736709594727  GigaBytes
Max Memory Allocated: 0.24454736709594727  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.2855086326599121  GigaBytes
Max Memory Allocated: 0.28830385208129883  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([915, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.28809690475463867  GigaBytes
Max Memory Allocated: 0.28830385208129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.28809690475463867  GigaBytes
Max Memory Allocated: 0.28830385208129883  GigaBytes

 h.shape torch.Size([1, 915, 128]), torch.Size([1, 915, 128])
----------------------------------------3
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.2889695167541504  GigaBytes
Max Memory Allocated: 0.2889695167541504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.3334674835205078  GigaBytes
Max Memory Allocated: 0.33652162551879883  GigaBytes

rst.shape  torch.Size([1, 915, 128])
m.shape torch.Size([792, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.33605241775512695  GigaBytes
Max Memory Allocated: 0.33652162551879883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.33605241775512695  GigaBytes
Max Memory Allocated: 0.33652162551879883  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.3368077278137207  GigaBytes
Max Memory Allocated: 0.3368077278137207  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.3807406425476074  GigaBytes
Max Memory Allocated: 0.3837618827819824  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([801, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.3838005065917969  GigaBytes
Max Memory Allocated: 0.3838815689086914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.3838005065917969  GigaBytes
Max Memory Allocated: 0.3838815689086914  GigaBytes

 h.shape torch.Size([1, 801, 128]), torch.Size([1, 801, 128])
----------------------------------------3
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.3845643997192383  GigaBytes
Max Memory Allocated: 0.3845643997192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.4343380928039551  GigaBytes
Max Memory Allocated: 0.4377756118774414  GigaBytes

rst.shape  torch.Size([1, 801, 128])
m.shape torch.Size([12117, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.4925498962402344  GigaBytes
Max Memory Allocated: 0.49390459060668945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.4925498962402344  GigaBytes
Max Memory Allocated: 0.49390459060668945  GigaBytes

 h.shape torch.Size([1, 12117, 128]), torch.Size([1, 12117, 128])
----------------------------------------3
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5041089057922363  GigaBytes
Max Memory Allocated: 0.5041089057922363  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.3343462944030762  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

rst.shape  torch.Size([1, 12117, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.2599730491638184  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.2798218727111816  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.299670696258545  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.2796664237976074  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

torch.Size([20813, 256])
first layer input nodes number: 69374
first layer output nodes number: 20813
edges number: 162924
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.30018949508667  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.3200383186340332  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.3250007629394531  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.6131591796875 GB
    Memory Allocated: 1.3250007629394531  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.347402572631836  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.347402572631836  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3482551574707031  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3561153411865234  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([368, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3563966751098633  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3563966751098633  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3570985794067383  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3715968132019043  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3721628189086914  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3721628189086914  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3727693557739258  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.3865489959716797  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([199, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.3870110511779785  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.3870110511779785  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.3873906135559082  GigaBytes
Max Memory Allocated: 1.3929400444030762  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.3983979225158691  GigaBytes
Max Memory Allocated: 1.3991570472717285  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.399087905883789  GigaBytes
Max Memory Allocated: 1.3991570472717285  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.399087905883789  GigaBytes
Max Memory Allocated: 1.3991570472717285  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.3994369506835938  GigaBytes
Max Memory Allocated: 1.3994369506835938  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 1.4120025634765625  GigaBytes
Max Memory Allocated: 1.4128751754760742  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([173, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 1.4130339622497559  GigaBytes
Max Memory Allocated: 1.4130382537841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 1.4130339622497559  GigaBytes
Max Memory Allocated: 1.4130382537841797  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 2.6697998046875 GB
    Memory Allocated: 1.4133639335632324  GigaBytes
Max Memory Allocated: 1.4133639335632324  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6854248046875 GB
    Memory Allocated: 1.4275527000427246  GigaBytes
Max Memory Allocated: 1.4285426139831543  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.4282422065734863  GigaBytes
Max Memory Allocated: 1.4285426139831543  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.4282422065734863  GigaBytes
Max Memory Allocated: 1.4285426139831543  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.4284844398498535  GigaBytes
Max Memory Allocated: 1.4285426139831543  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 1.440596103668213  GigaBytes
Max Memory Allocated: 1.441443920135498  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 1.441190242767334  GigaBytes
Max Memory Allocated: 1.441443920135498  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 1.441190242767334  GigaBytes
Max Memory Allocated: 1.441443920135498  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.6932373046875 GB
    Memory Allocated: 1.4413676261901855  GigaBytes
Max Memory Allocated: 1.441443920135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7030029296875 GB
    Memory Allocated: 1.4514784812927246  GigaBytes
Max Memory Allocated: 1.4521880149841309  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7030029296875 GB
    Memory Allocated: 1.452211856842041  GigaBytes
Max Memory Allocated: 1.4522151947021484  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7030029296875 GB
    Memory Allocated: 1.452211856842041  GigaBytes
Max Memory Allocated: 1.4522151947021484  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 2.7030029296875 GB
    Memory Allocated: 1.4523930549621582  GigaBytes
Max Memory Allocated: 1.4523930549621582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.4639897346496582  GigaBytes
Max Memory Allocated: 1.4648051261901855  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.464735507965088  GigaBytes
Max Memory Allocated: 1.4648051261901855  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.464735507965088  GigaBytes
Max Memory Allocated: 1.4648051261901855  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 2.7166748046875 GB
    Memory Allocated: 1.4649014472961426  GigaBytes
Max Memory Allocated: 1.4649014472961426  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 1.4766831398010254  GigaBytes
Max Memory Allocated: 1.4775128364562988  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 1.4772133827209473  GigaBytes
Max Memory Allocated: 1.4775128364562988  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 1.4772133827209473  GigaBytes
Max Memory Allocated: 1.4775128364562988  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 1.4773240089416504  GigaBytes
Max Memory Allocated: 1.4775128364562988  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.4859528541564941  GigaBytes
Max Memory Allocated: 1.4865612983703613  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.4865784645080566  GigaBytes
Max Memory Allocated: 1.4865813255310059  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.4865784645080566  GigaBytes
Max Memory Allocated: 1.4865813255310059  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.4866909980773926  GigaBytes
Max Memory Allocated: 1.4866909980773926  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.4962563514709473  GigaBytes
Max Memory Allocated: 1.496931552886963  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.4967751502990723  GigaBytes
Max Memory Allocated: 1.496931552886963  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.4967751502990723  GigaBytes
Max Memory Allocated: 1.496931552886963  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.7479248046875 GB
    Memory Allocated: 1.4968628883361816  GigaBytes
Max Memory Allocated: 1.496931552886963  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 1.5049347877502441  GigaBytes
Max Memory Allocated: 1.505505084991455  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 1.5054831504821777  GigaBytes
Max Memory Allocated: 1.505505084991455  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 1.5054831504821777  GigaBytes
Max Memory Allocated: 1.505505084991455  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 1.5055670738220215  GigaBytes
Max Memory Allocated: 1.5055670738220215  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.5138754844665527  GigaBytes
Max Memory Allocated: 1.514462947845459  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.5144391059875488  GigaBytes
Max Memory Allocated: 1.514462947845459  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.5144391059875488  GigaBytes
Max Memory Allocated: 1.514462947845459  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.514519214630127  GigaBytes
Max Memory Allocated: 1.514519214630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.5230107307434082  GigaBytes
Max Memory Allocated: 1.5236115455627441  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.5235090255737305  GigaBytes
Max Memory Allocated: 1.5236115455627441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.5235090255737305  GigaBytes
Max Memory Allocated: 1.5236115455627441  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 2.7733154296875 GB
    Memory Allocated: 1.523575782775879  GigaBytes
Max Memory Allocated: 1.5236115455627441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.5311193466186523  GigaBytes
Max Memory Allocated: 1.5316534042358398  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.531609058380127  GigaBytes
Max Memory Allocated: 1.5316534042358398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.531609058380127  GigaBytes
Max Memory Allocated: 1.5316534042358398  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.7811279296875 GB
    Memory Allocated: 1.531670093536377  GigaBytes
Max Memory Allocated: 1.531670093536377  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.538994312286377  GigaBytes
Max Memory Allocated: 1.539513111114502  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.5395350456237793  GigaBytes
Max Memory Allocated: 1.5395374298095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.5395350456237793  GigaBytes
Max Memory Allocated: 1.5395374298095703  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.7889404296875 GB
    Memory Allocated: 1.539597988128662  GigaBytes
Max Memory Allocated: 1.539597988128662  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5475916862487793  GigaBytes
Max Memory Allocated: 1.5481581687927246  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5481629371643066  GigaBytes
Max Memory Allocated: 1.5481653213500977  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5481629371643066  GigaBytes
Max Memory Allocated: 1.5481653213500977  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 2.7967529296875 GB
    Memory Allocated: 1.5482258796691895  GigaBytes
Max Memory Allocated: 1.5482258796691895  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.5566601753234863  GigaBytes
Max Memory Allocated: 1.557258129119873  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.5570712089538574  GigaBytes
Max Memory Allocated: 1.557258129119873  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.5570712089538574  GigaBytes
Max Memory Allocated: 1.557258129119873  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 2.8065185546875 GB
    Memory Allocated: 1.557115077972412  GigaBytes
Max Memory Allocated: 1.557258129119873  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 1.563300609588623  GigaBytes
Max Memory Allocated: 1.56373929977417  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 1.5636420249938965  GigaBytes
Max Memory Allocated: 1.56373929977417  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 1.5636420249938965  GigaBytes
Max Memory Allocated: 1.56373929977417  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 2.8123779296875 GB
    Memory Allocated: 1.563676357269287  GigaBytes
Max Memory Allocated: 1.56373929977417  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8182373046875 GB
    Memory Allocated: 1.5687575340270996  GigaBytes
Max Memory Allocated: 1.5691180229187012  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.8182373046875 GB
    Memory Allocated: 1.5690155029296875  GigaBytes
Max Memory Allocated: 1.5691180229187012  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8182373046875 GB
    Memory Allocated: 1.5690155029296875  GigaBytes
Max Memory Allocated: 1.5691180229187012  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.8182373046875 GB
    Memory Allocated: 1.569040298461914  GigaBytes
Max Memory Allocated: 1.5691180229187012  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8221435546875 GB
    Memory Allocated: 1.5728836059570312  GigaBytes
Max Memory Allocated: 1.5731563568115234  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.8221435546875 GB
    Memory Allocated: 1.5733137130737305  GigaBytes
Max Memory Allocated: 1.5733156204223633  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8221435546875 GB
    Memory Allocated: 1.5733137130737305  GigaBytes
Max Memory Allocated: 1.5733156204223633  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.8221435546875 GB
    Memory Allocated: 1.5733518600463867  GigaBytes
Max Memory Allocated: 1.5733518600463867  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.5795316696166992  GigaBytes
Max Memory Allocated: 1.579970359802246  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.579789638519287  GigaBytes
Max Memory Allocated: 1.579970359802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.579789638519287  GigaBytes
Max Memory Allocated: 1.579970359802246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 1.5798125267028809  GigaBytes
Max Memory Allocated: 1.579970359802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.5836806297302246  GigaBytes
Max Memory Allocated: 1.5839552879333496  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([284, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.5904932022094727  GigaBytes
Max Memory Allocated: 1.590519905090332  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.5904932022094727  GigaBytes
Max Memory Allocated: 1.590519905090332  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 2.8338623046875 GB
    Memory Allocated: 1.5910348892211914  GigaBytes
Max Memory Allocated: 1.5910348892211914  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.6883635520935059  GigaBytes
Max Memory Allocated: 1.6951346397399902  GigaBytes

rst.shape  torch.Size([1, 284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.6690545082092285  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.669478416442871  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.6699023246765137  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.669456958770752  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

torch.Size([2842, 40])
input nodes number: 20813
output nodes number: 2842
edges number: 22731
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.670057773590088  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8865966796875 GB
    Memory Allocated: 1.6700587272644043  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.04315519332885742  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

pseudo mini batch 1 input nodes size: 69902
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.07253408432006836  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.0725555419921875  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.03933095932006836  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.04072999954223633  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.04072999954223633  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.04072999954223633  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

torch.Size([69902, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9139404296875 GB
    Memory Allocated: 0.04072999954223633  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.12157869338989258  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.12157869338989258  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.12234354019165039  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.12855768203735352  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([1091, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.12921571731567383  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.12921571731567383  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.13025617599487305  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.14586305618286133  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1066, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1468677520751953  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1468677520751953  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.14788436889648438  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.17024993896484375  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1114, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.17186641693115234  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.17186641693115234  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.1729288101196289  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.2041463851928711  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1145, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.2063450813293457  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.2063450813293457  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 1145, 128]), torch.Size([1, 1145, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.20743703842163086  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.24674749374389648  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 1145, 128])
m.shape torch.Size([956, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.24893665313720703  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.24893665313720703  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.2498483657836914  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.2900552749633789  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([919, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.2926669120788574  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.2926669120788574  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 919, 128]), torch.Size([1, 919, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.29354333877563477  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.3380908966064453  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 919, 128])
m.shape torch.Size([891, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.3410515785217285  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.3410515785217285  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.3419013023376465  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.3918476104736328  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([752, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.3946499824523926  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.3946499824523926  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 752, 128]), torch.Size([1, 752, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.3953671455383301  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.44225549697875977  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 752, 128])
m.shape torch.Size([12210, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.500490665435791  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.500490665435791  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 12210, 128]), torch.Size([1, 12210, 128])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 0.5121350288391113  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3433480262756348  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 12210, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.268664836883545  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.2886404991149902  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3086161613464355  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.2884840965270996  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

torch.Size([20946, 256])
first layer input nodes number: 69902
first layer output nodes number: 20946
edges number: 164528
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3091392517089844  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3291149139404297  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3344011306762695  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3344011306762695  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3571105003356934  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3571105003356934  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3578753471374512  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3655991554260254  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([366, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3659205436706543  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3659205436706543  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3666186332702637  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.379788875579834  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([271, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3802213668823242  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3802213668823242  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3807382583618164  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.393223762512207  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([252, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3939342498779297  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3939342498779297  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.3944149017333984  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4083538055419922  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([226, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4091997146606445  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4091997146606445  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4096307754516602  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4251489639282227  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4258275032043457  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4258275032043457  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4261231422424316  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.438835620880127  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4395627975463867  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4395627975463867  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4398107528686523  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4522085189819336  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4527997970581055  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4527997970581055  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.452977180480957  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.463088035583496  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.463864803314209  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.463864803314209  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4640555381774902  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4762625694274902  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4769172668457031  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4769172668457031  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4770660400390625  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4876289367675781  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4884004592895508  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4884004592895508  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.4885530471801758  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5004549026489258  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5011630058288574  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5011630058288574  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5012927055358887  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.512317180633545  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5128273963928223  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5128273963928223  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5129151344299316  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5209870338439941  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.521522045135498  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.521522045135498  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.521604061126709  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5297236442565918  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5301156044006348  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5301156044006348  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5301728248596191  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.536238193511963  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5367016792297363  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5367016792297363  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5367627143859863  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5436596870422363  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5440707206726074  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5440707206726074  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5441222190856934  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5503020286560059  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.550795555114746  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.550795555114746  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5508527755737305  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.558119773864746  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5584931373596191  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5584931373596191  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.558535099029541  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5641579627990723  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.564694881439209  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.564694881439209  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5647501945495605  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5725493431091309  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5729660987854004  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5729660987854004  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5730080604553223  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5792183876037598  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5796418190002441  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5796418190002441  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5796818733215332  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.585890293121338  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5860915184020996  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5860915184020996  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5861105918884277  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.589200496673584  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5895371437072754  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5895371437072754  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5895657539367676  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.5944008827209473  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.6014752388000488  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.6014752388000488  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 2.9940185546875 GB
    Memory Allocated: 1.6020379066467285  GigaBytes
Max Memory Allocated: 1.6962323188781738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9998779296875 GB
    Memory Allocated: 1.7039484977722168  GigaBytes
Max Memory Allocated: 1.710981845855713  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.9998779296875 GB
    Memory Allocated: 1.6842803955078125  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.9998779296875 GB
    Memory Allocated: 1.684704303741455  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.9998779296875 GB
    Memory Allocated: 1.6851282119750977  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9998779296875 GB
    Memory Allocated: 1.684682846069336  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

torch.Size([2842, 40])
input nodes number: 20946
output nodes number: 2842
edges number: 23092
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9998779296875 GB
    Memory Allocated: 1.6848607063293457  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9998779296875 GB
    Memory Allocated: 1.684861183166504  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.04332447052001953  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

pseudo mini batch 2 input nodes size: 70700
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.03933095932006836  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.03933095932006836  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.0730433464050293  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.07306480407714844  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.03971147537231445  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.0411381721496582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.0411381721496582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.0411381721496582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

torch.Size([70700, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.0037841796875 GB
    Memory Allocated: 0.0411381721496582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

m.shape torch.Size([844, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.12378072738647461  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.12378072738647461  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.12458562850952148  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.13126277923583984  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([1110, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.13191890716552734  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.13191890716552734  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.13297748565673828  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.14885616302490234  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1101, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.1508769989013672  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.1508769989013672  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.15192699432373047  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.1756582260131836  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1071, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.17717599868774414  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.17717599868774414  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.17819738388061523  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.20781755447387695  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1115, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.20996522903442383  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.20996522903442383  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.2110285758972168  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.2498950958251953  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([913, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.25197553634643555  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.25197553634643555  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 913, 128]), torch.Size([1, 913, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.25284624099731445  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.2911381721496582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 913, 128])
m.shape torch.Size([891, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.29367685317993164  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.29367685317993164  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.2945265769958496  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.33785009384155273  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([901, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.3408622741699219  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.3408622741699219  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.3417215347290039  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.39197349548339844  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([822, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.39507150650024414  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.39507150650024414  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.3958554267883301  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.4467434883117676  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([12561, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.5062470436096191  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.5062470436096191  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 12561, 128]), torch.Size([1, 12561, 128])
----------------------------------------3
 Nvidia-smi: 3.0858154296875 GB
    Memory Allocated: 0.518226146697998  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3699264526367188  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 12561, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.2935185432434082  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.313859462738037  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.334200382232666  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3137001991271973  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

torch.Size([21329, 256])
first layer input nodes number: 70700
first layer output nodes number: 21329
edges number: 168157
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3347291946411133  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3550701141357422  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3601555824279785  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3601555824279785  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3830857276916504  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3830857276916504  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3839154243469238  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.391733169555664  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3919930458068848  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3919930458068848  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.392662525177002  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4032654762268066  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4037961959838867  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4037961959838867  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4043684005737305  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4188847541809082  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4194369316101074  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4194369316101074  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4198527336120605  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4319109916687012  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4325733184814453  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4325733184814453  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4329185485839844  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4453468322753906  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4460453987121582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4460453987121582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.446333408355713  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4587178230285645  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4593749046325684  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4593749046325684  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.459601879119873  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4709506034851074  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4717755317687988  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4717755317687988  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.472008228302002  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.48527193069458  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4859776496887207  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4859776496887207  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.486158847808838  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.497755527496338  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4984822273254395  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4984822273254395  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4986443519592285  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.510155200958252  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5109624862670898  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5109624862670898  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.511122703552246  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5236196517944336  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5242319107055664  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5242319107055664  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5243463516235352  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.534073829650879  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5346665382385254  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5346665382385254  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5347657203674316  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5438904762268066  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5444464683532715  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5444464683532715  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.544532299041748  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5530295372009277  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.553635597229004  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.553635597229004  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5537214279174805  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.562819480895996  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5632686614990234  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5632686614990234  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5633296966552734  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5702266693115234  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5705723762512207  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5705723762512207  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5706162452697754  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.575880527496338  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.576343059539795  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.576343059539795  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5763964653015137  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.583178997039795  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5835542678833008  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5835542678833008  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5835962295532227  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.589219093322754  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5895252227783203  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5895252227783203  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5895576477050781  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5941295623779297  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5944972038269043  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5944972038269043  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5945334434509277  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5998969078063965  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.600153923034668  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.600153923034668  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6001787185668945  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6040220260620117  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.604252815246582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.604252815246582  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.604273796081543  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6076726913452148  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.608123779296875  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.608123779296875  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6081619262695312  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6146087646484375  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([314, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6221346855163574  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6221346855163574  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6227335929870605  GigaBytes
Max Memory Allocated: 1.7118048667907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7375035285949707  GigaBytes
Max Memory Allocated: 1.7449898719787598  GigaBytes

rst.shape  torch.Size([1, 314, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7176299095153809  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7180538177490234  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.718477725982666  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7180323600769043  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([2842, 40])
input nodes number: 21329
output nodes number: 2842
edges number: 23292
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7182130813598633  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7182135581970215  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04377555847167969  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

pseudo mini batch 3 input nodes size: 69979
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03971147537231445  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03971147537231445  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.07308006286621094  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.07310152053833008  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03936767578125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.040764808654785156  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.040764808654785156  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.040764808654785156  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([69979, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.040764808654785156  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12165117263793945  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12165117263793945  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12243986129760742  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12877416610717773  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([1067, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12939739227294922  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12939739227294922  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1304149627685547  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.14567852020263672  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([1123, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1467761993408203  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1467761993408203  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.14784717559814453  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1716623306274414  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([1094, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.17321348190307617  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.17321348190307617  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1742568016052246  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.20526456832885742  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1074, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.20730352401733398  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.20730352401733398  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2083277702331543  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.24563074111938477  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2479567527770996  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2479567527770996  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2489027976989746  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2901930809020996  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([916, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.29277753829956055  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.29277753829956055  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.29365110397338867  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.338101863861084  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([912, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3411440849304199  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3411440849304199  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3420138359069824  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.39236021041870117  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([800, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3953585624694824  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3953585624694824  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3961215019226074  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.4458351135253906  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([12164, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5040473937988281  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5040473937988281  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 12164, 128]), torch.Size([1, 12164, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5156478881835938  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3463783264160156  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 12164, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.2717022895812988  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.2916998863220215  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3116974830627441  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.2915434837341309  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([20969, 256])
first layer input nodes number: 69979
first layer output nodes number: 20969
edges number: 164576
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3122210502624512  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3322186470031738  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3374462127685547  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3374462127685547  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

m.shape torch.Size([437, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3599472045898438  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3599472045898438  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3607807159423828  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3688392639160156  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3691205978393555  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3691205978393555  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3698129653930664  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3838520050048828  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([279, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3843107223510742  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3843107223510742  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.384842872619629  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.397486686706543  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.398108959197998  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.398108959197998  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3985495567321777  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4113268852233887  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4121975898742676  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4121975898742676  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.412630558013916  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4282174110412598  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4288430213928223  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4288430213928223  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.429121494293213  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4410958290100098  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4418177604675293  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4418177604675293  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4420619010925293  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4542689323425293  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.455000400543213  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.455000400543213  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.455212116241455  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4672799110412598  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4679527282714844  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4679527282714844  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4681243896484375  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4791107177734375  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.479736328125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.479736328125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4798774719238281  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.489898681640625  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4905896186828613  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4905896186828613  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4907269477844238  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5014386177062988  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.501993179321289  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.501993179321289  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.502096176147461  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5108509063720703  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5114741325378418  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5114741325378418  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5115771293640137  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5210528373718262  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.521378517150879  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.521378517150879  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5214319229125977  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.526719093322754  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5272979736328125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5272979736328125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5273780822753906  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5358695983886719  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5363988876342773  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5363988876342773  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5364694595336914  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5444440841674805  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5448174476623535  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5448174476623535  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5448651313781738  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5505871772766113  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5511689186096191  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5511689186096191  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5512356758117676  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5597138404846191  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5602102279663086  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5602102279663086  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5602655410766602  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5676774978637695  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5680923461914062  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5680923461914062  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.568136215209961  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5743217468261719  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5746631622314453  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5746631622314453  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.574697494506836  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5797786712646484  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5801844596862793  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5801844596862793  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5802226066589355  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5861353874206543  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5864481925964355  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5864481925964355  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5864768028259277  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.591111660003662  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.591374397277832  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.591374397277832  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5913972854614258  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5952653884887695  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([292, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6022706031799316  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6022706031799316  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.602827548980713  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7031617164611816  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 292, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6837372779846191  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6841611862182617  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6845850944519043  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6841397285461426  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([2842, 40])
input nodes number: 20969
output nodes number: 2842
edges number: 22842
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6843175888061523  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6843180656433105  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04335594177246094  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

pseudo mini batch 4 input nodes size: 70412
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03936767578125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03936767578125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.07294273376464844  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.07296419143676758  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03957414627075195  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04098176956176758  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04098176956176758  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04098176956176758  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([70412, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04098176956176758  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

m.shape torch.Size([843, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12242269515991211  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12242269515991211  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12322664260864258  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12965822219848633  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([1070, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.13032197952270508  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.13032197952270508  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.13134241104125977  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.14664888381958008  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([1134, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.14860105514526367  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.14860105514526367  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.14968252182006836  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1735396385192871  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1058, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1750168800354004  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1750168800354004  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1760258674621582  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.20528650283813477  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([1082, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.20736169815063477  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.20736169815063477  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1082, 128]), torch.Size([1, 1082, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.20839357376098633  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.24712324142456055  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1082, 128])
m.shape torch.Size([987, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.24943113327026367  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.24943113327026367  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.25037240982055664  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2915530204772949  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([940, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.294219970703125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.294219970703125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2951164245605469  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.34001731872558594  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([879, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3429222106933594  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3429222106933594  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.34376049041748047  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3921661376953125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([810, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.39522314071655273  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.39522314071655273  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3959956169128418  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.44549131393432617  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([12285, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5036988258361816  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5036988258361816  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 12285, 128]), torch.Size([1, 12285, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5154147148132324  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3478269577026367  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 12285, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.2726140022277832  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.2927250862121582  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3128361701965332  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.2925677299499512  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([21088, 256])
first layer input nodes number: 70412
first layer output nodes number: 21088
edges number: 165701
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3133630752563477  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3334741592407227  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3387537002563477  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3387537002563477  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

m.shape torch.Size([424, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3615002632141113  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3615002632141113  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3623089790344238  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3697986602783203  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([329, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3700270652770996  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3700270652770996  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.370654582977295  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3823184967041016  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.382826805114746  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.382826805114746  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3833703994750977  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3960447311401367  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3966574668884277  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3966574668884277  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3970961570739746  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.409818172454834  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4105987548828125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4105987548828125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.410989761352539  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4250659942626953  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([174, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4258742332458496  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4258742332458496  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.426206111907959  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.440476894378662  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([155, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4413537979125977  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4413537979125977  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4416494369506836  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4564313888549805  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.457137107849121  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.457137107849121  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4573488235473633  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.469416618347168  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4700636863708496  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4700636863708496  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4702296257019043  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4808497428894043  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4815168380737305  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4815168380737305  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4816656112670898  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4922285079956055  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4928946495056152  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4928946495056152  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.493028163909912  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5034422874450684  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5039987564086914  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5039987564086914  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5041017532348633  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5128564834594727  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5135550498962402  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5135550498962402  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.513669490814209  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.524198055267334  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5246391296386719  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5246391296386719  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.524709701538086  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5316963195800781  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.532266616821289  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.532266616821289  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5323467254638672  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5408382415771484  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.541290283203125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.541290283203125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.541351318359375  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.548248291015625  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5488390922546387  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5488390922546387  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5489115715026855  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5576090812683105  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5580401420593262  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5580401420593262  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.558091640472412  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5646319389343262  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5651359558105469  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5651359558105469  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5651912689208984  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5726032257080078  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.572960376739502  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.572960376739502  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5729985237121582  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5783772468566895  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5787014961242676  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5787014961242676  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5787339210510254  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5835328102111816  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.583855152130127  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.583855152130127  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.583885669708252  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.588615894317627  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5889325141906738  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5889325141906738  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.588961124420166  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5935959815979004  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5941123962402344  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5941123962402344  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.594156265258789  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6015701293945312  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([284, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6083722114562988  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6083722114562988  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6089138984680176  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.706395149230957  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6867222785949707  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6871461868286133  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6875700950622559  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6871247291564941  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([2842, 40])
input nodes number: 21088
output nodes number: 2842
edges number: 23109
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6873035430908203  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6873040199279785  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04359149932861328  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

pseudo mini batch 5 input nodes size: 70743
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03957414627075195  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03957414627075195  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.07330703735351562  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.07332849502563477  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.03973197937011719  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04115867614746094  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04115867614746094  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04115867614746094  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([70743, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.04115867614746094  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

m.shape torch.Size([854, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12377452850341797  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.12377452850341797  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1245889663696289  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.13135576248168945  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([1076, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1319746971130371  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1319746971130371  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.13300085067749023  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1483931541442871  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([1208, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.14960813522338867  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.14960813522338867  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1208, 128]), torch.Size([1, 1208, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.15076017379760742  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.17610502243041992  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1208, 128])
m.shape torch.Size([1084, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1775965690612793  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.1775965690612793  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.17863035202026367  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.20929670333862305  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1106, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.21141672134399414  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.21141672134399414  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.21247148513793945  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.25121641159057617  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1000, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.25355005264282227  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.25355005264282227  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 1000, 128]), torch.Size([1, 1000, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2545037269592285  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.29677438735961914  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 1000, 128])
m.shape torch.Size([914, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2993483543395996  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.2993483543395996  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 914, 128]), torch.Size([1, 914, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.3002200126647949  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.34445619583129883  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 914, 128])
m.shape torch.Size([891, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.34741926193237305  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.34741926193237305  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.348268985748291  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.39820241928100586  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([823, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.4013094902038574  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.4013094902038574  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.40209436416625977  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.45454883575439453  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([12466, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5135989189147949  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5135989189147949  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 12466, 128]), torch.Size([1, 12466, 128])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 0.5254874229431152  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3704209327697754  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 12466, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.294135570526123  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3145651817321777  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3349947929382324  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3144054412841797  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

torch.Size([21422, 256])
first layer input nodes number: 70743
first layer output nodes number: 21422
edges number: 168089
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.335524082183838  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3559536933898926  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3618979454040527  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3618979454040527  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

m.shape torch.Size([437, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3848037719726562  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3848037719726562  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3856372833251953  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.392399787902832  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3926753997802734  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.3926753997802734  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.393362045288086  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4051036834716797  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.405599594116211  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.405599594116211  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4061546325683594  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.422128677368164  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4227395057678223  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4227395057678223  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.423180103302002  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.435957431793213  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([210, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4368290901184082  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4368290901184082  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4372296333312988  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4516491889953613  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4522333145141602  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4522333145141602  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4524927139282227  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4636468887329102  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4644122123718262  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4644122123718262  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4646658897399902  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4773497581481934  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([85, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4778766632080078  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4778766632080078  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4780387878417969  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4872798919677734  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.488020896911621  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.488020896911621  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4882020950317383  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.4997987747192383  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5004005432128906  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5004005432128906  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5005378723144531  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5102882385253906  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5108752250671387  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5108752250671387  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.510993480682373  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5202174186706543  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5209083557128906  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5209083557128906  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5210323333740234  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5315704345703125  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5319957733154297  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5319957733154297  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5320701599121094  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5389137268066406  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5395898818969727  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5395898818969727  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5396909713745117  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.549698829650879  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.550210952758789  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.550210952758789  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5502853393554688  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5581703186035156  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5586562156677246  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5586562156677246  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5587210655212402  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5660490989685059  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5666213035583496  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5666213035583496  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5666918754577637  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5751605033874512  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5757827758789062  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5757827758789062  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5758552551269531  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5850601196289062  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5855355262756348  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5855355262756348  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5855889320373535  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.592745304107666  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5933337211608887  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5933337211608887  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.5933947563171387  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6020007133483887  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6024751663208008  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6024751663208008  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.602522850036621  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6095800399780273  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6098313331604004  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6098313331604004  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.609856128692627  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6136994361877441  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6141071319580078  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6141071319580078  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6141433715820312  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6200141906738281  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6203885078430176  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6203885078430176  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6204209327697754  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6259007453918457  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6335816383361816  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.6335816383361816  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.63413667678833  GigaBytes
Max Memory Allocated: 1.7453432083129883  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7424063682556152  GigaBytes
Max Memory Allocated: 1.7493443489074707  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7233266830444336  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7237505912780762  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7241744995117188  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.723729133605957  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

torch.Size([2842, 40])
input nodes number: 21422
output nodes number: 2842
edges number: 23262
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7239103317260742  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7303466796875 GB
    Memory Allocated: 1.7239108085632324  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.04379844665527344  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

pseudo mini batch 6 input nodes size: 70405
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.03973197937011719  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.03973197937011719  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.0733036994934082  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.07332515716552734  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.03957080841064453  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.04098320007324219  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.04098320007324219  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.04098320007324219  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

torch.Size([70405, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.04098320007324219  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

m.shape torch.Size([830, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.12349319458007812  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.12349319458007812  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.12428474426269531  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.1306171417236328  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([1083, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.1312541961669922  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.1312541961669922  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.13228702545166016  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.1477794647216797  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([1142, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.1488966941833496  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.1488966941833496  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.14998579025268555  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.17441797256469727  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1116, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.17600202560424805  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.17600202560424805  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.17706632614135742  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.20825529098510742  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1103, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.21035289764404297  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.21035289764404297  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.21140480041503906  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.24987030029296875  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1011, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.25223684310913086  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.25223684310913086  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.2532010078430176  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.29554080963134766  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([932, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.2981696128845215  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.2981696128845215  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.2990584373474121  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.34349966049194336  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([908, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.34651899337768555  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.34651899337768555  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.3473849296569824  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.39746809005737305  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([809, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.40050697326660156  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.40050697326660156  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.4012784957885742  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.45131731033325195  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([12286, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.5095252990722656  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.5095252990722656  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 12286, 128]), torch.Size([1, 12286, 128])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 0.5212421417236328  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3532524108886719  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 12286, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.277033805847168  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.2972707748413086  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3175077438354492  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.2971124649047852  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

torch.Size([21220, 256])
first layer input nodes number: 70405
first layer output nodes number: 21220
edges number: 166396
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3180346488952637  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3382716178894043  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3434252738952637  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3434252738952637  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3661651611328125  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3661651611328125  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3669509887695312  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3743906021118164  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3747262954711914  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3747262954711914  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3754491806030273  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3879094123840332  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([263, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3883066177368164  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.3883066177368164  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.388808250427246  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.401515007019043  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.40217924118042  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.40217924118042  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4026331901550293  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4157977104187012  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4164552688598633  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4164552688598633  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4168062210083008  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4294404983520508  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4302053451538086  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4302053451538086  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.430516242980957  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4438848495483398  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4446783065795898  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4446783065795898  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4449472427368164  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4583940505981445  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4590749740600586  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4590749740600586  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4592771530151367  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4708013534545898  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.471548080444336  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.471548080444336  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4717350006103516  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4836978912353516  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4843735694885254  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4843735694885254  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4845261573791504  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4953598976135254  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([81, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4961400032043457  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4961400032043457  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.4962944984436035  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.508345127105713  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.508948802947998  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.508948802947998  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.509061336517334  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5186266899108887  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5191330909729004  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5191330909729004  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.519218921661377  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5271153450012207  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.527705192565918  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.527705192565918  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5277948379516602  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5366697311401367  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5372161865234375  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5372161865234375  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5372943878173828  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.545583724975586  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([45, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5462369918823242  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5462369918823242  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5463228225708008  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5560216903686523  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5565180778503418  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5565180778503418  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5565810203552246  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.564134120941162  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5644488334655762  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5644488334655762  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5644869804382324  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5693316459655762  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5697693824768066  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5697693824768066  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.569817066192627  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5762066841125488  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.57672119140625  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.57672119140625  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5767745971679688  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5843048095703125  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.584883689880371  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.584883689880371  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5849409103393555  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.593409538269043  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.593613624572754  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.593613624572754  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5936346054077148  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5968866348266602  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5971636772155762  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5971636772155762  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.5971884727478027  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6012053489685059  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.601539134979248  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.601539134979248  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6015677452087402  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.60640287399292  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.613236904144287  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.613236904144287  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6137804985046387  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.711885929107666  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6922073364257812  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6926312446594238  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6930551528930664  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6926097869873047  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

torch.Size([2842, 40])
input nodes number: 21220
output nodes number: 2842
edges number: 23115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6927895545959473  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7322998046875 GB
    Memory Allocated: 1.6927900314331055  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.04360055923461914  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

pseudo mini batch 7 input nodes size: 70701
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.03957080841064453  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.03957080841064453  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.07328367233276367  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.07330513000488281  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.039711952209472656  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.041152000427246094  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.041152000427246094  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.041152000427246094  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

torch.Size([70701, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.041152000427246094  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

m.shape torch.Size([805, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.12443113327026367  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.12443113327026367  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.1251988410949707  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.13134050369262695  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([1027, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.13216066360473633  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.13216066360473633  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.13314008712768555  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.14783143997192383  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([1126, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.14895248413085938  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.14895248413085938  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.1500263214111328  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.17385292053222656  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1048, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.17531490325927734  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.17531490325927734  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.1763143539428711  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.20529842376708984  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([1044, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.20728778839111328  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.20728778839111328  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2082834243774414  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2441263198852539  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1017, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2465381622314453  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2465381622314453  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.24750804901123047  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.28934669494628906  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([948, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2920260429382324  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2920260429382324  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 948, 128]), torch.Size([1, 948, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.29293012619018555  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.3381342887878418  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 948, 128])
m.shape torch.Size([894, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.341092586517334  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.341092586517334  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.34194517135620117  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.39157629013061523  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([882, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.39533472061157227  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.39533472061157227  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 882, 128]), torch.Size([1, 882, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.3961758613586426  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.4500088691711426  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 882, 128])
m.shape torch.Size([12603, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.5101351737976074  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.5101351737976074  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 12603, 128]), torch.Size([1, 12603, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.5221543312072754  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3763575553894043  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 12603, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.2993173599243164  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3197202682495117  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.340123176574707  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3195605278015137  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

torch.Size([21394, 256])
first layer input nodes number: 70701
first layer output nodes number: 21394
edges number: 169507
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3406519889831543  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3610548973083496  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3661651611328125  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3661651611328125  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.390294075012207  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.390294075012207  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3910646438598633  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.397317886352539  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([355, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3976154327392578  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3976154327392578  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3982925415039062  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4092860221862793  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.409815788269043  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.409815788269043  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4103899002075195  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4248571395874023  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4254083633422852  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4254083633422852  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4258241653442383  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.437882423400879  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4386072158813477  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4386072158813477  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4389772415161133  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4522981643676758  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.45298433303833  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.45298433303833  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4532723426818848  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4656567573547363  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.466367244720459  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.466367244720459  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4666094779968262  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4787211418151855  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4794611930847168  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4794611930847168  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4796748161315918  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4918513298034668  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.492600917816162  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.492600917816162  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4927897453308105  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5048747062683105  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([92, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5056648254394531  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5056648254394531  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5058403015136719  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5182991027832031  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5189833641052246  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5189833641052246  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.51912260055542  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5299830436706543  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5305709838867188  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5305709838867188  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.530679702758789  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5399208068847656  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5405912399291992  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5405912399291992  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5407018661499023  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5508794784545898  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5515108108520508  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5515108108520508  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5516080856323242  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5612382888793945  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5617375373840332  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5617375373840332  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.56181001663208  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5694928169250488  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5698871612548828  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5698871612548828  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5699405670166016  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5759754180908203  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.57637357711792  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.57637357711792  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.576423168182373  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.582374095916748  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5829029083251953  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5829029083251953  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5829639434814453  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5907154083251953  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5911049842834473  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5911049842834473  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.591148853302002  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.59702730178833  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.597428321838379  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.597428321838379  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5974702835083008  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6033868789672852  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.603830337524414  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.603830337524414  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6038742065429688  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6103668212890625  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6107468605041504  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6107468605041504  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6107831001281738  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6164002418518066  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6167359352111816  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6167359352111816  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6167664527893066  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6217103004455566  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6220874786376953  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6220874786376953  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6221199035644531  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6275997161865234  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6349363327026367  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6349363327026367  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6355199813842773  GigaBytes
Max Memory Allocated: 1.7510128021240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7475309371948242  GigaBytes
Max Memory Allocated: 1.754826545715332  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7264394760131836  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7268633842468262  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7272872924804688  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.726841926574707  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

torch.Size([2842, 40])
input nodes number: 21394
output nodes number: 2842
edges number: 23556
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7270231246948242  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7270236015319824  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.0438075065612793  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

pseudo mini batch 8 input nodes size: 71657
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.039711952209472656  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.039711952209472656  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.07388067245483398  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.07390213012695312  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.040167808532714844  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.04160499572753906  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.04160499572753906  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.04160499572753906  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

torch.Size([71657, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.04160499572753906  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

m.shape torch.Size([848, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.12482738494873047  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.12482738494873047  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.12563610076904297  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.13210582733154297  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([1106, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.13298749923706055  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.13298749923706055  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.13404226303100586  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.14986371994018555  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1126, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.15135812759399414  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.15135812759399414  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.15243196487426758  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.17625856399536133  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1114, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.17784643173217773  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.17784643173217773  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.1789088249206543  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.21012639999389648  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1085, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.21218204498291016  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.21218204498291016  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.21321678161621094  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2515406608581543  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([990, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.25385570526123047  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.25385570526123047  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.25479984283447266  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.29604625701904297  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([971, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2988152503967285  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.2988152503967285  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.299741268157959  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.3460421562194824  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([942, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.34917259216308594  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.34917259216308594  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.3500709533691406  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.4012775421142578  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([797, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.4042487144470215  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.4042487144470215  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 797, 128]), torch.Size([1, 797, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.40500879287719727  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.4543743133544922  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 797, 128])
m.shape torch.Size([12557, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.5145411491394043  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.5145411491394043  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 12557, 128]), torch.Size([1, 12557, 128])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 0.5265164375305176  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3775219917297363  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 12557, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3006491661071777  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3211874961853027  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3417258262634277  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3210268020629883  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

torch.Size([21536, 256])
first layer input nodes number: 71657
first layer output nodes number: 21536
edges number: 169335
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.342261791229248  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.362800121307373  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3687877655029297  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3687877655029297  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

m.shape torch.Size([408, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3918890953063965  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3918890953063965  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.392667293548584  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3989286422729492  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([364, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3992395401000977  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3992395401000977  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.3999338150024414  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4106183052062988  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4110989570617676  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4110989570617676  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4116463661193848  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.426283359527588  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4268903732299805  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4268903732299805  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4273271560668945  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4399938583374023  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([201, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4407415390014648  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4407415390014648  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4411249160766602  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4549264907836914  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4554557800292969  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4554557800292969  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4556941986083984  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4659461975097656  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4666814804077148  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4666814804077148  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.466923713684082  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4790353775024414  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4798293113708496  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4798293113708496  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4800562858581543  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4929938316345215  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4936761856079102  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.4936761856079102  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.493851661682129  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.505082130432129  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5058307647705078  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5058307647705078  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5059967041015625  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5177783966064453  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5184993743896484  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5184993743896484  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5186443328857422  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5299510955810547  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5307321548461914  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5307321548461914  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5308732986450195  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5428705215454102  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5433497428894043  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5433497428894043  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.543433666229248  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.551154613494873  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5516915321350098  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5516915321350098  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5517735481262207  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5598931312561035  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.560457706451416  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.560457706451416  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5605378150939941  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5690293312072754  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5696353912353516  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5696353912353516  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5697154998779297  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5787677764892578  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5792508125305176  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5792508125305176  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5793118476867676  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5866360664367676  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5870728492736816  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5870728492736816  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5871243476867676  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5936646461486816  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.594186782836914  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.594186782836914  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.5942440032958984  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6019115447998047  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6023635864257812  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6023635864257812  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6024112701416016  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6091346740722656  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6095552444458008  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6095552444458008  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6095972061157227  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6158075332641602  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6162943840026855  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6162943840026855  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.616340160369873  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6234354972839355  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6238327026367188  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6238327026367188  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6238689422607422  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.629739761352539  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.630021572113037  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.630021572113037  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6300463676452637  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6342368125915527  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([290, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6418347358703613  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.6418347358703613  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.642387866973877  GigaBytes
Max Memory Allocated: 1.7553777694702148  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7487201690673828  GigaBytes
Max Memory Allocated: 1.7556343078613281  GigaBytes

rst.shape  torch.Size([1, 290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7286744117736816  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7290983200073242  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7295222282409668  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.729076862335205  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([2842, 40])
input nodes number: 21536
output nodes number: 2842
edges number: 23496
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7292590141296387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7342529296875 GB
    Memory Allocated: 1.7292594909667969  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.044266700744628906  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

pseudo mini batch 9 input nodes size: 70305
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.040167808532714844  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.040167808532714844  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07369184494018555  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07371330261230469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03952312469482422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04094219207763672  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04094219207763672  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04094219207763672  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([70305, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04094219207763672  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([792, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12343978881835938  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12343978881835938  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12419509887695312  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13023757934570312  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([1052, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13086318969726562  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13086318969726562  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.131866455078125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14691543579101562  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1131, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14837074279785156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14837074279785156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14944934844970703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1732950210571289  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1156, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17496061325073242  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17496061325073242  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17606306076049805  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20803403854370117  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1049, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20998382568359375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20998382568359375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2109842300415039  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.24700212478637695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1049, 128])
m.shape torch.Size([974, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.24928855895996094  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.24928855895996094  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2502174377441406  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29114723205566406  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([890, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2936534881591797  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2936534881591797  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29450225830078125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3387613296508789  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([867, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.341644287109375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.341644287109375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3424711227416992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3896007537841797  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3926548957824707  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3926548957824707  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.39342546463012695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.44274187088012695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([12448, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5017132759094238  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5017132759094238  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 12448, 128]), torch.Size([1, 12448, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5135846138000488  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3575940132141113  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 12448, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.281270980834961  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.301457405090332  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3216438293457031  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3012995719909668  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([21167, 256])
first layer input nodes number: 70305
first layer output nodes number: 21167
edges number: 166920
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3221697807312012  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3423562049865723  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3475289344787598  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3475289344787598  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([398, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.370439052581787  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.370439052581787  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3711981773376465  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3775362968444824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([380, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.37788724899292  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.37788724899292  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3786120414733887  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.390479564666748  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3909735679626465  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3909735679626465  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3915400505065918  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.40643310546875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([236, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.407057285308838  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.407057285308838  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4075074195861816  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4205613136291504  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4212160110473633  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4212160110473633  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.421565055847168  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4341306686401367  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.43483304977417  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.43483304977417  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4351229667663574  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.44758939743042  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.448258876800537  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.448258876800537  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4484896659851074  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.460029125213623  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.460805892944336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.460805892944336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4610271453857422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4736385345458984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4742894172668457  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4742894172668457  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4744572639465332  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4851994514465332  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4858942031860352  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4858942031860352  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.486048698425293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4970178604125977  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4976916313171387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4976916313171387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4978270530700684  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.508389949798584  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5089569091796875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5089569091796875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5090618133544922  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5179786682128906  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5186762809753418  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5186762809753418  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5187907218933105  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5293192863464355  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5298137664794922  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5298137664794922  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5298919677734375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5376338958740234  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5380706787109375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5380706787109375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5381336212158203  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5448055267333984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.545389175415039  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.545389175415039  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5454654693603516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.554086685180664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5546369552612305  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5546369552612305  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5547056198120117  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5629453659057617  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5634303092956543  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5634303092956543  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5634875297546387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5707545280456543  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5713286399841309  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5713286399841309  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5713915824890137  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5798258781433105  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5802369117736816  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5802369117736816  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5802807807922363  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5864663124084473  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5870904922485352  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5870904922485352  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5871515274047852  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5961847305297852  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5967040061950684  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5967040061950684  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5967535972595215  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6044402122497559  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.604813575744629  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.604813575744629  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6048479080200195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6104097366333008  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6107850074768066  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6107850074768066  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6108174324035645  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6162972450256348  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([275, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6228890419006348  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6228890419006348  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6234135627746582  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7290124893188477  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 275, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7091617584228516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7095856666564941  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7100095748901367  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.709564208984375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([2842, 40])
input nodes number: 21167
output nodes number: 2842
edges number: 23307
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7097434997558594  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7097439765930176  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.043566226959228516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

pseudo mini batch 10 input nodes size: 70645
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03952312469482422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03952312469482422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07320928573608398  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07323074340820312  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03968524932861328  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04112052917480469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04112052917480469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04112052917480469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([70645, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04112052917480469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([815, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1240854263305664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1240854263305664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1248626708984375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13108062744140625  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([1037, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13220834732055664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13220834732055664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13319730758666992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14803171157836914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([1094, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14910221099853516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14910221099853516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1501455307006836  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17385005950927734  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1064, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17535781860351562  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17535781860351562  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17637252807617188  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20579910278320312  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([1094, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2079000473022461  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2079000473022461  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20894336700439453  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2477130889892578  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1007, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2500724792480469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2500724792480469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.25103282928466797  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29360485076904297  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([893, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29610538482666016  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29610538482666016  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29695701599121094  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.34112024307250977  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([832, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3438682556152344  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3438682556152344  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3446617126464844  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3905162811279297  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([784, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.39348411560058594  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.39348411560058594  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.39423179626464844  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.4429302215576172  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([12695, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5031032562255859  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5031032562255859  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 12695, 128]), torch.Size([1, 12695, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5152297019958496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3755130767822266  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 12695, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.2987041473388672  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3190317153930664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3393592834472656  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3188724517822266  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([21315, 256])
first layer input nodes number: 70645
first layer output nodes number: 21315
edges number: 168852
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3398876190185547  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.360215187072754  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3656988143920898  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3656988143920898  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([411, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3898344039916992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3898344039916992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3906183242797852  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3968896865844727  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.397176742553711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.397176742553711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3978500366210938  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4080924987792969  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4086356163024902  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4086356163024902  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.409217357635498  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.422135829925537  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4226946830749512  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4226946830749512  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4231162071228027  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.435340404510498  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([219, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4363150596618652  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4363150596618652  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4367327690124512  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.451770305633545  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4523749351501465  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4523749351501465  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.452643871307373  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4642081260681152  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([116, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4648542404174805  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4648542404174805  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4650754928588867  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4761381149291992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([97, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.476773738861084  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.476773738861084  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4769587516784668  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.487504482269287  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4881906509399414  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4881906509399414  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4883623123168945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4993486404418945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5001087188720703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5001087188720703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5002765655517578  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5121936798095703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5127758979797363  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5127758979797363  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5128960609436035  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5222687721252441  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.522935390472412  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.522935390472412  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5230555534362793  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5332694053649902  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.533884048461914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.533884048461914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.533987045288086  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5434627532958984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5440034866333008  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5440034866333008  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5440874099731445  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5523958206176758  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5529165267944336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5529165267944336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5529909133911133  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5608758926391602  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.561500072479248  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.561500072479248  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.561582088470459  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.570849895477295  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5712828636169434  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5712828636169434  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.571338176727295  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5779757499694824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5784502029418945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5784502029418945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.578505516052246  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5855302810668945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5860505104064941  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5860505104064941  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5861077308654785  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5937752723693848  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5940542221069336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5940542221069336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5940847396850586  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5983877182006836  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5987963676452637  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5987963676452637  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5988364219665527  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.604764461517334  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6050405502319336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6050405502319336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.605067253112793  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.609206199645996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.609591007232666  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.609591007232666  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6096253395080566  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.615187168121338  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.615516185760498  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.615516185760498  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6155447959899902  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.62037992477417  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([323, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.628127098083496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.628127098083496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6287431716918945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.740433692932129  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 323, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7193260192871094  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.719749927520752  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7201738357543945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7197284698486328  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([2842, 40])
input nodes number: 21315
output nodes number: 2842
edges number: 23678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7199091911315918  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.71990966796875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.043768882751464844  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

pseudo mini batch 11 input nodes size: 70614
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03968524932861328  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03968524932861328  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07335662841796875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07337808609008789  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.039670467376708984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04109334945678711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04109334945678711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04109334945678711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([70614, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04109334945678711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([872, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12363576889038086  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12363576889038086  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12446737289428711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1311202049255371  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([1065, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13172006607055664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13172006607055664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1327357292175293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14797067642211914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([1139, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1490921974182129  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1490921974182129  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1501784324645996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17459774017333984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([1121, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1761927604675293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1761927604675293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1772618293762207  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20851850509643555  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1005, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.21038007736206055  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.21038007736206055  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.21133852005004883  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.24689865112304688  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([960, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.24916601181030273  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.24916601181030273  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.25008153915405273  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2895827293395996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([983, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2924060821533203  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2924060821533203  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 983, 128]), torch.Size([1, 983, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29334354400634766  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.34099864959716797  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 983, 128])
m.shape torch.Size([880, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3438868522644043  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3438868522644043  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3447260856628418  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.39284467697143555  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([814, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3959183692932129  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3959183692932129  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3966946601867676  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.4481778144836426  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([12468, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5072417259216309  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5072417259216309  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 12468, 128]), torch.Size([1, 12468, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.519132137298584  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3641886711120605  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 12468, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.2879233360290527  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3082432746887207  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3285632133483887  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.308084487915039  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([21307, 256])
first layer input nodes number: 70614
first layer output nodes number: 21307
edges number: 167615
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3290915489196777  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3494114875793457  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3544983863830566  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3544983863830566  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3773856163024902  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3773856163024902  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3782057762145996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3849329948425293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3852458000183105  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3852458000183105  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.385962963104248  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.397773265838623  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([272, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3981990814208984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3981990814208984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3987178802490234  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4118809700012207  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([229, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4125022888183594  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4125022888183594  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4129390716552734  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4256057739257812  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([162, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.42616605758667  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.42616605758667  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4264750480651855  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.437598705291748  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4383440017700195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4383440017700195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4386415481567383  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4514360427856445  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.452108383178711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.452108383178711  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.452341079711914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4639759063720703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4647979736328125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4647979736328125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4650306701660156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4782943725585938  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4790172576904297  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4790172576904297  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4792022705078125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4910430908203125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4918732643127441  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4918732643127441  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4920563697814941  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5050568580627441  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.505758285522461  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.505758285522461  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5059013366699219  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.517059326171875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.517714500427246  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.517714500427246  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5178346633911133  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5280485153198242  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5286760330200195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5286760330200195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5287809371948242  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5384321212768555  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5389585494995117  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5389585494995117  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5390405654907227  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5471601486206055  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5477538108825684  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5477538108825684  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.547837734222412  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5567336082458496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5571837425231934  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5571837425231934  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5572447776794434  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5641417503356934  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5645198822021484  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5645198822021484  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5645675659179688  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5702896118164062  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.570542812347412  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.570542812347412  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.570573329925537  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.574449062347412  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5748906135559082  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5748906135559082  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5749382972717285  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5813279151916504  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5819001197814941  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5819001197814941  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5819592475891113  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5902962684631348  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5908522605895996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5908522605895996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5909075736999512  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5990939140319824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.599447250366211  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.599447250366211  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5994815826416016  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6048030853271484  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6051397323608398  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6051397323608398  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6051702499389648  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6101140975952148  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6106066703796387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6106066703796387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6106486320495605  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6177401542663574  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.625413417816162  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.625413417816162  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6259589195251465  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7359461784362793  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.716137409210205  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7165613174438477  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7169852256774902  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7165398597717285  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([2842, 40])
input nodes number: 21307
output nodes number: 2842
edges number: 23252
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7167201042175293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7167205810546875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04372549057006836  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

pseudo mini batch 12 input nodes size: 70274
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.039670467376708984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.039670467376708984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07317972183227539  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07320117950439453  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03950834274291992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04091310501098633  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04091310501098633  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04091310501098633  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([70274, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04091310501098633  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([827, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12221574783325195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12221574783325195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12300443649291992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12931394577026367  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([1119, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13011837005615234  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13011837005615234  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13118553161621094  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14719295501708984  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1153, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1486525535583496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1486525535583496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14975214004516602  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17394304275512695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1755237579345703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1755237579345703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1765890121459961  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20776939392089844  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1071, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20979022979736328  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.20979022979736328  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.21081161499023438  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.24777841567993164  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([985, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.25008583068847656  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.25008583068847656  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 985, 128]), torch.Size([1, 985, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2510251998901367  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2922210693359375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 985, 128])
m.shape torch.Size([931, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2948589324951172  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2948589324951172  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2957468032836914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3403763771057129  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([870, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.34325122833251953  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.34325122833251953  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.34408092498779297  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3923006057739258  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([822, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3954133987426758  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3954133987426758  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3961973190307617  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.4478025436401367  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([12229, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5060043334960938  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5060043334960938  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 12229, 128]), torch.Size([1, 12229, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5176668167114258  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3495488166809082  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 12229, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.2745099067687988  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.2946553230285645  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.31480073928833  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.2944974899291992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([21124, 256])
first layer input nodes number: 70274
first layer output nodes number: 21124
edges number: 165422
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3153266906738281  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3354721069335938  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3407173156738281  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3407173156738281  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3633785247802734  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3633785247802734  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3641853332519531  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3719115257263184  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3722138404846191  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3722138404846191  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3729138374328613  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3856534957885742  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.386159896850586  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.386159896850586  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.3867263793945312  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4009971618652344  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4016447067260742  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4016447067260742  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4021062850952148  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.415492057800293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.416111946105957  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.416111946105957  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4164495468139648  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.428603172302246  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4291958808898926  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4291958808898926  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4294476509094238  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4402737617492676  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.441002368927002  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.441002368927002  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4412446022033691  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4533562660217285  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4540963172912598  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4540963172912598  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4543099403381348  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4664864540100098  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.467322826385498  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.467322826385498  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4675307273864746  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4808363914489746  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([102, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.481712818145752  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.481712818145752  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4819073677062988  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.495720386505127  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4963107109069824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4963107109069824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.4964346885681152  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5061049461364746  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5066661834716797  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5066661834716797  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5067691802978516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.515523910522461  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.51600980758667  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.51600980758667  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5160918235778809  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.523637294769287  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5242018699645996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5242018699645996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5242877006530762  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5327849388122559  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5333046913146973  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5333046913146973  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.533379077911377  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5412640571594238  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5417346954345703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5417346954345703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5417976379394531  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.548910140991211  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5494346618652344  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5494346618652344  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.54949951171875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.557281494140625  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5579066276550293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5579066276550293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5579791069030762  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5671839714050293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5675678253173828  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5675678253173828  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5676116943359375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5734901428222656  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5740833282470703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5740833282470703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5741443634033203  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5827503204345703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.583043098449707  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.583043098449707  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.583073616027832  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.587590217590332  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5879979133605957  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5879979133605957  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.588036060333252  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5939488410949707  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5941510200500488  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5941510200500488  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.594170093536377  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5972599983215332  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5975966453552246  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5975966453552246  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.5976252555847168  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6024603843688965  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([287, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6093425750732422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6093425750732422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6098899841308594  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.7085785865783691  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6889863014221191  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6894102096557617  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6898341178894043  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6893887519836426  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([2842, 40])
input nodes number: 21124
output nodes number: 2842
edges number: 23024
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.689568042755127  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 1.6895685195922852  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.04351997375488281  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

pseudo mini batch 13 input nodes size: 71354
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03950834274291992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.03950834274291992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.0735325813293457  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.07355403900146484  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.0400233268737793  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.041468143463134766  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.041468143463134766  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.041468143463134766  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([71354, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.041468143463134766  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([794, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12595462799072266  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12595462799072266  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 794, 128]), torch.Size([1, 794, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.12671184539794922  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13276958465576172  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 794, 128])
m.shape torch.Size([1069, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13341045379638672  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.13341045379638672  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.134429931640625  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.14972209930419922  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1143, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.15094709396362305  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.15094709396362305  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1520371437072754  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17601823806762695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([1142, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17765140533447266  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.17765140533447266  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.1787405014038086  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.21032428741455078  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1069, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.21232843399047852  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.21232843399047852  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2133479118347168  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2501654624938965  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([994, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2524995803833008  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2524995803833008  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2534475326538086  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.2947816848754883  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([923, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29738855361938477  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29738855361938477  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.29826879501342773  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3427605628967285  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([870, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3456392288208008  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3456392288208008  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3464689254760742  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.39473628997802734  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([807, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3977847099304199  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.3977847099304199  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.39855432510375977  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.44780969619750977  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([12707, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5080165863037109  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5080165863037109  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 12707, 128]), torch.Size([1, 12707, 128])
----------------------------------------3
 Nvidia-smi: 3.7381591796875 GB
    Memory Allocated: 0.5201349258422852  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3808698654174805  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 12707, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3026328086853027  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3231539726257324  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.343675136566162  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.322993278503418  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([21518, 256])
first layer input nodes number: 71354
first layer output nodes number: 21518
edges number: 169992
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3442087173461914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.364729881286621  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3701448440551758  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3701448440551758  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.394270896911621  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.394270896911621  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.395035743713379  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4011545181274414  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4014568328857422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4014568328857422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4021358489990234  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.412613868713379  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([313, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4131770133972168  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4131770133972168  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.413774013519287  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.428269863128662  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([246, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.428917407989502  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.428917407989502  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4293866157531738  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4429936408996582  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4436578750610352  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4436578750610352  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.444014549255371  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4568548202514648  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4575419425964355  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4575419425964355  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4578280448913574  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.470130443572998  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([102, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4706740379333496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4706740379333496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4708685874938965  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4805960655212402  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4813833236694336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4813833236694336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.481602668762207  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.494105339050293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([79, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4946794509887695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4946794509887695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4948301315307617  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5044736862182617  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5051674842834473  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5051674842834473  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5053200721740723  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5161538124084473  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5167756080627441  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5167756080627441  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5169014930725098  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5267205238342285  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5273728370666504  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5273728370666504  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5274910926818848  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5375428199768066  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5382084846496582  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5382084846496582  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5383191108703613  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5484967231750488  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5490608215332031  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5490608215332031  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5491485595703125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5578346252441406  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5584111213684082  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5584111213684082  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5584931373596191  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5671868324279785  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5675764083862305  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5675764083862305  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5676298141479492  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.573664665222168  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.574324607849121  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.574324607849121  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5744047164916992  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5840177536010742  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5844449996948242  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5844449996948242  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5844964981079102  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5910367965698242  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5913763046264648  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5913763046264648  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.591414451599121  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5965261459350586  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5970454216003418  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5970454216003418  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5970988273620605  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6046290397644043  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6051878929138184  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6051878929138184  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.60524320602417  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6134295463562012  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6137404441833496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6137404441833496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6137709617614746  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6185011863708496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6189284324645996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6189284324645996  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6189665794372559  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6251463890075684  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6255888938903809  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6255888938903809  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.625627040863037  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6320738792419434  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([308, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.639455795288086  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.639455795288086  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6400432586669922  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7457995414733887  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7247071266174316  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7251310348510742  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7255549430847168  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.725109577178955  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([2842, 40])
input nodes number: 21518
output nodes number: 2842
edges number: 23718
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7252917289733887  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7252922058105469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.044137001037597656  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

pseudo mini batch 14 input nodes size: 71909
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.0400233268737793  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.0400233268737793  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07431221008300781  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07433366775512695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04028797149658203  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04174232482910156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04174232482910156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04174232482910156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([71909, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04174232482910156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([803, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1262521743774414  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1262521743774414  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12701797485351562  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13314437866210938  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([1100, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13381052017211914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13381052017211914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13485956192016602  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.15059518814086914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1112, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.15166139602661133  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.15166139602661133  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.15272188186645508  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17702531814575195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1119, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17862939834594727  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17862939834594727  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17969655990600586  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21097993850708008  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1176, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21325016021728516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21325016021728516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2143716812133789  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2547464370727539  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([999, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.25704383850097656  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.25704383850097656  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 999, 128]), torch.Size([1, 999, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2579965591430664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2994403839111328  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 999, 128])
m.shape torch.Size([961, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3021717071533203  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3021717071533203  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3030881881713867  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34891223907470703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([909, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.35192155838012695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.35192155838012695  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.35278844833374023  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.4031205177307129  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.4061546325683594  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.4061546325683594  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.4069252014160156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.4564962387084961  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([12737, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.516845703125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.516845703125  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 12737, 128]), torch.Size([1, 12737, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5289926528930664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.39143705368042  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 12737, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3132777214050293  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3339953422546387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.354712963104248  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3338332176208496  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

torch.Size([21724, 256])
first layer input nodes number: 71909
first layer output nodes number: 21724
edges number: 171330
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3552508354187012  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3759684562683105  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3817205429077148  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3817205429077148  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4058599472045898  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4058599472045898  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4066495895385742  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4131526947021484  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([347, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4134249687194824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4134249687194824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4140868186950684  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4242753982543945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4247751235961914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4247751235961914  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4253244400024414  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4387359619140625  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4393959045410156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4393959045410156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.439859390258789  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4533004760742188  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([227, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4541740417480469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4541740417480469  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4546070098876953  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.470193862915039  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([125, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.470698356628418  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.470698356628418  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4709367752075195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4811887741088867  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.481971263885498  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.481971263885498  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.482226848602295  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4950060844421387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4956398010253906  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4956398010253906  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.495828628540039  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.506591796875  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.507371425628662  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.507371425628662  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5075640678405762  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5198931694030762  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.52048921585083  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.52048921585083  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5206265449523926  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.53037691116333  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5309743881225586  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5309743881225586  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5310945510864258  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5404672622680664  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5409955978393555  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5409955978393555  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.541092872619629  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.549361228942871  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5499377250671387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5499377250671387  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5500330924987793  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5588068962097168  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.559338092803955  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.559338092803955  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.559420108795166  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5675396919250488  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5680465698242188  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5680465698242188  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5681190490722656  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5758018493652344  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5762271881103516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5762271881103516  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.576284408569336  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5827503204345703  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.583228588104248  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.583228588104248  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5832877159118652  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5903830528259277  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5910282135009766  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5910282135009766  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5911026000976562  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6005496978759766  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6009693145751953  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6009693145751953  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6010169982910156  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6074066162109375  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6078829765319824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6078829765319824  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6079325675964355  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6149249076843262  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6154251098632812  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6154251098632812  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6154747009277344  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6228141784667969  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6231279373168945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6231279373168945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6231584548950195  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6278886795043945  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.628183364868164  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.628183364868164  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6282100677490234  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6325359344482422  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6328225135803223  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6328225135803223  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6328473091125488  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.637037754058838  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([327, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6448826789855957  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6448826789855957  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6455063819885254  GigaBytes
Max Memory Allocated: 1.756582260131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.757817268371582  GigaBytes
Max Memory Allocated: 1.7656135559082031  GigaBytes

rst.shape  torch.Size([1, 327, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7367057800292969  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7371296882629395  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.737553596496582  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7371082305908203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([2842, 40])
input nodes number: 21724
output nodes number: 2842
edges number: 23726
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7372918128967285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7372922897338867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04442882537841797  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

pseudo mini batch 15 input nodes size: 70858
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04028797149658203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04028797149658203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07407569885253906  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.0740971565246582  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03978681564331055  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04121065139770508  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04121065139770508  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04121065139770508  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([70858, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04121065139770508  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([837, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12374448776245117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12374448776245117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1245427131652832  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13092851638793945  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([1125, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13160228729248047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13160228729248047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1326751708984375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14956283569335938  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1175, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.15070724487304688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.15070724487304688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1175, 128]), torch.Size([1, 1175, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.15182781219482422  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17648029327392578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1175, 128])
m.shape torch.Size([1161, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17813444137573242  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17813444137573242  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17924165725708008  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2113509178161621  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([1024, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21323871612548828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21323871612548828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1024, 128]), torch.Size([1, 1024, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21421527862548828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24958086013793945  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1024, 128])
m.shape torch.Size([989, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2519221305847168  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2519221305847168  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2528653144836426  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29408979415893555  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([955, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29680585861206055  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29680585861206055  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2977166175842285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34325456619262695  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([870, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3461179733276367  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3461179733276367  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34694766998291016  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3944864273071289  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39751338958740234  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39751338958740234  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39827823638916016  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.44808006286621094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12469, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5071544647216797  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5071544647216797  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 12469, 128]), torch.Size([1, 12469, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5190458297729492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.363332748413086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 12469, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2871108055114746  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3075261116027832  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3279414176940918  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3073663711547852  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([21407, 256])
first layer input nodes number: 70858
first layer output nodes number: 21407
edges number: 167863
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3284716606140137  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3488869667053223  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3539910316467285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3539910316467285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3767194747924805  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3767194747924805  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3775091171264648  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3839120864868164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([371, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.384230613708496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.384230613708496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3849382400512695  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3966126441955566  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3970866203308105  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3970866203308105  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3976340293884277  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4125752449035645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([234, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4132013320922852  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4132013320922852  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4136476516723633  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.426590919494629  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4272427558898926  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4272427558898926  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4275898933410645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.440086841583252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4408016204833984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4408016204833984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4410953521728516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.453725814819336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4545278549194336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4545278549194336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4547967910766602  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4682435989379883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4688935279846191  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4688935279846191  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.469088077545166  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.480177402496338  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([109, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4810233116149902  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4810233116149902  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4812312126159668  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4945368766784668  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4951634407043457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4951634407043457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4953083992004395  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5056004524230957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5062365531921387  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5062365531921387  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.506364345550537  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5163321495056152  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5170412063598633  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5170412063598633  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5171689987182617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.528031349182129  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5286049842834473  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5286049842834473  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5287022590637207  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.537651538848877  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.537980079650879  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.537980079650879  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5380334854125977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.543320655822754  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5438995361328125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5438995361328125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5439796447753906  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5524711608886719  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5530309677124023  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5530309677124023  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.553105354309082  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5615110397338867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5619969367980957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5619969367980957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5620579719543457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5693821907043457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5700263977050781  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5700263977050781  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5701007843017578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5795478820800781  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5799674987792969  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5799674987792969  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5800151824951172  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.586404800415039  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5869193077087402  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5869193077087402  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.586972713470459  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5945029258728027  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5950818061828613  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5950818061828613  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5951390266418457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6036076545715332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6038966178894043  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6038966178894043  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6039252281188965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6083598136901855  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6086993217468262  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6086993217468262  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6087298393249512  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6136736869812012  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6140046119689941  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6140046119689941  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6140332221984863  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.618868350982666  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([278, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6255340576171875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6255340576171875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6260643005371094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7356600761413574  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 278, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7160015106201172  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7164254188537598  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7168493270874023  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7164039611816406  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([2842, 40])
input nodes number: 21407
output nodes number: 2842
edges number: 23100
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7165851593017578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.716585636138916  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04384756088256836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

pseudo mini batch 16 input nodes size: 71190
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03978681564331055  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03978681564331055  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07373285293579102  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07375431060791016  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.039945125579833984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04138517379760742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04138517379760742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04138517379760742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([71190, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04138517379760742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([841, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1246633529663086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1246633529663086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12546539306640625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1318817138671875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([1080, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1327066421508789  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1327066421508789  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13373661041259766  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1491861343383789  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1118, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1510305404663086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1510305404663086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.15209674835205078  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17589282989501953  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1140, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1775341033935547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1775341033935547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1786212921142578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21014976501464844  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1115, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2122645378112793  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2122645378112793  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21332788467407227  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.25200891494750977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1008, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2543611526489258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2543611526489258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2553224563598633  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29761791229248047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([876, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3000612258911133  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3000612258911133  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.30089664459228516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34355878829956055  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([872, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3464674949645996  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3464674949645996  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34729909896850586  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3947005271911621  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([845, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39791107177734375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39791107177734375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39871692657470703  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.45067310333251953  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([12621, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5108170509338379  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5108170509338379  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 12621, 128]), torch.Size([1, 12621, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5228533744812012  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.378007411956787  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 12621, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3010363578796387  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3215556144714355  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3420748710632324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.321394920349121  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([21516, 256])
first layer input nodes number: 71190
first layer output nodes number: 21516
edges number: 169461
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3426074981689453  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3631267547607422  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3690099716186523  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3690099716186523  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([407, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.393143653869629  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.393143653869629  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3939199447631836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.400130271911621  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([382, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4004764556884766  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4004764556884766  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.401205062866211  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4122514724731445  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([270, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.412665843963623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.412665843963623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4131808280944824  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4264707565307617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4271554946899414  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4271554946899414  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4276227951049805  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4411745071411133  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4418158531188965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4418158531188965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4421629905700684  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4546599388122559  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4552998542785645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4552998542785645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.455568790435791  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4671330451965332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([110, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4677391052246094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4677391052246094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4679489135742188  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4784393310546875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4791111946105957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4791111946105957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4793038368225098  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4902844429016113  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4910707473754883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4910707473754883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4912652969360352  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5037164688110352  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5043978691101074  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5043978691101074  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5045523643493652  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.51552152633667  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5161738395690918  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5161738395690918  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5163054466247559  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5265707969665527  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5272550582885742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5272550582885742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.527379035949707  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.537917137145996  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5387048721313477  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5387048721313477  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.538834571838379  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.550766944885254  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([55, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5514426231384277  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5514426231384277  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5515475273132324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5619330406188965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.562471866607666  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.562471866607666  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5625500679016113  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5708394050598145  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.571277141571045  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.571277141571045  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.571336269378662  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5780177116394043  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5783967971801758  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5783967971801758  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.578444480895996  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5841665267944336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5848002433776855  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5848002433776855  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5848727226257324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5940775871276855  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5944433212280273  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5944433212280273  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5944852828979492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6001081466674805  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6004142761230469  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6004142761230469  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6004467010498047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6050186157226562  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6055474281311035  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6055474281311035  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6055989265441895  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6132206916809082  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6135125160217285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6135125160217285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6135411262512207  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6179757118225098  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6184258460998535  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6184258460998535  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6184659004211426  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6249547004699707  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6253037452697754  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6253037452697754  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6253342628479004  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6304917335510254  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([311, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6379494667053223  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6379494667053223  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.638542652130127  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7497658729553223  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 311, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7286686897277832  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7290925979614258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7295165061950684  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7290711402893066  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([2842, 40])
input nodes number: 21516
output nodes number: 2842
edges number: 23733
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7292532920837402  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7292537689208984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.044048309326171875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

pseudo mini batch 17 input nodes size: 69720
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.039945125579833984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.039945125579833984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07319021224975586  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.073211669921875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03924417495727539  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04064321517944336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04064321517944336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04064321517944336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([69720, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04064321517944336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([793, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12149810791015625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12149810791015625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1222543716430664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12840890884399414  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([1122, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12910079956054688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12910079956054688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1301708221435547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14622116088867188  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1123, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1472926139831543  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1472926139831543  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14836359024047852  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1721787452697754  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([1099, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17373943328857422  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17373943328857422  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1747875213623047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20584774017333984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1085, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20791053771972656  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20791053771972656  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20894527435302734  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24738359451293945  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([980, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24967002868652344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24967002868652344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.25060462951660156  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29163169860839844  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([923, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29424524307250977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29424524307250977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29512548446655273  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3396921157836914  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([874, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34258604049682617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34258604049682617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34341955184936523  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.391843318939209  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3949241638183594  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3949241638183594  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39570140838623047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.44719982147216797  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([12165, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5054049491882324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5054049491882324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 12165, 128]), torch.Size([1, 12165, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5170063972473145  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3483219146728516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 12165, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.273665428161621  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2936725616455078  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3136796951293945  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2935161590576172  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([20979, 256])
first layer input nodes number: 69720
first layer output nodes number: 20979
edges number: 164545
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3142013549804688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3342084884643555  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3395500183105469  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3395500183105469  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3623046875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3623046875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3631057739257812  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3710951805114746  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([388, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3714408874511719  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3714408874511719  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3721809387207031  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3856101036071777  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([269, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3860158920288086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3860158920288086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3865289688110352  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.39973783493042  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([216, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4003119468688965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4003119468688965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.400723934173584  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4126715660095215  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([197, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4134125709533691  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4134125709533691  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4137883186340332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4273152351379395  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.428067684173584  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.428067684173584  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4283785820007324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4417471885681152  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4425067901611328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4425067901611328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4427661895751953  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4557361602783203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4564447402954102  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4564447402954102  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4566526412963867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4685029983520508  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4692211151123047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4692211151123047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4694023132324219  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4809989929199219  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4815621376037598  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4815621376037598  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.481691837310791  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4909005165100098  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.491523265838623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.491523265838623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4916472434997559  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5013175010681152  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5019822120666504  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5019822120666504  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5021023750305176  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5123162269592285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5128188133239746  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5128188133239746  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5129046440124512  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.520801067352295  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5215120315551758  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5215120315551758  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5216188430786133  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5321931838989258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5328607559204102  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5328607559204102  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5329561233520508  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.543065071105957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.543525218963623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.543525218963623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5435881614685059  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5507006645202637  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5510940551757812  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5510940551757812  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5511436462402344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5570945739746094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5575027465820312  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5575027465820312  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5575504302978516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5636062622070312  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5641121864318848  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5641121864318848  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5641674995422363  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5715794563293457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.572166919708252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.572166919708252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.572227954864502  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.580833911895752  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5812878608703613  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5812878608703613  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5813336372375488  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5881085395812988  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5883817672729492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5883817672729492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5884084701538086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5925474166870117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5929985046386719  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5929985046386719  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.593038558959961  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.599527359008789  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.599853515625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.599853515625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5998821258544922  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6047172546386719  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([283, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6115031242370605  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6115031242370605  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6120429039001465  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7095947265625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 283, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.689910888671875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6903347969055176  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6907587051391602  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6903133392333984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([2842, 40])
input nodes number: 20979
output nodes number: 2842
edges number: 23120
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6904911994934082  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6904916763305664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04323625564575195  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

pseudo mini batch 18 input nodes size: 69839
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03924417495727539  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03924417495727539  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07254600524902344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07256746292114258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03930091857910156  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.040694236755371094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.040694236755371094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.040694236755371094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([69839, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.040694236755371094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([835, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12144184112548828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12144184112548828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1222381591796875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12875795364379883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([1097, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12940597534179688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12940597534179688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13045215606689453  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14614486694335938  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1138, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14724969863891602  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14724969863891602  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14833498001098633  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1722111701965332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1118, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17383527755737305  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17383527755737305  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17490148544311523  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20612287521362305  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1091, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20819091796875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20819091796875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20923137664794922  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24756765365600586  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([971, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24982547760009766  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24982547760009766  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2507514953613281  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2905702590942383  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([932, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29321813583374023  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29321813583374023  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29410696029663086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3388209342956543  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([813, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3414778709411621  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3414778709411621  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3422532081604004  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3875899314880371  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([761, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39046812057495117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39046812057495117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39119386672973633  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.43833112716674805  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([12221, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.49656200408935547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.49656200408935547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 12221, 128]), torch.Size([1, 12221, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5082168579101562  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3395452499389648  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 12221, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.264986515045166  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.28499174118042  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3049969673156738  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2848353385925293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([20977, 256])
first layer input nodes number: 69839
first layer output nodes number: 20977
edges number: 164283
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3055195808410645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3255248069763184  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3308115005493164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3308115005493164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3531193733215332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3531193733215332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3539338111877441  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3617095947265625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([372, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3620176315307617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3620176315307617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.362727165222168  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3765625953674316  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.37703275680542  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.37703275680542  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3775782585144043  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3912086486816406  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3918280601501465  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3918280601501465  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.392270565032959  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4051032066345215  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4059300422668457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4059300422668457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4063458442687988  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4213147163391113  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([163, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4220471382141113  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4220471382141113  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4223580360412598  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4357266426086426  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.436492919921875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.436492919921875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4367542266845703  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.449819564819336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4505963325500488  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4505963325500488  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4508213996887207  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4636502265930176  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4641695022583008  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4641695022583008  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.464308738708496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.473219871520996  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4739384651184082  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4739384651184082  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4740948677062988  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4851994514465332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4858508110046387  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4858508110046387  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4859824180603027  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4962477684020996  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4967589378356934  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4967589378356934  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.496854305267334  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.504960536956787  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.505537986755371  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.505537986755371  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5056333541870117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5144071578979492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5148711204528809  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5148711204528809  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5149435997009277  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5221190452575684  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5226306915283203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5226306915283203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5227031707763672  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.530385971069336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5307035446166992  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5307035446166992  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.530747413635254  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5357046127319336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5361566543579102  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5361566543579102  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5362119674682617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5428495407104492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.543358325958252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.543358325958252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5434174537658691  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.550926685333252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5512990951538086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5512990951538086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5513410568237305  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5569639205932617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5576353073120117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5576353073120117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.557703971862793  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5673856735229492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5676140785217285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5676140785217285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.567638874053955  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5713086128234863  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5715713500976562  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5715713500976562  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5715961456298828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.575439453125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5756702423095703  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5756702423095703  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5756912231445312  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5790901184082031  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.579310417175293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.579310417175293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.579329490661621  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5825529098510742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5897760391235352  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5897760391235352  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5903501510620117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6935548782348633  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6743035316467285  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.674727439880371  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6751513481140137  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.674705982208252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([2842, 40])
input nodes number: 20977
output nodes number: 2842
edges number: 22650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6748838424682617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.67488431930542  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04327869415283203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

pseudo mini batch 19 input nodes size: 69736
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03930091857910156  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03930091857910156  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07255363464355469  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07257509231567383  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03925180435180664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04064607620239258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04064607620239258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04064607620239258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([69736, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04064607620239258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([830, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12137269973754883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12137269973754883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12216424942016602  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12867450714111328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([1118, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12934494018554688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12934494018554688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13041114807128906  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14640426635742188  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1080, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1483755111694336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1483755111694336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14940547943115234  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17206478118896484  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1176, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17379283905029297  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17379283905029297  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1176, 128]), torch.Size([1, 1176, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17491436004638672  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20743846893310547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1176, 128])
m.shape torch.Size([1047, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20937395095825195  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20937395095825195  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2103724479675293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24631834030151367  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([932, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24848556518554688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24848556518554688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2493743896484375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2876420021057129  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([967, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29042530059814453  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29042530059814453  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2913475036621094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.33745765686035156  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([857, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34026575088500977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34026575088500977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3410830497741699  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.38832664489746094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([849, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39156150817871094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39156150817871094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39237117767333984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.44438838958740234  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([12114, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5025773048400879  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5025773048400879  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 12114, 128]), torch.Size([1, 12114, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5141301155090332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3449187278747559  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 12114, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2704262733459473  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2904248237609863  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3104233741760254  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2902684211730957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([20970, 256])
first layer input nodes number: 69736
first layer output nodes number: 20970
edges number: 164243
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3109450340270996  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3309435844421387  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3362860679626465  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3362860679626465  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3586750030517578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3586750030517578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.359506607055664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3677759170532227  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([394, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3681178092956543  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3681178092956543  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3688693046569824  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3824257850646973  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3828692436218262  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3828692436218262  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.383410930633545  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3961114883422852  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3967633247375488  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3967633247375488  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3972210884094238  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4104962348937988  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([175, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4111084938049316  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4111084938049316  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4114422798156738  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4234585762023926  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.424116611480713  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.424116611480713  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.424389362335205  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4361176490783691  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.436835765838623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.436835765838623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4370779991149902  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4491896629333496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4498300552368164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4498300552368164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4500188827514648  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4607820510864258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.461474895477295  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.461474895477295  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4616484642028809  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4727568626403809  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4735159873962402  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4735159873962402  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4736838340759277  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4856009483337402  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4861936569213867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4861936569213867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4863157272338867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4958372116088867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.496549129486084  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.496549129486084  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4966769218444824  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5075392723083496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.508000373840332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.508000373840332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5080804824829102  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5154504776000977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([61, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5162315368652344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5162315368652344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.516347885131836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5278663635253906  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.528313159942627  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.528313159942627  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5283799171447754  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5354561805725098  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5360074043273926  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5360074043273926  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5360798835754395  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5442700386047363  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5447239875793457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5447239875793457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.54478120803833  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.551647663116455  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.552086353302002  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.552086353302002  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.552137851715088  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.558678150177002  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5590362548828125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5590362548828125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5590763092041016  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.564443588256836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5650386810302734  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5650386810302734  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5650997161865234  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5737056732177734  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5740790367126465  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5740790367126465  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5741171836853027  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5797629356384277  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5801668167114258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5801668167114258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.580204963684082  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5861177444458008  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5865187644958496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5865187644958496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.586555004119873  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.59242582321167  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5928921699523926  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5928921699523926  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5929322242736816  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5997014045715332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([268, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6061210632324219  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6061210632324219  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6066322326660156  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.697892189025879  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 268, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.678600788116455  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6790246963500977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6794486045837402  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6790032386779785  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([2842, 40])
input nodes number: 20970
output nodes number: 2842
edges number: 22726
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6791810989379883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6791815757751465  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04323148727416992  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

pseudo mini batch 20 input nodes size: 69777
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03925180435180664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03925180435180664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.0725240707397461  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07254552841186523  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03927135467529297  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04065704345703125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04065704345703125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04065704345703125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([69777, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04065704345703125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([870, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1211996078491211  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1211996078491211  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 870, 128]), torch.Size([1, 870, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12202930450439453  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12866687774658203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 870, 128])
m.shape torch.Size([1133, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1293325424194336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1293325424194336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13041305541992188  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1471271514892578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1123, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.148193359375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.148193359375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14926433563232422  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1736149787902832  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([1093, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17516422271728516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17516422271728516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1762065887451172  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20714664459228516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1137, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2093362808227539  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2093362808227539  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2104206085205078  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24946975708007812  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([962, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2516798973083496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2516798973083496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2525973320007324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29303646087646484  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([875, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2954983711242676  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2954983711242676  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 875, 128]), torch.Size([1, 875, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29633283615112305  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3380560874938965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 875, 128])
m.shape torch.Size([854, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3408966064453125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3408966064453125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34171104431152344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3881340026855469  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([784, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39109134674072266  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39109134674072266  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39183902740478516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.4400453567504883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([12073, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.4972400665283203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.4972400665283203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 12073, 128]), torch.Size([1, 12073, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.508753776550293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3385295867919922  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 12073, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.264218807220459  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2841544151306152  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3040900230407715  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.2839984893798828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([20904, 256])
first layer input nodes number: 69777
first layer output nodes number: 20904
edges number: 163077
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.304612159729004  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3245477676391602  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3299336433410645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3299336433410645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3522944450378418  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3522944450378418  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3531088829040527  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3615198135375977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3618221282958984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3618221282958984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3625259399414062  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3765411376953125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([315, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3770976066589355  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3770976066589355  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3776984214782715  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3915209770202637  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3921475410461426  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3921475410461426  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3926072120666504  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.405937671661377  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4066596031188965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4066596031188965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4070372581481934  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4206328392028809  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.421309471130371  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.421309471130371  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.421595573425293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4338979721069336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.434488296508789  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.434488296508789  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4346961975097656  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4450912475585938  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4458565711975098  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4458565711975098  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4460721015930176  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.458357334136963  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.45904541015625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.45904541015625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4592208862304688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4704513549804688  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4711809158325195  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4711809158325195  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4713430404663086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.482853889465332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4834918975830078  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4834918975830078  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.483621597290039  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4937381744384766  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4943079948425293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4943079948425293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.494412899017334  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5033297538757324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.503852367401123  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.503852367401123  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5039401054382324  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.512012004852295  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5125737190246582  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5125737190246582  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5126595497131348  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5211567878723145  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([28, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5215177536010742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5215177536010742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.521571159362793  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5272321701049805  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5277132987976074  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5277132987976074  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5277762413024902  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.534888744354248  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5354294776916504  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5354294776916504  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5354962348937988  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5435070991516113  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.543889045715332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.543889045715332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5439348220825195  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.549748420715332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5501823425292969  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5501823425292969  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5502300262451172  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.556619644165039  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.556999683380127  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.556999683380127  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.557039737701416  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5626873970031738  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.56303071975708  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.56303071975708  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5630650520324707  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5681462287902832  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5685944557189941  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5685944557189941  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.568636417388916  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5751404762268066  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5754294395446777  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5754294395446777  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.575456142425537  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5797820091247559  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.580183982849121  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.580183982849121  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5802183151245117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5860204696655273  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5929956436157227  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5929956436157227  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.593550682067871  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6937804222106934  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6744866371154785  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.674910545349121  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6753344535827637  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.674889087677002  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([2842, 40])
input nodes number: 20904
output nodes number: 2842
edges number: 22706
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6750664710998535  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6750669479370117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.043233394622802734  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

pseudo mini batch 21 input nodes size: 70574
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03927135467529297  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03927135467529297  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07292366027832031  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07294511795043945  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03965139389038086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04107046127319336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04107046127319336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04107046127319336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([70574, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04107046127319336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([782, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12356281280517578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12356281280517578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.12430858612060547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13027477264404297  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([1079, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13093090057373047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.13093090057373047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1319599151611328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14739513397216797  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1083, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1485600471496582  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1485600471496582  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1083, 128]), torch.Size([1, 1083, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.14959287643432617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17325544357299805  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1083, 128])
m.shape torch.Size([1108, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1748523712158203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.1748523712158203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.17590904235839844  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2070636749267578  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1069, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20908403396606445  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.20908403396606445  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.21010351181030273  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2471780776977539  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1011, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24956083297729492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.24956083297729492  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.25052499771118164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29223203659057617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([874, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29466724395751953  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.29466724395751953  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.2955007553100586  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3371763229370117  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([856, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3400249481201172  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3400249481201172  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.34084129333496094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3873729705810547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([776, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39029502868652344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.39029502868652344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 776, 128]), torch.Size([1, 776, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.3910350799560547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.43911170959472656  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 776, 128])
m.shape torch.Size([12513, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.49928855895996094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.49928855895996094  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 12513, 128]), torch.Size([1, 12513, 128])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.5112218856811523  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3584880828857422  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 12513, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.282127857208252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3022990226745605  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3224701881408691  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3021411895751953  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([21151, 256])
first layer input nodes number: 70574
first layer output nodes number: 21151
edges number: 167112
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.322998046875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3431692123413086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3482122421264648  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3482122421264648  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([427, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3710813522338867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3710813522338867  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3718957901000977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3784184455871582  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([383, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3787474632263184  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3787474632263184  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3794779777526855  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3907580375671387  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([275, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3911857604980469  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3911857604980469  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.3917102813720703  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4057188034057617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([216, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4062871932983398  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4062871932983398  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4066991806030273  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4186468124389648  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.419349193572998  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.419349193572998  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4197096824645996  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4326872825622559  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([171, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4335060119628906  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4335060119628906  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4338321685791016  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4478569030761719  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4485483169555664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4485483169555664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4487905502319336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.460902214050293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4616422653198242  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4616422653198242  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4618558883666992  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4740324020385742  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([63, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.474470615386963  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.474470615386963  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.47459077835083  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.48228120803833  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.482980728149414  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.482980728149414  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4831314086914062  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4938297271728516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4944734573364258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.4944734573364258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.494603157043457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5047197341918945  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.505335807800293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.505335807800293  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.505448341369629  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5150136947631836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([63, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.515744686126709  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.515744686126709  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5158648490905762  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5269198417663574  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.527505874633789  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.527505874633789  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.527597427368164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.536661148071289  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5373077392578125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5373077392578125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5373992919921875  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5471038818359375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5476274490356445  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5476274490356445  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5476980209350586  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5556726455688477  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5561442375183105  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5561442375183105  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5562033653259277  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5632987022399902  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.563840389251709  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.563840389251709  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5639033317565918  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.571897029876709  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.572432041168213  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.572432041168213  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.57249116897583  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5804142951965332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5807499885559082  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5807499885559082  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5807862281799316  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5858960151672363  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5863018035888672  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5863018035888672  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5863418579101562  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5922698974609375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5926308631896973  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5926308631896973  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.592665195465088  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5979866981506348  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5982794761657715  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5982794761657715  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.5983061790466309  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6026320457458496  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6029877662658691  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6029877662658691  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6030182838439941  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6081757545471191  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([294, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.615224838256836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.615224838256836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.6157855987548828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7240142822265625  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 294, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7042131423950195  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.704637050628662  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7050609588623047  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.704615592956543  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([2842, 40])
input nodes number: 21151
output nodes number: 2842
edges number: 23237
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7047948837280273  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 1.7047953605651855  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04369544982910156  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

pseudo mini batch 22 input nodes size: 71653
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03965139389038086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.03965139389038086  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07381820678710938  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.07383966445922852  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.04016590118408203  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.041626930236816406  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.041626930236816406  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.041626930236816406  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([71653, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8006591796875 GB
    Memory Allocated: 0.041626930236816406  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1261744499206543  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1261744499206543  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12694597244262695  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13349676132202148  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([1044, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13410663604736328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13410663604736328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1351022720336914  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15003681182861328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1116, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15113544464111328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15113544464111328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15219974517822266  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17598819732666016  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1121, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17759418487548828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17759418487548828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1786632537841797  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20995426177978516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1030, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21187543869018555  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21187543869018555  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21285772323608398  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2488846778869629  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([954, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25112295150756836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25112295150756836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 954, 128]), torch.Size([1, 954, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2520327568054199  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29140615463256836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 954, 128])
m.shape torch.Size([938, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29410600662231445  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29410600662231445  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2950005531311035  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.33972787857055664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([855, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3425421714782715  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3425421714782715  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34335756301879883  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.38985395431518555  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([791, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3928408622741699  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3928408622741699  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39359521865844727  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4426412582397461  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([12997, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5047640800476074  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5047640800476074  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 12997, 128]), torch.Size([1, 12997, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5171589851379395  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.416649341583252  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 12997, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3383030891418457  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.358954906463623  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3796067237854004  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3587932586669922  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

torch.Size([21655, 256])
first layer input nodes number: 71653
first layer output nodes number: 21655
edges number: 172098
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3801426887512207  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.400794506072998  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4059576988220215  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4059576988220215  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

m.shape torch.Size([405, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4300899505615234  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4300899505615234  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4308624267578125  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4377131462097168  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([356, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.438011646270752  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.438011646270752  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4386906623840332  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.449160099029541  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([296, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.449674129486084  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.449674129486084  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4502387046813965  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4640827178955078  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([241, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4647274017333984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4647274017333984  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4651870727539062  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4785175323486328  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([169, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.479100227355957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.479100227355957  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4794225692749023  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4910268783569336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.491650104522705  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.491650104522705  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4919095039367676  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.503063678741455  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.503889560699463  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.503889560699463  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5041604042053223  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.517702579498291  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.518420696258545  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.518420696258545  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.518632411956787  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5307002067565918  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5314249992370605  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5314249992370605  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5316081047058105  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5433268547058105  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5440716743469238  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5440716743469238  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5442376136779785  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5560193061828613  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5565710067749023  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5565710067749023  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.556685447692871  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5656118392944336  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([72, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.566385269165039  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.566385269165039  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5665225982666016  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.578195571899414  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5788145065307617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5788145065307617  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5789194107055664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5885705947875977  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5890026092529297  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5890026092529297  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.589071273803711  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5958690643310547  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.596426010131836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.596426010131836  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5965042114257812  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6047935485839844  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6052007675170898  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6052007675170898  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6052560806274414  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.611506462097168  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.611985683441162  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.611985683441162  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6120448112487793  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6191401481628418  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6196298599243164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6196298599243164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6196870803833008  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6269540786743164  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6272363662719727  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6272363662719727  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6272687911987305  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6316137313842773  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6323089599609375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6323089599609375  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6323795318603516  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6423301696777344  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6427998542785645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6427998542785645  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6428475379943848  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.649904727935791  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.650240421295166  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.650240421295166  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6502728462219238  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6552987098693848  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6557025909423828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6557025909423828  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6557388305664062  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6616096496582031  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6620759963989258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6620759963989258  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6621160507202148  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6688852310180664  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([313, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6763863563537598  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6763863563537598  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.67698335647583  GigaBytes
Max Memory Allocated: 1.7656445503234863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7850852012634277  GigaBytes
Max Memory Allocated: 1.7925477027893066  GigaBytes

rst.shape  torch.Size([1, 313, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.763986587524414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7644104957580566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7648344039916992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7643890380859375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21655
output nodes number: 2842
edges number: 23863
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7645721435546875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7645726203918457  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.044318199157714844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 23 input nodes size: 71305
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04016590118408203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04016590118408203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07416677474975586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.074188232421875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039999961853027344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04145240783691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04145240783691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04145240783691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([71305, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04145240783691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([810, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12595510482788086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12595510482788086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12672758102416992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13290739059448242  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([1007, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13348150253295898  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13348150253295898  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13444185256958008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14884710311889648  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([1108, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14995193481445312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14995193481445312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15100860595703125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17476654052734375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([1128, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1763896942138672  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1763896942138672  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1128, 128]), torch.Size([1, 1128, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17746543884277344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2088298797607422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1128, 128])
m.shape torch.Size([1052, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2108001708984375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2108001708984375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21180343627929688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.24831199645996094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1019, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25072574615478516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25072574615478516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2516975402832031  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2945213317871094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([935, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29715633392333984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29715633392333984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2980480194091797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34267568588256836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([877, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34557533264160156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34557533264160156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34641170501708984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3949089050292969  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([855, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3981599807739258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3981599807739258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3989753723144531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.45209360122680664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([12783, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5126399993896484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5126399993896484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12783, 128]), torch.Size([1, 12783, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5248308181762695  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3905901908874512  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12783, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3123435974121094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3329181671142578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3534927368164062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3327569961547852  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21574, 256])
first layer input nodes number: 71305
first layer output nodes number: 21574
edges number: 171120
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3540263175964355  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.374600887298584  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.380289077758789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.380289077758789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4044342041015625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4044342041015625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4052352905273438  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4116439819335938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([346, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4119086265563965  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4119086265563965  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4125685691833496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4236149787902832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4241271018981934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4241271018981934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4246840476989746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4377918243408203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.438455581665039  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.438455581665039  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4389228820800781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.452474594116211  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.453111171722412  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.453111171722412  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4534564018249512  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4658846855163574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([170, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4666924476623535  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4666924476623535  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4670166969299316  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.480959415435791  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4815711975097656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4815711975097656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.481790542602539  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.492757797241211  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4934020042419434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4934020042419434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.493588924407959  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5042433738708496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5049457550048828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5049457550048828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5051212310791016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5163516998291016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5169081687927246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5169081687927246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.517035961151123  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.526109218597412  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5268173217773438  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5268173217773438  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.526956558227539  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5378170013427734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5384397506713867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5384397506713867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5385541915893555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5482816696166992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5490241050720215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5490241050720215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5491461753845215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5603766441345215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.560746192932129  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.560746192932129  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.560807228088379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.566849708557129  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5673527717590332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5673527717590332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5674233436584473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.574903964996338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.575483798980713  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.575483798980713  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5755600929260254  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.584181308746338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5846171379089355  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5846171379089355  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.584672451019287  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5913100242614746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5918359756469727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5918359756469727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5918970108032227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5996484756469727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.600165843963623  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.600165843963623  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6002230644226074  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6078906059265137  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.608323574066162  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.608323574066162  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6083693504333496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.614823818206787  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.615427017211914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.615427017211914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6154861450195312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.624237060546875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6244192123413086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6244192123413086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6244382858276367  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.627394676208496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6276063919067383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6276063919067383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6276254653930664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6307153701782227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.631190299987793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.631190299987793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.631230354309082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6379995346069336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([323, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6457409858703613  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6457409858703613  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6463570594787598  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7559432983398438  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 323, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.735356330871582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7357802391052246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7362041473388672  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7357587814331055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21574
output nodes number: 2842
edges number: 23777
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7359414100646973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7359418869018555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04412984848022461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 24 input nodes size: 70402
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039999961853027344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039999961853027344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07357025146484375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07359170913696289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03956937789916992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04098176956176758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04098176956176758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04098176956176758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([70402, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04098176956176758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([771, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1234598159790039  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1234598159790039  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 771, 128]), torch.Size([1, 771, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12419509887695312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13007736206054688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 771, 128])
m.shape torch.Size([1058, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13071870803833008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13071870803833008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1317276954650879  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14686250686645508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([1135, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1483607292175293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1483607292175293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1494431495666504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17330408096313477  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1074, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17481136322021484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17481136322021484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17583560943603516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20553874969482422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1059, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2075514793395996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2075514793395996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20856142044067383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2456521987915039  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([1010, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.24803686141967773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.24803686141967773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.24900007247924805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29068517684936523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([884, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.293154239654541  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.293154239654541  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 884, 128]), torch.Size([1, 884, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29399728775024414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.33707475662231445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 884, 128])
m.shape torch.Size([896, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3400712013244629  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3400712013244629  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 896, 128]), torch.Size([1, 896, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3409256935119629  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39116525650024414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 896, 128])
m.shape torch.Size([853, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39439868927001953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39439868927001953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39521217346191406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.44794416427612305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([12352, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5064363479614258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5064363479614258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12352, 128]), torch.Size([1, 12352, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5182161331176758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3548154830932617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12352, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2785067558288574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.298621654510498  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3187365531921387  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.298464298248291  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21092, 256])
first layer input nodes number: 70402
first layer output nodes number: 21092
edges number: 166496
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3192634582519531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3393783569335938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3449630737304688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3449630737304688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.36761474609375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.36761474609375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3683853149414062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3752365112304688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3755683898925781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3755683898925781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3762798309326172  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3886737823486328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([314, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.389223575592041  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.389223575592041  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3898224830627441  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4082188606262207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4087462425231934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4087462425231934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.409156322479248  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.421048641204834  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4218144416809082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4218144416809082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4221997261047363  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4360699653625488  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4368062019348145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4368062019348145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4371132850646973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4503178596496582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4509921073913574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4509921073913574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4512267112731934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4629569053649902  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4636240005493164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4636240005493164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4638185501098633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4749078750610352  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4757018089294434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4757018089294434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.475898265838623  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.488471508026123  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([60, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.488950252532959  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.488950252532959  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4890646934509277  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.497189998626709  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4979047775268555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4979047775268555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4980440139770508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5089044570922852  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5095157623291016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5095157623291016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5096282958984375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5191936492919922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.519749641418457  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.519749641418457  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5198431015014648  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5284414291381836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.529040813446045  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.529040813446045  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.52913236618042  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.538196086883545  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5388426780700684  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5388426780700684  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5389342308044434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5486388206481934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.549269676208496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.549269676208496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5493535995483398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5588369369506836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5594978332519531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5594978332519531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.559579849243164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5694217681884766  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5697789192199707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5697789192199707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5698227882385254  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5753941535949707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5758838653564453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5758838653564453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.575937271118164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5830936431884766  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.583451747894287  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.583451747894287  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5834898948669434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5888686180114746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5892128944396973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5892128944396973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.589247226715088  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5943284034729004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5947341918945312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5947341918945312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5947723388671875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6006851196289062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6009316444396973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6009316444396973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.600954532623291  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6046624183654785  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6049742698669434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6049742698669434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6050009727478027  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.609513759613037  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6163725852966309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6163725852966309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6169180870056152  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7256197929382324  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7060198783874512  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7064437866210938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7068676948547363  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7064223289489746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21092
output nodes number: 2842
edges number: 23033
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7066011428833008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.706601619720459  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.043595314025878906  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 25 input nodes size: 71480
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03956937789916992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03956937789916992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0736536979675293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07367515563964844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04008340835571289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.041539669036865234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.041539669036865234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.041539669036865234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([71480, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.041539669036865234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([842, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1260671615600586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1260671615600586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12687015533447266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13329410552978516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([1012, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13385772705078125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13385772705078125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1012, 128]), torch.Size([1, 1012, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13482284545898438  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14929962158203125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1012, 128])
m.shape torch.Size([1121, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1504206657409668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1504206657409668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1514897346496582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17529726028442383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1103, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1768665313720703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1768665313720703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1779184341430664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20902061462402344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1138, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21120786666870117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21120786666870117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21229314804077148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25136327743530273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1053, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2538332939147949  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2538332939147949  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1053, 128]), torch.Size([1, 1053, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2548375129699707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29817724227905273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1053, 128])
m.shape torch.Size([953, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3008561134338379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3008561134338379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.30176496505737305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34813594818115234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([889, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3510727882385254  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3510727882385254  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.35192060470581055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40126562118530273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([846, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40447235107421875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40447235107421875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40527915954589844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.45804405212402344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([12752, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5184469223022461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5184469223022461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12752, 128]), torch.Size([1, 12752, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5306081771850586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3942441940307617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12752, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3160734176635742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3367767333984375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3574800491333008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3366146087646484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21709, 256])
first layer input nodes number: 71480
first layer output nodes number: 21709
edges number: 171566
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3580145835876465  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3787178993225098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3841004371643066  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3841004371643066  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4082422256469727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4082422256469727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4090356826782227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4154901504516602  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([362, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4157896041870117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4157896041870117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4164800643920898  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4270968437194824  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([267, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4275217056274414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4275217056274414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4280309677124023  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.439681053161621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4402918815612793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4402918815612793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.440721035003662  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4531664848327637  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4538507461547852  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4538507461547852  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.454207420349121  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4670476913452148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4676942825317383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4676942825317383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4679670333862305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4796953201293945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([153, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.480635166168213  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.480635166168213  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4809269905090332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4955182075500488  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4961566925048828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4961566925048828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4963512420654297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5074405670166016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5082173347473145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5082173347473145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5084099769592285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5207390785217285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5213637351989746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5213637351989746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5215067863464355  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.531663417816162  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5323848724365234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5323848724365234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5325279235839844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5436859130859375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5443410873413086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5443410873413086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5444612503051758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5546751022338867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5553150177001953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5553150177001953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5554218292236328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5652484893798828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.565800666809082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.565800666809082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5658864974975586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5743837356567383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5748887062072754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5748887062072754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5749611854553223  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.582643985748291  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.583207607269287  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.583207607269287  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5832819938659668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5916876792907715  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5921735763549805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5921735763549805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5922346115112305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5995588302612305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.599926471710205  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.599926471710205  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5999703407287598  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.605541706085205  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.606013298034668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.606013298034668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.606064796447754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6129655838012695  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6134591102600098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6134591102600098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6135106086730957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.620771884918213  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.621251106262207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.621251106262207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6212987899780273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6283559799194336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6287975311279297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6287975311279297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6288394927978516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6353435516357422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6356987953186035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6356987953186035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6357312202453613  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.640984058380127  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6413369178771973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6413369178771973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6413674354553223  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6465249061584473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.653862476348877  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.653862476348877  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6544461250305176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7602996826171875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7392077445983887  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7396316528320312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7400555610656738  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.739610195159912  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21709
output nodes number: 2842
edges number: 23758
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7397937774658203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7397942543029785  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04422473907470703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 26 input nodes size: 69923
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04008340835571289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04008340835571289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07342529296875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07344675064086914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039340972900390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.040749549865722656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.040749549865722656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.040749549865722656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([69923, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.040749549865722656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1232457160949707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1232457160949707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12402009963989258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13021516799926758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([1065, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1308436393737793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1308436393737793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1065, 128]), torch.Size([1, 1065, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13185930252075195  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1470942497253418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1065, 128])
m.shape torch.Size([1130, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1482677459716797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1482677459716797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14934539794921875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.173187255859375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([1109, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17476367950439453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17476367950439453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17582130432128906  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2069864273071289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1094, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20906591415405273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20906591415405273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21010923385620117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2485356330871582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([988, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2508406639099121  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2508406639099121  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 988, 128]), torch.Size([1, 988, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2517828941345215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2929854393005371  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 988, 128])
m.shape torch.Size([920, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29558515548706055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29558515548706055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2964625358581543  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34096860885620117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([854, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34378767013549805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34378767013549805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.344602108001709  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3910250663757324  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([807, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39408111572265625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39408111572265625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3948507308959961  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4442286491394043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([12329, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5026330947875977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5026330947875977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12329, 128]), torch.Size([1, 12329, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5143909454345703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.349198341369629  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12329, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2729058265686035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2930359840393066  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3131661415100098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2928786277770996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21108, 256])
first layer input nodes number: 69923
first layer output nodes number: 21108
edges number: 165991
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3136892318725586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3338193893432617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3395028114318848  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3395028114318848  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3620667457580566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3620667457580566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.362865924835205  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.369832992553711  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([404, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3702101707458496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3702101707458496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3709807395935059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.384244441986084  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3846492767333984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3846492767333984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.385171890258789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4020328521728516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4025907516479492  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4025907516479492  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4029970169067383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.414778709411621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4154601097106934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4154601097106934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4158110618591309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4284453392028809  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4291291236877441  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4291291236877441  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4294133186340332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.441633701324463  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([142, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4424471855163574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4424471855163574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4427180290222168  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4562602043151855  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4569783210754395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4569783210754395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4571900367736816  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4692578315734863  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4699392318725586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4699392318725586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4701128005981445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4812211990356445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.481884479522705  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.481884479522705  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4820332527160645  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.49259614944458  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4932622909545898  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4932622909545898  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4933958053588867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.503809928894043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5045161247253418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5045161247253418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5046439170837402  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5155062675476074  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5161924362182617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5161924362182617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5163068771362305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5268354415893555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.527491569519043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.527491569519043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.527592658996582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5376005172729492  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.538069248199463  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.538069248199463  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5381379127502441  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5454163551330566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5459513664245605  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5459513664245605  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5460219383239746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5539965629577637  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5545334815979004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5545334815979004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5546002388000488  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5626111030578613  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.562941074371338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.562941074371338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.562981128692627  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.568068027496338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.568504810333252  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.568504810333252  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5685524940490723  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5749421119689941  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5752835273742676  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5752835273742676  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.575319766998291  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5804295539855957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5807347297668457  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5807347297668457  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5807652473449707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5852818489074707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5856685638427734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5856685638427734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5857048034667969  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5913219451904297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5918126106262207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5918126106262207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5918564796447754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5989632606506348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5992412567138672  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5992412567138672  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5992660522460938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6034564971923828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([283, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6102442741394043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6102442741394043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6107840538024902  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7226009368896484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 283, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7031059265136719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7035298347473145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.703953742980957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7035083770751953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21108
output nodes number: 2842
edges number: 22922
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7036871910095215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7036876678466797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.043355464935302734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 27 input nodes size: 69216
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039340972900390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039340972900390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07254409790039062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07256555557250977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.040598392486572266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.040598392486572266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.040598392486572266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([69216, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.040598392486572266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([831, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12141609191894531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12141609191894531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 831, 128]), torch.Size([1, 831, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1222085952758789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1286330223083496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 831, 128])
m.shape torch.Size([1081, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12926769256591797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12926769256591797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13029861450195312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14576244354248047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([1105, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14682769775390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14682769775390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14788150787353516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17162799835205078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1073, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17314767837524414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17314767837524414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17417097091674805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20384645462036133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([1080, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20590972900390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20590972900390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.206939697265625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.24454879760742188  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([982, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2468433380126953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2468433380126953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 982, 128]), torch.Size([1, 982, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.24777984619140625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2888507843017578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 982, 128])
m.shape torch.Size([894, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2913665771484375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2913665771484375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2922191619873047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3364877700805664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([911, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3395366668701172  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3395366668701172  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3404054641723633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39085960388183594  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([793, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3938283920288086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3938283920288086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39458465576171875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4439253807067871  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([12186, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.502140998840332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.502140998840332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12186, 128]), torch.Size([1, 12186, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5137624740600586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3453102111816406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12186, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2706775665283203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2906436920166016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3106098175048828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.290487289428711  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([20936, 256])
first layer input nodes number: 69216
first layer output nodes number: 20936
edges number: 164435
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3111276626586914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3310937881469727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3365182876586914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3365182876586914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([454, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3589882850646973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3589882850646973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3598542213439941  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3678832054138184  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3681445121765137  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3681445121765137  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.368833065032959  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3813362121582031  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.381782054901123  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.381782054901123  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3823046684265137  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3950419425964355  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.395665168762207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.395665168762207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.396103858947754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4088258743286133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4094815254211426  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4094815254211426  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4098286628723145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.422325611114502  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.423098087310791  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.423098087310791  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4234108924865723  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.436861515045166  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([110, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4374456405639648  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4374456405639648  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4376554489135742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.448145866394043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([126, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.449009895324707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.449009895324707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4492502212524414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4629487991333008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4636507034301758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4636507034301758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.463831901550293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.475428581237793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4762511253356934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4762511253356934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4764323234558105  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4892973899841309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.489915370941162  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.489915370941162  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4900431632995605  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5000109672546387  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.500570297241211  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.500570297241211  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5006732940673828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5094280242919922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5099515914916992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5099515914916992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5100393295288086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.518111228942871  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5186328887939453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5186328887939453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5187129974365234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5266437530517578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5272092819213867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5272092819213867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5272893905639648  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.535780906677246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5362639427185059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5362639427185059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5363287925720215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.543656826019287  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5442943572998047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5442943572998047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.54437255859375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5537567138671875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5541505813598633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5541505813598633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5541982650756836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5602540969848633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5608515739440918  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5608515739440918  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5609164237976074  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5696063041687012  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.570054531097412  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.570054531097412  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5701022148132324  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5768256187438965  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5771450996398926  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5771450996398926  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5771775245666504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5819764137268066  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.582277774810791  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.582277774810791  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5823063850402832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5867409706115723  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5871248245239258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5871248245239258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5871591567993164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5927209854125977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5930962562561035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5930962562561035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5931286811828613  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5986084938049316  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([274, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6051764488220215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6051764488220215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.605699062347412  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.700869083404541  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 274, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6815094947814941  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6819334030151367  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6823573112487793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6819119453430176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 20936
output nodes number: 2842
edges number: 22792
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6820898056030273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6820902824401855  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0431828498840332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 28 input nodes size: 70511
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.039202213287353516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07282447814941406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0728459358215332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03962135314941406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.041049957275390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.041049957275390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.041049957275390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([70511, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.041049957275390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([848, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12374448776245117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12374448776245117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12455320358276367  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13120317459106445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([1022, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1317734718322754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1317734718322754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13274812698364258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1473679542541504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([1094, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14844560623168945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14844560623168945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1494889259338379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17339086532592773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1121, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17570734024047852  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17570734024047852  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17677640914916992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2080674171447754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1051, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2100386619567871  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2100386619567871  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21104097366333008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2477121353149414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([993, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25005197525024414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25005197525024414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 993, 128]), torch.Size([1, 993, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25099897384643555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2923111915588379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 993, 128])
m.shape torch.Size([924, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.294921875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.294921875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2958030700683594  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34046173095703125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([842, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3432331085205078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3432331085205078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3440361022949219  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39006614685058594  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([853, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3933253288269043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3933253288269043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39413881301879883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4462094306945801  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([12551, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5063495635986328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5063495635986328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12551, 128]), torch.Size([1, 12551, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5183191299438477  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3681583404541016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12551, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2916908264160156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3120031356811523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.332315444946289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3118443489074707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21299, 256])
first layer input nodes number: 70511
first layer output nodes number: 21299
edges number: 168262
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3328428268432617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3531551361083984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3582334518432617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3582334518432617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3811650276184082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3811650276184082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3819756507873535  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3884739875793457  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([343, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.388728141784668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.388728141784668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3893823623657227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3999114036560059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([311, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4004812240600586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4004812240600586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4010744094848633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.416275978088379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.416856288909912  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.416856288909912  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4172911643981934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4299025535583496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4306130409240723  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4306130409240723  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.430981159210205  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4442334175109863  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4449377059936523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4449377059936523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4452314376831055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4578619003295898  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4585833549499512  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4585833549499512  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.458829402923584  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4711318016052246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4718470573425293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4718470573425293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4720549583435059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.48390531539917  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([78, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.484476089477539  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.484476089477539  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4846248626708984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4941463470458984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4948797225952148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4948797225952148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.495039939880371  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5064153671264648  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5070228576660156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5070228576660156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5071468353271484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5168170928955078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.517481803894043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.517481803894043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5176019668579102  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.527815818786621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5283432006835938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5283432006835938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.528432846069336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5366802215576172  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5373082160949707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5373082160949707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5374035835266113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5468449592590332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5473885536193848  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5473885536193848  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.54746675491333  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5557560920715332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5561017990112305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5561017990112305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5561494827270508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.561537742614746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5621838569641113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5621838569641113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5622620582580566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5716462135314941  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5721783638000488  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5721783638000488  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5722413063049316  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5802350044250488  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.580733299255371  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.580733299255371  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5807886123657227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.588200569152832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.588749885559082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.588749885559082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5888071060180664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5968751907348633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5973515510559082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5973515510559082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5973992347717285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6044564247131348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6048555374145508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6048555374145508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.604893684387207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6108064651489258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.611119270324707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.611119270324707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6111478805541992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6157827377319336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6160225868225098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6160225868225098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6160435676574707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6195893287658691  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([293, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6266193389892578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6266193389892578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6271781921386719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.737353801727295  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7174901962280273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.71791410446167  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7183380126953125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7178926467895508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21299
output nodes number: 2842
edges number: 23300
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7180728912353516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7180733680725098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04368782043457031  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 29 input nodes size: 70303
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03962135314941406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03962135314941406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07314443588256836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0731658935546875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03952217102050781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04092693328857422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04092693328857422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04092693328857422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([70303, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04092693328857422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([839, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1221771240234375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1221771240234375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12297725677490234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1293783187866211  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([1069, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1302342414855957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1302342414855957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13125371932983398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1465458869934082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1149, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14853286743164062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14853286743164062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1496286392211914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1737356185913086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17528200149536133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17528200149536133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1763291358947754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20728158950805664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1207, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20963573455810547  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.20963573455810547  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1207, 128]), torch.Size([1, 1207, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2107868194580078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2522258758544922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1207, 128])
m.shape torch.Size([1017, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2545599937438965  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2545599937438965  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25552988052368164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2974276542663574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([922, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3000202178955078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3000202178955078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 922, 128]), torch.Size([1, 922, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3008995056152344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3450508117675781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 922, 128])
m.shape torch.Size([940, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34819698333740234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34819698333740234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3490934371948242  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4002408981323242  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([805, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4032473564147949  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4032473564147949  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40401506423950195  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.45353174209594727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([12113, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5117416381835938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5117416381835938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12113, 128]), torch.Size([1, 12113, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5232934951782227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3534889221191406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12113, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2785792350769043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2987580299377441  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.318936824798584  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.298600196838379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21159, 256])
first layer input nodes number: 70303
first layer output nodes number: 21159
edges number: 165302
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.319462776184082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3396415710449219  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.344853401184082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.344853401184082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([413, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.367537498474121  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.367537498474121  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3683252334594727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.376145362854004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3764495849609375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3764495849609375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3771419525146484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3908967971801758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([308, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3914389610290527  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3914389610290527  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.392026424407959  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4065799713134766  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([199, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4070515632629395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4070515632629395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4074311256408691  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.41843843460083  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([231, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4193639755249023  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4193639755249023  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.419804573059082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4356660842895508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4363627433776855  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4363627433776855  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4366660118103027  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4497065544128418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([97, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4502077102661133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4502077102661133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.450392723083496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4596433639526367  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([122, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.460489273071289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.460489273071289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4607219696044922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4739856719970703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.474604606628418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.474604606628418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.474766731262207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.485142707824707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4857826232910156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4857826232910156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4859256744384766  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4960823059082031  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([85, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4969096183776855  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4969096183776855  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4970717430114746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5097174644470215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5102596282958984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5102596282958984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5103626251220703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5191173553466797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5197906494140625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5197906494140625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5199012756347656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5300788879394531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.530656337738037  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.530656337738037  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5307459831237793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5396208763122559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5401673316955566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5401673316955566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.540245532989502  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.548534870147705  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5491724014282227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5491724014282227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5492563247680664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5587396621704102  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5591225624084473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5591225624084473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5591721534729004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5651230812072754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5656518936157227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5656518936157227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5657129287719727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5734643936157227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5738539695739746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5738539695739746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5738978385925293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5797762870788574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5803122520446777  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5803122520446777  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5803675651550293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5881667137145996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5886034965515137  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5886034965515137  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5886473655700684  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.595139980316162  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.595604419708252  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.595604419708252  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5956482887268066  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6024479866027832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6027579307556152  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6027579307556152  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6027865409851074  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6074213981628418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6077532768249512  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6077532768249512  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6077818870544434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.612617015838623  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([275, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6192107200622559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6192107200622559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6197352409362793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7154059410095215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 275, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.695793628692627  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6962175369262695  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.696641445159912  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6961960792541504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21159
output nodes number: 2842
edges number: 23056
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6963753700256348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.696375846862793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04353475570678711  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 30 input nodes size: 72247
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03952217102050781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.03952217102050781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07397222518920898  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07399368286132812  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04044914245605469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04190540313720703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04190540313720703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04190540313720703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([72247, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04190540313720703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([830, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12642621994018555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12642621994018555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12721776962280273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13355016708374023  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([1084, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13418817520141602  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13418817520141602  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1352219581604004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15072870254516602  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1112, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15180253982543945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15180253982543945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1528630256652832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17716646194458008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1091, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17871713638305664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17871713638305664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17975759506225586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2106938362121582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1041, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21265554428100586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21265554428100586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21364831924438477  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2500762939453125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([1027, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2525181770324707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2525181770324707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2534976005554199  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29645490646362305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([861, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29883909225463867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29883909225463867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 861, 128]), torch.Size([1, 861, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29966020584106445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34160518646240234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 861, 128])
m.shape torch.Size([847, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34442567825317383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34442567825317383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3452334403991699  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39148569107055664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([826, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3946266174316406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3946266174316406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 826, 128]), torch.Size([1, 826, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3954143524169922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4464864730834961  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 826, 128])
m.shape torch.Size([12922, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5085926055908203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5085926055908203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12922, 128]), torch.Size([1, 12922, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5209159851074219  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.412984848022461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12922, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.334700584411621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3553390502929688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3759775161743164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.355177402496338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21641, 256])
first layer input nodes number: 72247
first layer output nodes number: 21641
edges number: 171522
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3765177726745605  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3971562385559082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4023160934448242  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4023160934448242  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4264569282531738  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4264569282531738  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.427248477935791  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4343924522399902  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4346909523010254  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4346909523010254  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4353795051574707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4462265968322754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4467101097106934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4467101097106934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4472575187683105  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.460768222808838  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([215, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4613213539123535  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4613213539123535  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4617314338684082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4736237525939941  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([181, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4742889404296875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4742889404296875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4746341705322266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4870624542236328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([156, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4877896308898926  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4877896308898926  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4880871772766113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5008816719055176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.501601219177246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.501601219177246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.501847267150879  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5141496658325195  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5149264335632324  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5149264335632324  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5151495933532715  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.527869701385498  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5285630226135254  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5285630226135254  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.528740406036377  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.540092945098877  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5409560203552246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5409560203552246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.541144847869873  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.554551601409912  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5550918579101562  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5550918579101562  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.555206298828125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5641326904296875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.564767837524414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.564767837524414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5648822784423828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5746097564697266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5751152038574219  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5751152038574219  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5752010345458984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5830974578857422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5836739540100098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5836739540100098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5837616920471191  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5924477577209473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5931391716003418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5931391716003418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5932364463806152  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6035475730895996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6038837432861328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6038837432861328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6039314270019531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6093196868896484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.609868049621582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.609868049621582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6099348068237305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.617945671081543  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6184487342834473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6184487342834473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6185078620910645  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6260170936584473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6264443397521973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6264443397521973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6264920234680176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6328816413879395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.633223056793213  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.633223056793213  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6332592964172363  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.638369083404541  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6386537551879883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6386537551879883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6386823654174805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6429166793823242  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6433043479919434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6433043479919434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6433405876159668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6489577293395996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6493158340454102  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6493158340454102  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.649348258972168  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6546010971069336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6549773216247559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6549773216247559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6550097465515137  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.660489559173584  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([324, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6682586669921875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6682586669921875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6688766479492188  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.778181552886963  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 324, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7570724487304688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7574963569641113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.757920265197754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7574748992919922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21641
output nodes number: 2842
edges number: 23779
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7576580047607422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7576584815979004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04459524154663086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 31 input nodes size: 71317
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04044914245605469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04044914245605469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07445573806762695  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0744771957397461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04000568389892578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04145240783691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04145240783691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04145240783691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([71317, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04145240783691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([849, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12597227096557617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12597227096557617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12678194046020508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13325929641723633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([1022, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13382911682128906  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13382911682128906  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13480377197265625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.14942359924316406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([1166, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.150604248046875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.150604248046875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1166, 128]), torch.Size([1, 1166, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1517162322998047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1761798858642578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1166, 128])
m.shape torch.Size([1106, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1777334213256836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1777334213256836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1787881851196289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2098073959350586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1091, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21188116073608398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21188116073608398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2129216194152832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25132083892822266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1004, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25367307662963867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25367307662963867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1004, 128]), torch.Size([1, 1004, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25463056564331055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.297025203704834  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1004, 128])
m.shape torch.Size([910, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29958391189575195  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.29958391189575195  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.30045175552368164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3446211814880371  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([879, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34754037857055664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34754037857055664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 879, 128]), torch.Size([1, 879, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34837865829467773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39707231521606445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 879, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40012073516845703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40012073516845703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4008913040161133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4502077102661133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([12761, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5106716156005859  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5106716156005859  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12761, 128]), torch.Size([1, 12761, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5228414535522461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3871474266052246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12761, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3089194297790527  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.329514980316162  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3501105308532715  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3293538093566895  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21596, 256])
first layer input nodes number: 71317
first layer output nodes number: 21596
edges number: 170578
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3506441116333008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3712396621704102  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3770222663879395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3770222663879395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([417, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4001336097717285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4001336097717285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4009289741516113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4073519706726074  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([364, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4076542854309082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4076542854309082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.408348560333252  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.418961524963379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.419482707977295  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.419482707977295  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4200568199157715  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.433729648590088  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4342961311340332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4342961311340332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4347195625305176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4469990730285645  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4478235244750977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4478235244750977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4482145309448242  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4622907638549805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([161, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4630241394042969  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4630241394042969  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4633312225341797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4765357971191406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4771156311035156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4771156311035156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4773235321044922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4877185821533203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4884376525878906  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4884376525878906  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4886417388916016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.500274658203125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5010552406311035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5010552406311035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5012497901916504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5137009620666504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5142574310302734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5142574310302734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5143871307373047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5235958099365234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.524017333984375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.524017333984375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5241050720214844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5309486389160156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5316085815429688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5316085815429688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5317249298095703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5416145324707031  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5421438217163086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5421438217163086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5422334671020508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.550480842590332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5511226654052734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5511226654052734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5512199401855469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5608501434326172  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5613064765930176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5613064765930176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.561373233795166  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5684494972229004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5689854621887207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5689854621887207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5690560340881348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5770306587219238  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5776329040527344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5776329040527344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.577707290649414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5866336822509766  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5871500968933105  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5871500968933105  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5872111320495605  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5949625968933105  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5954070091247559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5954070091247559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.595456600189209  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6021018028259277  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6024041175842285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6024041175842285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6024365425109863  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.607008457183838  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6074366569519043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6074366569519043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6074786186218262  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6136889457702637  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6139640808105469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6139640808105469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6139907836914062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6181297302246094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6186251640319824  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6186251640319824  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.618669033050537  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6257758140563965  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6262845993041992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6262845993041992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.626328468322754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.633742332458496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([310, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.641169548034668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.641169548034668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6417608261108398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.749223232269287  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 310, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.729154109954834  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7295775413513184  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7300009727478027  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7295560836791992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2839, 40])
input nodes number: 21596
output nodes number: 2839
edges number: 23498
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7297382354736328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.729738712310791  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.044121742248535156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04967212677001953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04967212677001953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01574954390525818 |0.013314731419086456 |0.13142794370651245 |9.372085332870483e-05 |0.07623673975467682 |0.005926370620727539 |
----------------------------------------------------------pseudo_mini_loss sum 5.341135501861572
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2939570
Number of first layer input nodes during this epoch:  2259025
Number of first layer output nodes during this epoch:  680545
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04967164993286133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.021106243133544922
number of batches is  32
batch size is  2842
range selection method spend 0.016881465911865234
time for parepare:  0.019794464111328125
local_output_nid generation:  0.0008342266082763672
local_in_edges_tensor generation:  0.0036911964416503906
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.0074193477630615234
local_output_nid generation:  0.0009510517120361328
local_in_edges_tensor generation:  0.0005931854248046875
mini_batch_src_global generation:  0.0012001991271972656
r_  generation:  0.007695198059082031
local_output_nid generation:  0.0008533000946044922
local_in_edges_tensor generation:  0.0004940032958984375
mini_batch_src_global generation:  0.0007572174072265625
r_  generation:  0.0068225860595703125
local_output_nid generation:  0.0008404254913330078
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0008018016815185547
r_  generation:  0.006716012954711914
local_output_nid generation:  0.0008230209350585938
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.0006837844848632812
r_  generation:  0.0069425106048583984
local_output_nid generation:  0.0008625984191894531
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0007009506225585938
r_  generation:  0.007187366485595703
local_output_nid generation:  0.0008089542388916016
local_in_edges_tensor generation:  0.0004684925079345703
mini_batch_src_global generation:  0.0007026195526123047
r_  generation:  0.007086753845214844
local_output_nid generation:  0.0007965564727783203
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.0007026195526123047
r_  generation:  0.007266044616699219
local_output_nid generation:  0.0008854866027832031
local_in_edges_tensor generation:  0.0004558563232421875
mini_batch_src_global generation:  0.0006837844848632812
r_  generation:  0.007193803787231445
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0006937980651855469
r_  generation:  0.007075786590576172
local_output_nid generation:  0.0007982254028320312
local_in_edges_tensor generation:  0.00046062469482421875
mini_batch_src_global generation:  0.0006933212280273438
r_  generation:  0.007112026214599609
local_output_nid generation:  0.0007998943328857422
local_in_edges_tensor generation:  0.0004608631134033203
mini_batch_src_global generation:  0.0006868839263916016
r_  generation:  0.007127285003662109
local_output_nid generation:  0.0007970333099365234
local_in_edges_tensor generation:  0.00045228004455566406
mini_batch_src_global generation:  0.0006973743438720703
r_  generation:  0.0073049068450927734
local_output_nid generation:  0.0007891654968261719
local_in_edges_tensor generation:  0.0004513263702392578
mini_batch_src_global generation:  0.0007030963897705078
r_  generation:  0.007081031799316406
local_output_nid generation:  0.0008471012115478516
local_in_edges_tensor generation:  0.0004620552062988281
mini_batch_src_global generation:  0.0007016658782958984
r_  generation:  0.007137298583984375
local_output_nid generation:  0.0007855892181396484
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0007295608520507812
r_  generation:  0.007373332977294922
local_output_nid generation:  0.000789642333984375
local_in_edges_tensor generation:  0.0004596710205078125
mini_batch_src_global generation:  0.0007154941558837891
r_  generation:  0.007212400436401367
local_output_nid generation:  0.0007922649383544922
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0008397102355957031
r_  generation:  0.007166385650634766
local_output_nid generation:  0.0007925033569335938
local_in_edges_tensor generation:  0.00045680999755859375
mini_batch_src_global generation:  0.0007226467132568359
r_  generation:  0.007415771484375
local_output_nid generation:  0.0007841587066650391
local_in_edges_tensor generation:  0.0004513263702392578
mini_batch_src_global generation:  0.0007224082946777344
r_  generation:  0.0074045658111572266
local_output_nid generation:  0.0008859634399414062
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.0007367134094238281
r_  generation:  0.0072481632232666016
local_output_nid generation:  0.0007843971252441406
local_in_edges_tensor generation:  0.00045228004455566406
mini_batch_src_global generation:  0.0007519721984863281
r_  generation:  0.007426261901855469
local_output_nid generation:  0.0007834434509277344
local_in_edges_tensor generation:  0.00045752525329589844
mini_batch_src_global generation:  0.0007297992706298828
r_  generation:  0.007509469985961914
local_output_nid generation:  0.0008714199066162109
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.0007169246673583984
r_  generation:  0.007454872131347656
local_output_nid generation:  0.0008094310760498047
local_in_edges_tensor generation:  0.0004496574401855469
mini_batch_src_global generation:  0.0007143020629882812
r_  generation:  0.00726008415222168
local_output_nid generation:  0.0008668899536132812
local_in_edges_tensor generation:  0.00045371055603027344
mini_batch_src_global generation:  0.0007195472717285156
r_  generation:  0.007658720016479492
local_output_nid generation:  0.0007810592651367188
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.0007343292236328125
r_  generation:  0.007315158843994141
local_output_nid generation:  0.0007789134979248047
local_in_edges_tensor generation:  0.0004622936248779297
mini_batch_src_global generation:  0.0007112026214599609
r_  generation:  0.007254600524902344
local_output_nid generation:  0.0007801055908203125
local_in_edges_tensor generation:  0.0004558563232421875
mini_batch_src_global generation:  0.0007307529449462891
r_  generation:  0.0073397159576416016
local_output_nid generation:  0.0007891654968261719
local_in_edges_tensor generation:  0.0004591941833496094
mini_batch_src_global generation:  0.0008394718170166016
r_  generation:  0.0074002742767333984
local_output_nid generation:  0.0007607936859130859
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.0009005069732666016
r_  generation:  0.007210969924926758
local_output_nid generation:  0.0008697509765625
local_in_edges_tensor generation:  0.0004448890686035156
mini_batch_src_global generation:  0.0007088184356689453
r_  generation:  0.0072252750396728516
----------------------check_connections_block total spend ----------------------------- 0.3799755573272705
generate_one_block  0.019329071044921875
generate_one_block  0.01404881477355957
generate_one_block  0.01186227798461914
generate_one_block  0.011877298355102539
generate_one_block  0.01216268539428711
generate_one_block  0.012234210968017578
generate_one_block  0.012029886245727539
generate_one_block  0.012288808822631836
generate_one_block  0.012043952941894531
generate_one_block  0.011840581893920898
generate_one_block  0.011842012405395508
generate_one_block  0.011766433715820312
generate_one_block  0.011918783187866211
generate_one_block  0.013919591903686523
generate_one_block  0.012033462524414062
generate_one_block  0.012230396270751953
generate_one_block  0.01177215576171875
generate_one_block  0.011794328689575195
generate_one_block  0.012147903442382812
generate_one_block  0.011869430541992188
generate_one_block  0.011847972869873047
generate_one_block  0.01258540153503418
generate_one_block  0.01197052001953125
generate_one_block  0.011786937713623047
generate_one_block  0.01216888427734375
generate_one_block  0.012107133865356445
generate_one_block  0.012197494506835938
generate_one_block  0.011889457702636719
generate_one_block  0.0121002197265625
generate_one_block  0.012271404266357422
generate_one_block  0.011969804763793945
generate_one_block  0.011765003204345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024915695190429688
gen group dst list time:  0.020160913467407227
time for parepare:  0.01934051513671875
local_output_nid generation:  0.0036797523498535156
local_in_edges_tensor generation:  0.008383035659790039
mini_batch_src_global generation:  0.005342721939086914
r_  generation:  0.05794382095336914
local_output_nid generation:  0.005782365798950195
local_in_edges_tensor generation:  0.005770444869995117
mini_batch_src_global generation:  0.01003885269165039
r_  generation:  0.06017184257507324
local_output_nid generation:  0.005872011184692383
local_in_edges_tensor generation:  0.005075931549072266
mini_batch_src_global generation:  0.0054547786712646484
r_  generation:  0.06115388870239258
local_output_nid generation:  0.006092071533203125
local_in_edges_tensor generation:  0.005353212356567383
mini_batch_src_global generation:  0.005928516387939453
r_  generation:  0.06386089324951172
local_output_nid generation:  0.0067217350006103516
local_in_edges_tensor generation:  0.005192995071411133
mini_batch_src_global generation:  0.006251811981201172
r_  generation:  0.0634770393371582
local_output_nid generation:  0.0063419342041015625
local_in_edges_tensor generation:  0.005096912384033203
mini_batch_src_global generation:  0.006677389144897461
r_  generation:  0.06435155868530273
local_output_nid generation:  0.006412029266357422
local_in_edges_tensor generation:  0.005071401596069336
mini_batch_src_global generation:  0.006634950637817383
r_  generation:  0.06406569480895996
local_output_nid generation:  0.0063588619232177734
local_in_edges_tensor generation:  0.005091667175292969
mini_batch_src_global generation:  0.006983280181884766
r_  generation:  0.06444001197814941
local_output_nid generation:  0.006233692169189453
local_in_edges_tensor generation:  0.01146245002746582
mini_batch_src_global generation:  0.009799718856811523
r_  generation:  0.06687211990356445
local_output_nid generation:  0.007632255554199219
local_in_edges_tensor generation:  0.006525278091430664
mini_batch_src_global generation:  0.006682157516479492
r_  generation:  0.06246304512023926
local_output_nid generation:  0.006130218505859375
local_in_edges_tensor generation:  0.005247592926025391
mini_batch_src_global generation:  0.007065534591674805
r_  generation:  0.06375694274902344
local_output_nid generation:  0.006119966506958008
local_in_edges_tensor generation:  0.0054285526275634766
mini_batch_src_global generation:  0.006696462631225586
r_  generation:  0.06328177452087402
local_output_nid generation:  0.006140232086181641
local_in_edges_tensor generation:  0.005192279815673828
mini_batch_src_global generation:  0.00748896598815918
r_  generation:  0.06374144554138184
local_output_nid generation:  0.0062711238861083984
local_in_edges_tensor generation:  0.005226612091064453
mini_batch_src_global generation:  0.0065691471099853516
r_  generation:  0.06319069862365723
local_output_nid generation:  0.00627446174621582
local_in_edges_tensor generation:  0.02674388885498047
mini_batch_src_global generation:  0.006471395492553711
r_  generation:  0.06304550170898438
local_output_nid generation:  0.006365537643432617
local_in_edges_tensor generation:  0.005334615707397461
mini_batch_src_global generation:  0.007214546203613281
r_  generation:  0.06544303894042969
local_output_nid generation:  0.006147623062133789
local_in_edges_tensor generation:  0.005172252655029297
mini_batch_src_global generation:  0.006620645523071289
r_  generation:  0.06347799301147461
local_output_nid generation:  0.006299734115600586
local_in_edges_tensor generation:  0.005495548248291016
mini_batch_src_global generation:  0.006852149963378906
r_  generation:  0.06365752220153809
local_output_nid generation:  0.006338357925415039
local_in_edges_tensor generation:  0.005647420883178711
mini_batch_src_global generation:  0.006887674331665039
r_  generation:  0.06577491760253906
local_output_nid generation:  0.006291389465332031
local_in_edges_tensor generation:  0.00568699836730957
mini_batch_src_global generation:  0.006786346435546875
r_  generation:  0.06403088569641113
local_output_nid generation:  0.006383419036865234
local_in_edges_tensor generation:  0.005171775817871094
mini_batch_src_global generation:  0.00728154182434082
r_  generation:  0.0637507438659668
local_output_nid generation:  0.006453275680541992
local_in_edges_tensor generation:  0.006269216537475586
mini_batch_src_global generation:  0.006934165954589844
r_  generation:  0.06499385833740234
local_output_nid generation:  0.006425619125366211
local_in_edges_tensor generation:  0.0063610076904296875
mini_batch_src_global generation:  0.006998538970947266
r_  generation:  0.06509208679199219
local_output_nid generation:  0.006291389465332031
local_in_edges_tensor generation:  0.005201816558837891
mini_batch_src_global generation:  0.006945133209228516
r_  generation:  0.06421589851379395
local_output_nid generation:  0.00632786750793457
local_in_edges_tensor generation:  0.00596308708190918
mini_batch_src_global generation:  0.0068569183349609375
r_  generation:  0.06321525573730469
local_output_nid generation:  0.006313323974609375
local_in_edges_tensor generation:  0.005682706832885742
mini_batch_src_global generation:  0.007060527801513672
r_  generation:  0.06371498107910156
local_output_nid generation:  0.006396293640136719
local_in_edges_tensor generation:  0.006785869598388672
mini_batch_src_global generation:  0.00712132453918457
r_  generation:  0.06457996368408203
local_output_nid generation:  0.00630497932434082
local_in_edges_tensor generation:  0.005685567855834961
mini_batch_src_global generation:  0.019304275512695312
r_  generation:  0.06364870071411133
local_output_nid generation:  0.006379842758178711
local_in_edges_tensor generation:  0.005795478820800781
mini_batch_src_global generation:  0.007509469985961914
r_  generation:  0.06583309173583984
local_output_nid generation:  0.006362438201904297
local_in_edges_tensor generation:  0.005350589752197266
mini_batch_src_global generation:  0.007149219512939453
r_  generation:  0.06518411636352539
local_output_nid generation:  0.006469249725341797
local_in_edges_tensor generation:  0.005246162414550781
mini_batch_src_global generation:  0.006986856460571289
r_  generation:  0.06530594825744629
local_output_nid generation:  0.00642704963684082
local_in_edges_tensor generation:  0.0057086944580078125
mini_batch_src_global generation:  0.006862640380859375
r_  generation:  0.0646212100982666
----------------------check_connections_block total spend ----------------------------- 3.222893714904785
generate_one_block  0.08960390090942383
generate_one_block  0.08402061462402344
generate_one_block  0.08145952224731445
generate_one_block  0.08339929580688477
generate_one_block  0.08383584022521973
generate_one_block  0.12219929695129395
generate_one_block  0.08707761764526367
generate_one_block  0.08646917343139648
generate_one_block  0.08598709106445312
generate_one_block  0.08539032936096191
generate_one_block  0.0874643325805664
generate_one_block  0.09797000885009766
generate_one_block  0.09167027473449707
generate_one_block  0.10239744186401367
generate_one_block  0.09148430824279785
generate_one_block  0.09197616577148438
generate_one_block  0.10074114799499512
generate_one_block  0.08490109443664551
generate_one_block  0.09663558006286621
generate_one_block  0.09034872055053711
generate_one_block  0.08804130554199219
generate_one_block  0.0874168872833252
generate_one_block  0.1022188663482666
generate_one_block  0.09609103202819824
generate_one_block  0.08380889892578125
generate_one_block  0.08485174179077148
generate_one_block  0.08544683456420898
generate_one_block  0.08407449722290039
generate_one_block  0.11652207374572754
generate_one_block  0.09143424034118652
generate_one_block  0.0866544246673584
generate_one_block  0.08809494972229004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04967164993286133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

connection checking time:  3.222893714904785
block generation total time  2.919687509536743
average batch blocks generation time:  0.09124023467302322
block dataloader generation time/epoch 7.3566296100616455
pseudo mini batch 0 input nodes size: 70308
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04555463790893555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04555463790893555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07908010482788086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0791015625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.045073509216308594  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.046478271484375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.046478271484375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.046478271484375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([70308, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.046478271484375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([846, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12770938873291016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12770938873291016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.12851619720458984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13497066497802734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([1035, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13584041595458984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13584041595458984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1368274688720703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15163326263427734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([1134, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15276193618774414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15276193618774414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15384340286254883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17770051956176758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1152, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17935705184936523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.17935705184936523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.18045568466186523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21231603622436523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1036, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21423673629760742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21423673629760742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2152247428894043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25093984603881836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([990, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2532782554626465  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2532782554626465  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.25422239303588867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2955336570739746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([882, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2980055809020996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2980055809020996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 882, 128]), torch.Size([1, 882, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2988467216491699  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34096860885620117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 882, 128])
m.shape torch.Size([877, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34389352798461914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.34389352798461914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3447299003601074  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.39240312576293945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([820, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3955039978027344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3955039978027344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3962860107421875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4478607177734375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([12265, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5060634613037109  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5060634613037109  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12265, 128]), torch.Size([1, 12265, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5177602767944336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3495502471923828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12265, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2745299339294434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2945923805236816  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.31465482711792  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.2944355010986328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21037, 256])
first layer input nodes number: 70308
first layer output nodes number: 21037
edges number: 165266
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.315180778503418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3352432250976562  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.340571403503418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.340571403503418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3633208274841309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3633208274841309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3641505241394043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3717679977416992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3720417022705078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3720417022705078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3727245330810547  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3857536315917969  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3862862586975098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3862862586975098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.386864185333252  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4006524085998535  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([236, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.401270866394043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.401270866394043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4017210006713867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4147748947143555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([178, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4154052734375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4154052734375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4157447814941406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4279670715332031  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.428731918334961  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.428731918334961  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4290409088134766  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4423274993896484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([132, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.443061351776123  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.443061351776123  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4433131217956543  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4559016227722168  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.456552505493164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.456552505493164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4567451477050781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4677257537841797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4683647155761719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4683647155761719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.468526840209961  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.478902816772461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.479590892791748  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.479590892791748  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.479743480682373  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.490577220916748  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4912834167480469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4912834167480469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.491424560546875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5024337768554688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5030670166015625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5030670166015625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.503183364868164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5130729675292969  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5135273933410645  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5135273933410645  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5136055946350098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5208001136779785  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5214338302612305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5214338302612305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.521529197692871  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.530970573425293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5313410758972168  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5313410758972168  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5313963890075684  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.537259578704834  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5376935005187988  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5376935005187988  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5377507209777832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5442166328430176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5446949005126953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5446949005126953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5447540283203125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.551849365234375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.552443027496338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.552443027496338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5525116920471191  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.561232089996338  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5614900588989258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5614900588989258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5615205764770508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5656099319458008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.566171646118164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.566171646118164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5662288665771484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5742969512939453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5745916366577148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5745916366577148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5746221542358398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5791387557983398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5795464515686035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5795464515686035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5795845985412598  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5854973793029785  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5858983993530273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5858983993530273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5859346389770508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5918054580688477  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5922951698303223  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5922951698303223  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5923371315002441  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.599428653717041  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6065444946289062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6065444946289062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6071109771728516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7087321281433105  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6890544891357422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6894783973693848  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6899023056030273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6894569396972656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21037
output nodes number: 2842
edges number: 23102
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6896357536315918  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6896367073059082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04908466339111328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 1 input nodes size: 70739
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0450749397277832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0450749397277832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.07880592346191406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.0788273811340332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04528045654296875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04671955108642578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04671955108642578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04671955108642578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([70739, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.04671955108642578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([814, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1300802230834961  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1300802230834961  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13085651397705078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13706684112548828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([1076, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13781213760375977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.13781213760375977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1388382911682129  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15423059463500977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([1189, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15627717971801758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.15627717971801758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1189, 128]), torch.Size([1, 1189, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1574110984802246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.1823573112487793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1189, 128])
m.shape torch.Size([1093, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.18387508392333984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.18387508392333984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.18491744995117188  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21573162078857422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1092, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21781396865844727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.21781396865844727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2188553810119629  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.257387638092041  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([991, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.259702205657959  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.259702205657959  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.2606472969055176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.30191564559936523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([947, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.30460405349731445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.30460405349731445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.30550718307495117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3506636619567871  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([882, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.35357666015625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.35357666015625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 882, 128]), torch.Size([1, 882, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.3544178009033203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4026451110839844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 882, 128])
m.shape torch.Size([851, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40587663650512695  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40587663650512695  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.40668821334838867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.4587278366088867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([12600, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5188689231872559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5188689231872559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12600, 128]), torch.Size([1, 12600, 128])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 0.5308852195739746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3848724365234375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12600, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3078269958496094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.328364372253418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3489017486572266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3282036781311035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21535, 256])
first layer input nodes number: 70739
first layer output nodes number: 21535
edges number: 169655
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.349431037902832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3699684143066406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3751029968261719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3751029968261719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([413, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3981404304504395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.3981404304504395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.398928165435791  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4052300453186035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.405588150024414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.405588150024414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4063339233398438  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.417612075805664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4180612564086914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4180612564086914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.418604850769043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4325547218322754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4331021308898926  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4331021308898926  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4335083961486816  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4452900886535645  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([180, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4459524154663086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4459524154663086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4462957382202148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4586553573608398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([126, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4592103958129883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4592103958129883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4594507217407227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4697847366333008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([148, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4706692695617676  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4706692695617676  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4709515571594238  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4850659370422363  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4858169555664062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4858169555664062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4860382080078125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4986495971679688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4993610382080078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.4993610382080078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.499542236328125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.511138916015625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.511913776397705  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.511913776397705  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5120854377746582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.52427339553833  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5249171257019043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5249171257019043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5250487327575684  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5353140830993652  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5358366966247559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5358366966247559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5359339714050293  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5442023277282715  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.544816017150879  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.544816017150879  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.544917106628418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5542173385620117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5547184944152832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5547184944152832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5547966957092285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5625386238098145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5630621910095215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5630621910095215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5631365776062012  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.571021556854248  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.571645736694336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.571645736694336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5717277526855469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5809955596923828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.581526756286621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.581526756286621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5815935134887695  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.589604377746582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5900211334228516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5900211334228516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5900707244873047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5963687896728516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5968375205993652  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5968375205993652  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.5968890190124512  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6037898063659668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6043987274169922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6043987274169922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.604461669921875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6133365631103516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6137895584106445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6137895584106445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.613835334777832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.620610237121582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6208624839782715  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6208624839782715  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.620887279510498  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6247305870056152  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6251606941223145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6251606941223145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6251988410949707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6313786506652832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6318440437316895  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6318440437316895  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6318840980529785  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.63865327835083  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([290, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.645601749420166  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.645601749420166  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.6461548805236816  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7517027854919434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 290, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.732649803161621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7330737113952637  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7334976196289062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7330522537231445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21535
output nodes number: 2842
edges number: 23424
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7332344055175781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8846435546875 GB
    Memory Allocated: 1.7332348823547363  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04937553405761719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 2 input nodes size: 69500
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04528045654296875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04528045654296875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.07848358154296875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.07850503921508789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([69500, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.12677431106567383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.12677431106567383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.12753915786743164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13396835327148438  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([1066, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13460254669189453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13460254669189453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1356191635131836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15086841583251953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1135, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15198373794555664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15198373794555664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15306615829467773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1769270896911621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1079, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.17844390869140625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.17844390869140625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1794729232788086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.20931434631347656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1057, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2113199234008789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2113199234008789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2123279571533203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.24933195114135742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([976, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2516202926635742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2516202926635742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2525510787963867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2934904098510742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([951, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.29619932174682617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.29619932174682617  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 951, 128]), torch.Size([1, 951, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2971062660217285  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3424534797668457  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 951, 128])
m.shape torch.Size([869, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.34531497955322266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.34531497955322266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3461437225341797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.39399194717407227  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([798, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3970022201538086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3970022201538086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3977632522583008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.4465947151184082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([12149, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.5048079490661621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.5048079490661621  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12149, 128]), torch.Size([1, 12149, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.5163941383361816  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3469672203063965  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12149, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.2724981307983398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.2924127578735352  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3123273849487305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.2922568321228027  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([20882, 256])
first layer input nodes number: 69500
first layer output nodes number: 20882
edges number: 164077
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3128471374511719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3327617645263672  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3382377624511719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3382377624511719  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([433, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3606820106506348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3606820106506348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3615078926086426  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3696155548095703  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3699545860290527  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3699545860290527  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3707003593444824  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.385068416595459  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3855695724487305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3855695724487305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3861474990844727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4000558853149414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4005861282348633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4005861282348633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4009923934936523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4127740859985352  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.413527488708496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.413527488708496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4139070510864258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4275712966918945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4282755851745605  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4282755851745605  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4285712242126465  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4412837028503418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4419636726379395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4419636726379395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4421982765197754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4539284706115723  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([83, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4544496536254883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4544496536254883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4546079635620117  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4636316299438477  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([100, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4644179344177246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4644179344177246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4646086692810059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4768157005310059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4774703979492188  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4774703979492188  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4776191711425781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4881820678710938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4888482093811035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4888482093811035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4889817237854004  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4993958473205566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.500032901763916  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.500032901763916  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5001492500305176  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5100388526916504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5105557441711426  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5105557441711426  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.510643482208252  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5187153816223145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.519169807434082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.519169807434082  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.519240379333496  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5262269973754883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5267972946166992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5267972946166992  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5268774032592773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5353689193725586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5358519554138184  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5358519554138184  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.535916805267334  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5432448387145996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5438170433044434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5438170433044434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5438876152038574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.552356243133545  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5528230667114258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5528230667114258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5528783798217773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5599031448364258  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5603322982788086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5603322982788086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.560379981994629  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5667695999145508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5673036575317383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5673036575317383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5673589706420898  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5751581192016602  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.575554370880127  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.575554370880127  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.575594425201416  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5815224647521973  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.581883430480957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.581883430480957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5819177627563477  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5872392654418945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5874876976013184  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5874876976013184  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.587510585784912  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5912184715270996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5913686752319336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5913686752319336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5913820266723633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5936384201049805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([296, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6007442474365234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6007442474365234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.601308822631836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.704094409942627  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 296, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6847190856933594  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.685142993927002  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6855669021606445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6851215362548828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 20882
output nodes number: 2842
edges number: 22785
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6852989196777344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6852993965148926  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04872846603393555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 3 input nodes size: 70582
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.07840871810913086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.07843017578125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04520559310913086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.046617984771728516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.046617984771728516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.046617984771728516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([70582, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.046617984771728516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([814, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.129119873046875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.129119873046875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1298961639404297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1361064910888672  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([1104, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13677120208740234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13677120208740234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13782405853271484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15361690521240234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1122, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1546955108642578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1546955108642578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1122, 128]), torch.Size([1, 1122, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15576553344726562  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.18011188507080078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1122, 128])
m.shape torch.Size([1052, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.18158340454101562  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.18158340454101562  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.182586669921875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.21168136596679688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1107, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.21381902694702148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.21381902694702148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2148747444152832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2539339065551758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([953, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2561326026916504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2561326026916504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.25704145431518555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.29612207412719727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([917, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.29872846603393555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.29872846603393555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2996029853820801  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3441438674926758  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([890, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.34710168838500977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.34710168838500977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.34795045852661133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3978409767150879  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([749, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.4006309509277344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.4006309509277344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 749, 128]), torch.Size([1, 749, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.40134525299072266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.44897937774658203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 749, 128])
m.shape torch.Size([12421, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.507850170135498  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.507850170135498  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12421, 128]), torch.Size([1, 12421, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.5196957588195801  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3607325553894043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12421, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.2844057083129883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.304555892944336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3247060775756836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3043980598449707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21129, 256])
first layer input nodes number: 70582
first layer output nodes number: 21129
edges number: 166339
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3252339363098145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.345384120941162  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.350672721862793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.350672721862793  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3733563423156738  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3733563423156738  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.374147891998291  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3808293342590332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3811430931091309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3811430931091309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3818469047546387  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.393908977508545  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3943819999694824  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3943819999694824  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3949275016784668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4096431732177734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([236, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4102778434753418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4102778434753418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4107279777526855  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4237818717956543  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4252643585205078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4252643585205078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4256591796875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4398727416992188  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4405465126037598  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4405465126037598  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4408345222473145  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.453218936920166  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4539499282836914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4539499282836914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.454197883605957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4665956497192383  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.467325210571289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.467325210571289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4675369262695312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.479604721069336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.480156421661377  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.480156421661377  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4803013801574707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4895787239074707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.49031400680542  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.49031400680542  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4904742240905762  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.50184965133667  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.502488613128662  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.502488613128662  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5026183128356934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5127348899841309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5133390426635742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5133390426635742  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5134496688842773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.522852897644043  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5235347747802734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5235347747802734  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5236473083496094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5340003967285156  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5346035957336426  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5346035957336426  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5346970558166504  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5439496040344238  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5445809364318848  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5445809364318848  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.544670581817627  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5541729927062988  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5546202659606934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5546202659606934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5546813011169434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5615782737731934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5621037483215332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5621037483215332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5621685981750488  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5699505805969238  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5703682899475098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5703682899475098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.570417881011963  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5767159461975098  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5772209167480469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5772209167480469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5772762298583984  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5846881866455078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5850834846496582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5850834846496582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.58512544631958  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5910420417785645  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5912632942199707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5912632942199707  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5912861824035645  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5946736335754395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5950217247009277  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5950217247009277  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5950541496276855  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6000800132751465  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6003737449645996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6003737449645996  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.600400447845459  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6047263145446777  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6050591468811035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6050591468811035  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6050877571105957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6099228858947754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.616997241973877  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.616997241973877  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6175599098205566  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7289438247680664  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7093148231506348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7097387313842773  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.71016263961792  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7097172737121582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21129
output nodes number: 2842
edges number: 23052
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7098965644836426  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7098970413208008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04923534393310547  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 4 input nodes size: 70831
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04520559310913086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04520559310913086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.0789804458618164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.07900190353393555  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.04532432556152344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.046753883361816406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.046753883361816406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.046753883361816406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([70831, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.046753883361816406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([842, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1294260025024414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1294260025024414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13022899627685547  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13686466217041016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([1077, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13749027252197266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.13749027252197266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.1385173797607422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15392398834228516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1137, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15503692626953125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15503692626953125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.15612125396728516  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.17998981475830078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1105, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.18155527114868164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.18155527114868164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.18260908126831055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.21373224258422852  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1018, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.21563243865966797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.21563243865966797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.21660327911376953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2525749206542969  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([970, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2548646926879883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2548646926879883  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.25578975677490234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2955808639526367  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([987, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2984127998352051  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.2984127998352051  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.29935407638549805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3471236228942871  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([912, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3501319885253906  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3501319885253906  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 912, 128]), torch.Size([1, 912, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.3510017395019531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.4009742736816406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 912, 128])
m.shape torch.Size([812, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.4040241241455078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.4040241241455078  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.4047985076904297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.45699119567871094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([12497, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.51715087890625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.51715087890625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12497, 128]), torch.Size([1, 12497, 128])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 0.5290689468383789  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3753571510314941  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12497, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.2989635467529297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.319331169128418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3396987915039062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3191719055175781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21357, 256])
first layer input nodes number: 70831
first layer output nodes number: 21357
edges number: 168220
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.34022855758667  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3605961799621582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3656883239746094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3656883239746094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3887829780578613  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3887829780578613  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3895764350891113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3961257934570312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.39642333984375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.39642333984375  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.3971118927001953  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4085044860839844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([267, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4089303016662598  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4089303016662598  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4094395637512207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.423841953277588  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4244794845581055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4244794845581055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.424921989440918  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4377546310424805  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([185, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.438422679901123  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.438422679901123  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4387755393981934  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4514784812927246  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4521732330322266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4521732330322266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4524612426757812  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4648456573486328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4656925201416016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4656925201416016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.465972900390625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4799919128417969  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4806900024414062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4806900024414062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4808979034423828  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4927482604980469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4934492111206055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.4934492111206055  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.493626594543457  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.504979133605957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.505669116973877  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.505669116973877  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5058236122131348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5167927742004395  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.517519474029541  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.517519474029541  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5176644325256348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5289711952209473  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5296602249145508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5296602249145508  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5297861099243164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5404863357543945  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5411605834960938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5411605834960938  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5412731170654297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.551626205444336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5521893501281738  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5521893501281738  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5522770881652832  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5609631538391113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.561467170715332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.561467170715332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.561539649963379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5692224502563477  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5697245597839355  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5697245597839355  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.569791316986084  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5773348808288574  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5777592658996582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5777592658996582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.577812671661377  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.584221363067627  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5847482681274414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5847482681274414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5848093032836914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5925607681274414  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5930051803588867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5930051803588867  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5930547714233398  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.5996999740600586  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6001558303833008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6001558303833008  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.600203514099121  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6069269180297852  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6074886322021484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6074886322021484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6075439453125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6157302856445312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6160411834716797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6160411834716797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6160717010498047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6208019256591797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6210966110229492  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6210966110229492  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6211233139038086  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6254491806030273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6257820129394531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6257820129394531  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6258106231689453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.630645751953125  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([295, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6377201080322266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6377201080322266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.6382827758789062  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.748873233795166  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 295, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.728837013244629  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7292609214782715  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.729684829711914  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7292394638061523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([2842, 40])
input nodes number: 21357
output nodes number: 2842
edges number: 23479
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7294201850891113  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8865966796875 GB
    Memory Allocated: 1.7294206619262695  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04939699172973633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

pseudo mini batch 5 input nodes size: 71837
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04532432556152344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04532432556152344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.07957887649536133  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.07960033416748047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04580402374267578  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.0472564697265625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.0472564697265625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.0472564697265625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([71837, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.0472564697265625  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([804, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1317615509033203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1317615509033203  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13252830505371094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13866233825683594  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([1077, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13930606842041016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13930606842041016  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1403331756591797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15573978424072266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1137, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15685272216796875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15685272216796875  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15793704986572266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.18234777450561523  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1139, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.18397808074951172  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.18397808074951172  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.18506431579589844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.21656513214111328  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([1099, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2186422348022461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2186422348022461  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.21969032287597656  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2581462860107422  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1036, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2605862617492676  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2605862617492676  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.26157426834106445  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3043370246887207  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([917, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3069038391113281  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3069038391113281  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.30777835845947266  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.35182714462280273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([828, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.35454845428466797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.35454845428466797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.35533809661865234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4010953903198242  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.40419816970825195  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.40419816970825195  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.40497541427612305  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4567880630493164  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([12809, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.5174775123596191  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.5174775123596191  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 12809, 128]), torch.Size([1, 12809, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.5296931266784668  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4190678596496582  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 12809, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3408465385437012  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.361504077911377  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3821616172790527  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.361342430114746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

torch.Size([21661, 256])
first layer input nodes number: 71837
first layer output nodes number: 21661
edges number: 171104
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3826990127563477  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4033565521240234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.408933162689209  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.408933162689209  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

m.shape torch.Size([419, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4330787658691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4330787658691406  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.433877944946289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4402713775634766  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([379, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4406003952026367  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4406003952026367  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4413232803344727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4528985023498535  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([274, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4533271789550781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4533271789550781  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4538497924804688  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4665489196777344  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([228, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4671645164489746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4671645164489746  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4675993919372559  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.480210781097412  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([177, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4808440208435059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4808440208435059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4811816215515137  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.493335247039795  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([144, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4939970970153809  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4939970970153809  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4942717552185059  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5060820579528809  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5068597793579102  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5068597793579102  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5071191787719727  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5200891494750977  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5207514762878418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5207514762878418  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5209479331970215  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5321459770202637  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.532869815826416  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.532869815826416  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5330510139465332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5446476936340332  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5453166961669922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5453166961669922  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5454673767089844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5561656951904297  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5568199157714844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5568199157714844  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5569515228271484  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5672168731689453  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5678319931030273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5678319931030273  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5679445266723633  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.577509880065918  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.578141212463379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.578141212463379  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5782461166381836  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5878973007202148  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5885448455810547  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5885448455810547  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.588644027709961  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5984630584716797  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5989184379577637  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5989184379577637  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.598985195159912  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6060614585876465  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6065049171447754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6065049171447754  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6065640449523926  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6132454872131348  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.61378812789917  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.61378812789917  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6138548851013184  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6218657493591309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6222996711730957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6222996711730957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6223511695861816  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6288914680480957  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6293773651123047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6293773651123047  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6294307708740234  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.636587142944336  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.637002944946289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.637002944946289  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6370468139648438  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6432323455810547  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6435737609863281  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6435737609863281  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6436080932617188  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6486892700195312  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6490530967712402  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6490530967712402  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6490874290466309  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6544089317321777  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6547455787658691  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6547455787658691  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6547760963439941  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6597199440002441  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6600279808044434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6600279808044434  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6600546836853027  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.664567470550537  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([328, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6724357604980469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6724357604980469  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6730613708496094  GigaBytes
Max Memory Allocated: 1.7929253578186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7871508598327637  GigaBytes
Max Memory Allocated: 1.794970989227295  GigaBytes

rst.shape  torch.Size([1, 328, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7660369873046875  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.76646089553833  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7668848037719727  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.766439437866211  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

torch.Size([2842, 40])
input nodes number: 21661
output nodes number: 2842
edges number: 23763
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.766622543334961  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7666230201721191  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.049939632415771484  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

pseudo mini batch 6 input nodes size: 71013
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04580402374267578  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04580402374267578  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.0796656608581543  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.07968711853027344  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.045411109924316406  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04685401916503906  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04685401916503906  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04685401916503906  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

torch.Size([71013, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04685401916503906  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

m.shape torch.Size([804, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13134479522705078  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13134479522705078  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1321115493774414  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1382455825805664  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([1067, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13887977600097656  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13887977600097656  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13989734649658203  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15516090393066406  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([1077, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15635442733764648  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15635442733764648  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15738153457641602  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1799778938293457  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([1100, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1815624237060547  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1815624237060547  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.18261146545410156  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2136821746826172  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1092, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2157611846923828  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2157611846923828  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.21680259704589844  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2552833557128906  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1040, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2577381134033203  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2577381134033203  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1040, 128]), torch.Size([1, 1040, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2587299346923828  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3018665313720703  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1040, 128])
m.shape torch.Size([927, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.30446481704711914  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.30446481704711914  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 927, 128]), torch.Size([1, 927, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.30534887313842773  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.34963369369506836  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 927, 128])
m.shape torch.Size([880, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.35254859924316406  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.35254859924316406  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.35338783264160156  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4018440246582031  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([812, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4049091339111328  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4049091339111328  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4056835174560547  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4572329521179199  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([12691, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.517392635345459  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.517392635345459  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 12691, 128]), torch.Size([1, 12691, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.5294957160949707  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3893404006958008  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 12691, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3110966682434082  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3315911293029785  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3520855903625488  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3314309120178223  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

torch.Size([21490, 256])
first layer input nodes number: 71013
first layer output nodes number: 21490
edges number: 170016
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.352616786956787  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3731112480163574  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.378990650177002  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.378990650177002  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

m.shape torch.Size([392, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.402048110961914  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.402048110961914  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4027957916259766  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4087772369384766  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([346, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4090685844421387  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4090685844421387  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4097285270690918  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4199681282043457  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([317, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4205522537231445  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4205522537231445  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.421156883239746  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4362030029296875  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4367618560791016  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4367618560791016  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4371891021728516  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4495792388916016  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.450326919555664  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.450326919555664  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4507083892822266  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4644412994384766  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4651098251342773  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4651098251342773  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4653940200805664  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.477614402770996  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4783940315246582  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4783940315246582  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4786553382873535  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4917206764221191  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.492497444152832  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.492497444152832  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.492722511291504  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5055513381958008  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5062694549560547  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5062694549560547  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5064525604248047  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5181713104248047  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5187525749206543  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5187525749206543  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5188860893249512  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5283656120300293  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5290918350219727  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5290918350219727  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5292348861694336  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5403928756713867  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5409445762634277  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5409445762634277  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5410475730895996  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.549802303314209  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5505132675170898  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5505132675170898  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5506296157836914  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5613336563110352  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.561948299407959  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.561948299407959  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5620436668395996  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5714850425720215  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5719709396362305  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5719709396362305  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5720415115356445  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5795221328735352  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5799331665039062  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5799331665039062  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5799884796142578  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5862388610839844  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5867013931274414  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5867013931274414  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5867586135864258  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5936250686645508  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5942020416259766  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5942020416259766  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.594268798828125  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6027469635009766  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6032071113586426  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6032071113586426  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6032586097717285  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6101593971252441  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6106529235839844  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6106529235839844  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6107044219970703  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6179656982421875  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6184449195861816  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6184449195861816  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.618492603302002  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6255497932434082  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6259069442749023  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6259069442749023  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.625941276550293  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6312627792358398  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6316437721252441  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6316437721252441  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6316781044006348  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.637239933013916  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.63759183883667  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.63759183883667  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.637622356414795  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.64277982711792  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.649756908416748  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.649756908416748  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6503119468688965  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7515664100646973  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7315483093261719  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7319722175598145  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.732396125793457  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7319507598876953  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

torch.Size([2842, 40])
input nodes number: 21490
output nodes number: 2842
edges number: 23464
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7321324348449707  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.732132911682129  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.0495147705078125  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

pseudo mini batch 7 input nodes size: 71709
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.045411109924316406  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.045411109924316406  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.0796046257019043  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.07962608337402344  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04574298858642578  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04720306396484375  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04720306396484375  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04720306396484375  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

torch.Size([71709, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.04720306396484375  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

m.shape torch.Size([783, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13170814514160156  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13170814514160156  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 783, 128]), torch.Size([1, 783, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.13245487213134766  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1384286880493164  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 783, 128])
m.shape torch.Size([1094, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1390986442565918  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1390986442565918  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.14014196395874023  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1557917594909668  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([1219, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1570138931274414  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1570138931274414  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1219, 128]), torch.Size([1, 1219, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.15817642211914062  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.18375205993652344  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1219, 128])
m.shape torch.Size([1110, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1852879524230957  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.1852879524230957  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.18634653091430664  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.21710634231567383  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1061, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.21910667419433594  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.21910667419433594  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.22011852264404297  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.25679636001586914  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([970, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2590656280517578  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2590656280517578  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.2599906921386719  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.29976844787597656  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([955, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3024935722351074  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3024935722351074  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3034043312072754  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.34894227981567383  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([890, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3518819808959961  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.3518819808959961  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.35273075103759766  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.40282726287841797  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([803, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.40584897994995117  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.40584897994995117  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4066147804260254  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.4565110206604004  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([12868, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.5174875259399414  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.5174875259399414  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 12868, 128]), torch.Size([1, 12868, 128])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 0.529759407043457  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4205408096313477  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 12868, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3423328399658203  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3630781173706055  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3838233947753906  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3629159927368164  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

torch.Size([21753, 256])
first layer input nodes number: 71709
first layer output nodes number: 21753
edges number: 171905
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.3843598365783691  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4051051139831543  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.410428524017334  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.410428524017334  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

m.shape torch.Size([370, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4345264434814453  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4345264434814453  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.435232162475586  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4418535232543945  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4422235488891602  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4422235488891602  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4429407119750977  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4541997909545898  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([324, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4547758102416992  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4547758102416992  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4553937911987305  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4692420959472656  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4697985649108887  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4697985649108887  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4702277183532715  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.482673168182373  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([183, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4833383560180664  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4833383560180664  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.483687400817871  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4962530136108398  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.496891975402832  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.496891975402832  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.4971609115600586  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5087251663208008  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([131, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.509472370147705  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.509472370147705  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5097222328186035  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5222153663635254  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5229825973510742  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5229825973510742  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5232038497924805  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5358152389526367  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5364227294921875  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5364227294921875  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.536581039428711  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.546712875366211  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.547316551208496  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.547316551208496  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5474519729614258  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5570669174194336  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5578346252441406  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5578346252441406  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5579853057861328  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5697383880615234  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5702400207519531  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5702400207519531  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5703353881835938  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5784416198730469  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5790815353393555  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5790815353393555  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5791864395141602  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5888376235961914  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5893774032592773  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5893774032592773  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.589461326599121  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5977697372436523  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5982904434204102  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5982904434204102  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.5983648300170898  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6062498092651367  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6068124771118164  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6068124771118164  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.606886863708496  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6152925491333008  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6159090995788574  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6159090995788574  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.61598539352417  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.62514066696167  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6256389617919922  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6256389617919922  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6256980895996094  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6332073211669922  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.633725643157959  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.633725643157959  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6337828636169434  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6414504051208496  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6419219970703125  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6419219970703125  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6419715881347656  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6489639282226562  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6495246887207031  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6495246887207031  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6495800018310547  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.657766342163086  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6581406593322754  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6581406593322754  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6581768989562988  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6637940406799316  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.664262294769287  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.664262294769287  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.664304256439209  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6711020469665527  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6715426445007324  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6715426445007324  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6715807914733887  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.678027629852295  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([299, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6851930618286133  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6851930618286133  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.6857633590698242  GigaBytes
Max Memory Allocated: 1.7949767112731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.788074016571045  GigaBytes
Max Memory Allocated: 1.7952027320861816  GigaBytes

rst.shape  torch.Size([1, 299, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7669892311096191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8885498046875 GB
    Memory Allocated: 1.7674131393432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7678370475769043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7673916816711426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21753
output nodes number: 2842
edges number: 23882
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7675752639770508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.767575740814209  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04989480972290039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 8 input nodes size: 71609
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04574298858642578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04574298858642578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07988882064819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0799102783203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04569530487060547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.047145843505859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.047145843505859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.047145843505859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71609, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.047145843505859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([840, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1316671371459961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1316671371459961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13246822357177734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13887691497802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([1062, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13948917388916016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13948917388916016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1405019760131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15569400787353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1143, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15682268142700195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15682268142700195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1579127311706543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18234920501708984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([1117, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18393468856811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18393468856811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18499994277954102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21619939804077148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1112, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21831798553466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21831798553466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21937847137451172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2579984664916992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1010, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2603578567504883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2603578567504883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2613210678100586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30351734161376953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([942, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3061800003051758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3061800003051758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30707836151123047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35199642181396484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([869, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3548622131347656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3548622131347656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35569095611572266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4033927917480469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([804, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40642881393432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40642881393432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4071955680847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.45715951919555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([12784, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5177350044250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5177350044250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12784, 128]), torch.Size([1, 12784, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5299267768859863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3956069946289062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12784, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3174090385437012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.338087558746338  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3587660789489746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.337925910949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21683, 256])
first layer input nodes number: 71609
first layer output nodes number: 21683
edges number: 171103
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3593015670776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3799800872802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3856639862060547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3856639862060547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([401, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4087719917297363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4087719917297363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4095368385314941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4156670570373535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4159655570983887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4159655570983887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4166407585144043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.426957607269287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4274277687072754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4274277687072754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.427961826324463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4410924911499023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4417481422424316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4417481422424316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4422059059143066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4554810523986816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.456160545349121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.456160545349121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4565210342407227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.469498634338379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([175, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4703335762023926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4703335762023926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4706673622131348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4850201606750488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([147, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4858684539794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4858684539794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4861488342285156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5001678466796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5008506774902344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5008506774902344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5010547637939453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5126876831054688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5133299827575684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5133299827575684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5134940147399902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5239920616149902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5247077941894531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5247077941894531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5248661041259766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5361061096191406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5368413925170898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5368413925170898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5369882583618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5484437942504883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.549039363861084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.549039363861084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.549149990081787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5585532188415527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5589981079101562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5589981079101562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5590744018554688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5660934448242188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5665535926818848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5665535926818848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5666241645812988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.573610782623291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5741524696350098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5741524696350098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5742287635803223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5823159217834473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5829086303710938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5829086303710938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.582986831665039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5918235778808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5922584533691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5922584533691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5923137664794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5989513397216797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5994772911071777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5994772911071777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5995383262634277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6072897911071777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6076064109802246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6076064109802246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.607642650604248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6124987602233887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6129612922668457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6129612922668457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.613008975982666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.61973237991333  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.620112419128418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.620112419128418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6201505661010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6257963180541992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6263060569763184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6263060569763184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6263537406921387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.633744716644287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6340084075927734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6340084075927734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.634033203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6380500793457031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6384992599487305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6384992599487305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6385374069213867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.644984245300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([304, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6523613929748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6523613929748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6529412269592285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.757697582244873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7376251220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.738049030303955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7384729385375977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.738027572631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21683
output nodes number: 2842
edges number: 23509
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.738210678100586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7382111549377441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04982328414916992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 9 input nodes size: 70433
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04569530487060547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04569530487060547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07928037643432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07930183410644531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045134544372558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04653739929199219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04653739929199219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04653739929199219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70433, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04653739929199219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([848, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12768173217773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12768173217773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12849044799804688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13496017456054688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([1016, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13552474975585938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13552474975585938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13649368286132812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15102767944335938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([1095, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15210962295532227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15210962295532227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1531538963317871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17686223983764648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1172, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1785755157470703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1785755157470703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1172, 128]), torch.Size([1, 1172, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17969322204589844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21210670471191406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1172, 128])
m.shape torch.Size([1077, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21411561965942383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21411561965942383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1077, 128]), torch.Size([1, 1077, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21514272689819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2521185874938965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1077, 128])
m.shape torch.Size([937, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2542858123779297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2542858123779297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25517940521240234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29360389709472656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([910, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29619455337524414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29619455337524414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29706239700317383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34155988693237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([900, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3445591926574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3445591926574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34541749954223633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39554262161254883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39919519424438477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39919519424438477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.399965763092041  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4496440887451172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([12238, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5078525543212891  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5078525543212891  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12238, 128]), torch.Size([1, 12238, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5195236206054688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3510303497314453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12238, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2760915756225586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2961196899414062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.316147804260254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2959628105163574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21001, 256])
first layer input nodes number: 70433
first layer output nodes number: 21001
edges number: 165082
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3166747093200684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.336702823638916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3420653343200684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3420653343200684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.364762783050537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.364762783050537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3655943870544434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3733315467834473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3735790252685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3735790252685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.374237060546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.387279987335205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.387784481048584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.387784481048584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3883357048034668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4023399353027344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4030065536499023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4030065536499023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4034738540649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4170255661010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([184, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4176764488220215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4176764488220215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.418027400970459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.430661678314209  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.431380271911621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.431380271911621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.431675910949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4443883895874023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4450278282165527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4450278282165527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4452509880065918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.456408977508545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4570741653442383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4570741653442383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4572668075561523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.468247413635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4690423011779785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4690423011779785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4692387580871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4818120002746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([101, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.48268461227417  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.48268461227417  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.482877254486084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4965548515319824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4970612525939941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4970612525939941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4971699714660645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5056500434875488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5062880516052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5062880516052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5064024925231934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.516129970550537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5168476104736328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5168476104736328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5169658660888672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5278453826904297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5284323692321777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5284323692321777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5285239219665527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5375876426696777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.538219928741455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.538219928741455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5383095741271973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5478119850158691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5482287406921387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5482287406921387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.548285961151123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5547518730163574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.555295467376709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.555295467376709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5553622245788574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.56337308883667  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5638070106506348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5638070106506348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5638585090637207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5703988075256348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.570847988128662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.570847988128662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5708975791931152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.577542781829834  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5779027938842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5779027938842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5779409408569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5833196640014648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5836238861083984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5836238861083984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5836544036865234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5881710052490234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.588515281677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.588515281677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.588547706604004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5935735702514648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.593977451324463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.593977451324463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5940136909484863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5998845100402832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.600327968597412  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.600327968597412  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6003661155700684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6068129539489746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([282, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.613570213317871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.613570213317871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6141080856323242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.711533546447754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 282, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6919231414794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6923470497131348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6927709579467773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6923255920410156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21001
output nodes number: 2842
edges number: 23049
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6925039291381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6925044059753418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04914140701293945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 10 input nodes size: 70551
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045134544372558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045134544372558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07877588272094727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0787973403930664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04519081115722656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04660797119140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04660797119140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04660797119140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70551, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04660797119140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([869, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12914752960205078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12914752960205078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 869, 128]), torch.Size([1, 869, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1299762725830078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13660621643066406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 869, 128])
m.shape torch.Size([1067, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13720941543579102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13720941543579102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1067, 128]), torch.Size([1, 1067, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13822698593139648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15349054336547852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1067, 128])
m.shape torch.Size([1153, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1546311378479004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1546311378479004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1153, 128]), torch.Size([1, 1153, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1557307243347168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18021011352539062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1153, 128])
m.shape torch.Size([1110, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1817774772644043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1817774772644043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18283605575561523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2139296531677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1151, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21614456176757812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21614456176757812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1151, 128]), torch.Size([1, 1151, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21724224090576172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2567586898803711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1151, 128])
m.shape torch.Size([997, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2590622901916504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2590622901916504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 997, 128]), torch.Size([1, 997, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2600131034851074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3014798164367676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 997, 128])
m.shape torch.Size([931, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30411195755004883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30411195755004883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30499982833862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3495512008666992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([945, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35271215438842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35271215438842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35361337661743164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4049830436706543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([806, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4079914093017578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4079914093017578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40876007080078125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4585404396057129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([12301, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5168118476867676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5168118476867676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12301, 128]), torch.Size([1, 12301, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5285429954528809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3614544868469238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12301, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2852773666381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.305619239807129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3259611129760742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.305459976196289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21330, 256])
first layer input nodes number: 70551
first layer output nodes number: 21330
edges number: 166980
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.326488971710205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3468308448791504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3526344299316406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3526344299316406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([428, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3753294944763184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3753294944763184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.376145839691162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3832488059997559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([348, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.383509635925293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.383509635925293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3841733932495117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3953814506530762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([298, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3959088325500488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3959088325500488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.396477222442627  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4161057472229004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([244, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.416759967803955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.416759967803955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4172253608703613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4307217597961426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4314265251159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4314265251159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4317984580993652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.445188045501709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4458212852478027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4458212852478027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.446092128753662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4577383995056152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([140, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.458545207977295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.458545207977295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4588122367858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4721636772155762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4728760719299316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4728760719299316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.473085880279541  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4850449562072754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4857964515686035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4857964515686035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.485985279083252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.498070240020752  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4987449645996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4987449645996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4988975524902344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5097312927246094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5102577209472656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5102577209472656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.510366439819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5188465118408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5195999145507812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5195999145507812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5197334289550781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5310821533203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5316028594970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5316028594970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5316925048828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5399398803710938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.540339469909668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.540339469909668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5404024124145508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5466337203979492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5471649169921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5471649169921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5472393035888672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.555124282836914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5555176734924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5555176734924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5555710792541504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5616059303283691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5621514320373535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5621514320373535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.562218189239502  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5702290534973145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5707149505615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5707149505615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5707721710205078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5780391693115234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5785584449768066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5785584449768066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.578615665435791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5862832069396973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5867352485656738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5867352485656738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5867829322814941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5935063362121582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5939269065856934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5939269065856934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5939688682556152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6001791954040527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.600602626800537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.600602626800537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6006426811218262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6068511009216309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6071186065673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6071186065673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6071434020996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6111602783203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6116557121276855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6116557121276855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6116976737976074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6187891960144043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6256403923034668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6256403923034668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6261858940124512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7419395446777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7223200798034668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7227439880371094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.723167896270752  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7227225303649902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21330
output nodes number: 2842
edges number: 23051
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7229032516479492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7229037284851074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04923391342163086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 11 input nodes size: 70117
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04519081115722656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04519081115722656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07862520217895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07864665985107422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044983863830566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04638099670410156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04638099670410156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04638099670410156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70117, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04638099670410156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([866, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1272449493408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1272449493408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12807083129882812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13467788696289062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([1069, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13590526580810547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13590526580810547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13692474365234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15221691131591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1128, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15404939651489258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15404939651489258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1128, 128]), torch.Size([1, 1128, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15512514114379883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17895936965942383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1128, 128])
m.shape torch.Size([1079, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1804795265197754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1804795265197754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18150854110717773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2113499641418457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1048, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2133340835571289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2133340835571289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21433353424072266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25111865997314453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([957, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25335693359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25335693359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 957, 128]), torch.Size([1, 957, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2542695999145508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2935323715209961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 957, 128])
m.shape torch.Size([881, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2960166931152344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2960166931152344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 881, 128]), torch.Size([1, 881, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2968568801879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3388662338256836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 881, 128])
m.shape torch.Size([890, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3418412208557129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3418412208557129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34268999099731445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3928208351135254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([787, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39577388763427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39577388763427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 787, 128]), torch.Size([1, 787, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39652442932128906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.44461631774902344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 787, 128])
m.shape torch.Size([12244, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5028347969055176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5028347969055176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12244, 128]), torch.Size([1, 12244, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5145115852355957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.346081256866455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12244, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2713985443115234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.291377067565918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3113555908203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2912206649780273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([20949, 256])
first layer input nodes number: 70117
first layer output nodes number: 20949
edges number: 164496
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.311880111694336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3318586349487305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3370394706726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3370394706726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([431, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3595962524414062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3595962524414062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3604183197021484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3681106567382812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([391, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3684515953063965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3684515953063965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3691973686218262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.382957935333252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.383415699005127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.383415699005127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.383965015411377  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3970694541931152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([214, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3976178169250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3976178169250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3980259895324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.409862995147705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([205, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4106760025024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4106760025024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.411067008972168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4251432418823242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.425830364227295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.425830364227295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4261221885681152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4386706352233887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([123, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4393525123596191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4393525123596191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.439587116241455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.451317310333252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.45200777053833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.45200777053833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4522080421447754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4636235237121582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.464284896850586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.464284896850586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4644527435302734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4751949310302734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4758129119873047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4758129119873047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4759521484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4858379364013672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4864449501037598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4864449501037598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4865670204162598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4960885047912598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4967083930969238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4967083930969238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4968209266662598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5063862800598145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5070300102233887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5070300102233887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5071368217468262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5169634819030762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5175294876098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5175294876098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5176172256469727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5263032913208008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.526850700378418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.526850700378418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5269289016723633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5352182388305664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5356407165527344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5356407165527344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5356979370117188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5421638488769531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5426583290100098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5426583290100098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5427193641662598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5500435829162598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5504283905029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5504283905029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5504741668701172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5562877655029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5567216873168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5567216873168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5567693710327148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5631589889526367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([33, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.563769817352295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.563769817352295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5638327598571777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5727076530456543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5731406211853027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5731406211853027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5731844902038574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5796771049499512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.580204963684082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.580204963684082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5802545547485352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5879411697387695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5881595611572266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5881595611572266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5881805419921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5915794372558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5919380187988281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5919380187988281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5919685363769531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5971260070800781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.603959083557129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.603959083557129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6045026779174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7023429870605469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.682863712310791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6832876205444336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6837115287780762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6832661628723145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 20949
output nodes number: 2842
edges number: 22906
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6834440231323242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6834444999694824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04897308349609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 12 input nodes size: 69335
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044983863830566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044983863830566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0781869888305664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07820844650268555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([69335, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([845, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12668418884277344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12668418884277344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12749004364013672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13393688201904297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([1121, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13460302352905273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13460302352905273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13567209243774414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15250635147094727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1208, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1536998748779297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1536998748779297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1208, 128]), torch.Size([1, 1208, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15485191345214844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18019676208496094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1208, 128])
m.shape torch.Size([1111, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18173980712890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18173980712890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1827993392944336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21361541748046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([1104, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21571779251098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21571779251098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21677064895629883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25525331497192383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1019, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2576422691345215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2576422691345215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25861406326293945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3008885383605957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([891, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3033766746520996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3033766746520996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3042263984680176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3478355407714844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([795, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35044336318969727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35044336318969727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35120153427124023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39499521255493164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([827, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.398165225982666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.398165225982666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.398953914642334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4506072998046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([12094, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5088067054748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5088067054748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12094, 128]), torch.Size([1, 12094, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5203404426574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3503365516662598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12094, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2760682106018066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.296109676361084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3161511421203613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2959527969360352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21015, 256])
first layer input nodes number: 69335
first layer output nodes number: 21015
edges number: 163769
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3166699409484863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3367114067077637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3420605659484863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3420605659484863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3647851943969727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3647851943969727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.365555763244629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3737382888793945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.374131679534912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.374131679534912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3749041557312012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3899197578430176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([297, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3903899192810059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3903899192810059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3909564018249512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4051156044006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4056978225708008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4056978225708008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4061269760131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4185724258422852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4192328453063965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4192328453063965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4195799827575684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4320769309997559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([143, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4327282905578613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4327282905578613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4330010414123535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4447293281555176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4454407691955566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4454407691955566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.445681095123291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4576973915100098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.458338737487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.458338737487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4585275650024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4692907333374023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4700355529785156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4700355529785156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4702205657958984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4820613861083984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4828243255615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4828243255615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4829940795898438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.495046615600586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([66, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4956598281860352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4956598281860352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4957857131958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5056047439575195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.506314754486084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.506314754486084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5064425468444824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5173048973083496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.517878532409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.517878532409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5179758071899414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5269250869750977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5274958610534668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5274958610534668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5275835990905762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5362696647644043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5367450714111328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5367450714111328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.536813735961914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5440921783447266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5446271896362305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5446271896362305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5446977615356445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5526723861694336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5530786514282227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5530786514282227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5531301498413086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.559309959411621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.559889793395996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.559889793395996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5599565505981445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.568434715270996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5688400268554688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5688400268554688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5688858032226562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5750198364257812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5753045082092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5753045082092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5753350257873535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5796380043029785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5800065994262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5800065994262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.580042839050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5854063034057617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5857901573181152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5857901573181152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5858263969421387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5914435386657715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5918679237365723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5918679237365723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5919060707092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.598085880279541  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5984129905700684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5984129905700684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5984416007995605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6032767295837402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([297, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6103992462158203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6103992462158203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6109657287597656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.713822364807129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6941399574279785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.694563865661621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6949877738952637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.694542407989502  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21015
output nodes number: 2842
edges number: 23106
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.69472074508667  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6947212219238281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04873228073120117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 13 input nodes size: 69707
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07799148559570312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07801294326782227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044788360595703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([69707, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([833, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12669658660888672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12669658660888672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12749099731445312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13384628295898438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([1066, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13446569442749023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13446569442749023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1354823112487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15073156356811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([1095, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15178966522216797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15178966522216797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1528339385986328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17580795288085938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1141, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17746210098266602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17746210098266602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17855024337768555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21013879776000977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1042, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21207904815673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21207904815673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2130727767944336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.24905014038085938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([984, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25136852264404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25136852264404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2523069381713867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29342174530029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([940, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29609012603759766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29609012603759766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 940, 128]), torch.Size([1, 940, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29698657989501953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3418149948120117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 940, 128])
m.shape torch.Size([849, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3446054458618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3446054458618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3454151153564453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39254093170166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3955221176147461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3955221176147461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3962745666503906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4448676109313965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([12090, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5030851364135742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5030851364135742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12090, 128]), torch.Size([1, 12090, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5146150588989258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.344569206237793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12090, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2702155113220215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2900795936584473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.309943675994873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.289924144744873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([20829, 256])
first layer input nodes number: 69707
first layer output nodes number: 20829
edges number: 163301
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3104653358459473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.330329418182373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.335820198059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.335820198059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([441, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3579864501953125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3579864501953125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3588275909423828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3672189712524414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3674774169921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3674774169921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3681507110595703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3819580078125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3824691772460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3824691772460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3830299377441406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.396287441253662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3969106674194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3969106674194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3973588943481445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4103574752807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([192, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4110560417175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4110560417175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4114222526550293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4246058464050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4253973960876465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4253973960876465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4257197380065918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4395804405212402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.440206527709961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.440206527709961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4404296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4515876770019531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([112, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4523372650146484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4523372650146484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4525508880615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4647274017333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.465468406677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.465468406677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4656553268432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4776182174682617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4782938957214355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4782938957214355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4784464836120605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4892802238464355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4899864196777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4899864196777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4901275634765625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5011367797851562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5017929077148438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5017929077148438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.501913070678711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5121269226074219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5126166343688965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5126166343688965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5127005577087402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5204215049743652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5210390090942383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5210390090942383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.521132469177246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5303850173950195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.53098726272583  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.53098726272583  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5310730934143066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5401711463928223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5405588150024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5405588150024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5406122207641602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.546647071838379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.547257900238037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.547257900238037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5473322868347168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5562586784362793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5567235946655273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5567235946655273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.556778907775879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5638036727905273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.564323902130127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.564323902130127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5643811225891113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5720486640930176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.572481632232666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.572481632232666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5725274085998535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.578981876373291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5794639587402344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5794639587402344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5795116424560547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.586568832397461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.586820125579834  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.586820125579834  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5868449211120605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5906882286071777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5910077095031738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5910077095031738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.591036319732666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5956711769104004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5960259437561035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5960259437561035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5960564613342285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6012139320373535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([257, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6073741912841797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6073741912841797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6078643798828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.697901725769043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 257, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6788463592529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6792702674865723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6796941757202148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6792488098144531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 20829
output nodes number: 2842
edges number: 22491
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6794257164001465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6794261932373047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04874420166015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 14 input nodes size: 70454
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044788360595703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044788360595703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0783834457397461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07840490341186523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04514455795288086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04655027389526367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04655027389526367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04655027389526367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70454, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04655027389526367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([848, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1279430389404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1279430389404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1287517547607422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1352214813232422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([1090, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13593482971191406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13593482971191406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13697433471679688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15256690979003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1120, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1542520523071289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1542520523071289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1553201675415039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1791238784790039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1084, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18065738677978516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18065738677978516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18169116973876953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21259403228759766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1027, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21452569961547852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21452569961547852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21550512313842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2507643699645996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([1008, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2531585693359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2531585693359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.254119873046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2957611083984375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([931, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2983880043029785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2983880043029785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29927587509155273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34394359588623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([880, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34685659408569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34685659408569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 880, 128]), torch.Size([1, 880, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34769582748413086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39640378952026367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 880, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3994259834289551  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3994259834289551  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4001908302307129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4491410255432129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12291, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5073666572570801  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5073666572570801  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12291, 128]), torch.Size([1, 12291, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5190882682800293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3513226509094238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12291, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2761530876159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.296257495880127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.316361904144287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.29610013961792  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21081, 256])
first layer input nodes number: 70454
first layer output nodes number: 21081
edges number: 165592
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3168888092041016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3369932174682617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3428397178649902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3428397178649902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.365405559539795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.365405559539795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3661952018737793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.373608112335205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([388, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3739595413208008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3739595413208008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.374699592590332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3878345489501953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([273, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.388251781463623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.388251781463623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3887724876403809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.404686450958252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([254, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.405402660369873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.405402660369873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4058871269226074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4199366569519043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([206, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4216499328613281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4216499328613281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4220428466796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.436187744140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4368624687194824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4368624687194824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.437150478363037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4495348930358887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([151, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4513463973999023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4513463973999023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.451634407043457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4660348892211914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4667906761169434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4667906761169434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4670138359069824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.479733943939209  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([74, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4802627563476562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4802627563476562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4804039001464844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4894371032714844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([71, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4900493621826172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4900493621826172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4901847839355469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4997997283935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5003666877746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5003666877746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.500481128692627  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5094075202941895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5099849700927734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5099849700927734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5100898742675781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5190067291259766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5195794105529785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5195794105529785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5196747779846191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5284485816955566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5288586616516113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5288586616516113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.528923511505127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5353436470031738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5357728004455566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5357728004455566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5358338356018066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5423035621643066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.542780876159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.542780876159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5428438186645508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5499563217163086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5503497123718262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5503497123718262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5503993034362793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5563502311706543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.556654453277588  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.556654453277588  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5566906929016113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.561293125152588  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5617866516113281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5617866516113281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5618400573730469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5689964294433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5695080757141113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5695080757141113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.56956148147583  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5770916938781738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.577488899230957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.577488899230957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.577528953552246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5834569931030273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.583796501159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.583796501159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5838289260864258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5888547897338867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5891704559326172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5891704559326172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5891990661621094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5938339233398438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5941658020019531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5941658020019531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5941944122314453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.599029541015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([310, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6064643859863281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6064643859863281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6070556640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7298760414123535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 310, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7103486061096191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7107725143432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7111964225769043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7107510566711426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21081
output nodes number: 2842
edges number: 22930
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7109298706054688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.710930347442627  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.049157142639160156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 15 input nodes size: 71099
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04514455795288086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04514455795288086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07904720306396484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07906866073608398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045452117919921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046904563903808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046904563903808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046904563903808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71099, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046904563903808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13140630722045898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13140630722045898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13217782974243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1383500099182129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([1063, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1389780044555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1389780044555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13999176025390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1551980972290039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([1110, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15641450881958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15641450881958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15747308731079102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18123865127563477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1132, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18286848068237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18286848068237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1132, 128]), torch.Size([1, 1132, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18394804000854492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21535444259643555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1132, 128])
m.shape torch.Size([1063, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21734905242919922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21734905242919922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1063, 128]), torch.Size([1, 1063, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21836280822753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2551083564758301  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1063, 128])
m.shape torch.Size([990, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2574338912963867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2574338912963867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2583780288696289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2996244430541992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([893, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30213308334350586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30213308334350586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30298471450805664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3472127914428711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([854, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35004472732543945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35004472732543945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 854, 128]), torch.Size([1, 854, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3508591651916504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39728212356567383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 854, 128])
m.shape torch.Size([817, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40038108825683594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40038108825683594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40116024017333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4527444839477539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([12845, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5136046409606934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5136046409606934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12845, 128]), torch.Size([1, 12845, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5258545875549316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4162788391113281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12845, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.338003158569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3585796356201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3791561126708984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3584184646606445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21576, 256])
first layer input nodes number: 71099
first layer output nodes number: 21576
edges number: 170934
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.379687786102295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4002642631530762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.405686378479004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.405686378479004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([424, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4298381805419922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4298381805419922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4306468963623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.438077449798584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([342, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4383306503295898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4383306503295898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4389829635620117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4493165016174316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.449815273284912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.449815273284912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4503607749938965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4632182121276855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4638566970825195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4638566970825195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.464308738708496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4774179458618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4781723022460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4781723022460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4785614013671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4925689697265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4932336807250977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4932336807250977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4935178756713867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5057382583618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5063095092773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5063095092773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5065116882324219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5166206359863281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5172500610351562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5172500610351562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5174312591552734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5277595520019531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5284476280212402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5284476280212402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5286192893981934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5396056175231934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([96, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5404424667358398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5404424667358398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5406255722045898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5536260604858398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5542960166931152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5542960166931152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5544333457946777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5651450157165527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([76, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.565953254699707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.565953254699707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5660982131958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5784196853637695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5788097381591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5788097381591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5788803100585938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5853729248046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.585970401763916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.585970401763916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5860600471496582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5949349403381348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5955533981323242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5955533981323242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5956411361694336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6049413681030273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6054973602294922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6054973602294922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6055717468261719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6139774322509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6145777702331543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6145777702331543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.614652156829834  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6235785484313965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6239914894104004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6239914894104004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6240410804748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6303391456604004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.630551815032959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.630551815032959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6305766105651855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.633899211883545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6343097686767578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6343097686767578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6343517303466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.640268325805664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6406917572021484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6406917572021484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6407337188720703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6469440460205078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.647134780883789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.647134780883789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6471538543701172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6501102447509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6502776145935059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6502776145935059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6502928733825684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6527647972106934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6532187461853027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6532187461853027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.653256893157959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6597037315368652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([336, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6677584648132324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6677584648132324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6683993339538574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7839741706848145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 336, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7628521919250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7632761001586914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.763700008392334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7632546424865723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21576
output nodes number: 2842
edges number: 23821
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.763437271118164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7634377479553223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.049581050872802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 16 input nodes size: 69765
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045452117919921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045452117919921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07871866226196289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07874011993408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044816017150878906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04621696472167969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04621696472167969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04621696472167969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([69765, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04621696472167969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([833, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1273055076599121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1273055076599121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12809991836547852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13445520401000977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([1075, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13546323776245117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13546323776245117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1364884376525879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15186643600463867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1085, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15381622314453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15381622314453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15485095977783203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17852115631103516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1800980567932129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1800980567932129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18114519119262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21219491958618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1097, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21428680419921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21428680419921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2153329849243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25386476516723633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([920, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25597381591796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25597381591796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2568511962890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2952384948730469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([916, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29785728454589844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29785728454589844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 916, 128]), torch.Size([1, 916, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29873085021972656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3434715270996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 916, 128])
m.shape torch.Size([847, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3462657928466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3462657928466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3470735549926758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39327430725097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3964066505432129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3964066505432129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39719247817993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4483036994934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([12275, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5065045356750488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5065045356750488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12275, 128]), torch.Size([1, 12275, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5182108879089355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3501057624816895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12275, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2751808166503906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2951793670654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3151779174804688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.295022964477539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([20970, 256])
first layer input nodes number: 69765
first layer output nodes number: 20970
edges number: 164989
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3157000541687012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3356986045837402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3410272598266602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3410272598266602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3636860847473145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3636860847473145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3644795417785645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3719816207885742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3722639083862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3722639083862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3729372024536133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3862762451171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([280, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3867473602294922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3867473602294922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3872814178466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3993535041809082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3999824523925781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3999824523925781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4004268646240234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4133148193359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([199, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4140491485595703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4140491485595703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4144287109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4280929565429688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([159, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4288201332092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4288201332092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4291234016418457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4421639442443848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4429411888122559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4429411888122559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.443204402923584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4563651084899902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4570717811584473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4570717811584473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4572796821594238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.469130039215088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4698395729064941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4698395729064941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4700188636779785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4814934730529785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4823074340820312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4823074340820312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4824867248535156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4952163696289062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([75, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4959197044372559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4959197044372559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4960627555847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.50722074508667  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5079569816589355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5079569816589355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5080904960632324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5194392204284668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5198974609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5198974609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5199775695800781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5273475646972656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5278730392456055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5278730392456055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5279531478881836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.535883903503418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5365362167358398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5365362167358398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5366277694702148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5463323593139648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5468864440917969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5468864440917969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5469608306884766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5553665161132812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5559015274047852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5559015274047852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5559682846069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.563979148864746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5643439292907715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5643439292907715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5643877983093262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5699591636657715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5703210830688477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5703210830688477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5703611373901367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.575728416442871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5762276649475098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5762276649475098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5762791633605957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.583540439605713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5839385986328125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5839385986328125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5839786529541016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5899066925048828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5901618003845215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5901618003845215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.590186595916748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5940299034118652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.594283103942871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.594283103942871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5943059921264648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5980138778686523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5982565879821777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5982565879821777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5982775688171387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.601823329925537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([288, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6087331771850586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6087331771850586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6092824935913086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7086172103881836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 288, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6890196800231934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.689443588256836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6898674964904785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6894221305847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 20970
output nodes number: 2842
edges number: 23025
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6895999908447266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6896004676818848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04881143569946289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 17 input nodes size: 70404
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044816017150878906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.044816017150878906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07838726043701172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07840871810913086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0451207160949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04652738571166992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04652738571166992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04652738571166992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70404, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04652738571166992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([842, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12792253494262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12792253494262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12872552871704102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13514947891235352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([1097, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13585996627807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13585996627807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13690614700317383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15259885787963867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1144, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1542348861694336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1542348861694336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1144, 128]), torch.Size([1, 1144, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15532588958740234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17932796478271484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1144, 128])
m.shape torch.Size([1118, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18091487884521484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18091487884521484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18198108673095703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21319103240966797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1036, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21512794494628906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21512794494628906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21611595153808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2522544860839844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([975, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2545499801635742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2545499801635742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 975, 128]), torch.Size([1, 975, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2554798126220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29639720916748047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 975, 128])
m.shape torch.Size([893, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29891300201416016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29891300201416016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 893, 128]), torch.Size([1, 893, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29976463317871094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34409379959106445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 893, 128])
m.shape torch.Size([811, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34676170349121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34676170349121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 811, 128]), torch.Size([1, 811, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3475351333618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39333057403564453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 811, 128])
m.shape torch.Size([815, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3964414596557617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3964414596557617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 815, 128]), torch.Size([1, 815, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3972187042236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4483513832092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 815, 128])
m.shape torch.Size([12356, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5068807601928711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5068807601928711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12356, 128]), torch.Size([1, 12356, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5186643600463867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.355299949645996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12356, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2800970077514648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3002071380615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.320317268371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3000497817993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21087, 256])
first layer input nodes number: 70404
first layer output nodes number: 21087
edges number: 165604
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3208441734313965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.340954303741455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3465218544006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3465218544006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3692293167114258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3692293167114258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3700037002563477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3768281936645508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.377161979675293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.377161979675293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3778772354125977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3905954360961914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3911118507385254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3911118507385254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3916897773742676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4093899726867676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([260, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4109325408935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4109325408935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.411428451538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4359188079833984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4366035461425781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4366035461425781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4369735717773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4502944946289062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4510440826416016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4510440826416016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4513530731201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.464639663696289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([108, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4652118682861328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4652118682861328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4654178619384766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.475717544555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4763836860656738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4763836860656738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.476574420928955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4874463081359863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4881038665771484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4881038665771484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4882698059082031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4988899230957031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4995088577270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4995088577270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.499648094177246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5095338821411133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.510204792022705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.510204792022705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.510338306427002  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5207524299621582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5212969779968262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5212969779968262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5213980674743652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5299906730651855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.530627727508545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.530627727508545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5307326316833496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5403838157653809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5408968925476074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5408968925476074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5409770011901855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.54890775680542  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5494012832641602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5494012832641602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5494718551635742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5569524765014648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5573787689208984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5573787689208984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5574359893798828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5639019012451172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5644125938415527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5644125938415527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5644755363464355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.572028636932373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5726027488708496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5726027488708496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.572669506072998  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5811476707458496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.581479549407959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.581479549407959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5815176963806152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5866293907165527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5869951248168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5869951248168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5870332717895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.592411994934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5930190086364746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5930190086364746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5930781364440918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6018290519714355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6021804809570312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6021804809570312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6022148132324219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6075363159179688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.60780668258667  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.60780668258667  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6078314781188965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6118483543395996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6122050285339355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6122050285339355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6122355461120605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6173930168151855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([301, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.624610424041748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.624610424041748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6251845359802246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7285475730895996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 301, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7088804244995117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7093043327331543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7097282409667969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7092828750610352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21087
output nodes number: 2842
edges number: 23086
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7094616889953613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7094621658325195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04913616180419922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 18 input nodes size: 71027
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0451207160949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0451207160949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07898902893066406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0790104866027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04541778564453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046863555908203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046863555908203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046863555908203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71027, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046863555908203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([819, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1313619613647461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1313619613647461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1321430206298828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13839149475097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([1010, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13896417617797852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13896417617797852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1010, 128]), torch.Size([1, 1010, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13992738723754883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15437555313110352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1010, 128])
m.shape torch.Size([1071, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.155426025390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.155426025390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1071, 128]), torch.Size([1, 1071, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1564474105834961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17891788482666016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1071, 128])
m.shape torch.Size([1161, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18062162399291992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18062162399291992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18172883987426758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2138381004333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([1085, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21587133407592773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21587133407592773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21690607070922852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2550625801086426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([976, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2573375701904297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2573375701904297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2582683563232422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2992076873779297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([904, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3017597198486328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3017597198486328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30262184143066406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34686946868896484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([837, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34963130950927734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34963130950927734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3504295349121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3964204788208008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([830, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3995833396911621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3995833396911621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4003748893737793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.45165300369262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([12784, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5122160911560059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5122160911560059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12784, 128]), torch.Size([1, 12784, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5244078636169434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3903656005859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12784, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.31207275390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.332554817199707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.353036880493164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3323945999145508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21477, 256])
first layer input nodes number: 71027
first layer output nodes number: 21477
edges number: 170311
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3535680770874023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3740501403808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.37933349609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.37933349609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4034919738769531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4034919738769531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4043216705322266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.410959243774414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4112191200256348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4112191200256348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.411888599395752  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.422410488128662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([287, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4229035377502441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4229035377502441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4234509468078613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.436840534210205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4374165534973145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4374165534973145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.437838077545166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4500622749328613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.45086669921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.45086669921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4512615203857422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.465475082397461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4661197662353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4661197662353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4663982391357422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.478372573852539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4789466857910156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4789466857910156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4791488647460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4892578125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([105, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.489964485168457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.489964485168457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4901647567749023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5015802383422852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.502406120300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.502406120300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.502610206604004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.515671730041504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5162906646728516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5162906646728516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5164337158203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.526590347290039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.527153491973877  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.527153491973877  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5272679328918457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5361943244934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5369329452514648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5369329452514648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.537064552307129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5482511520385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5488104820251465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5488104820251465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.548905849456787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5576796531677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.558210849761963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.558210849761963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5582928657531738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5664124488830566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.567063808441162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.567063808441162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.567155361175537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.576859951019287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5774755477905273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5774755477905273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5775575637817383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5868253707885742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5872583389282227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5872583389282227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5873136520385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5939512252807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5943045616149902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5943045616149902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.594346523284912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5996756553649902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6000747680664062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6000747680664062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.600118637084961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.605997085571289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6064753532409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6064753532409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.60652494430542  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6135172843933105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6138763427734375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6138763427734375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.613912582397461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6192760467529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6196808815002441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6196808815002441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6197190284729004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6256318092346191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6259002685546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6259002685546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.625925064086914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6299419403076172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6303682327270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6303682327270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6304044723510742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6365289688110352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([318, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6441521644592285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6441521644592285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.644758701324463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7541117668151855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 318, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.733008861541748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7334327697753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7338566780090332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7334113121032715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21477
output nodes number: 2842
edges number: 23626
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7335929870605469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.733593463897705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04952812194824219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 19 input nodes size: 70440
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04541778564453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04541778564453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07900619506835938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07902765274047852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045137882232666016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04654550552368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04654550552368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04654550552368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70440, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04654550552368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([795, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12800312042236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12800312042236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12876129150390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13482666015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([1120, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13551568984985352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13551568984985352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13658380508422852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15260553359985352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1135, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15369510650634766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15369510650634766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15477752685546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17917966842651367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1096, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18072891235351562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18072891235351562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18177413940429688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21272850036621094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([1095, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21481657028198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21481657028198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21586084365844727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2543916702270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([1012, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25676488876342773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25676488876342773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1012, 128]), torch.Size([1, 1012, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25773000717163086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30017805099487305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1012, 128])
m.shape torch.Size([932, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30280637741088867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30280637741088867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3036952018737793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34813642501831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([848, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35092687606811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35092687606811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35173559188842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39899396896362305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([788, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40197134017944336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40197134017944336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 788, 128]), torch.Size([1, 788, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4027228355407715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.45113706588745117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 788, 128])
m.shape torch.Size([12300, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5094122886657715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5094122886657715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12300, 128]), torch.Size([1, 12300, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5211424827575684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3539862632751465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12300, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2787446975708008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2988872528076172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3190298080444336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.298729419708252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21121, 256])
first layer input nodes number: 70440
first layer output nodes number: 21121
edges number: 165771
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.319556713104248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3396992683410645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3455071449279785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3455071449279785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([416, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3680720329284668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3680720329284668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3688654899597168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.376208782196045  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3765215873718262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3765215873718262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.377225399017334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3893046379089355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([290, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.38978910446167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.38978910446167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3903422355651855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4099268913269043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([231, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.410538673400879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.410538673400879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4109792709350586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4237565994262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([215, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4246411323547363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4246411323547363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.425051212310791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4398140907287598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4404568672180176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4404568672180176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.440737247467041  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4527935981750488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.453474521636963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.453474521636963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.453707218170166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4653420448303223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4660639762878418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4660639762878418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4662718772888184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4781222343444824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4787883758544922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4787883758544922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4789581298828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4898223876953125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4906315803527832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4906315803527832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4908089637756348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5034031867980957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5041184425354004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5041184425354004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5042634010314941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5155701637268066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5163054466247559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5163054466247559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5164389610290527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.527787685394287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5283207893371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5283207893371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5284123420715332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5368351936340332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.537435531616211  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.537435531616211  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.537527084350586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.546590805053711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5469632148742676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5469632148742676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5470185279846191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5528817176818848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5531926155090332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5531926155090332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.553234577178955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.557976245880127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5583477020263672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5583477020263672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5583934783935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5638866424560547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5644350051879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5644350051879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.564497947692871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5724916458129883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5728988647460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5728988647460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5729446411132812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5790786743164062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.579498291015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.579498291015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5795421600341797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5857276916503906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5863518714904785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5863518714904785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5864129066467285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5954461097717285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5956697463989258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5956697463989258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5956926345825195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5992403030395508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5996270179748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5996270179748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5996613502502441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6052231788635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6054601669311523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6054601669311523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6054811477661133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6090269088745117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6160087585449219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6160087585449219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6165637969970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7306747436523438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7111682891845703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.711592197418213  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7120161056518555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7115707397460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21121
output nodes number: 2842
edges number: 22928
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7117500305175781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7117505073547363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04915618896484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 20 input nodes size: 70256
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045137882232666016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045137882232666016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07863855361938477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0786600112915039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04505014419555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0464634895324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0464634895324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0464634895324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70256, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0464634895324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([814, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12896203994750977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12896203994750977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12973833084106445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13594865798950195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([1140, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13664770126342773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13664770126342773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13773488998413086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15478277206420898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1130, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15585565567016602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15585565567016602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1130, 128]), torch.Size([1, 1130, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15693330764770508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18131399154663086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1130, 128])
m.shape torch.Size([1044, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18276643753051758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18276643753051758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1837620735168457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21263551712036133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1020, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2145695686340332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2145695686340332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21554231643676758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2506375312805176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
m.shape torch.Size([978, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25294923782348633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25294923782348633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25388193130493164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29486513137817383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([867, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29729270935058594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29729270935058594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29811954498291016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3394613265991211  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([850, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34229040145874023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34229040145874023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34310102462768555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.38941144943237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39244794845581055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39244794845581055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39321279525756836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.442568302154541  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12463, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5016140937805176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5016140937805176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12463, 128]), torch.Size([1, 12463, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5134997367858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3573803901672363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12463, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2810254096984863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3011555671691895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3212857246398926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3009982109069824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21108, 256])
first layer input nodes number: 70256
first layer output nodes number: 21108
edges number: 166345
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3218111991882324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3419413566589355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3470497131347656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3470497131347656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([407, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.36991548538208  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.36991548538208  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3706917762756348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3771023750305176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3774642944335938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3774642944335938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3782081604003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3901557922363281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([301, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3906521797180176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3906521797180176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3912262916564941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4059476852416992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([206, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4064526557922363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4064526557922363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4068455696105957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4182400703430176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([194, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4189763069152832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4189763069152832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4193463325500488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4326672554016113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4333477020263672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4333477020263672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.433633804321289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4459362030029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4465537071228027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4465537071228027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4467692375183105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4575457572937012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4583687782287598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4583687782287598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.45859956741333  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.471754550933838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.472426414489746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.472426414489746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.472599983215332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.483708381652832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4843621253967285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4843621253967285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.484508991241455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.494936466217041  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4956140518188477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4956140518188477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4957494735717773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.506312370300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([70, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5070524215698242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5070524215698242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.507185935974121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5185346603393555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.518968105316162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.518968105316162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5190443992614746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5260634422302246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5267386436462402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5267386436462402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5268397331237793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5368475914001465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.537489414215088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.537489414215088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.537580966949463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.547285556793213  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5476703643798828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5476703643798828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5477237701416016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5537586212158203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5542879104614258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5542879104614258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5543527603149414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5621347427368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5626559257507324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5626559257507324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5627169609069824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5704684257507324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.570894718170166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.570894718170166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5709424018859863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5773320198059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.577692985534668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.577692985534668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5777311325073242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5831098556518555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5836763381958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5836763381958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5837316513061523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5919179916381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.592355728149414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.592355728149414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.592397689819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5989017486572266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.599256992340088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.599256992340088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5992894172668457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6045422554016113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6050338745117188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6050338745117188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6050758361816406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6121673583984375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([281, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6188983917236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6188983917236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6194343566894531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.727795124053955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7079906463623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7084145545959473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7088384628295898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7083930969238281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21108
output nodes number: 2842
edges number: 23249
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7085719108581543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7085723876953125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04907846450805664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 21 input nodes size: 70954
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04505014419555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04505014419555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07888364791870117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07890510559082031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04538297653198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04683065414428711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04683065414428711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04683065414428711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70954, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04683065414428711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([830, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13133621215820312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13133621215820312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 830, 128]), torch.Size([1, 830, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1321277618408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1384601593017578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 830, 128])
m.shape torch.Size([1103, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1391162872314453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1391162872314453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1103, 128]), torch.Size([1, 1103, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1401681900024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1559467315673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1103, 128])
m.shape torch.Size([1124, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1570286750793457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1570286750793457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15810060501098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18245553970336914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1087, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18399286270141602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18399286270141602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1850295066833496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21589326858520508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([1124, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21805477142333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21805477142333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21912670135498047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25800609588623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([984, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2602853775024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2602853775024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 984, 128]), torch.Size([1, 984, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.26122379302978516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3032388687133789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 984, 128])
m.shape torch.Size([876, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3056936264038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3056936264038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30652904510498047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34925174713134766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([889, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35222530364990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35222530364990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3530731201171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40227794647216797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([824, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40539026260375977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40539026260375977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4061760902404785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.45867013931274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([12733, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5189929008483887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5189929008483887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12733, 128]), torch.Size([1, 12733, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5311360359191895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3937726020812988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12733, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3155508041381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.336125373840332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3566999435424805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3359642028808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21574, 256])
first layer input nodes number: 70954
first layer output nodes number: 21574
edges number: 170270
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3572306632995605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.377805233001709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3837080001831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3837080001831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([424, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.407860279083252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.407860279083252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4086689949035645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4153056144714355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([388, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4156475067138672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4156475067138672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4163875579833984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4275317192077637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4279603958129883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4279603958129883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4284887313842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4405412673950195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([198, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4410386085510254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4410386085510254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4414162635803223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4523682594299316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([212, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.453291893005371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.453291893005371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4536962509155273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4682531356811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([147, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4688987731933594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4688987731933594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4691791534423828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4812355041503906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([118, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.481889247894287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.481889247894287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.482114315032959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4933676719665527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4941778182983398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4941778182983398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4944067001342773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5074529647827148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([83, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.508056640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.508056640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5082149505615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5183467864990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5189309120178223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5189309120178223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5190625190734863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5284066200256348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.529059886932373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.529059886932373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5291895866394043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5393061637878418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5398411750793457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5398411750793457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.539940357208252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5483708381652832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5489835739135742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5489835739135742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5490846633911133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.558384895324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.558913230895996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.558913230895996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.558995246887207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5671148300170898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5675930976867676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5675930976867676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5676617622375488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5749402046203613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5753674507141113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5753674507141113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5754246711730957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.58189058303833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5823850631713867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5823850631713867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5824460983276367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5897703170776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.590224266052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.590224266052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5902776718139648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.597060203552246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5974903106689453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5974903106689453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5975379943847656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6039276123046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.604461669921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.604461669921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6045169830322266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6123161315917969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6127934455871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6127934455871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6128411293029785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6198983192443848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6202974319458008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6202974319458008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.620335578918457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6262483596801758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.62660551071167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.62660551071167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6266379356384277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6318907737731934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6322898864746094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6322898864746094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.63232421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6381263732910156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([330, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.64603853225708  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.64603853225708  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6466679573059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7606439590454102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 330, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7395272254943848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7399511337280273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.74037504196167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7399296760559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21574
output nodes number: 2842
edges number: 23812
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7401123046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7401127815246582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04950141906738281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 22 input nodes size: 71449
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04538297653198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04538297653198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0794525146484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07947397232055664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04561901092529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04705524444580078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04705524444580078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04705524444580078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71449, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04705524444580078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([862, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1302495002746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1302495002746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 862, 128]), torch.Size([1, 862, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1310715675354004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1376481056213379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 862, 128])
m.shape torch.Size([1093, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13855838775634766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13855838775634766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1093, 128]), torch.Size([1, 1093, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1396007537841797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15523624420166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1093, 128])
m.shape torch.Size([1120, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15680551528930664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15680551528930664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15787363052368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18167734146118164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1091, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18322420120239258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18322420120239258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1842646598815918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2152409553527832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1123, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21739816665649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21739816665649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21846914291381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2572779655456543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([1022, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25966644287109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25966644287109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.26064109802246094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3031792640686035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([977, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3059530258178711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3059530258178711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.306884765625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3543682098388672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([910, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3573737144470215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3573737144470215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35824155807495117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40814733505249023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([837, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.41130542755126953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.41130542755126953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.41210365295410156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.464141845703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([12509, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.524289608001709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.524289608001709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12509, 128]), torch.Size([1, 12509, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5362191200256348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3838796615600586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12509, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3070683479309082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3276143074035645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3481602668762207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.32745361328125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21544, 256])
first layer input nodes number: 71449
first layer output nodes number: 21544
edges number: 169261
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3486948013305664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3692407608032227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3748250007629395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3748250007629395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3978428840637207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3978428840637207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3986496925354004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4051742553710938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([338, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4054207801818848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4054207801818848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4060654640197754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.417189121246338  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([318, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4177837371826172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4177837371826172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4183902740478516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.434600830078125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4351897239685059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4351897239685059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4356322288513184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4484648704528809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.449103832244873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.449103832244873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4494452476501465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4617362022399902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4624075889587402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4624075889587402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4626860618591309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4746603965759277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4753355979919434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4753355979919434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4755663871765137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4871058464050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([121, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4879212379455566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4879212379455566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.488152027130127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5013070106506348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5020742416381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5020742416381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5022687911987305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5147199630737305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([83, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5154204368591309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5154204368591309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5155787467956543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5268187522888184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5274271965026855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5274271965026855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5275511741638184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5372214317321777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5378632545471191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5378632545471191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5379796028137207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5478692054748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5484485626220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5484485626220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5485458374023438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5574951171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.557971477508545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.557971477508545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5580458641052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5654101371765137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.565892219543457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.565892219543457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5659608840942383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5732393264770508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5738048553466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5738048553466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5738792419433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.582284927368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.582770824432373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.582770824432373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.582831859588623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.590156078338623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5906100273132324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5906100273132324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5906634330749512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5974459648132324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.59800386428833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.59800386428833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.59806489944458  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.60624361038208  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6067132949829102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6067132949829102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6067628860473633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.613755226135254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6141748428344727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6141748428344727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6142168045043945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.620427131652832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6207022666931152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6207022666931152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6207289695739746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6248679161071777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6251420974731445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6251420974731445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.625166893005371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6291837692260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6294021606445312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6294021606445312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6294212341308594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6326446533203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([311, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6401081085205078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6401081085205078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6407012939453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7543482780456543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 311, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7343792915344238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7348031997680664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.735227108001709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7347817420959473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21544
output nodes number: 2842
edges number: 23395
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7349638938903809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.734964370727539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0497136116027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 23 input nodes size: 70624
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04561901092529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04561901092529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07929515838623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07931661605834961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04522562026977539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04663801193237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04663801193237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04663801193237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70624, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04663801193237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([804, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1291332244873047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1291332244873047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1298999786376953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1360340118408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([1051, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13665294647216797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13665294647216797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13765525817871094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15268993377685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1117, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15408945083618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15408945083618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15515470504760742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17894697189331055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1131, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1805715560913086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1805715560913086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1131, 128]), torch.Size([1, 1131, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18165016174316406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21304607391357422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1131, 128])
m.shape torch.Size([1011, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21491718292236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21491718292236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1011, 128]), torch.Size([1, 1011, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21588134765625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2516179084777832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1011, 128])
m.shape torch.Size([924, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25377941131591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25377941131591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25466060638427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2934122085571289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([901, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29597902297973633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29597902297973633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29683828353881836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34061765670776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([856, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34345340728759766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34345340728759766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 856, 128]), torch.Size([1, 856, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3442697525024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39080142974853516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 856, 128])
m.shape torch.Size([805, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3938479423522949  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3938479423522949  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 805, 128]), torch.Size([1, 805, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39461565017700195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4441547393798828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 805, 128])
m.shape torch.Size([12472, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.503242015838623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.503242015838623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12472, 128]), torch.Size([1, 12472, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5151362419128418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.359626293182373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12472, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2832493782043457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3033452033996582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3234410285949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3031878471374512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21072, 256])
first layer input nodes number: 70624
first layer output nodes number: 21072
edges number: 166500
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3239693641662598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3440651893615723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.349134922027588  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.349134922027588  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([432, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3717913627624512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3717913627624512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3726153373718262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3793330192565918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3796653747558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3796653747558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3804035186767578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.392125129699707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([286, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3925809860229492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3925809860229492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3931264877319336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4087591171264648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([263, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4095516204833984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4095516204833984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4100532531738281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4312610626220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([173, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4318418502807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4318418502807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4321718215942383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4440507888793945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4447684288024902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4447684288024902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4450602531433105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.457608699798584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([115, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4582366943359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4582366943359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.458456039428711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4694232940673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4700441360473633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4700441360473633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4702253341674805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4805536270141602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4812159538269043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4812159538269043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.481381893157959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.492002010345459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4927072525024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4927072525024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.492863655090332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5039682388305664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.504598617553711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.504598617553711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5047264099121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5146942138671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5152416229248047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5152416229248047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5153427124023438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.523935317993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5244598388671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5244598388671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5245475769042969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5326194763183594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5330872535705566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5330872535705566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5331597328186035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5403351783752441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5409770011901855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5409770011901855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5410666465759277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5505690574645996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5510163307189941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5510163307189941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5510773658752441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5579743385314941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5585813522338867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5585813522338867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5586557388305664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.567582130432129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5679082870483398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5679082870483398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.567948341369629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5730352401733398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5735816955566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5735816955566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5736408233642578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.581563949584961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.581995964050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.581995964050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5820417404174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.588496208190918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5888571739196777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5888571739196777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5888934135437012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.59425687789917  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5945138931274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5945138931274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.594538688659668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5983819961547852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5987896919250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5987896919250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5988259315490723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6046967506408691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6049556732177734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6049556732177734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6049785614013672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.608846664428711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([308, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6162362098693848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6162362098693848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.616823673248291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7243390083312988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 308, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7047724723815918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7051963806152344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.705620288848877  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7051749229431152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21072
output nodes number: 2842
edges number: 23007
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7053537368774414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7053542137145996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.049252986907958984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 24 input nodes size: 70154
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04522562026977539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04522562026977539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07867765426635742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07869911193847656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04500150680541992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04641103744506836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04641103744506836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04641103744506836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70154, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04641103744506836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([823, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12788772583007812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12788772583007812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12867259979248047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13495159149169922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([1086, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13559484481811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13559484481811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13663053512573242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15216588973999023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([1138, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1532759666442871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1532759666442871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15436124801635742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17877626419067383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1148, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18042325973510742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18042325973510742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1815180778503418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21326780319213867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([1146, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2154526710510254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2154526710510254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1146, 128]), torch.Size([1, 1146, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21654558181762695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2558903694152832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1146, 128])
m.shape torch.Size([1016, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25825071334838867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25825071334838867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2592196464538574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3012385368347168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([970, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30399179458618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30399179458618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3049168586730957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35117006301879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([901, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3541445732116699  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3541445732116699  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.35500383377075195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40523672103881836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([840, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40841197967529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40841197967529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4092130661010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4607877731323242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([12140, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5189809799194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5189809799194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12140, 128]), torch.Size([1, 12140, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5314836502075195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3619623184204102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12140, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2868337631225586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3070592880249023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.327284812927246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.306900978088379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21208, 256])
first layer input nodes number: 70154
first layer output nodes number: 21208
edges number: 165785
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3278098106384277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3480353355407715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3532004356384277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3532004356384277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([413, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.376035213470459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.376035213470459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3768229484558105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3848929405212402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([337, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3851470947265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3851470947265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3857898712158203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3977460861206055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3983044624328613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3983044624328613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3988862037658691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4142422676086426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.414797306060791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.414797306060791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4152169227600098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4273858070373535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4281854629516602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4281854629516602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4285821914672852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4428644180297852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4436407089233398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4436407089233398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4439630508422852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4578237533569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.458517074584961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.458517074584961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4587593078613281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4708709716796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4716572761535645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4716572761535645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4718823432922363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4847111701965332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4853858947753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4853858947753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4855594635009766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4966678619384766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4973406791687012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4973406791687012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4974913597106934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5081896781921387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.508854866027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.508854866027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.508988380432129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5194025039672852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.519970417022705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.519970417022705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5200753211975098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5289921760559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5295896530151367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5295896530151367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.529688835144043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.538813591003418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5394773483276367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5394773483276367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5395784378051758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.549586296081543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.550184726715088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.550184726715088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5502705574035645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.55936861038208  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5598640441894531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5598640441894531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5599308013916016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.567474365234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5678658485412598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5678658485412598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.567915439605713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.573866367340088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5743780136108398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5743780136108398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.574437141418457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5819463729858398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5823006629943848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5823006629943848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5823407173156738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5877079963684082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5881109237670898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5881109237670898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5881528854370117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.594069480895996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5944929122924805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5944929122924805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5945348739624023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6007452011108398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.601210594177246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.601210594177246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6012544631958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6080541610717773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6084084510803223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6084084510803223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.60844087600708  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6136937141418457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6141619682312012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6141619682312012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6142020225524902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6209712028503418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([282, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6277275085449219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6277275085449219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.628265380859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7255840301513672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 282, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.705815315246582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7062392234802246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7066631317138672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7062177658081055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21208
output nodes number: 2842
edges number: 23213
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.706397533416748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7063980102539062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04902458190917969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 25 input nodes size: 70137
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04500150680541992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04500150680541992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0784454345703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07846689224243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04499340057373047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04641151428222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04641151428222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04641151428222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70137, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04641151428222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([825, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1289229393005371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1289229393005371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12970972061157227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13600397109985352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([1060, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13662147521972656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13662147521972656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1376323699951172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15279579162597656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([1140, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1539592742919922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1539592742919922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1140, 128]), torch.Size([1, 1140, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1550464630126953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17896461486816406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1140, 128])
m.shape torch.Size([1125, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18056678771972656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18056678771972656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1816396713256836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21294403076171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1095, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21501827239990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21501827239990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1095, 128]), torch.Size([1, 1095, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2160625457763672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2544384002685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1095, 128])
m.shape torch.Size([950, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2566342353820801  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2566342353820801  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.257540225982666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29670047760009766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([939, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29938173294067383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.29938173294067383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3002772331237793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3452882766723633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([889, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34823179244995117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34823179244995117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34907960891723633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39878225326538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([800, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4017915725708008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4017915725708008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4025545120239258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4514780044555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([12387, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.510162353515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.510162353515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12387, 128]), torch.Size([1, 12387, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5219755172729492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3609957695007324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12387, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.284724235534668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3049516677856445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.325179100036621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.304793357849121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21210, 256])
first layer input nodes number: 70137
first layer output nodes number: 21210
edges number: 166795
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3257036209106445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.345931053161621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.351365566253662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.351365566253662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3743114471435547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3743114471435547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.375112533569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3820075988769531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.382270336151123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.382270336151123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3829283714294434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3943347930908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([284, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3948249816894531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3948249816894531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3953666687011719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.411757469177246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4123711585998535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4123711585998535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4128098487854004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4255318641662598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4262738227844238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4262738227844238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4266552925109863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4403882026672363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4410338401794434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4410338401794434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4413104057312012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.453202724456787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4539728164672852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4539728164672852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4542303085327148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4671049118041992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4678220748901367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4678220748901367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.468031883239746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4799909591674805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.480760097503662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.480760097503662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4809527397155762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4932818412780762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([103, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4942007064819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4942007064819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4943971633911133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.508345603942871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5089030265808105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5089030265808105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.509021282196045  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5182452201843262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5188322067260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5188322067260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5189390182495117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5280179977416992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5285396575927734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5285396575927734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5286273956298828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5366992950439453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5372343063354492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5372343063354492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5373163223266602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.545435905456543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5459575653076172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5459575653076172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5460319519042969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5539169311523438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5545411109924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5545411109924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5546231269836426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5638909339904785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5644221305847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5644221305847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5644888877868652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5724997520446777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([46, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5732622146606445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5732622146606445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.573349952697754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5844926834106445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.584850788116455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.584850788116455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.584892749786377  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5905156135559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5909175872802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5909175872802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5909595489501953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5968761444091797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5971784591674805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5971784591674805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5972089767456055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6017255783081055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6020488739013672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6020488739013672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6020793914794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6068096160888672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6073031425476074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6073031425476074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.607347011566162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6144537925720215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6148934364318848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6148934364318848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.614931583404541  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6213784217834473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([280, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6280875205993652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6280875205993652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6286215782165527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7371830940246582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7181119918823242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7185359001159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7189598083496094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7185144424438477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21210
output nodes number: 2842
edges number: 23321
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7186942100524902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7186946868896484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04903411865234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 26 input nodes size: 70843
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04499340057373047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04499340057373047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07877397537231445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0787954330444336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045330047607421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046764373779296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046764373779296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046764373779296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70843, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046764373779296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([838, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12978696823120117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12978696823120117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1305861473083496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1369795799255371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([1047, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13805389404296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13805389404296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1390523910522461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15402984619140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([1119, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15513134002685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15513134002685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15619850158691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17999839782714844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1037, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1814427375793457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1814427375793457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.18243169784545898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21111154556274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([1117, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21328020095825195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21328020095825195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21434545516967773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25348567962646484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([997, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25580549240112305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.25580549240112305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 997, 128]), torch.Size([1, 997, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2567563056945801  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2981562614440918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 997, 128])
m.shape torch.Size([909, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30071496963500977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30071496963500977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.30158185958862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3459434509277344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([932, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34906530380249023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34906530380249023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 932, 128]), torch.Size([1, 932, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34995412826538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4007258415222168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 932, 128])
m.shape torch.Size([812, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4037661552429199  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4037661552429199  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4045405387878418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.45665693283081055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([12581, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5168166160583496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5168166160583496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12581, 128]), torch.Size([1, 12581, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5288147926330566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3815021514892578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3047375679016113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3251357078552246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.345533847808838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3249759674072266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21389, 256])
first layer input nodes number: 70843
first layer output nodes number: 21389
edges number: 168941
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3460636138916016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3664617538452148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3715615272521973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3715615272521973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([425, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3946952819824219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3946952819824219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3955059051513672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.402878761291504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([351, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4031481742858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4031481742858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4038176536560059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.414191722869873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([289, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4146904945373535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4146904945373535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4152417182922363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4297542572021484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([219, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4303207397460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4303207397460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4307384490966797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4428520202636719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([170, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.443460464477539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.443460464477539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4437847137451172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4554576873779297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4561896324157715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4561896324157715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4564852714538574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4691977500915527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4699854850769043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4699854850769043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4702506065368652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.483506679534912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4843354225158691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4843354225158691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4845738410949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4981637001037598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([104, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4989442825317383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4989442825317383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4991426467895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5118379592895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5124406814575195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5124406814575195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5125799179077148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.522465705871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([78, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5232210159301758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5232210159301758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5233697891235352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5349740982055664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([68, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5356841087341309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5356841087341309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.535813808441162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5468382835388184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5474233627319336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5474233627319336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5475225448608398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5566473007202148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5570554733276367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5570554733276367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5571203231811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5635404586791992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5640559196472168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5640559196472168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5641283988952637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5718111991882324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5723748207092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5723748207092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5724492073059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.580854892730713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5812101364135742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5812101364135742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5812559127807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5867490768432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5871591567993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5871591567993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5872068405151367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5932626724243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5936956405639648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5936956405639648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5937433242797852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.600132942199707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6006474494934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6006474494934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.600700855255127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6082310676574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.608729362487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.608729362487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.608778953552246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6161184310913086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6164112091064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6164112091064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6164398193359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6208744049072266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.621412754058838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.621412754058838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6214604377746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6291851997375488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6295537948608398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6295537948608398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6295862197875977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.635066032409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([298, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6422104835510254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6422104835510254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6427788734436035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7510676383972168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 298, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7309980392456055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.731421947479248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7318458557128906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.731400489807129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21389
output nodes number: 2842
edges number: 23511
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.731581687927246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.7315821647644043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.04941415786743164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 27 input nodes size: 69988
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045330047607421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.045330047607421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07870292663574219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.07872438430786133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.0449223518371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046328067779541016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046328067779541016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046328067779541016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([69988, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.046328067779541016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([821, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12760686874389648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12760686874389648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 821, 128]), torch.Size([1, 821, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.12838983535766602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13465356826782227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 821, 128])
m.shape torch.Size([1069, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13547658920288086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13547658920288086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.13649606704711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15178823471069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1068, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15280628204345703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.15280628204345703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1538248062133789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17623233795166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([1086, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1777944564819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.1777944564819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.17883014678955078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.20975399017333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([1096, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21184921264648438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21184921264648438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.21289443969726562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2515106201171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2538261413574219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2538261413574219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2547721862792969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2960624694824219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([944, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2987403869628906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2987403869628906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.2996406555175781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3446540832519531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([930, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3477516174316406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.3477516174316406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.34863853454589844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.39923095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([808, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40235424041748047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.40235424041748047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 808, 128]), torch.Size([1, 808, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4031248092651367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.4525594711303711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 808, 128])
m.shape torch.Size([12213, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.510767936706543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.510767936706543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12213, 128]), torch.Size([1, 12213, 128])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 0.5224151611328125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3536596298217773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12213, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2786006927490234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2986536026000977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3187065124511719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.2984967231750488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21027, 256])
first layer input nodes number: 69988
first layer output nodes number: 21027
edges number: 165389
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.319230079650879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3392829895019531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3444509506225586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3444509506225586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([430, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3672027587890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3672027587890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3680229187011719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3758444786071777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.376145839691162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.376145839691162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3768515586853027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3900260925292969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([253, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3904027938842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.3904027938842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.390885353088379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4015016555786133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([213, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4020795822143555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4020795822143555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4024858474731445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4142675399780273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([208, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4151101112365723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4151101112365723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4155068397521973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4297890663146973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([139, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4303927421569824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4303927421569824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4306578636169434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4420580863952637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4427666664123535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4427666664123535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.443005084991455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4549260139465332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4555912017822266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4555912017822266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4557857513427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4668750762939453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([101, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4676518440246582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4676518440246582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4678444862365723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4801735877990723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([100, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4810385704040527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4810385704040527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.481229305267334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4947714805603027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.495448112487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.495448112487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.4955873489379883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5064477920532227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([74, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5072317123413086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5072317123413086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5073728561401367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5193700790405273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5201120376586914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5201120376586914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5202360153198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.531641960144043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5323338508605957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5323338508605957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5324406623840332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5430150032043457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5435385704040527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5435385704040527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5436148643493652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5517020225524902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5523715019226074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5523715019226074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5524592399597168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5623736381530762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5628199577331543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5628199577331543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5628771781921387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5697436332702637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5701823234558105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5701823234558105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5702338218688965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5767741203308105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5773696899414062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5773696899414062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5774345397949219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5861244201660156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5866689682006836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5866689682006836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.586726188659668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5947942733764648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5953106880187988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5953106880187988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.5953621864318848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6029839515686035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6032123565673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6032123565673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6032352447509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6067829132080078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6071476936340332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6071476936340332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.607180118560791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6124329566955566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6127400398254395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6127400398254395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6127667427062988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6172795295715332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([256, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6234173774719238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6234173774719238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 3.8924560546875 GB
    Memory Allocated: 1.6239056587219238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7098431587219238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 256, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6908717155456543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6912956237792969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6917195320129395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6912741661071777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21027
output nodes number: 2842
edges number: 23111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6914525032043457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.691452980041504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04893159866333008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 28 input nodes size: 70844
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0449223518371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0449223518371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07870340347290039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07872486114501953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04533052444458008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046770572662353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046770572662353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046770572662353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70844, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046770572662353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([792, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13014650344848633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13014650344848633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 792, 128]), torch.Size([1, 792, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13090181350708008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13694429397583008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 792, 128])
m.shape torch.Size([1089, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13767194747924805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13767194747924805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13871049880981445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15428876876831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1101, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15630626678466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15630626678466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15735626220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18108749389648438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1097, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18265485763549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18265485763549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1837010383605957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21474027633666992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1080, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21679210662841797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21679210662841797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21782207489013672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2552480697631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([959, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.257476806640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.257476806640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2583913803100586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2977180480957031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([917, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3003215789794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3003215789794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3011960983276367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3457827568054199  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([845, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3485689163208008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3485689163208008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34937477111816406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3955802917480469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([810, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.398653507232666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.398653507232666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 810, 128]), torch.Size([1, 810, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3994259834289551  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.44913625717163086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 810, 128])
m.shape torch.Size([12743, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5095133781433105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5095133781433105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12743, 128]), torch.Size([1, 12743, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5216660499572754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3850131034851074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12743, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3078227043151855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3282628059387207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3487029075622559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3281030654907227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21433, 256])
first layer input nodes number: 70844
first layer output nodes number: 21433
edges number: 169714
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3492326736450195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3696727752685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.375532627105713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.375532627105713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3986420631408691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3986420631408691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3994431495666504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4059863090515137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([377, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4063105583190918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4063105583190918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.407029628753662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.418057918548584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([268, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.418471336364746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.418471336364746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4189825057983398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4306883811950684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4313173294067383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4313173294067383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4317560195922852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4444780349731445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([221, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.445352554321289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.445352554321289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4457740783691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4609489440917969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4615516662597656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4615516662597656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4618206024169922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4733848571777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([110, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4739909172058105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4739909172058105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.47420072555542  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4846911430358887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([106, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4854016304016113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4854016304016113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4856038093566895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4971280097961426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4978489875793457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4978489875793457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.498030185699463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509626865386963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5101995468139648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5101995468139648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.510331153869629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5196752548217773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5202860832214355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5202860832214355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5204081535339355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5299296379089355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5304570198059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5304570198059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5305542945861816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5388226509094238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5396738052368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5396738052368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.539811134338379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.552445411682129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5529823303222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5529823303222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5530681610107422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5615653991699219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.562171459197998  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.562171459197998  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5622572898864746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5713553428649902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5718355178833008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5718355178833008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5719003677368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.579228401184082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5796375274658203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5796375274658203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5796890258789062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5858688354492188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5863966941833496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5863966941833496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5864577293395996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5942091941833496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.59474515914917  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.59474515914917  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.594804286956787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6027274131774902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6031785011291504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6031785011291504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6032261848449707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6099495887756348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6104307174682617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6104307174682617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.610478401184082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6175355911254883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6179771423339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6179771423339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6180191040039062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6245231628417969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6249666213989258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6249666213989258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6250066757202148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.631495475769043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6317524909973145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6317524909973145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6317753791809082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.635643482208252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([299, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6428165435791016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6428165435791016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6433868408203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7479329109191895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 299, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.727881908416748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7283058166503906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7287297248840332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7282843589782715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21433
output nodes number: 2842
edges number: 23492
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7284655570983887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7284660339355469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04942607879638672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 29 input nodes size: 70765
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04533052444458008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04533052444458008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07907390594482422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07909536361694336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04529285430908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04672431945800781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04672431945800781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04672431945800781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70765, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04672431945800781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([838, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12952613830566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12952613830566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1303253173828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1368083953857422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([1025, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13738632202148438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13738632202148438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1025, 128]), torch.Size([1, 1025, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13836383819580078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15302658081054688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1025, 128])
m.shape torch.Size([1102, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1541142463684082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1541142463684082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1551651954650879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17890024185180664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([1138, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18054533004760742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18054533004760742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18163061141967773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2131037712097168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1085, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2151479721069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2151479721069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1085, 128]), torch.Size([1, 1085, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21618270874023438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2544364929199219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1085, 128])
m.shape torch.Size([1013, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2568173408508301  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2568173408508301  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1013, 128]), torch.Size([1, 1013, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2577834129333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30043697357177734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1013, 128])
m.shape torch.Size([882, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30289793014526367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30289793014526367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 882, 128]), torch.Size([1, 882, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.303739070892334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3457961082458496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 882, 128])
m.shape torch.Size([859, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34865236282348633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34865236282348633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 859, 128]), torch.Size([1, 859, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3494715690612793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3961663246154785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 859, 128])
m.shape torch.Size([853, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3994174003601074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3994174003601074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 853, 128]), torch.Size([1, 853, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40023088455200195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.45230913162231445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 853, 128])
m.shape torch.Size([12552, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5124492645263672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5124492645263672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12552, 128]), torch.Size([1, 12552, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5244197845458984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3752360343933105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12552, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2986817359924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3190398216247559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.33939790725708  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.318880558013916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21347, 256])
first layer input nodes number: 70765
first layer output nodes number: 21347
edges number: 168492
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3399271965026855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3602852821350098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.36537504196167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.36537504196167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([407, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3885016441345215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3885016441345215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3892779350280762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.395556926727295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([357, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.39585542678833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.39585542678833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3965363502502441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4072480201721191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4077296257019043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4077296257019043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4082732200622559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4229507446289062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([226, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4235482215881348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4235482215881348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4239792823791504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4364800453186035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([176, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.437110424041748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.437110424041748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.437446117401123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.449531078338623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([177, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4503974914550781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4503974914550781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.450735092163086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4652519226074219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([127, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.465937614440918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.465937614440918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4661798477172852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4782915115356445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4790472984313965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4790472984313965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.479264736175537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4916586875915527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4922943115234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4922943115234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4924583435058594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5029563903808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5035858154296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5035858154296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5037269592285156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5137481689453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5145130157470703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5145130157470703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5146636962890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5264167785644531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5270566940307617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5270566940307617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.527174949645996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.537226676940918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5379300117492676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5379300117492676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5380463600158691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.548750400543213  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549257755279541  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549257755279541  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5493378639221191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5572686195373535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.557891845703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.557891845703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5579795837402344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5672798156738281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5678668022155762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5678668022155762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5679450035095215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5767817497253418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5773963928222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5773963928222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5774726867675781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5866279602050781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5870399475097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5870399475097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5870895385742188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5933876037597656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5938925743103027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5938925743103027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5939478874206543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6013598442077637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.601851463317871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.601851463317871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.601902961730957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6091642379760742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6096434593200684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6096434593200684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6096911430358887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.616748332977295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.616978645324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.616978645324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6170015335083008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.620549201965332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6209802627563477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6209802627563477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.621018409729004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6271982192993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6275482177734375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6275482177734375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6275787353515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6327362060546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([287, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6396174430847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6396174430847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.640164852142334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7479000091552734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7278308868408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.728254795074463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7286787033081055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7282333374023438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21347
output nodes number: 2842
edges number: 23524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7284140586853027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.728414535522461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049368858337402344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 30 input nodes size: 71090
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04529285430908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04529285430908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07919120788574219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07921266555786133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04544782638549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0468602180480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0468602180480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0468602180480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71090, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0468602180480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([846, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12938451766967773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12938451766967773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 846, 128]), torch.Size([1, 846, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13019132614135742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13664579391479492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 846, 128])
m.shape torch.Size([1134, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13732385635375977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13732385635375977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13840532302856445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1552586555480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1157, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1563730239868164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1563730239868164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15747642517089844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18197298049926758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([1125, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18356704711914062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18356704711914062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18463993072509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.215911865234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1072, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21793127059936523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21793127059936523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21895360946655273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25587034225463867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([1051, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25836610794067383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25836610794067383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2593684196472168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30283498764038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([911, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3053746223449707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3053746223449707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3062434196472168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3501009941101074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([920, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3531761169433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3531761169433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 920, 128]), torch.Size([1, 920, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3540534973144531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40462493896484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 920, 128])
m.shape torch.Size([844, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4078083038330078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4078083038330078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4086132049560547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.46071434020996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([12225, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5189056396484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5189056396484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12225, 128]), torch.Size([1, 12225, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5305643081665039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3619346618652344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12225, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2857708930969238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3060698509216309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.326368808746338  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3059110641479492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21285, 256])
first layer input nodes number: 71090
first layer output nodes number: 21285
edges number: 166334
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3269004821777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3471994400024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3522911071777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3522911071777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([431, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3749933242797852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3749933242797852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3758153915405273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.383589267730713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([358, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.383866786956787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.383866786956787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.384549617767334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3971600532531738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3976173400878906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3976173400878906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3981456756591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4104337692260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([219, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4110116958618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4110116958618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4114294052124023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4235429763793945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4242620468139648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4242620468139648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4246301651000977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.437882423400879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([184, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4387598037719727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4387598037719727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4391107559204102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4542016983032227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4548134803771973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4548134803771973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4550366401672363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4661946296691895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.466975212097168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.466975212097168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4671964645385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4798078536987305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4806232452392578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4806232452392578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4808273315429688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4938888549804688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4945173263549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4945173263549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4946622848510742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5049543380737305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5054950714111328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5054950714111328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.505605697631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5142345428466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.514721393585205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.514721393585205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5148110389709473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5224308967590332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.523148536682129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.523148536682129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5232648849487305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5339689254760742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5345301628112793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5345301628112793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5346179008483887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5433039665222168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5437650680541992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5437650680541992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5438318252563477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550908088684082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5514593124389648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5514593124389648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5515317916870117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5597219467163086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5603070259094238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5603070259094238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5603795051574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5690770149230957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([37, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.569681167602539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.569681167602539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5697517395019531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.578714370727539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5793004035949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5793004035949707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5793652534484863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.58805513381958  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5885610580444336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5885610580444336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5886144638061523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.596144676208496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5965218544006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5965218544006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.596560001373291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.602205753326416  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.602546215057373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.602546215057373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6025786399841309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6076045036315918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.607853889465332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.607853889465332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6078767776489258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6115846633911133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.612034797668457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.612034797668457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6120729446411133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6185197830200195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([273, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6250605583190918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6250605583190918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6255812644958496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7213201522827148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 273, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7017087936401367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7021327018737793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7025566101074219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7021112442016602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21285
output nodes number: 2842
edges number: 23058
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.702291488647461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7022919654846191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0494842529296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 31 input nodes size: 70499
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04544782638549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04544782638549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07906436920166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0790858268737793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045166015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04658699035644531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04658699035644531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04658699035644531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70499, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04658699035644531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([819, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12910223007202148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12910223007202148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 819, 128]), torch.Size([1, 819, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1298832893371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13613176345825195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 819, 128])
m.shape torch.Size([1056, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1367483139038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1367483139038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1056, 128]), torch.Size([1, 1056, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1377553939819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1528615951538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1056, 128])
m.shape torch.Size([1086, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15411090850830078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15411090850830078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1086, 128]), torch.Size([1, 1086, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15514659881591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17882061004638672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1086, 128])
m.shape torch.Size([1097, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18039512634277344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18039512634277344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1814413070678711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2124805450439453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1120, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21462774276733398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21462774276733398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21569585800170898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.254453182220459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([939, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2566056251525879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2566056251525879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25750112533569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29629945755004883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([950, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2990226745605469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2990226745605469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 950, 128]), torch.Size([1, 950, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2999286651611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3453226089477539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 950, 128])
m.shape torch.Size([924, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34839439392089844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34839439392089844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3492755889892578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39964866638183594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([775, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4028778076171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4028778076171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 775, 128]), torch.Size([1, 775, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40361690521240234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4516105651855469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 775, 128])
m.shape torch.Size([12462, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5106644630432129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5106644630432129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12462, 128]), torch.Size([1, 12462, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5225491523742676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3663620948791504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12462, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2900614738464355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3103060722351074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3305506706237793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.310147762298584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21228, 256])
first layer input nodes number: 70499
first layer output nodes number: 21228
edges number: 167448
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.331078052520752  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3513226509094238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3564352989196777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3564352989196777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([451, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3791770935058594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3791770935058594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3800373077392578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3869190216064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3871870040893555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3871870040893555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3878793716430664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3989839553833008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([310, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3995318412780762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3995318412780762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.400123119354248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4164009094238281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([218, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4169435501098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4169435501098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4173593521118164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.429417610168457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([207, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4303412437438965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4303412437438965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4307360649108887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4449496269226074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([132, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4455137252807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4455137252807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.445765495300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4565916061401367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.457226276397705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.457226276397705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.457441806793213  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4682183265686035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4688644409179688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4688644409179688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4690513610839844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.479705810546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.480417251586914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.480417251586914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4805946350097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4919471740722656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4925603866577148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4925603866577148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4926996231079102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5025854110717773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.503150463104248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.503150463104248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5032649040222168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5121912956237793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.512803077697754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.512803077697754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.512913703918457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5223169326782227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.522836685180664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.522836685180664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5229244232177734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.530996322631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([58, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5317330360412598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5317330360412598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.531843662261963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5427956581115723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5433173179626465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5433173179626465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.543393611907959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.551480770111084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.551950454711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.551950454711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5520133972167969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5591259002685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5594215393066406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5594215393066406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5594596862792969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5640373229980469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5646758079528809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5646758079528809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5647482872009277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5739531517028809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5745744705200195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5745744705200195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5746431350708008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5838441848754883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5842328071594238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5842328071594238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5842747688293457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.59019136428833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5904936790466309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5904936790466309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5905241966247559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5950407981872559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5954484939575195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5954484939575195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5954866409301758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6013994216918945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.601667881011963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.601667881011963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6016926765441895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6057095527648926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6059741973876953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6059741973876953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.605997085571289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6098651885986328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6172785758972168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6172785758972168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6178679466247559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7348999977111816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7152314186096191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7156548500061035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.716078281402588  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7156333923339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2839, 40])
input nodes number: 21228
output nodes number: 2839
edges number: 23078
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7158126831054688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.715813159942627  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04921293258666992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04921293258666992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04921293258666992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015863068401813507 |0.00298936665058136 |0.11933889985084534 |8.951127529144287e-05 |0.07532628625631332 |0.004763364791870117 |
----------------------------------------------------------pseudo_mini_loss sum 4.126286506652832
Total (block generation + training)time/epoch 14.340085983276367
Training time/epoch 6.98305344581604
Training time without block to device /epoch 6.8873937129974365
Training time without total dataloading part /epoch 6.236913681030273
load block tensor time/epoch 0.5076181888580322
block to device time/epoch 0.09565973281860352
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2939451
Number of first layer input nodes during this epoch:  2259063
Number of first layer output nodes during this epoch:  680388
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04921245574951172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.021376371383666992
number of batches is  32
batch size is  2842
range selection method spend 0.01734447479248047
time for parepare:  0.020496606826782227
local_output_nid generation:  0.0008716583251953125
local_in_edges_tensor generation:  0.006423234939575195
mini_batch_src_global generation:  0.0012366771697998047
r_  generation:  0.0073337554931640625
local_output_nid generation:  0.0009493827819824219
local_in_edges_tensor generation:  0.0005857944488525391
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  0.007647275924682617
local_output_nid generation:  0.0008900165557861328
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.0007777214050292969
r_  generation:  0.006796598434448242
local_output_nid generation:  0.0009615421295166016
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0007176399230957031
r_  generation:  0.006716489791870117
local_output_nid generation:  0.0009562969207763672
local_in_edges_tensor generation:  0.0005397796630859375
mini_batch_src_global generation:  0.0007083415985107422
r_  generation:  0.006982564926147461
local_output_nid generation:  0.0008270740509033203
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0006833076477050781
r_  generation:  0.00691986083984375
local_output_nid generation:  0.0008425712585449219
local_in_edges_tensor generation:  0.0005040168762207031
mini_batch_src_global generation:  0.0007390975952148438
r_  generation:  0.007098197937011719
local_output_nid generation:  0.0008301734924316406
local_in_edges_tensor generation:  0.0005016326904296875
mini_batch_src_global generation:  0.0006787776947021484
r_  generation:  0.00719904899597168
local_output_nid generation:  0.0008292198181152344
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0006916522979736328
r_  generation:  0.007055997848510742
local_output_nid generation:  0.0008566379547119141
local_in_edges_tensor generation:  0.0004963874816894531
mini_batch_src_global generation:  0.0006973743438720703
r_  generation:  0.007095813751220703
local_output_nid generation:  0.00089263916015625
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0007474422454833984
r_  generation:  0.007207155227661133
local_output_nid generation:  0.00081634521484375
local_in_edges_tensor generation:  0.000492095947265625
mini_batch_src_global generation:  0.0007076263427734375
r_  generation:  0.007132768630981445
local_output_nid generation:  0.0009062290191650391
local_in_edges_tensor generation:  0.0004918575286865234
mini_batch_src_global generation:  0.0008692741394042969
r_  generation:  0.007226228713989258
local_output_nid generation:  0.0028057098388671875
local_in_edges_tensor generation:  0.0005002021789550781
mini_batch_src_global generation:  0.0008871555328369141
r_  generation:  0.007320880889892578
local_output_nid generation:  0.0008106231689453125
local_in_edges_tensor generation:  0.0004608631134033203
mini_batch_src_global generation:  0.0007085800170898438
r_  generation:  0.007222175598144531
local_output_nid generation:  0.0008161067962646484
local_in_edges_tensor generation:  0.0005092620849609375
mini_batch_src_global generation:  0.0007071495056152344
r_  generation:  0.007055044174194336
local_output_nid generation:  0.0008196830749511719
local_in_edges_tensor generation:  0.000453948974609375
mini_batch_src_global generation:  0.000759124755859375
r_  generation:  0.007216691970825195
local_output_nid generation:  0.0008115768432617188
local_in_edges_tensor generation:  0.0005025863647460938
mini_batch_src_global generation:  0.0007865428924560547
r_  generation:  0.007246494293212891
local_output_nid generation:  0.0008113384246826172
local_in_edges_tensor generation:  0.0005345344543457031
mini_batch_src_global generation:  0.0007252693176269531
r_  generation:  0.0071506500244140625
local_output_nid generation:  0.000804901123046875
local_in_edges_tensor generation:  0.00044465065002441406
mini_batch_src_global generation:  0.0007178783416748047
r_  generation:  0.007106781005859375
local_output_nid generation:  0.0008063316345214844
local_in_edges_tensor generation:  0.0005342960357666016
mini_batch_src_global generation:  0.0009107589721679688
r_  generation:  0.0074503421783447266
local_output_nid generation:  0.0007960796356201172
local_in_edges_tensor generation:  0.0005447864532470703
mini_batch_src_global generation:  0.00077056884765625
r_  generation:  0.00741887092590332
local_output_nid generation:  0.0008842945098876953
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0007069110870361328
r_  generation:  0.008794307708740234
local_output_nid generation:  0.0008897781372070312
local_in_edges_tensor generation:  0.0005087852478027344
mini_batch_src_global generation:  0.0010650157928466797
r_  generation:  0.007265567779541016
local_output_nid generation:  0.000804901123046875
local_in_edges_tensor generation:  0.0004544258117675781
mini_batch_src_global generation:  0.0007441043853759766
r_  generation:  0.007340431213378906
local_output_nid generation:  0.0008933544158935547
local_in_edges_tensor generation:  0.0005419254302978516
mini_batch_src_global generation:  0.0007252693176269531
r_  generation:  0.007126331329345703
local_output_nid generation:  0.0007853507995605469
local_in_edges_tensor generation:  0.00046515464782714844
mini_batch_src_global generation:  0.0009036064147949219
r_  generation:  0.0074541568756103516
local_output_nid generation:  0.0007982254028320312
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.0007367134094238281
r_  generation:  0.007253885269165039
local_output_nid generation:  0.0007863044738769531
local_in_edges_tensor generation:  0.0004572868347167969
mini_batch_src_global generation:  0.0007650852203369141
r_  generation:  0.007234334945678711
local_output_nid generation:  0.0008869171142578125
local_in_edges_tensor generation:  0.0004961490631103516
mini_batch_src_global generation:  0.0007929801940917969
r_  generation:  0.0073108673095703125
local_output_nid generation:  0.0007987022399902344
local_in_edges_tensor generation:  0.0005342960357666016
mini_batch_src_global generation:  0.0007636547088623047
r_  generation:  0.007275104522705078
local_output_nid generation:  0.0007874965667724609
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0009100437164306641
r_  generation:  0.007441520690917969
----------------------check_connections_block total spend ----------------------------- 0.3913557529449463
generate_one_block  0.018092632293701172
generate_one_block  0.012682199478149414
generate_one_block  0.012167215347290039
generate_one_block  0.011929750442504883
generate_one_block  0.012350082397460938
generate_one_block  0.012055397033691406
generate_one_block  0.012175798416137695
generate_one_block  0.013720273971557617
generate_one_block  0.01218271255493164
generate_one_block  0.012065410614013672
generate_one_block  0.012157917022705078
generate_one_block  0.011968612670898438
generate_one_block  0.012157678604125977
generate_one_block  0.015033483505249023
generate_one_block  0.012154340744018555
generate_one_block  0.011889457702636719
generate_one_block  0.012027978897094727
generate_one_block  0.012581110000610352
generate_one_block  0.011759757995605469
generate_one_block  0.011884450912475586
generate_one_block  0.012476921081542969
generate_one_block  0.012507438659667969
generate_one_block  0.011640787124633789
generate_one_block  0.012075662612915039
generate_one_block  0.013676166534423828
generate_one_block  0.011934757232666016
generate_one_block  0.012521982192993164
generate_one_block  0.01192474365234375
generate_one_block  0.01197504997253418
generate_one_block  0.01228189468383789
generate_one_block  0.011920452117919922
generate_one_block  0.012344837188720703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021273374557495117
gen group dst list time:  0.018559932708740234
time for parepare:  0.01868438720703125
local_output_nid generation:  0.003710508346557617
local_in_edges_tensor generation:  0.010803461074829102
mini_batch_src_global generation:  0.005322694778442383
r_  generation:  0.05694746971130371
local_output_nid generation:  0.005875587463378906
local_in_edges_tensor generation:  0.005606412887573242
mini_batch_src_global generation:  0.006438493728637695
r_  generation:  0.061553001403808594
local_output_nid generation:  0.005995512008666992
local_in_edges_tensor generation:  0.004809856414794922
mini_batch_src_global generation:  0.005639791488647461
r_  generation:  0.06203722953796387
local_output_nid generation:  0.005961418151855469
local_in_edges_tensor generation:  0.0045928955078125
mini_batch_src_global generation:  0.00571751594543457
r_  generation:  0.06218910217285156
local_output_nid generation:  0.006240367889404297
local_in_edges_tensor generation:  0.00574493408203125
mini_batch_src_global generation:  0.012644767761230469
r_  generation:  0.07826042175292969
local_output_nid generation:  0.0062406063079833984
local_in_edges_tensor generation:  0.004912376403808594
mini_batch_src_global generation:  0.010396957397460938
r_  generation:  0.08496594429016113
local_output_nid generation:  0.008289098739624023
local_in_edges_tensor generation:  0.005541086196899414
mini_batch_src_global generation:  0.007567882537841797
r_  generation:  0.06798458099365234
local_output_nid generation:  0.00733184814453125
local_in_edges_tensor generation:  0.008257627487182617
mini_batch_src_global generation:  0.007540225982666016
r_  generation:  0.06609582901000977
local_output_nid generation:  0.006459951400756836
local_in_edges_tensor generation:  0.00525665283203125
mini_batch_src_global generation:  0.006933450698852539
r_  generation:  0.06530308723449707
local_output_nid generation:  0.006376743316650391
local_in_edges_tensor generation:  0.0054912567138671875
mini_batch_src_global generation:  0.0069427490234375
r_  generation:  0.0647881031036377
local_output_nid generation:  0.00626373291015625
local_in_edges_tensor generation:  0.005306243896484375
mini_batch_src_global generation:  0.011166095733642578
r_  generation:  0.08453679084777832
local_output_nid generation:  0.007546186447143555
local_in_edges_tensor generation:  0.00524592399597168
mini_batch_src_global generation:  0.006925344467163086
r_  generation:  0.06595730781555176
local_output_nid generation:  0.0071642398834228516
local_in_edges_tensor generation:  0.006974697113037109
mini_batch_src_global generation:  0.007325410842895508
r_  generation:  0.06662917137145996
local_output_nid generation:  0.00675511360168457
local_in_edges_tensor generation:  0.0050203800201416016
mini_batch_src_global generation:  0.007059812545776367
r_  generation:  0.06669235229492188
local_output_nid generation:  0.006414651870727539
local_in_edges_tensor generation:  0.005465030670166016
mini_batch_src_global generation:  0.0069158077239990234
r_  generation:  0.06690096855163574
local_output_nid generation:  0.00637364387512207
local_in_edges_tensor generation:  0.007498025894165039
mini_batch_src_global generation:  0.012570619583129883
r_  generation:  0.0829775333404541
local_output_nid generation:  0.007415056228637695
local_in_edges_tensor generation:  0.00557255744934082
mini_batch_src_global generation:  0.007155895233154297
r_  generation:  0.06508183479309082
local_output_nid generation:  0.006930112838745117
local_in_edges_tensor generation:  0.005438089370727539
mini_batch_src_global generation:  0.007153511047363281
r_  generation:  0.06993532180786133
local_output_nid generation:  0.008447408676147461
local_in_edges_tensor generation:  0.0309445858001709
mini_batch_src_global generation:  0.006376028060913086
r_  generation:  0.06369686126708984
local_output_nid generation:  0.006342887878417969
local_in_edges_tensor generation:  0.0052907466888427734
mini_batch_src_global generation:  0.006650686264038086
r_  generation:  0.0639948844909668
local_output_nid generation:  0.006616830825805664
local_in_edges_tensor generation:  0.005416393280029297
mini_batch_src_global generation:  0.014521598815917969
r_  generation:  0.0875391960144043
local_output_nid generation:  0.007625579833984375
local_in_edges_tensor generation:  0.006049394607543945
mini_batch_src_global generation:  0.007344722747802734
r_  generation:  0.06629467010498047
local_output_nid generation:  0.006666898727416992
local_in_edges_tensor generation:  0.0058345794677734375
mini_batch_src_global generation:  0.0068204402923583984
r_  generation:  0.06257414817810059
local_output_nid generation:  0.006738185882568359
local_in_edges_tensor generation:  0.005333662033081055
mini_batch_src_global generation:  0.00684809684753418
r_  generation:  0.06613755226135254
local_output_nid generation:  0.006659984588623047
local_in_edges_tensor generation:  0.005501508712768555
mini_batch_src_global generation:  0.0069887638092041016
r_  generation:  0.06580734252929688
local_output_nid generation:  0.006400346755981445
local_in_edges_tensor generation:  0.005551338195800781
mini_batch_src_global generation:  0.00679779052734375
r_  generation:  0.06396079063415527
local_output_nid generation:  0.006639003753662109
local_in_edges_tensor generation:  0.005480766296386719
mini_batch_src_global generation:  0.0072438716888427734
r_  generation:  0.06801080703735352
local_output_nid generation:  0.006458282470703125
local_in_edges_tensor generation:  0.005541563034057617
mini_batch_src_global generation:  0.007161378860473633
r_  generation:  0.06525158882141113
local_output_nid generation:  0.006430149078369141
local_in_edges_tensor generation:  0.00522303581237793
mini_batch_src_global generation:  0.007036447525024414
r_  generation:  0.06538271903991699
local_output_nid generation:  0.006333112716674805
local_in_edges_tensor generation:  0.005263566970825195
mini_batch_src_global generation:  0.0069468021392822266
r_  generation:  0.06517910957336426
local_output_nid generation:  0.006353139877319336
local_in_edges_tensor generation:  0.005596637725830078
mini_batch_src_global generation:  0.007084369659423828
r_  generation:  0.06434106826782227
local_output_nid generation:  0.006511688232421875
local_in_edges_tensor generation:  0.005698680877685547
mini_batch_src_global generation:  0.007372140884399414
r_  generation:  0.06597900390625
----------------------check_connections_block total spend ----------------------------- 3.3951327800750732
generate_one_block  0.08175992965698242
generate_one_block  0.08469772338867188
generate_one_block  0.08328700065612793
generate_one_block  0.08257365226745605
generate_one_block  0.08544373512268066
generate_one_block  0.10506296157836914
generate_one_block  0.08669590950012207
generate_one_block  0.08434629440307617
generate_one_block  0.08434414863586426
generate_one_block  0.08337640762329102
generate_one_block  0.08335494995117188
generate_one_block  0.08220958709716797
generate_one_block  0.08506393432617188
generate_one_block  0.0850365161895752
generate_one_block  0.0826423168182373
generate_one_block  0.08177947998046875
generate_one_block  0.08225393295288086
generate_one_block  0.08609676361083984
generate_one_block  0.08130240440368652
generate_one_block  0.10073995590209961
generate_one_block  0.08831357955932617
generate_one_block  0.10249495506286621
generate_one_block  0.08562994003295898
generate_one_block  0.09723305702209473
generate_one_block  0.09069275856018066
generate_one_block  0.0860128402709961
generate_one_block  0.08676004409790039
generate_one_block  0.10003066062927246
generate_one_block  0.08934617042541504
generate_one_block  0.08722209930419922
generate_one_block  0.08583807945251465
generate_one_block  0.0876619815826416
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04921245574951172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

connection checking time:  3.3951327800750732
block generation total time  2.7993037700653076
average batch blocks generation time:  0.08747824281454086
block dataloader generation time/epoch 7.310611248016357
pseudo mini batch 0 input nodes size: 70200
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04516458511352539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04516458511352539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07863855361938477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0786600112915039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045022010803222656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046421051025390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046421051025390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046421051025390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70200, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046421051025390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([847, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1274552345275879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1274552345275879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 847, 128]), torch.Size([1, 847, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12826299667358398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13472509384155273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 847, 128])
m.shape torch.Size([1196, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13579463958740234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13579463958740234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1196, 128]), torch.Size([1, 1196, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13693523406982422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15404415130615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1196, 128])
m.shape torch.Size([1160, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15513324737548828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15513324737548828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15623950958251953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18074893951416016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
m.shape torch.Size([1152, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18239307403564453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18239307403564453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18349170684814453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21535205841064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1109, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21744680404663086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21744680404663086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1109, 128]), torch.Size([1, 1109, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2185044288635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25707292556762695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1109, 128])
m.shape torch.Size([1006, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25942230224609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25942230224609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1006, 128]), torch.Size([1, 1006, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.26038169860839844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3023185729980469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1006, 128])
m.shape torch.Size([924, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30492305755615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30492305755615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 924, 128]), torch.Size([1, 924, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3058042526245117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3500089645385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 924, 128])
m.shape torch.Size([860, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35284900665283203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35284900665283203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3536691665649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40125560760498047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([780, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4041929244995117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4041929244995117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4049367904663086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4528355598449707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([12157, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5110573768615723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5110573768615723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12157, 128]), torch.Size([1, 12157, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.522651195526123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3533082008361816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12157, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2786097526550293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2988190650939941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.319028377532959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2986607551574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21191, 256])
first layer input nodes number: 70200
first layer output nodes number: 21191
edges number: 164846
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3195533752441406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3397626876831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3449440002441406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3449440002441406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([408, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3673992156982422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3673992156982422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3681774139404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3756933212280273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([405, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3760828971862793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3760828971862793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3768553733825684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3914203643798828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3918848037719727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3918848037719727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3924474716186523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4063596725463867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([230, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4069628715515137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4069628715515137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4074015617370605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.42012357711792  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4208416938781738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4208416938781738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4212136268615723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.434603214263916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([151, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.435288429260254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.435288429260254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4355764389038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4479608535766602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([135, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4487252235412598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4487252235412598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4489827156066895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4618573188781738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4625592231750488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4625592231750488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4627652168273926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4745068550109863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4751996994018555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4751996994018555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4753751754760742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4866056442260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([66, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4871525764465332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4871525764465332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4872784614562988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4962162971496582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4969253540039062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4969253540039062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4970645904541016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.507925033569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5083975791931152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5083975791931152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5084872245788574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5161070823669434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5167245864868164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5167245864868164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5168256759643555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5261259078979492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5265870094299316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5265870094299316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5266594886779785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5338349342346191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534317970275879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534317970275879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5343866348266602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5416650772094727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5421843528747559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5421843528747559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.542253017425537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5500121116638184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5505661964416504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5505661964416504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5506348609924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5588746070861816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.559255599975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.559255599975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5593013763427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.565114974975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5655488967895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5655488967895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.565596580505371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.571986198425293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5724430084228516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5724430084228516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5724906921386719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.579214096069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5795536041259766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5795536041259766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5795879364013672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5846691131591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5852017402648926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5852017402648926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5852513313293457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.59293794631958  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5933332443237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5933332443237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.593369483947754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5992403030395508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5995912551879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5995912551879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5996217727661133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6047792434692383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([285, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.611612319946289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.611612319946289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6121559143066406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7096266746520996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 285, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6902270317077637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6906509399414062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6910748481750488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.690629482269287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21191
output nodes number: 2842
edges number: 22820
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.690809726715088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6908106803894043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049022674560546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 1 input nodes size: 70751
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045023441314697266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045023441314697266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07876014709472656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0787816047668457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04528617858886719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04669380187988281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04669380187988281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04669380187988281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70751, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04669380187988281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([841, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12818431854248047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12818431854248047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12898635864257812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13540267944335938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([1160, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1361079216003418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1361079216003418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1160, 128]), torch.Size([1, 1160, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13721418380737305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1541457176208496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1160, 128])
m.shape torch.Size([1149, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15523624420166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15523624420166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15633201599121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18079423904418945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1172, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1824817657470703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1824817657470703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1172, 128]), torch.Size([1, 1172, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18359947204589844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21601295471191406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1172, 128])
m.shape torch.Size([1134, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21815776824951172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21815776824951172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2192392349243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2582368850708008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([1022, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2606201171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2606201171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2615947723388672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3035430908203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([952, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30623340606689453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30623340606689453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3071413040161133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3526144027709961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([906, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35561656951904297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35561656951904297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35648059844970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40677547454833984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([866, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.41005992889404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.41005992889404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4108858108520508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.46457862854003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([12098, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5227594375610352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5227594375610352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12098, 128]), torch.Size([1, 12098, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5348453521728516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3648834228515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12098, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2898149490356445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3101282119750977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3304414749145508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.309969425201416  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21300, 256])
first layer input nodes number: 70751
first layer output nodes number: 21300
edges number: 165784
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3309707641601562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3512840270996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3563623428344727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3563623428344727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3789749145507812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3789749145507812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3797760009765625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3880529403686523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3883695602416992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3883695602416992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3890810012817383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4030866622924805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([304, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4036078453063965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4036078453063965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4041876792907715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4194259643554688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4200549125671387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4200549125671387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4205107688903809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4337306022644043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4344735145568848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4344735145568848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.434858798980713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4487290382385254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([140, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4493441581726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4493441581726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4496111869812012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4610934257507324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4617609977722168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4617609977722168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4619879722595215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4733366966247559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([109, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4740614891052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4740614891052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4742693901062012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4861197471618652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4868292808532715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4868292808532715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4870085716247559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4984831809997559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([69, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4990568161010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4990568161010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4991884231567383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5085325241088867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509228229522705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509228229522705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5093655586242676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5200772285461426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5206084251403809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5206084251403809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.520707607269287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5291380882263184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5296635627746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5296635627746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5297513008117676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.53782320022583  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5384254455566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5384254455566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5385169982910156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5475807189941406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.548126220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.548126220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5482044219970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5564937591552734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.556931495666504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.556931495666504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.556990623474121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5636720657348633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5642638206481934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5642638206481934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5643362998962402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5730338096618652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5735688209533691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5735688209533691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.573631763458252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5816254615783691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5821237564086914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5821237564086914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.582179069519043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5895910263061523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5900249481201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5900249481201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5900707244873047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5965251922607422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5969467163085938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5969467163085938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5969886779785156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6031990051269531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6035375595092773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6035375595092773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6035699844360352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.608595848083496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6089558601379395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6089558601379395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6089882850646973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614241123199463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6146864891052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6146864891052246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6147246360778809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.621171474456787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([283, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6279525756835938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6279525756835938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6284923553466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7258424758911133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 283, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7063093185424805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.706733226776123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7071571350097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.706711769104004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21300
output nodes number: 2842
edges number: 22975
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7068920135498047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.706892490386963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049309730529785156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 2 input nodes size: 70123
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04528617858886719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04528617858886719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07872343063354492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07874488830566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044986724853515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04639434814453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04639434814453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04639434814453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70123, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04639434814453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([836, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1289048194885254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1289048194885254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 836, 128]), torch.Size([1, 836, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12970209121704102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13608026504516602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 836, 128])
m.shape torch.Size([1091, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13672208786010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13672208786010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13776254653930664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15336942672729492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1141, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1544814109802246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1544814109802246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15556955337524414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17999744415283203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1075, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1815037727355957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1815037727355957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18252897262573242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2132115364074707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1096, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21531200408935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21531200408935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1096, 128]), torch.Size([1, 1096, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21635723114013672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2550973892211914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1096, 128])
m.shape torch.Size([986, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25739574432373047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25739574432373047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 986, 128]), torch.Size([1, 986, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25833606719970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29949474334716797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 986, 128])
m.shape torch.Size([906, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3020486831665039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3020486831665039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 906, 128]), torch.Size([1, 906, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30291271209716797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3471336364746094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 906, 128])
m.shape torch.Size([873, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35003185272216797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35003185272216797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 873, 128]), torch.Size([1, 873, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3508644104003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39928340911865234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 873, 128])
m.shape torch.Size([790, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40225744247436523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40225744247436523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 790, 128]), torch.Size([1, 790, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40301084518432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.45122861862182617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 790, 128])
m.shape torch.Size([12333, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5096602439880371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5096602439880371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12333, 128]), torch.Size([1, 12333, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5214219093322754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3565001487731934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12333, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2802133560180664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3003616333007812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.320509910583496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.300203800201416  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21127, 256])
first layer input nodes number: 70123
first layer output nodes number: 21127
edges number: 165903
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3210344314575195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3411827087402344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.346848964691162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.346848964691162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3693881034851074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3693881034851074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3701796531677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.376729965209961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([367, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.377039909362793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.377039909362793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3777399063110352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3902082443237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3907060623168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3907060623168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3912668228149414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.408463478088379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.409036636352539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.409036636352539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4094600677490234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4217395782470703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4224987030029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4224987030029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4228839874267578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4367542266845703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.437605381011963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.437605381011963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.437941074371338  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.452375888824463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([113, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4529685974121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4529685974121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4531841278076172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4639606475830078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([117, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4647526741027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4647526741027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4649758338928223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4776959419250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4782938957214355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4782938957214355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4784502983093262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4884600639343262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4891414642333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4891414642333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4892921447753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.499990463256836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5006237030029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5006237030029297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5007514953613281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5107192993164062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([81, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5115900039672852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5115900039672852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.511744499206543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.524876594543457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.525449275970459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.525449275970459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5255484580993652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5346732139587402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5352158546447754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5352158546447754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5352997779846191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5436081886291504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.544215202331543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.544215202331543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5443010330200195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5533990859985352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5538177490234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5538177490234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5538749694824219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5603408813476562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5609335899353027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5609335899353027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5610060691833496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5697035789489746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.570220947265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.570220947265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.570281982421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.578033447265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5782771110534668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5782771110534668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.578305721282959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.582139492034912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.582509994506836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.582509994506836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5825481414794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5879268646240234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5883522033691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5883522033691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5883941650390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5946044921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5948586463928223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5948586463928223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5948834419250488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.598726749420166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5991125106811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5991125106811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.599146842956543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6047086715698242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.604968547821045  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.604968547821045  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6049914360046387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6088595390319824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.615720272064209  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.615720272064209  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6162657737731934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7294836044311523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.710005760192871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7104296684265137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7108535766601562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7104082107543945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21127
output nodes number: 2842
edges number: 22903
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.710587501525879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.710587978363037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04900169372558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 3 input nodes size: 70252
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044986724853515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044986724853515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07848548889160156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0785069465637207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04504823684692383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046450138092041016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046450138092041016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046450138092041016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70252, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046450138092041016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([796, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12770318984985352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12770318984985352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 796, 128]), torch.Size([1, 796, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1284623146057129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1345353126525879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 796, 128])
m.shape torch.Size([1021, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13512945175170898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13512945175170898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1021, 128]), torch.Size([1, 1021, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13610315322875977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15070867538452148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1021, 128])
m.shape torch.Size([1121, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1518254280090332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1518254280090332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1528944969177246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17670202255249023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1075, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17821788787841797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17821788787841797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1792430877685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.20897388458251953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1068, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21100759506225586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21100759506225586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21202611923217773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2493281364440918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([931, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2514824867248535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2514824867248535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25237035751342773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2909121513366699  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([887, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.293428897857666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.293428897857666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 887, 128]), torch.Size([1, 887, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29427480697631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3375735282897949  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 887, 128])
m.shape torch.Size([840, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34035491943359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34035491943359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.341156005859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.38742494583129883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([845, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39065074920654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39065074920654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39145660400390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4432220458984375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([12341, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5016655921936035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5016655921936035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12341, 128]), torch.Size([1, 12341, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5141878128051758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3498077392578125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12341, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2746496200561523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2946052551269531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.314560890197754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2944493293762207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([20925, 256])
first layer input nodes number: 70252
first layer output nodes number: 20925
edges number: 165371
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3150863647460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3350419998168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3406739234924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3406739234924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.363093376159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.363093376159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3638792037963867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.370713233947754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([387, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3710646629333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3710646629333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.371802806854248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.384833812713623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3853559494018555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3853559494018555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3859453201293945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4032917022705078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4038581848144531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4038581848144531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4042854309082031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4166755676269531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([188, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.417365550994873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.417365550994873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4177241325378418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4306330680847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([166, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4314112663269043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4314112663269043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4317278861999512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4453425407409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4459853172302246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4459853172302246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4462122917175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4575610160827637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.458216667175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.458216667175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4584074020385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4692792892456055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4701099395751953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4701099395751953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4703140258789062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4833755493164062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([86, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.484100341796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.484100341796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4842643737792969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.49591064453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4964313507080078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4964313507080078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4965400695800781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5050201416015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5056581497192383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5056581497192383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.505772590637207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5155000686645508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.515967845916748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.515967845916748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5160479545593262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5234179496765137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5240912437438965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5240912437438965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5241923332214355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5342001914978027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534712314605713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534712314605713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5347867012023926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5426716804504395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([33, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.543142318725586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.543142318725586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5432052612304688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5503177642822266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5505971908569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5505971908569336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550633430480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5549821853637695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555673599243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555673599243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5557518005371094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.565683364868164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.56610107421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.56610107421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5661487579345703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5725383758544922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5728607177734375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5728607177734375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5728950500488281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5777359008789062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.578263759613037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.578263759613037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.578315258026123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5859370231628418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.586143970489502  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.586143970489502  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.586164951324463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5894169807434082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.589738368988037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.589738368988037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5897669792175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5944018363952637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5947566032409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5947566032409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5947871208190918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5999445915222168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([288, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6068496704101562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6068496704101562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6073989868164062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.720937728881836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 288, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7015738487243652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7019977569580078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7024216651916504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7019762992858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 20925
output nodes number: 2842
edges number: 22783
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7021536827087402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7021541595458984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04904603958129883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 4 input nodes size: 71279
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04504823684692383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04504823684692383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07903671264648438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07905817031860352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04553794860839844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046985626220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046985626220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046985626220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71279, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046985626220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([838, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13149404525756836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13149404525756836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1322932243347168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1386866569519043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([1016, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13925600051879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13925600051879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.14022493362426758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15475893020629883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([1147, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1559152603149414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1559152603149414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1147, 128]), torch.Size([1, 1147, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15700912475585938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1810741424560547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1147, 128])
m.shape torch.Size([1101, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18262720108032227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18262720108032227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1101, 128]), torch.Size([1, 1101, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18367719650268555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21467065811157227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1101, 128])
m.shape torch.Size([1080, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2167205810546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2167205810546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21775054931640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25510597229003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1019, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2575063705444336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2575063705444336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1019, 128]), torch.Size([1, 1019, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25847816467285156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3011646270751953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1019, 128])
m.shape torch.Size([942, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30382299423217773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30382299423217773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 942, 128]), torch.Size([1, 942, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3047213554382324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3496394157409668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 942, 128])
m.shape torch.Size([878, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3525395393371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3525395393371582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 878, 128]), torch.Size([1, 878, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3533768653869629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40164899826049805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 878, 128])
m.shape torch.Size([763, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40450477600097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40450477600097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 763, 128]), torch.Size([1, 763, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40523242950439453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.45253610610961914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 763, 128])
m.shape torch.Size([12765, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5130405426025391  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5130405426025391  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12765, 128]), torch.Size([1, 12765, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5252141952514648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3898015022277832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12765, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3115525245666504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3321032524108887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.352653980255127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3319425582885742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21549, 256])
first layer input nodes number: 71279
first layer output nodes number: 21549
edges number: 170364
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.353187084197998  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3737378120422363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3795032501220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3795032501220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([412, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4036426544189453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4036426544189453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.404428482055664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4107751846313477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([325, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4110074043273926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4110074043273926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4116272926330566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4211115837097168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([315, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4217100143432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4217100143432617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4223108291625977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.436811923980713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4373769760131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4373769760131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4378061294555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.450251579284668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([209, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4510884284973145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4510884284973145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4514870643615723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4658379554748535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4664921760559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4664921760559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4667744636535645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4789128303527832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.479586124420166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.479586124420166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4798169136047363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.491356372833252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([110, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4920868873596191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4920868873596191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4922966957092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.504255771636963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([89, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5049209594726562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5049209594726562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5050907135009766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5159549713134766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5165143013000488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5165143013000488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5166420936584473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5257153511047363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5264129638671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5264129638671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.52655029296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.537261962890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5380125045776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5380125045776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5381479263305664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5496587753295898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550365924835205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550365924835205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5504841804504395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.561363697052002  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5618162155151367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5618162155151367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5618886947631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5690641403198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5695037841796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5695037841796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5695667266845703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5762386322021484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5767765045166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5767765045166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5768470764160156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5848217010498047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5852932929992676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5852932929992676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5853524208068848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5924477577209473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.592902660369873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.592902660369873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5929560661315918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.599738597869873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6003146171569824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6003146171569824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6003775596618652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.608811855316162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6092805862426758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6092805862426758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609330177307129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6163225173950195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6166815757751465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6166815757751465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.61671781539917  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6220812797546387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6223173141479492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6223173141479492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.622340202331543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6258878707885742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6262526512145996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6262526512145996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6262850761413574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.631537914276123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6321215629577637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6321215629577637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6321711540222168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.640552043914795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([316, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.648120403289795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.648120403289795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6487231254577637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7578330039978027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 316, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7367310523986816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7371549606323242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7375788688659668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.737133502960205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21549
output nodes number: 2842
edges number: 23863
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7373156547546387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7373161315917969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04965782165527344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 5 input nodes size: 71090
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04553794860839844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04553794860839844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0794363021850586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07945775985717773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04544782638549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0468745231628418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0468745231628418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0468745231628418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71090, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0468745231628418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([851, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12950706481933594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12950706481933594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13031864166259766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13704919815063477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([1027, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13762283325195312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13762283325195312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1027, 128]), torch.Size([1, 1027, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13860225677490234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15329360961914062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1027, 128])
m.shape torch.Size([1151, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1544504165649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1544504165649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1151, 128]), torch.Size([1, 1151, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.155548095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17969703674316406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1151, 128])
m.shape torch.Size([1127, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18129777908325195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18129777908325195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1823725700378418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21368074417114258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1060, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21567058563232422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21567058563232422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21668148040771484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2532644271850586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([1005, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2556343078613281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2556343078613281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2565927505493164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2982196807861328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([907, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3007678985595703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3007678985595703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3016328811645508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34611988067626953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([851, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34893369674682617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34893369674682617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3497452735900879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3960585594177246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([814, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39914608001708984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39914608001708984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39992237091064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4506645202636719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([12545, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5108232498168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5108232498168945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12545, 128]), torch.Size([1, 12545, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5227870941162109  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3729877471923828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12545, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.296605110168457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3169546127319336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3373041152954102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3167953491210938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21338, 256])
first layer input nodes number: 71090
first layer output nodes number: 21338
edges number: 168129
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3378357887268066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3581852912902832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3632726669311523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3632726669311523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([454, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.386181354522705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.386181354522705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.387047290802002  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3949236869812012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([339, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3951425552368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3951425552368164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3957891464233398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4061651229858398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([303, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4067158699035645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4067158699035645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4072937965393066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.422574520111084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([238, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4232006072998047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4232006072998047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.423654556274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.436819076538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([174, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4374284744262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4374284744262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.437760353088379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4497079849243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([137, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4503321647644043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4503321647644043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4505934715270996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.461829662322998  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4625067710876465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4625067710876465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.462735652923584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.474179744720459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([101, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4748420715332031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4748420715332031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4750347137451172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4860153198242188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4868102073669434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4868102073669434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.487006664276123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.499579906463623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5001740455627441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5001740455627441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5003113746643066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5100617408752441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5108284950256348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5108284950256348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.510979175567627  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5227322578430176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5233144760131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5233144760131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.523423194885254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5326642990112305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5331850051879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5331850051879883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5332727432250977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5413446426391602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.54197359085083  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.54197359085083  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5420689582824707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5515103340148926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5521693229675293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5521693229675293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.552262783050537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5621695518493652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5627226829528809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5627226829528809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5627970695495605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5712027549743652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5716886520385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5716886520385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5717496871948242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5790739059448242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5796666145324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5796666145324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.579735279083252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5884556770324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.588860034942627  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.588860034942627  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5889058113098145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5950398445129395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5955171585083008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5955171585083008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.595566749572754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6025590896606445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6029582023620605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6029582023620605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6029982566833496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6089262962341309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6092238426208496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6092238426208496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6092524528503418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6136870384216309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6141371726989746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6141371726989746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6141772270202637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6206660270690918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.620945930480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.620945930480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6209707260131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6251611709594727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([293, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6321892738342285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6321892738342285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6327481269836426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7423033714294434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 293, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.722489833831787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7229137420654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7233376502990723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7228922843933105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21338
output nodes number: 2842
edges number: 23249
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7230730056762695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7230734825134277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0495147705078125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 6 input nodes size: 71268
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04544782638549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04544782638549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07943105697631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0794525146484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0455327033996582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046979427337646484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046979427337646484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046979427337646484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71268, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046979427337646484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([803, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1314711570739746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1314711570739746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 803, 128]), torch.Size([1, 803, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13223695755004883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13836336135864258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 803, 128])
m.shape torch.Size([1038, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13897037506103516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13897037506103516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13996028900146484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15480899810791016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([1135, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15638160705566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15638160705566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1135, 128]), torch.Size([1, 1135, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15746402740478516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18132495880126953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1135, 128])
m.shape torch.Size([1125, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18292951583862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18292951583862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18400239944458008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21533536911010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1030, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.217254638671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.217254638671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21823692321777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25423336029052734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([955, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25647449493408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25647449493408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 955, 128]), torch.Size([1, 955, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25738525390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2966957092285156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 955, 128])
m.shape torch.Size([907, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2992677688598633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2992677688598633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30013275146484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3448176383972168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([890, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3477802276611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3477802276611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3486289978027344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3986930847167969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([833, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4018435478210449  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4018435478210449  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40263795852661133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4539456367492676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([12768, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5144309997558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5144309997558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12768, 128]), torch.Size([1, 12768, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5266075134277344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.391397476196289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12768, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3131146430969238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3336033821105957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3540921211242676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3334431648254395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21484, 256])
first layer input nodes number: 71268
first layer output nodes number: 21484
edges number: 170310
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3546252250671387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3751139640808105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.380866527557373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.380866527557373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([407, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4049997329711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4049997329711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.405776023864746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.412552833557129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([341, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4128203392028809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4128203392028809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.41347074508667  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.423936367034912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([299, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.424473762512207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.424473762512207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.425044059753418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4389219284057617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([221, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4394865036010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4394865036010742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4399080276489258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.452132225036621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4528155326843262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4528155326843262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4531702995300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4659419059753418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([162, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4666991233825684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4666991233825684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.467008113861084  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4802947044372559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([134, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4810419082641602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4810419082641602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.481297492980957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4940767288208008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([125, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4949102401733398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4949102401733398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4951486587524414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5087385177612305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5094413757324219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5094413757324219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509622573852539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.521219253540039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5219364166259766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5219364166259766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5220966339111328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5334720611572266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5341215133666992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5341215133666992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5342531204223633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5445184707641602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5451102256774902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5451102256774902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5452189445495605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.554460048675537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5549554824829102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5549554824829102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555039405822754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.562760353088379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5634450912475586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5634450912475586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5635480880737305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.573744773864746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5741691589355469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5741691589355469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5742321014404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5809040069580078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5815033912658691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5815033912658691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5815815925598145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5904183387756348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.590886116027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.590886116027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5909452438354492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5980405807495117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5983920097351074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5983920097351074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5984339714050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6037631034851074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6042170524597168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6042170524597168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.60426664352417  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6109118461608887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6114253997802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6114253997802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6114788055419922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.619009017944336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6194267272949219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6194267272949219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6194686889648438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6256790161132812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6259756088256836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6259756088256836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6260042190551758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6304388046264648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6307783126831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6307783126831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6308088302612305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6357526779174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6362218856811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6362218856811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6362619400024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.643031120300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6504359245300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6504359245300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6510252952575684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7569451332092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7358503341674805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.736274242401123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7366981506347656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.736252784729004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21484
output nodes number: 2842
edges number: 23693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7364344596862793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7364349365234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04964780807495117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 7 input nodes size: 71291
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0455327033996582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0455327033996582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07952690124511719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07954835891723633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045543670654296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046982765197753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046982765197753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046982765197753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71291, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046982765197753906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([891, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13023614883422852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13023614883422852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13108587265014648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13788366317749023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([1069, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13873291015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13873291015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13975238800048828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1550445556640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1164, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15673398971557617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15673398971557617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15784406661987305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1822657585144043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([1031, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18367719650268555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18367719650268555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1846604347229004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21317434310913086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([1066, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2152242660522461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2152242660522461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21624088287353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2528390884399414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([982, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2551403045654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2551403045654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 982, 128]), torch.Size([1, 982, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2560768127441406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2971477508544922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 982, 128])
m.shape torch.Size([947, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29984045028686523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29984045028686523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30074357986450195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3459000587463379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([909, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34891605377197266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34891605377197266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34978294372558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3997163772583008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([798, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4032101631164551  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4032101631164551  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40397119522094727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.45293235778808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([12641, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5130987167358398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5130987167358398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12641, 128]), torch.Size([1, 12641, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5251541137695312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3815760612487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12641, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3046340942382812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3251361846923828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3456382751464844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3249759674072266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21498, 256])
first layer input nodes number: 71291
first layer output nodes number: 21498
edges number: 169360
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3461713790893555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.366673469543457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3726272583007812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3726272583007812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([447, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3967962265014648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3967962265014648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.397648811340332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4044694900512695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.404764175415039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.404764175415039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4054794311523438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4163141250610352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4167957305908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4167957305908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4173507690429688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4308433532714844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([205, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.43135404586792  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.43135404586792  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4317450523376465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4430842399597168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([175, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4437298774719238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4437298774719238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.444063663482666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4560799598693848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([149, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4567723274230957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4567723274230957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4570565223693848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4692769050598145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4699020385742188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4699020385742188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4701194763183594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4809913635253906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([108, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4817132949829102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4817132949829102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.481919288635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4936609268188477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([86, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4943022727966309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4943022727966309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4944663047790527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5049643516540527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.505690097808838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.505690097808838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5058503150939941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.517225742340088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5178542137145996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5178542137145996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.517982006072998  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5279498100280762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5286011695861816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5286011695861816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.528719425201416  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.538771152496338  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5393619537353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5393619537353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5394611358642578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5485858917236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549020767211914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549020767211914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5490894317626953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555887222290039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5563578605651855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5563578605651855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.556424617767334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5635008811950684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5639595985412598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5639595985412598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5640206336975098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5709176063537598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5714101791381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5714101791381836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5714712142944336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5787954330444336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.579439640045166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.579439640045166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5795140266418457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.588961124420166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.589599609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.589599609375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.589670181274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5991268157958984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5997066497802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5997066497802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5997676849365234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6083736419677734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.60906982421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.60906982421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6091384887695312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6193008422851562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6196260452270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6196260452270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6196584701538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6246843338012695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6249337196350098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6249337196350098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6249566078186035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.628664493560791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.628952980041504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.628952980041504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6289777755737305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6331682205200195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([306, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6405086517333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6405086517333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.641092300415039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7499942779541016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7289037704467773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.72932767868042  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7297515869140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7293062210083008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21498
output nodes number: 2842
edges number: 23590
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7294878959655762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7294883728027344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04964256286621094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 8 input nodes size: 70899
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045543670654296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045543670654296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07935094833374023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07937240600585938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04535675048828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04679393768310547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04679393768310547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04679393768310547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70899, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04679393768310547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([825, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12998294830322266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12998294830322266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 825, 128]), torch.Size([1, 825, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1307697296142578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13706398010253906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 825, 128])
m.shape torch.Size([1092, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13797521591186523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13797521591186523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1092, 128]), torch.Size([1, 1092, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13901662826538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15463781356811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1092, 128])
m.shape torch.Size([1084, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15643072128295898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15643072128295898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1084, 128]), torch.Size([1, 1084, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15746450424194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18113088607788086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1084, 128])
m.shape torch.Size([1088, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18268918991088867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18268918991088867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1088, 128]), torch.Size([1, 1088, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18372678756713867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21467161178588867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1088, 128])
m.shape torch.Size([1134, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2168564796447754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2168564796447754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1134, 128]), torch.Size([1, 1134, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21793794631958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25693559646606445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1134, 128])
m.shape torch.Size([970, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2591700553894043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2591700553894043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 970, 128]), torch.Size([1, 970, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.26009511947631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3000607490539551  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 970, 128])
m.shape torch.Size([925, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3026857376098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3026857376098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 925, 128]), torch.Size([1, 925, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30356788635253906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3481926918029785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 925, 128])
m.shape torch.Size([904, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3512001037597656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3512001037597656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3520622253417969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40221214294433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([844, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40540313720703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40540313720703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4062080383300781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4587688446044922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([12589, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5189132690429688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5189132690429688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12589, 128]), torch.Size([1, 12589, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.530919075012207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.384106159210205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12589, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3072004318237305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3276615142822266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3481225967407227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3275012969970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21455, 256])
first layer input nodes number: 70899
first layer output nodes number: 21455
edges number: 169296
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3486528396606445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3691139221191406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3750295639038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3750295639038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([432, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3981294631958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3981294631958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3989534378051758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4055452346801758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([376, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4058561325073242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4058561325073242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4065732955932617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4178600311279297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([263, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.418260097503662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.418260097503662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4187617301940918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.431993007659912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4326457977294922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4326457977294922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4330940246582031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4460926055908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([195, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4468059539794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4468059539794922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4471778869628906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4605674743652344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4612007141113281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4612007141113281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4614715576171875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4731178283691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.473790168762207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.473790168762207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4740190505981445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4854631423950195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([93, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4860639572143555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4860639572143555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.486241340637207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.496352195739746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([92, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4970593452453613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4970593452453613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.49723482131958  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.50846529006958  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5091948509216309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5091948509216309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.50935697555542  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5208678245544434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5215907096862793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5215907096862793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.521735668182373  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5330424308776855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5337657928466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5337657928466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5338973999023438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.545083999633789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([59, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.545755386352539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.545755386352539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.545867919921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5562210083007812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5568780899047852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5568780899047852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5569791793823242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5669870376586914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5673837661743164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5673837661743164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5674428939819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5737104415893555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5741729736328125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5741729736328125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5742340087890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5811309814453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5816235542297363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5816235542297363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5816845893859863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5890088081359863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5894112586975098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5894112586975098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.58945894241333  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5955147743225098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5959844589233398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5959844589233398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5960359573364258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6029367446899414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6033339500427246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6033339500427246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6033759117126465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6092925071716309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609816551208496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609816551208496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609868049621582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6174898147583008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.617802619934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.617802619934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.617833137512207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.622563362121582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6229462623596191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6229462623596191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6229805946350098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.628542423248291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6288251876831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6288251876831055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.628849983215332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.633040428161621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6404528617858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6404528617858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6410422325134277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.751366138458252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7313265800476074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.73175048828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7321743965148926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7317290306091309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21455
output nodes number: 2842
edges number: 23469
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7319107055664062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7319111824035645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04944801330566406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 9 input nodes size: 70818
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04535675048828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04535675048828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07912540435791016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0791468620300293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0453181266784668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04673624038696289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04673624038696289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04673624038696289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70818, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04673624038696289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([829, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1292576789855957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1292576789855957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 829, 128]), torch.Size([1, 829, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13004827499389648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13637304306030273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 829, 128])
m.shape torch.Size([1154, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13707828521728516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13707828521728516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1154, 128]), torch.Size([1, 1154, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13817882537841797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1551675796508789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1154, 128])
m.shape torch.Size([1080, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15616226196289062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15616226196289062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15719223022460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17985153198242188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1156, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18154144287109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18154144287109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1156, 128]), torch.Size([1, 1156, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18264389038085938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2146148681640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1156, 128])
m.shape torch.Size([1098, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21668148040771484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21668148040771484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2177286148071289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25610828399658203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1016, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25849151611328125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25849151611328125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25946044921875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3017158508300781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([974, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30448246002197266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30448246002197266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 974, 128]), torch.Size([1, 974, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30541133880615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35280895233154297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 974, 128])
m.shape torch.Size([874, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3556785583496094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3556785583496094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35651206970214844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.404022216796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([837, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4071974754333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4071974754333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40799570083618164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4594559669494629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([12305, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5177316665649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5177316665649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12305, 128]), torch.Size([1, 12305, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5294666290283203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3626489639282227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12305, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2864656448364258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3068008422851562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3271360397338867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3066415786743164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21323, 256])
first layer input nodes number: 70818
first layer output nodes number: 21323
edges number: 166980
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3276658058166504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3480010032653809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3537874221801758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3537874221801758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([404, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3765888214111328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3765888214111328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.377359390258789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3842830657958984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([375, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3846187591552734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3846187591552734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3853340148925781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3977751731872559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([265, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3981819152832031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3981819152832031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3986873626708984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4145584106445312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([217, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.415140151977539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.415140151977539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4155540466308594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4275569915771484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.428330421447754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.428330421447754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4287195205688477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4427270889282227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4434151649475098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4434151649475098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.44370698928833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4562554359436035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([120, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4569172859191895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4569172859191895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.457146167755127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.468590259552002  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([123, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4694218635559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4694218635559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4696564674377441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4830288887023926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.483750820159912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.483750820159912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.483935832977295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.495776653289795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([85, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4965014457702637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4965014457702637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4966635704040527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5081744194030762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([86, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509002685546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509002685546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5091667175292969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5219612121582031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5225715637207031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5225715637207031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5226860046386719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5324134826660156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5332560539245605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5332560539245605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.533393383026123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.546027660369873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5465645790100098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5465645790100098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5466504096984863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555147647857666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5557971000671387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5557971000671387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5558886528015137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5655932426452637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.56610107421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.56610107421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5661697387695312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5739288330078125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5743684768676758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5743684768676758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5744237899780273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5810613632202148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5815529823303223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5815529823303223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5816102027893066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5888772010803223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5892505645751953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5892505645751953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5892925262451172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5949153900146484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5954904556274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5954904556274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5955495834350586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.603886604309082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6044425964355469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6044425964355469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6044979095458984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6126842498779297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6130585670471191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6130585670471191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6130948066711426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6187119483947754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.619025707244873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.619025707244873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6190543174743652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6236891746520996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6239519119262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6239519119262695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6239748001098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.627842903137207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([265, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6341991424560547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6341991424560547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.63470458984375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.746534824371338  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 265, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7268071174621582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7272310256958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7276549339294434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7272095680236816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21323
output nodes number: 2842
edges number: 23186
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7273902893066406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7273907661437988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049365997314453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 10 input nodes size: 71008
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0453181266784668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0453181266784668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0791773796081543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07919883728027344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04540872573852539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046831607818603516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046831607818603516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046831607818603516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71008, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046831607818603516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([824, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12935304641723633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12935304641723633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13013887405395508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13642549514770508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([1089, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1370711326599121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1370711326599121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13810968399047852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1536879539489746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1142, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1548023223876953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1548023223876953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15589141845703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18032360076904297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1142, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18195724487304688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18195724487304688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1142, 128]), torch.Size([1, 1142, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1830463409423828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.214630126953125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1142, 128])
m.shape torch.Size([1149, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21682500839233398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21682500839233398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21792078018188477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2573685646057129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1008, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25970458984375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25970458984375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1008, 128]), torch.Size([1, 1008, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2606658935546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3025665283203125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1008, 128])
m.shape torch.Size([909, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30511999130249023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30511999130249023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 909, 128]), torch.Size([1, 909, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3059868812561035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3497910499572754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 909, 128])
m.shape torch.Size([868, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35266876220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35266876220703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3534965515136719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40148019790649414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([799, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4044952392578125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4044952392578125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 799, 128]), torch.Size([1, 799, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4052572250366211  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.45494556427001953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 799, 128])
m.shape torch.Size([12422, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5137972831726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5137972831726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12422, 128]), torch.Size([1, 12422, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5256438255310059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.366748332977295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12422, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2905244827270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.310887336730957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3312501907348633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3107280731201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21352, 256])
first layer input nodes number: 71008
first layer output nodes number: 21352
edges number: 167507
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3317813873291016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3521442413330078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3574285507202148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3574285507202148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([399, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3803977966308594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3803977966308594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3811588287353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3877735137939453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([369, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3881025314331055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3881025314331055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3888063430786133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4008569717407227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([293, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4013500213623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4013500213623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4019088745117188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4172801971435547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([222, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4178543090820312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4178543090820312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4182777404785156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4305572509765625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([216, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4313950538635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4313950538635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.431807041168213  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.446638584136963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([148, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4472861289978027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4472861289978027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.447568416595459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4597067832946777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4603867530822754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4603867530822754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4606194496154785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4722542762756348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4729299545288086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4729299545288086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4731264114379883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4843244552612305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4850826263427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4850826263427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4852714538574219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4973564147949219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4981369972229004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4981369972229004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4983105659484863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.510633945465088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5111923217773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5111923217773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5113086700439453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5203838348388672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([66, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5210871696472168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5210871696472168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5212130546569824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5319132804870605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5324501991271973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5324501991271973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5325417518615723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5409646034240723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5415782928466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5415782928466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5416717529296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550924301147461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5513968467712402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5513968467712402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5514655113220215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.558743953704834  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.559370994567871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.559370994567871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.559453010559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.568720817565918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5692520141601562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5692520141601562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5693187713623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5773296356201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.577711582183838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.577711582183838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5777573585510254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.583570957183838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5839500427246094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5839500427246094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5839920043945312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5896148681640625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5901899337768555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5901899337768555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5902490615844727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.598586082458496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.598940372467041  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.598940372467041  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5989766120910645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6043400764465332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6045546531677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6045546531677246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6045756340026855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6078276634216309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.608259677886963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.608259677886963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6082978248596191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6144776344299316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.615058422088623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.615058422088623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6151080131530762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6234889030456543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([289, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6304082870483398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6304082870483398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6309595108032227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7439470291137695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 289, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.724024772644043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7244486808776855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7248725891113281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7244272232055664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21352
output nodes number: 2842
edges number: 23367
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7246079444885254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7246084213256836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0494685173034668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 11 input nodes size: 69982
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04540872573852539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04540872573852539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07877874374389648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07880020141601562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044919490814208984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04633283615112305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04633283615112305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04633283615112305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([69982, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04633283615112305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([842, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1288456916809082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1288456916809082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 842, 128]), torch.Size([1, 842, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12964868545532227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13607263565063477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 842, 128])
m.shape torch.Size([1051, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1366734504699707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1366734504699707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13767576217651367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1527104377746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1080, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15389251708984375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15389251708984375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1549224853515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.177581787109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1001, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17897605895996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17897605895996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1001, 128]), torch.Size([1, 1001, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1799306869506836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2080535888671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1001, 128])
m.shape torch.Size([1037, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21004867553710938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21004867553710938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21103763580322266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.24664020538330078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([971, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.24892377853393555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.24892377853393555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.24984979629516602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.28966856002807617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([872, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2921161651611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2921161651611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 872, 128]), torch.Size([1, 872, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29294776916503906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.33474254608154297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 872, 128])
m.shape torch.Size([827, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3374814987182617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3374814987182617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3382701873779297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3844308853149414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([785, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3874053955078125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3874053955078125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 785, 128]), torch.Size([1, 785, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3881540298461914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.43613338470458984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 785, 128])
m.shape torch.Size([12554, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4963059425354004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4963059425354004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12554, 128]), torch.Size([1, 12554, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5082783699035645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.358320713043213  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12554, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2818794250488281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3019256591796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3219718933105469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3017687797546387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21020, 256])
first layer input nodes number: 69982
first layer output nodes number: 21020
edges number: 166524
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.322495460510254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3425416946411133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3485279083251953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3485279083251953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([443, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3712749481201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3712749481201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3721199035644531  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3788909912109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([380, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3791990280151367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3791990280151367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3799238204956055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3914241790771484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3919272422790527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3919272422790527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3924994468688965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4073877334594727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([225, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4079670906066895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4079670906066895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4083962440490723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4208416938781738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([187, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4215259552001953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4215259552001953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4218826293945312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.434722900390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([154, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4354329109191895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4354329109191895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4357266426086426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.448357105255127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([114, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4489774703979492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4489774703979492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4491949081420898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.460066795349121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([95, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.460688591003418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.460688591003418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4608697891235352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4711980819702148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([76, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4717650413513184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4717650413513184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.471909999847412  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.481187343597412  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4819512367248535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4819512367248535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4821171760559082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.493898868560791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([72, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.494577407836914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.494577407836914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4947147369384766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5054264068603516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5059809684753418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5059809684753418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5060839653015137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.514838695526123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5154247283935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5154247283935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5155220031738281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5244712829589844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.52492094039917  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.52492094039917  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.524991512298584  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5319781303405762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5325918197631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5325918197631836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5326776504516602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5417757034301758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5422863960266113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5422863960266113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5423550605773926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5501141548156738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550602912902832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550602912902832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550663948059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.557988166809082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5584769248962402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5584769248962402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5585341453552246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5658011436462402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5661377906799316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5661377906799316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.566175937652588  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5712876319885254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5717687606811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5717687606811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5718183517456055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.578810691833496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5791492462158203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5791492462158203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.579183578491211  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5842647552490234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5847129821777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5847129821777344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5847549438476562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5912590026855469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5916361808776855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5916361808776855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5916705131530762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5972323417663574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5975151062011719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5975151062011719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5975399017333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6017303466796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([307, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6090946197509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6090946197509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.60968017578125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7203960418701172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 307, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.700718879699707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7011427879333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7015666961669922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7011213302612305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21020
output nodes number: 2842
edges number: 23093
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7012996673583984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7013001441955566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04894399642944336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 12 input nodes size: 71260
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044919490814208984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044919490814208984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07889890670776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07892036437988281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04552888870239258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04697370529174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04697370529174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04697370529174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71260, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04697370529174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([780, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1314544677734375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1314544677734375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 780, 128]), torch.Size([1, 780, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13219833374023438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13814926147460938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 780, 128])
m.shape torch.Size([1052, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1387805938720703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1387805938720703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1052, 128]), torch.Size([1, 1052, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1397838592529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1548328399658203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1052, 128])
m.shape torch.Size([1114, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1563568115234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1563568115234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15741920471191406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1812000274658203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([1074, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18271732330322266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18271732330322266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1074, 128]), torch.Size([1, 1074, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18374156951904297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21344470977783203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1074, 128])
m.shape torch.Size([1099, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21555280685424805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21555280685424805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21660089492797852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25533008575439453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([980, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25760984420776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25760984420776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 980, 128]), torch.Size([1, 980, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2585444450378418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29957151412963867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 980, 128])
m.shape torch.Size([904, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.302121639251709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.302121639251709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 904, 128]), torch.Size([1, 904, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30298376083374023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34736013412475586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 904, 128])
m.shape torch.Size([867, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3502364158630371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3502364158630371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 867, 128]), torch.Size([1, 867, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35106325149536133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3981928825378418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 867, 128])
m.shape torch.Size([795, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40119123458862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40119123458862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.401949405670166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.450472354888916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([12799, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5111236572265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5111236572265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12799, 128]), torch.Size([1, 12799, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5233297348022461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3901634216308594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12799, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3118562698364258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3323259353637695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3527956008911133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3321657180786133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21464, 256])
first layer input nodes number: 71260
first layer output nodes number: 21464
edges number: 170306
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3533287048339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3737983703613281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.379417896270752  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.379417896270752  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([423, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4024982452392578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4024982452392578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4033050537109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.409759521484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([360, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.410048484802246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.410048484802246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4107351303100586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4217114448547363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([278, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4221701622009277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4221701622009277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4227004051208496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4351716041564941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([232, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4357986450195312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4357986450195312  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4362411499023438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4490737915039062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4498233795166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4498233795166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4502086639404297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4640789031982422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([142, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.464705467224121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.464705467224121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4649763107299805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4766225814819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([133, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4773821830749512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4773821830749512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4776358604431152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4903197288513184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.491015911102295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.491015911102295  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4912199974060059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5028529167175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5035643577575684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5035643577575684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5037436485290527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5152182579040527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5160226821899414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5160226821899414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.516200065612793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.528794288635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.529435157775879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.529435157775879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.529566764831543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5398321151733398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([55, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5404009819030762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5404009819030762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5405058860778809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5494227409362793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([48, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5499701499938965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5499701499938965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5500617027282715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5584845542907715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5590310096740723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5590310096740723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.559114933013916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5674233436584473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5678143501281738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5678143501281738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5678715705871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.573936939239502  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5743699073791504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5743699073791504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5744271278381348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5808930397033691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5814528465270996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5814528465270996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5815215110778809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5897612571716309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5902462005615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5902462005615234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5903034210205078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5975704193115234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5980896949768066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5980896949768066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.598146915435791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6058144569396973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6063437461853027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6063437461853027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6063990592956543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6141982078552246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6146149635314941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6146149635314941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614656925201416  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6208672523498535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6212058067321777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6212058067321777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6212382316589355  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6262640953063965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6266016960144043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6266016960144043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6266322135925293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6315760612487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6319761276245117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6319761276245117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6320104598999023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.637812614440918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([304, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6451773643493652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6451773643493652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6457571983337402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.751171588897705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7311477661132812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7315716743469238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7319955825805664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7315502166748047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21464
output nodes number: 2842
edges number: 23457
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.73173189163208  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7317323684692383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04963827133178711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 13 input nodes size: 70727
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04552888870239258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04552888870239258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.079254150390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07927560806274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04527473449707031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046703338623046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046703338623046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046703338623046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70727, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046703338623046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([837, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12926292419433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12926292419433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 837, 128]), torch.Size([1, 837, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13006114959716797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13677120208740234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 837, 128])
m.shape torch.Size([1062, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13738489151000977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13738489151000977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1383976936340332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15358972549438477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([1079, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15462684631347656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15462684631347656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1556558609008789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17829418182373047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1098, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17987394332885742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17987394332885742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18092107772827148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21197080612182617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([1022, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2138838768005371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2138838768005371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2148585319519043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25090456008911133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([944, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25311803817749023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25311803817749023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25401830673217773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29320669174194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([917, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29581737518310547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29581737518310547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 917, 128]), torch.Size([1, 917, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29669189453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34143877029418945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 917, 128])
m.shape torch.Size([877, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3443470001220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3443470001220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 877, 128]), torch.Size([1, 877, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3451833724975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3928565979003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 877, 128])
m.shape torch.Size([795, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39585018157958984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39585018157958984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3966083526611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.44542694091796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([12605, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5055947303771973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5055947303771973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12605, 128]), torch.Size([1, 12605, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.517615795135498  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3719377517700195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2955408096313477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3157930374145508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.336045265197754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3156347274780273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21236, 256])
first layer input nodes number: 70727
first layer output nodes number: 21236
edges number: 168004
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3365745544433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3568267822265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.362837314605713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.362837314605713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([436, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.386998176574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.386998176574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3878297805786133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3944826126098633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([371, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.394780158996582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.394780158996582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3954877853393555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4065961837768555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([278, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4070444107055664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4070444107055664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4075746536254883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4216012954711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([235, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4222397804260254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4222397804260254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4226880073547363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4356865882873535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([169, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4362750053405762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4362750053405762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4365973472595215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4482016563415527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([164, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.448986530303955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.448986530303955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4492993354797363  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.46274995803833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4634685516357422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4634685516357422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4637165069580078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.476114273071289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([87, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4766592979431152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4766592979431152  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.47682523727417  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.486283779144287  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([96, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4870314598083496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4870314598083496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4872145652770996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4989333152770996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4995145797729492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4995145797729492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.499648094177246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5091276168823242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5096850395202637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5096850395202637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5097975730895996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5185751914978027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([67, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.519291877746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.519291877746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5194196701049805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5302820205688477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5307931900024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5307931900024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5308809280395508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5389528274536133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([51, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.539595603942871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.539595603942871  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5396928787231445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5493230819702148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.54986572265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.54986572265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5499439239501953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5582332611083984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5588555335998535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5588555335998535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5589375495910645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5682053565979004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5686545372009277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5686545372009277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.568711757659912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.575578212738037  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5760517120361328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5760517120361328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5761070251464844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5831317901611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.583615779876709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.583615779876709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5836691856384277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5908255577087402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591221809387207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591221809387207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591263771057129  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5971803665161133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5975227355957031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5975227355957031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5975570678710938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6026382446289062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6030864715576172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6030864715576172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.603128433227539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6096324920654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6099433898925781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6099433898925781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6099720001220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6146068572998047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6149158477783203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6149158477783203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6149425506591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.619455337524414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([321, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6279072761535645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6279072761535645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6285195350646973  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7426371574401855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 321, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7215299606323242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7219538688659668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7223777770996094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7219324111938477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21236
output nodes number: 2842
edges number: 23591
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7221121788024902  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7221126556396484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049343109130859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 14 input nodes size: 70332
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04527473449707031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04527473449707031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0788116455078125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07883310317993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04508638381958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04649209976196289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04649209976196289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04649209976196289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70332, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04649209976196289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([812, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1278529167175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1278529167175293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 812, 128]), torch.Size([1, 812, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12862730026245117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13482236862182617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 812, 128])
m.shape torch.Size([1051, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13556766510009766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13556766510009766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13656997680664062  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15160465240478516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([1127, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15271568298339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15271568298339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1127, 128]), torch.Size([1, 1127, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15379047393798828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17762088775634766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1127, 128])
m.shape torch.Size([1099, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17917966842651367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17917966842651367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18022775650024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2112879753112793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([1110, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2134103775024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2134103775024414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1110, 128]), torch.Size([1, 1110, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21446895599365234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2530860900878906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1110, 128])
m.shape torch.Size([1054, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2555723190307617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2555723190307617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2565774917602539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3000192642211914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([938, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30264759063720703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30264759063720703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 938, 128]), torch.Size([1, 938, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3035421371459961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3482694625854492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 938, 128])
m.shape torch.Size([868, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3511333465576172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3511333465576172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 868, 128]), torch.Size([1, 868, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3519611358642578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39966392517089844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 868, 128])
m.shape torch.Size([834, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4028291702270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4028291702270508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 834, 128]), torch.Size([1, 834, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4036245346069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4550647735595703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 834, 128])
m.shape torch.Size([12198, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5132608413696289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5132608413696289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12198, 128]), torch.Size([1, 12198, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5248937606811523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3559808731079102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12198, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2808752059936523  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3009891510009766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3211030960083008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3008317947387695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21091, 256])
first layer input nodes number: 70332
first layer output nodes number: 21091
edges number: 165561
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3216290473937988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.341742992401123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3470196723937988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3470196723937988  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([441, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.36968994140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.36968994140625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3705310821533203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3784589767456055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([354, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3787193298339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3787193298339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.37939453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3919124603271484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([258, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3923192024230957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3923192024230957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3928112983703613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4045648574829102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([223, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4051761627197266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4051761627197266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4056015014648438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4179363250732422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([190, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4186367988586426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4186367988586426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.418999195098877  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4320454597473145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([196, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4329948425292969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4329948425292969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4333686828613281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4494438171386719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([141, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4502058029174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4502058029174805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.450474739074707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4639215469360352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([119, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4647021293640137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4647021293640137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4649291038513184  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4778666496276855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4784541130065918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4784541130065918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4786086082458496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4884963035583496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4891114234924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4891114234924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4892487525939941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4989991188049316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4995651245117188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4995651245117188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4996795654296875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.50860595703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([44, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509056568145752  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509056568145752  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5091404914855957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5162739753723145  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5171070098876953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5171070098876953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5172405242919922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5295238494873047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5301570892333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5301570892333984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5302562713623047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5400753021240234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([43, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5406460762023926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5406460762023926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5407280921936035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549421787261963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549872875213623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549872875213623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549933910369873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.556830883026123  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([44, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5575194358825684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5575194358825684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.557603359222412  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.567674160003662  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5680131912231445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5680131912231445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5680551528930664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5733842849731445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5738568305969238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5738568305969238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5739083290100098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5808091163635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5812063217163086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5812063217163086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5812482833862305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5871648788452148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5874066352844238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5874066352844238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5874314308166504  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5911011695861816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5915331840515137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5915331840515137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5915732383728027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5977816581726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5981817245483398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5981817245483398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5982179641723633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6040887832641602  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6044859886169434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6044859886169434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.604520320892334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6103224754333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([280, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6170334815979004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6170334815979004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.617567539215088  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7144875526428223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6949100494384766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6953339576721191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6957578659057617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6953125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21091
output nodes number: 2842
edges number: 23013
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6954913139343262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6954917907714844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04909801483154297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 15 input nodes size: 69683
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04508638381958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04508638381958008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07831382751464844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07833528518676758  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04477691650390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([69683, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046173095703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12697219848632812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12697219848632812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12773704528808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1340022087097168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([1124, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13469171524047852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13469171524047852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13576364517211914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15184259414672852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1119, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15384340286254883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15384340286254883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1119, 128]), torch.Size([1, 1119, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15491056442260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1787104606628418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1119, 128])
m.shape torch.Size([1125, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18032264709472656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18032264709472656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1813955307006836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21272850036621094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1070, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21474313735961914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21474313735961914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21576356887817383  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2527327537536621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([989, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2550520896911621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2550520896911621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 989, 128]), torch.Size([1, 989, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2559952735900879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29721975326538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 989, 128])
m.shape torch.Size([931, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29985570907592773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29985570907592773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30074357986450195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34535789489746094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([838, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3481106758117676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3481106758117676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 838, 128]), torch.Size([1, 838, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.348909854888916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3949894905090332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 838, 128])
m.shape torch.Size([791, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39798450469970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39798450469970703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 791, 128]), torch.Size([1, 791, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3987388610839844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.44752931594848633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 791, 128])
m.shape torch.Size([12189, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5057458877563477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5057458877563477  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12189, 128]), torch.Size([1, 12189, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5173702239990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.348362922668457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12189, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2737536430358887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.293759822845459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3137660026550293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2936034202575684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([20978, 256])
first layer input nodes number: 69683
first layer output nodes number: 20978
edges number: 164421
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3142871856689453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3342933654785156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.339653491973877  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.339653491973877  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([420, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3621325492858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3621325492858887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.36293363571167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3708200454711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([352, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.371096134185791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.371096134185791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.371767520904541  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.38493013381958  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([308, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3854827880859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3854827880859375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3860702514648438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3996906280517578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([243, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4003314971923828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4003314971923828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4007949829101562  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.414236068725586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.414879322052002  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.414879322052002  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4152264595031738  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4277234077453613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([152, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.428426742553711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.428426742553711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4287166595458984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.441183090209961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4418725967407227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4418725967407227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4421091079711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.453934669494629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4546699523925781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4546699523925781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4548816680908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.466949462890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4677696228027344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4677696228027344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4679737091064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4810352325439453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([84, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.481740951538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.481740951538086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4819011688232422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.493276596069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.493873119354248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.493873119354248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.493995189666748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.503516674041748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.504274845123291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.504274845123291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5044102668762207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5159211158752441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5165281295776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5165281295776367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5166311264038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.526106834411621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5266070365905762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5266070365905762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5266852378845215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5344271659851074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534907341003418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534907341003418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5349760055541992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5422544479370117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5428047180175781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5428047180175781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.542877197265625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5510673522949219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5514888763427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5514888763427734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5515422821044922  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5579509735107422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5584087371826172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5584087371826172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.558462142944336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5652446746826172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5656747817993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5656747817993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5657224655151367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5721120834350586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5726265907287598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5726265907287598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5726799964904785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5802102088928223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5807490348815918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5807490348815918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5808024406433105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5887064933776855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5890393257141113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5890393257141113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5890717506408691  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.59409761428833  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5943913459777832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5943913459777832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5944180488586426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5987439155578613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5991458892822266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5991458892822266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5991802215576172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6049823760986328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([269, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.611429214477539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.611429214477539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6119422912597656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7033390998840332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 269, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6848196983337402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6852436065673828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6856675148010254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6852221488952637  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 20978
output nodes number: 2842
edges number: 22837
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6854000091552734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6854004859924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04876089096069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 16 input nodes size: 70256
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04477691650390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04477691650390625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.078277587890625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07829904556274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04505014419555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046452999114990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046452999114990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046452999114990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70256, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046452999114990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([849, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12767887115478516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12767887115478516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 849, 128]), torch.Size([1, 849, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12848854064941406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1349658966064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 849, 128])
m.shape torch.Size([1061, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13584423065185547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13584423065185547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1368560791015625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15203380584716797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([1141, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15405893325805664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15405893325805664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15514707565307617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17908620834350586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1126, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18068981170654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18068981170654297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1817636489868164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21307849884033203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1100, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2151641845703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2151641845703125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21621322631835938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2546501159667969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([978, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2569236755371094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2569236755371094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 978, 128]), torch.Size([1, 978, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2578563690185547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2989482879638672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 978, 128])
m.shape torch.Size([905, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30150270462036133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30150270462036133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.302365779876709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3467597961425781  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([897, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3497500419616699  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3497500419616699  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35060548782348633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4007430076599121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40375709533691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40375709533691406  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4045219421386719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4534721374511719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12225, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.511683464050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.511683464050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12225, 128]), torch.Size([1, 12225, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5233421325683594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3552260398864746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12225, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2802538871765137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.300361156463623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3204684257507324  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.300203800201416  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21084, 256])
first layer input nodes number: 70256
first layer output nodes number: 21084
edges number: 165245
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3209939002990723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3411011695861816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3463845252990723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3463845252990723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([457, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3690762519836426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3690762519836426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.369947910308838  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3778209686279297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([349, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3780560493469238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3780560493469238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3787217140197754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3913211822509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3918018341064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3918018341064453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3923397064208984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4053306579589844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([220, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4059076309204102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4059076309204102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.406327247619629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4184961318969727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4192476272583008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4192476272583008  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4196290969848633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4333620071411133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([153, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.434053897857666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.434053897857666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4343457221984863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4468941688537598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([129, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4476165771484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4476165771484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4478626251220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.460165023803711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4609265327453613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4609265327453613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4611458778381348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4736485481262207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4742741584777832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4742741584777832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4744362831115723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4848122596740723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4854040145874023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4854040145874023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4855375289916992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4950170516967773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([84, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4958386421203613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4958386421203613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4959988594055176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.508495807647705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5090270042419434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5090270042419434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5091280937194824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5177206993103027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5182576179504395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5182576179504395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5183472633361816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.526594638824463  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.52714204788208  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.52714204788208  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5272259712219238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.535534381866455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.536170482635498  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.536170482635498  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5362601280212402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.545762538909912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5463485717773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5463485717773438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.546426773071289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5552635192871094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555600643157959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555600643157959  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5556445121765137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5609087944030762  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5614233016967773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5614233016967773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5614824295043945  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5689916610717773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5695648193359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5695648193359375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5696277618408203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5780620574951172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5783381462097168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5783381462097168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5783686637878418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5826716423034668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5830802917480469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5830802917480469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.583120346069336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5890483856201172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5893878936767578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5893878936767578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5894203186035156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5944461822509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5948500633239746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5948500633239746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.594886302947998  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.600757122039795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6010851860046387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6010851860046387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6011137962341309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6059489250183105  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.612926959991455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.612926959991455  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6134819984436035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7135953903198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6940016746520996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6944255828857422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6948494911193848  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.694404125213623  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21084
output nodes number: 2842
edges number: 23018
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6945829391479492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6945834159851074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04905557632446289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 17 input nodes size: 71304
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04505014419555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04505014419555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07905054092407227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0790719985961914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045549869537353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04698896408081055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04698896408081055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04698896408081055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71304, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04698896408081055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([824, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13038110733032227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13038110733032227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 824, 128]), torch.Size([1, 824, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13116693496704102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13745355606079102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 824, 128])
m.shape torch.Size([1124, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1381692886352539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1381692886352539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1124, 128]), torch.Size([1, 1124, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13924121856689453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1553201675415039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1124, 128])
m.shape torch.Size([1174, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1567373275756836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1567373275756836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1174, 128]), torch.Size([1, 1174, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15785694122314453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18248844146728516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1174, 128])
m.shape torch.Size([1133, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18408966064453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18408966064453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1133, 128]), torch.Size([1, 1133, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18517017364501953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2165088653564453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1133, 128])
m.shape torch.Size([1048, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21846723556518555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21846723556518555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2194666862487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2556777000427246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([992, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25801610946655273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25801610946655273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 992, 128]), torch.Size([1, 992, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25896215438842773  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30025243759155273  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 992, 128])
m.shape torch.Size([937, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30290699005126953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30290699005126953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 937, 128]), torch.Size([1, 937, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3038005828857422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34848451614379883  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 937, 128])
m.shape torch.Size([910, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35150909423828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35150909423828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 910, 128]), torch.Size([1, 910, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35237693786621094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4024639129638672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 910, 128])
m.shape torch.Size([850, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40594005584716797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40594005584716797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 850, 128]), torch.Size([1, 850, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4067506790161133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.45882129669189453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 850, 128])
m.shape torch.Size([12590, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5189628601074219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5189628601074219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12590, 128]), torch.Size([1, 12590, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5309696197509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3840293884277344  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12590, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3069853782653809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3275675773620605  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3481497764587402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.327406406402588  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21582, 256])
first layer input nodes number: 71304
first layer output nodes number: 21582
edges number: 169707
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3486833572387695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3692655563354492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3744111061096191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3744111061096191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([409, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3973278999328613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3973278999328613  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3981080055236816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4044060707092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([373, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4047331809997559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4047331809997559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.405444622039795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.41670560836792  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([277, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4171485900878906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4171485900878906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4176769256591797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.431717872619629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([240, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4323763847351074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4323763847351074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4328341484069824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4461092948913574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([202, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4468512535095215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4468512535095215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4472365379333496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.461106777191162  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4617562294006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4617562294006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4620347023010254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4740090370178223  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([124, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4747042655944824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4747042655944824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4749407768249512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4867663383483887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([91, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4873480796813965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4873480796813965  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4875216484069824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4974150657653809  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.498176097869873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.498176097869873  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4983630180358887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5103259086608887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([82, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5110206604003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5110206604003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5111770629882812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5222816467285156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([69, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.522933006286621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.522933006286621  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5230646133422852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.533329963684082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534060001373291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534060001373291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534191608428955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5453782081604004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([62, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5460872650146484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5460872650146484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5462055206298828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5570850372314453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5576720237731934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5576720237731934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5577635765075684  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5668272972106934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5673294067382812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5673294067382812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5674018859863281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5750846862792969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5756020545959473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5756020545959473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5756707191467285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5834298133850098  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5840492248535156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5840492248535156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5841255187988281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5932807922363281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.593761920928955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.593761920928955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5938191413879395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.601086139678955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6014595031738281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6014595031738281  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.60150146484375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6071243286132812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6075458526611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6075458526611328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6075897216796875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6137752532958984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614358901977539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614358901977539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6144161224365234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.622884750366211  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.623131275177002  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.623131275177002  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6231560707092285  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6269993782043457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.627429485321045  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.627429485321045  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6274676322937012  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6336474418640137  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6339516639709473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6339516639709473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6339783668518066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.638491153717041  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6453499794006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6453499794006348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6458954811096191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7497272491455078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7298698425292969  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7302937507629395  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.730717658996582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7302722930908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 21582
output nodes number: 2842
edges number: 23301
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.730454921722412  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7304553985595703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04965019226074219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 18 input nodes size: 69492
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045549869537353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045549869537353516  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07875299453735352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07877445220947266  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04613637924194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04613637924194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04613637924194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([69492, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04613637924194336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([840, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12665510177612305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12665510177612305  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1274561882019043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1338648796081543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([1059, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1344742774963379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1344742774963379  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1354842185974121  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1506333351135254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([1113, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15172386169433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15172386169433594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1527853012084961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17656230926513672  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1091, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17811250686645508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17811250686645508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1091, 128]), torch.Size([1, 1091, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1791529655456543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2101292610168457  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1091, 128])
m.shape torch.Size([1054, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21212196350097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21212196350097656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21312713623046875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.24996662139892578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([891, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2520132064819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2520132064819336  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 891, 128]), torch.Size([1, 891, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25286293029785156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2902383804321289  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 891, 128])
m.shape torch.Size([894, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2927975654602051  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2927975654602051  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 894, 128]), torch.Size([1, 894, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29365015029907227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3370537757873535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 894, 128])
m.shape torch.Size([876, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3399691581726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3399691581726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 876, 128]), torch.Size([1, 876, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3408045768737793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.38842344284057617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 876, 128])
m.shape torch.Size([817, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3915119171142578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3915119171142578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3922910690307617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.44298839569091797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([12099, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.501192569732666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.501192569732666  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12099, 128]), torch.Size([1, 12099, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5127310752868652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3427796363830566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12099, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2683792114257812  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2881526947021484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3079261779785156  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2879981994628906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([20734, 256])
first layer input nodes number: 69492
first layer output nodes number: 20734
edges number: 162886
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.308445930480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3282194137573242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.333836555480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.333836555480957  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([439, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3562307357788086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3562307357788086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3570680618286133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3654131889343262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([385, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3657350540161133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3657350540161133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.366469383239746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.381424903869629  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([300, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3819231986999512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3819231986999512  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.382495403289795  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3960189819335938  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3965482711791992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3965482711791992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3969526290893555  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4086790084838867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([204, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4094572067260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4094572067260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.409846305847168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.423853874206543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([135, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4244379997253418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4244379997253418  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4246954917907715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.435767650604248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([130, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.436513900756836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.436513900756836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4367618560791016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4491596221923828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([100, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4498047828674316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4498047828674316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.449995517730713  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4608674049377441  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([77, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4614381790161133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4614381790161133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4615850448608398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4709844589233398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([93, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4718050956726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4718050956726074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.471982479095459  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.48457670211792  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4851436614990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4851436614990234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4852619171142578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.494485855102539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4952459335327148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4952459335327148  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4953813552856445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.506892204284668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5074496269226074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5074496269226074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.507544994354248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5163187980651855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5169978141784668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5169978141784668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5171008110046387  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5272974967956543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5278229713439941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5278229713439941  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5278992652893066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5359864234924316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5363483428955078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5363483428955078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.536397933959961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.542001724243164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5425162315368652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5425162315368652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.542579174041748  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5501322746276855  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550602912902832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.550602912902832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5506582260131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.557682991027832  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5582399368286133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5582399368286133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5583009719848633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5664796829223633  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5669493675231934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5669493675231934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5669989585876465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.573991298675537  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.574249267578125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.574249267578125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5742759704589844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5782279968261719  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5785531997680664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5785531997680664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5785837173461914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5833139419555664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5837411880493164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5837411880493164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5837793350219727  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5899591445922852  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5903325080871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5903325080871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.590364933013916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5958447456359863  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([277, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6024847030639648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6024847030639648  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.603013038635254  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6997370719909668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 277, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6804347038269043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6808586120605469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6812825202941895  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6808371543884277  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 20734
output nodes number: 2842
edges number: 22726
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6810131072998047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.681013584136963  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.048703670501708984  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 19 input nodes size: 70012
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07813692092895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07815837860107422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04493379592895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04633474349975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04633474349975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04633474349975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([70012, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04633474349975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([814, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12741422653198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12741422653198242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 814, 128]), torch.Size([1, 814, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1281905174255371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1344008445739746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 814, 128])
m.shape torch.Size([1044, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13541793823242188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13541793823242188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1044, 128]), torch.Size([1, 1044, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13641357421875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15134811401367188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1044, 128])
m.shape torch.Size([1102, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15242671966552734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15242671966552734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1102, 128]), torch.Size([1, 1102, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15347766876220703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17721271514892578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1102, 128])
m.shape torch.Size([1152, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17888450622558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17888450622558594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17998313903808594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21184349060058594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1104, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2139263153076172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2139263153076172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2149791717529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2534618377685547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([953, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2556619644165039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2556619644165039  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25657081604003906  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29578685760498047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([900, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2983365058898926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2983365058898926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 900, 128]), torch.Size([1, 900, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2991948127746582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3435330390930176  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 900, 128])
m.shape torch.Size([855, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34636545181274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34636545181274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 855, 128]), torch.Size([1, 855, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3471808433532715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39372873306274414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 855, 128])
m.shape torch.Size([765, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.396604061126709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.396604061126709  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 765, 128]), torch.Size([1, 765, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39733362197875977  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4451770782470703  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 765, 128])
m.shape torch.Size([12291, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.503420352935791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.503420352935791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12291, 128]), torch.Size([1, 12291, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5151419639587402  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3473763465881348  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12291, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2724485397338867  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2924566268920898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.312464714050293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2923002243041992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([20980, 256])
first layer input nodes number: 70012
first layer output nodes number: 20980
edges number: 164989
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.31298828125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3329963684082031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3388428688049316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3388428688049316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([414, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3614630699157715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3614630699157715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3622527122497559  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3694844245910645  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3697876930236816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3697876930236816  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3704800605773926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3838105201721191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3842778205871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3842778205871582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3848156929016113  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4017682075500488  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([258, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4034547805786133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4034547805786133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.403946876525879  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4297776222229004  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([196, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.430473804473877  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.430473804473877  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4308476448059082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4443058967590332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([136, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4449033737182617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4449033737182617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4451627731323242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4563169479370117  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.457108974456787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.457108974456787  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4573702812194824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.470435619354248  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([98, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4710588455200195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4710588455200195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4712457656860352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4819002151489258  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([106, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4827237129211426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4827237129211426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4829258918762207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4958653450012207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([88, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.496610164642334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.496610164642334  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4967780113220215  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.508695125579834  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5093517303466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5093517303466797  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5094852447509766  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5198993682861328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5204901695251465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5204901695251465  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5205988883972168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5298399925231934  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5303354263305664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5303354263305664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5304193496704102  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5381402969360352  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5386638641357422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5386638641357422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5387439727783203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5466747283935547  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5473990440368652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5473990440368652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5475001335144043  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.558215618133545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5586881637573242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5586881637573242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5587530136108398  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5660810470581055  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5664901733398438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5664901733398438  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5665416717529297  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5727214813232422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5734400749206543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5734400749206543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5735220909118652  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5839381217956543  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5843720436096191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5843720436096191  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5844216346740723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591066837310791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591484546661377  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591484546661377  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5915284156799316  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5977139472961426  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5980758666992188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5980758666992188  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5981121063232422  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.603475570678711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6037535667419434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6037535667419434  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6037802696228027  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6079192161560059  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6083483695983887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6083483695983887  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.608386516571045  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6145663261413574  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6148242950439453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6148242950439453  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614847183227539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6187152862548828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([280, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.625432014465332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.625432014465332  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6259660720825195  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.728414535522461  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7088613510131836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7092852592468262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7097091674804688  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.709263801574707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([2842, 40])
input nodes number: 20980
output nodes number: 2842
edges number: 22986
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7094416618347168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.709442138671875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04893064498901367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

pseudo mini batch 20 input nodes size: 71587
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04493379592895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04493379592895508  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07906913757324219  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07909059524536133  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045684814453125  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.047156333923339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.047156333923339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.047156333923339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([71587, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.047156333923339844  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([793, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1323862075805664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1323862075805664  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 793, 128]), torch.Size([1, 793, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13314247131347656  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1391925811767578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 793, 128])
m.shape torch.Size([1045, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1400623321533203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1400623321533203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.14105892181396484  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1560077667236328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([1112, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15710020065307617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15710020065307617  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1112, 128]), torch.Size([1, 1112, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15816068649291992  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18193387985229492  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1112, 128])
m.shape torch.Size([1118, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18353605270385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18353605270385742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1846022605895996  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21586179733276367  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1057, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2178487777709961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2178487777709961  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 1057, 128]), torch.Size([1, 1057, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2188568115234375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25556325912475586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 1057, 128])
m.shape torch.Size([991, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25789451599121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25789451599121094  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25883960723876953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3001079559326172  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([930, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30273962020874023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30273962020874023  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 930, 128]), torch.Size([1, 930, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30362653732299805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3482213020324707  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 930, 128])
m.shape torch.Size([874, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35111188888549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35111188888549805  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3519454002380371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4003291130065918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([833, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4034872055053711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4034872055053711  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 833, 128]), torch.Size([1, 833, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4042816162109375  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4560546875  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 833, 128])
m.shape torch.Size([13059, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5181574821472168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5181574821472168  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13059, 128]), torch.Size([1, 13059, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.530611515045166  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4310479164123535  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13059, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.351219654083252  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.372021198272705  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3928227424621582  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3718585968017578  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

torch.Size([21812, 256])
first layer input nodes number: 71587
first layer output nodes number: 21812
edges number: 173511
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3933582305908203  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4141597747802734  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4196481704711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4196481704711914  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

m.shape torch.Size([382, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.443756103515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.443756103515625  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4444847106933594  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4509243965148926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([355, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4512429237365723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4512429237365723  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4519200325012207  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4621987342834473  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([283, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4626765251159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4626765251159668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4632163047790527  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4768128395080566  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([242, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4774737358093262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4774737358093262  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4779353141784668  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.491321086883545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.492051601409912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.492051601409912  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4924330711364746  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5061659812927246  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([158, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5068864822387695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5068864822387695  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.507187843322754  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.520146369934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5208568572998047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5208568572998047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5211009979248047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5333080291748047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5340704917907715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5340704917907715  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534289836883545  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5467925071716309  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([87, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5474357604980469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5474357604980469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5476016998291016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5582218170166016  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.55891752243042  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.55891752243042  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5590720176696777  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5700411796569824  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([68, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5706830024719238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5706830024719238  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.570812702178955  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5809292793273926  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.581533432006836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.581533432006836  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.581644058227539  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5910472869873047  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5916919708251953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5916919708251953  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5917987823486328  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6016254425048828  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.60219144821167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.60219144821167  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6022791862487793  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6109652519226074  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6114983558654785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6114983558654785  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.611574649810791  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.619661808013916  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6201467514038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6201467514038086  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6202116012573242  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6275396347045898  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6281447410583496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6281447410583496  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6282191276550293  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6371455192565918  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.637575626373291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.637575626373291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.637627124786377  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.644167423248291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6446895599365234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6446895599365234  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6447467803955078  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.652414321899414  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.652904987335205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.652904987335205  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.652956485748291  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6602177619934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.660818099975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.660818099975586  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6608772277832031  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6696281433105469  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6700005531311035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6700005531311035  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.670036792755127  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6756539344787598  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6759233474731445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6759233474731445  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.675948143005371  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6799650192260742  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6802759170532227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6802759170532227  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.680302619934082  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6848154067993164  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([309, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6922268867492676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6922268867492676  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6928162574768066  GigaBytes
Max Memory Allocated: 1.7968354225158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7984776496887207  GigaBytes
Max Memory Allocated: 1.805844783782959  GigaBytes

rst.shape  torch.Size([1, 309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7780733108520508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7784972190856934  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.778921127319336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7784757614135742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21812
output nodes number: 2842
edges number: 23914
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7786598205566406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7786602973937988  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049860477447509766  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 21 input nodes size: 70913
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045684814453125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045684814453125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0794987678527832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07952022552490234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045363426208496094  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046814918518066406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046814918518066406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046814918518066406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([70913, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046814918518066406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([828, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1313323974609375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1313323974609375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13212203979492188  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13843917846679688  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([1043, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1390390396118164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1390390396118164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.14003372192382812  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1549539566040039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([1154, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15631914138793945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15631914138793945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1154, 128]), torch.Size([1, 1154, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15741968154907227  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18163156509399414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1154, 128])
m.shape torch.Size([1138, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18325185775756836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18325185775756836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18433713912963867  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21581029891967773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1097, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21788311004638672  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21788311004638672  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1097, 128]), torch.Size([1, 1097, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21892929077148438  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2573356628417969  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1097, 128])
m.shape torch.Size([1023, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25973939895629883  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25973939895629883  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2607150077819824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3031153678894043  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([962, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30583858489990234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30583858489990234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 962, 128]), torch.Size([1, 962, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30675601959228516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35271549224853516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 962, 128])
m.shape torch.Size([929, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3558006286621094  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3558006286621094  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3566865921020508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.407254695892334  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([795, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.41022348403930664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.41022348403930664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4109816551208496  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4607563018798828  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([12715, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5210070610046387  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5210070610046387  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12715, 128]), torch.Size([1, 12715, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5331330299377441  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3946046829223633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12715, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3164381980895996  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3371176719665527  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3577971458435059  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3369560241699219  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21684, 256])
first layer input nodes number: 70913
first layer output nodes number: 21684
edges number: 171022
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.358327865600586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.379007339477539  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3849873542785645  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3849873542785645  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([409, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4091200828552246  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4091200828552246  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.409900188446045  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4164509773254395  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([370, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4167723655700684  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4167723655700684  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.417478084564209  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4283747673034668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([288, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4288525581359863  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4288525581359863  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4294018745422363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.441847324371338  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([237, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.442483901977539  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.442483901977539  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4429359436035156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.456045150756836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([182, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4566941261291504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4566941261291504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4570412635803223  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4695382118225098  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([130, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4701147079467773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4701147079467773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.470362663269043  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4810247421264648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4817485809326172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4817485809326172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4819889068603516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4940052032470703  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([115, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.49476957321167  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.49476957321167  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4949889183044434  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5074915885925293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([107, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.508307933807373  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.508307933807373  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.508512020111084  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.521573543548584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([77, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.522212028503418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.522212028503418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5223588943481445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5327863693237305  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.533421516418457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.533421516418457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5335493087768555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5435171127319336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5441222190856934  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5441222190856934  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5442328453063965  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.553636074066162  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5542058944702148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5542058944702148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5543012619018555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.563075065612793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.563673496246338  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.563673496246338  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.563765048980713  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.572828769683838  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5733885765075684  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5733885765075684  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5734686851501465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5819602012634277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5825352668762207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5825352668762207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5826115608215332  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5912327766418457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5917339324951172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5917339324951172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591796875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5993499755859375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5999069213867188  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5999069213867188  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5999717712402344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6082077026367188  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6087231636047363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6087231636047363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6087803840637207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.616447925567627  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6167654991149902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6167654991149902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6167998313903809  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.621640682220459  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.622107982635498  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.622107982635498  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6221537590026855  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6289286613464355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.629350185394287  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.629350185394287  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6293902397155762  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6355986595153809  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6359548568725586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6359548568725586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6359872817993164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.641240119934082  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6415472030639648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6415472030639648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6415739059448242  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6460866928100586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([305, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6535358428955078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6535358428955078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6541175842285156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7605648040771484  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 305, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7394752502441406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7398991584777832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7403230667114258  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.739877700805664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21684
output nodes number: 2842
edges number: 23632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.740060806274414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7400612831115723  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049489498138427734  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 22 input nodes size: 68936
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045363426208496094  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045363426208496094  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0785665512084961  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07858800888061523  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0461125373840332  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0461125373840332  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0461125373840332  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([68936, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0461125373840332  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([802, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1249246597290039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1249246597290039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12568950653076172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1319422721862793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([1115, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13262319564819336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13262319564819336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1115, 128]), torch.Size([1, 1115, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13368654251098633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.14963674545288086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1115, 128])
m.shape torch.Size([1104, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15068435668945312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15068435668945312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15173721313476562  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17547988891601562  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1069, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17699241638183594  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17699241638183594  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17801189422607422  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.20757675170898438  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([1098, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2096848487854004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2096848487854004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21073198318481445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.24949216842651367  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([931, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2516322135925293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2516322135925293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2525200843811035  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29094743728637695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([905, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29352426528930664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29352426528930664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 905, 128]), torch.Size([1, 905, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2943873405456543  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.33905792236328125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 905, 128])
m.shape torch.Size([817, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34174299240112305  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34174299240112305  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34252214431762695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3884291648864746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([816, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3915414810180664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3915414810180664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 816, 128]), torch.Size([1, 816, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3923196792602539  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4434385299682617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 816, 128])
m.shape torch.Size([11844, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4995260238647461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4995260238647461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 11844, 128]), torch.Size([1, 11844, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5108213424682617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3381948471069336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 11844, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2654709815979004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.285022258758545  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3045735359191895  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2848691940307617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([20501, 256])
first layer input nodes number: 68936
first layer output nodes number: 20501
edges number: 160351
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3050894737243652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3246407508850098  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3304800987243652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3304800987243652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([438, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3522396087646484  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3522396087646484  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3530750274658203  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.362039566040039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([374, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3623409271240234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3623409271240234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3630542755126953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3737602233886719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([294, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.374251365661621  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.374251365661621  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.374812126159668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.387929916381836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([224, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3885107040405273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3885107040405273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3889379501342773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4013280868530273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([213, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4021916389465332  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4021916389465332  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4025979042053223  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4172234535217285  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([138, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.417816162109375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.417816162109375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4180793762207031  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4293975830078125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([143, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4302282333374023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4302282333374023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4305009841918945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.444138526916504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4448943138122559  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4448943138122559  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.445115566253662  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4577269554138184  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([97, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4584555625915527  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4584555625915527  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4586405754089355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4704813957214355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4711389541625977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4711389541625977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.471287727355957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4818506240844727  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4825167655944824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4825167655944824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4826502799987793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4930644035339355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.49381685256958  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.49381685256958  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4939522743225098  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5054631233215332  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5060577392578125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5060577392578125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5061588287353516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5154590606689453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([46, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5160279273986816  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5160279273986816  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.516115665435791  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5248017311096191  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.525406837463379  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.525406837463379  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5254926681518555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534590721130371  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534994125366211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.534994125366211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5350494384765625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.541299819946289  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5417790412902832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5417790412902832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5418381690979004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.548933506011963  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549354076385498  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549354076385498  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5494036674499512  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555701732635498  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.55596923828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.55596923828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.555999755859375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.560089111328125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5604777336120605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5604777336120605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5605177879333496  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5661654472351074  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.566549301147461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.566549301147461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5665874481201172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5722332000732422  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5724892616271973  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5724892616271973  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5725140571594238  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.576357364654541  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5766105651855469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5766105651855469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5766334533691406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5803413391113281  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5807223320007324  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5807223320007324  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5807547569274902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5862345695495605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([257, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5923938751220703  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5923938751220703  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5928840637207031  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6848688125610352  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 257, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6662144660949707  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6666383743286133  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6670622825622559  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6666169166564941  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 20501
output nodes number: 2842
edges number: 22067
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6667914390563965  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6667919158935547  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04864358901977539  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 23 input nodes size: 71198
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04475259780883789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07870244979858398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07872390747070312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045499324798583984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04693174362182617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04693174362182617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04693174362182617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([71198, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04693174362182617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([848, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12988758087158203  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12988758087158203  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 848, 128]), torch.Size([1, 848, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13069629669189453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13716602325439453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 848, 128])
m.shape torch.Size([1121, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13831186294555664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13831186294555664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13938093185424805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15541696548461914  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([1154, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15673255920410156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15673255920410156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1154, 128]), torch.Size([1, 1154, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15783309936523438  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18204498291015625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1154, 128])
m.shape torch.Size([1126, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18364238739013672  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18364238739013672  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1126, 128]), torch.Size([1, 1126, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18471622467041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21600627899169922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1126, 128])
m.shape torch.Size([1100, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2180919647216797  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2180919647216797  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21914100646972656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2575550079345703  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1036, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2599945068359375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2599945068359375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2609825134277344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3037376403808594  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([918, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3063077926635742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3063077926635742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30718326568603516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3516225814819336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([866, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3544883728027344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3544883728027344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 866, 128]), torch.Size([1, 866, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3553142547607422  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.403350830078125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 866, 128])
m.shape torch.Size([795, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40634965896606445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40634965896606445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 795, 128]), torch.Size([1, 795, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4071078300476074  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4556307792663574  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 795, 128])
m.shape torch.Size([12550, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5157985687255859  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5157985687255859  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12550, 128]), torch.Size([1, 12550, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5277671813964844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3782453536987305  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12550, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3016281127929688  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3221454620361328  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3426628112792969  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3219847679138184  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21514, 256])
first layer input nodes number: 71198
first layer output nodes number: 21514
edges number: 168781
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3431954383850098  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3637127876281738  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3688421249389648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3688421249389648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([415, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3918609619140625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3918609619140625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3926525115966797  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3989849090576172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3992681503295898  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3992681503295898  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3999414443969727  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4105257987976074  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([309, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4110803604125977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4110803604125977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4116697311401367  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4264030456542969  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([216, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4269390106201172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4269390106201172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4273509979248047  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4392986297607422  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([198, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4400444030761719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4400444030761719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4404220581054688  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4540176391601562  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.454665184020996  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.454665184020996  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.454941749572754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4668340682983398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([122, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4675168991088867  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4675168991088867  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4677495956420898  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.479384422302246  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([107, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4800910949707031  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4800910949707031  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.480295181274414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4919281005859375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([99, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4926824569702148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4926824569702148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4928712844848633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5049562454223633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([87, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5056982040405273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5056982040405273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.505864143371582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5176458358764648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([74, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5183453559875488  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5183453559875488  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.518486499786377  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5294957160949707  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5301518440246582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5301518440246582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5302720069885254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5404858589172363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.541125774383545  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.541125774383545  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5412325859069824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5510592460632324  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([49, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5516653060913086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5516653060913086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5517587661743164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5610113143920898  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5615992546081543  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5615992546081543  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.561683177947998  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5705790519714355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.570937156677246  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.570937156677246  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5709867477416992  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5765905380249023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5771379470825195  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5771379470825195  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.577204704284668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5852155685424805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5855631828308105  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5855631828308105  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5856051445007324  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5909342765808105  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5913519859313965  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5913519859313965  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591397762298584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.597531795501709  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.597989559173584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.597989559173584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5980372428894043  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6047606468200684  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.605100154876709  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.605100154876709  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6051344871520996  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.610215663909912  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.610579490661621  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.610579490661621  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6106138229370117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6159353256225586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6161837577819824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6161837577819824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6162066459655762  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6199145317077637  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6204109191894531  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6204109191894531  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.620452880859375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6275444030761719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([303, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6348042488098145  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6348042488098145  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6353821754455566  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.747797966003418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 303, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.727828025817871  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7282519340515137  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7286758422851562  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7282304763793945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21514
output nodes number: 2842
edges number: 23403
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7284126281738281  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7284131050109863  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049584388732910156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 24 input nodes size: 70723
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045499324798583984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045499324798583984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0792226791381836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07924413681030273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0452728271484375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046713829040527344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046713829040527344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046713829040527344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([70723, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046713829040527344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([852, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13001537322998047  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13001537322998047  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 852, 128]), torch.Size([1, 852, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1308279037475586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1373281478881836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 852, 128])
m.shape torch.Size([1075, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13813066482543945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13813066482543945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13915586471557617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15453386306762695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1106, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15637493133544922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15637493133544922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15742969512939453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18118000030517578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1100, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18275070190429688  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18275070190429688  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18379974365234375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21487045288085938  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([1116, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21700668334960938  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21700668334960938  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21807098388671875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2567596435546875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([994, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25907135009765625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25907135009765625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 994, 128]), torch.Size([1, 994, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.26001930236816406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3023719787597656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 994, 128])
m.shape torch.Size([897, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30489206314086914  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30489206314086914  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 897, 128]), torch.Size([1, 897, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30574750900268555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35000038146972656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 897, 128])
m.shape torch.Size([911, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35304784774780273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35304784774780273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35391664505004883  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40435361862182617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([784, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4072837829589844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4072837829589844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 784, 128]), torch.Size([1, 784, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4080314636230469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4559745788574219  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 784, 128])
m.shape torch.Size([12661, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5161476135253906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5161476135253906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12661, 128]), torch.Size([1, 12661, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5282220840454102  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3862309455871582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12661, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3092126846313477  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3297128677368164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3502130508422852  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3295526504516602  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21496, 256])
first layer input nodes number: 70723
first layer output nodes number: 21496
edges number: 169497
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3507423400878906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3712425231933594  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3763675689697266  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3763675689697266  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([437, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.400528907775879  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.400528907775879  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.401362419128418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4084911346435547  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4087724685668945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4087724685668945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4094648361206055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4200592041015625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([285, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4205350875854492  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4205350875854492  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4210786819458008  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4344282150268555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([211, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4349679946899414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4349679946899414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4353704452514648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4470415115356445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([189, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4477486610412598  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4477486610412598  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4481091499328613  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4610867500305176  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([145, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.461742877960205  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.461742877960205  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.462019443511963  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4739117622375488  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([125, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4746146202087402  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4746146202087402  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4748530387878418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.48677396774292  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4876313209533691  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4876313209533691  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4878735542297363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.501680850982666  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5022950172424316  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5022950172424316  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5024571418762207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5128331184387207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([81, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5135307312011719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5135307312011719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5136852264404297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5246543884277344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5252647399902344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5252647399902344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5253887176513672  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5350589752197266  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.535539150238037  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.535539150238037  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5356287956237793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5432486534118652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5436911582946777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5436911582946777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5437655448913574  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5506091117858887  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.551271915435791  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.551271915435791  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5513710975646973  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.561190128326416  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5617752075195312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5617752075195312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.561859130859375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5707550048828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.571251392364502  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.571251392364502  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5713181495666504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5788617134094238  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5793843269348145  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5793843269348145  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.57944917678833  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.587231159210205  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.587752342224121  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.587752342224121  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.587813377380371  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.595564842224121  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.596045970916748  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.596045970916748  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5960993766784668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6032557487487793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.604036808013916  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.604036808013916  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6041169166564941  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6154122352600098  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.615513801574707  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.615513801574707  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6155271530151367  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6175031661987305  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6178350448608398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6178350448608398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6178655624389648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6225957870483398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6228680610656738  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6228680610656738  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6228928565979004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6269097328186035  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6270818710327148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6270818710327148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6270971298217773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6296758651733398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([332, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6376457214355469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6376457214355469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6382789611816406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7535696029663086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 332, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7324533462524414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.732877254486084  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7333011627197266  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7328557968139648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21496
output nodes number: 2842
edges number: 23693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7330374717712402  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7330379486083984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04937267303466797  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 25 input nodes size: 69768
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0452728271484375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0452728271484375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07854080200195312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07856225967407227  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044817447662353516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046205997467041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046205997467041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046205997467041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([69768, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046205997467041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([809, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12672090530395508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12672090530395508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12749242782592773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13366460800170898  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([1141, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1343669891357422  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1343669891357422  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13545513153076172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15253353118896484  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1079, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1535329818725586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1535329818725586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1079, 128]), torch.Size([1, 1079, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15456199645996094  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1772003173828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1079, 128])
m.shape torch.Size([1089, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17876291275024414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17876291275024414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17980146408081055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21077585220336914  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([1090, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21285533905029297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21285533905029297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1090, 128]), torch.Size([1, 1090, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21389484405517578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25244712829589844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1090, 128])
m.shape torch.Size([1043, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2549114227294922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2549114227294922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2559061050415039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2990407943725586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([947, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30170440673828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30170440673828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30260753631591797  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3477640151977539  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([874, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3506464958190918  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3506464958190918  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 874, 128]), torch.Size([1, 874, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35148000717163086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39920949935913086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 874, 128])
m.shape torch.Size([735, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.401947021484375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.401947021484375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 735, 128]), torch.Size([1, 735, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4026479721069336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.44887828826904297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 735, 128])
m.shape torch.Size([12072, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5060915946960449  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5060915946960449  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12072, 128]), torch.Size([1, 12072, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5176043510437012  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.34736967086792  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12072, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.273047924041748  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2929596900939941  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3128714561462402  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2928037643432617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([20879, 256])
first layer input nodes number: 69768
first layer output nodes number: 20879
edges number: 163348
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3133935928344727  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3333053588867188  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.338719367980957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.338719367980957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([393, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3612346649169922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3612346649169922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3619842529296875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.370269775390625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([390, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3706450462341309  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3706450462341309  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3713889122009277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3861947059631348  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([292, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.386664867401123  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.386664867401123  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3872218132019043  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4001131057739258  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([247, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4007844924926758  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4007844924926758  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4012556076049805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4149179458618164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4156103134155273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4156103134155273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4159784317016602  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4292306900024414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([176, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4300847053527832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4300847053527832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4304203987121582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4448552131652832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([137, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4456090927124023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4456090927124023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4458703994750977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4589357376098633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([99, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.459566593170166  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.459566593170166  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4597554206848145  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4705185890197754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4711251258850098  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4711251258850098  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4712796211242676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4811673164367676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([76, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4818205833435059  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4818205833435059  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4819655418395996  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4922575950622559  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4929571151733398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4929571151733398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4930963516235352  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5039567947387695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5046024322509766  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5046024322509766  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.504720687866211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5147724151611328  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5152382850646973  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5152382850646973  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5153183937072754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.522688388824463  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5231194496154785  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5231194496154785  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.523186206817627  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5297951698303223  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5303387641906738  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5303387641906738  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5304150581359863  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5385022163391113  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5390639305114746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5390639305114746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5391383171081543  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.547544002532959  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5479316711425781  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5479316711425781  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5479812622070312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5539321899414062  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.554288387298584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.554288387298584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5543303489685059  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.559659481048584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.560150146484375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.560150146484375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5602035522460938  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5673599243164062  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5678138732910156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5678138732910156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.567861557006836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5745849609375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5751872062683105  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5751872062683105  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5752463340759277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5839972496032715  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.584390640258789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.584390640258789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5844287872314453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.590341567993164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.590632438659668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.590632438659668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5906591415405273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.594985008239746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5953178405761719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5953178405761719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.595346450805664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6001815795898438  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([286, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.607039451599121  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.607039451599121  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6075849533081055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7055377960205078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 286, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6860628128051758  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6864867210388184  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.686910629272461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6864652633666992  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 20879
output nodes number: 2842
edges number: 22898
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6866426467895508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.686643123626709  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.048786163330078125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 26 input nodes size: 71884
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044817447662353516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.044817447662353516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07909440994262695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0791158676147461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04582643508911133  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04729509353637695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04729509353637695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04729509353637695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([71884, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04729509353637695  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([807, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13230133056640625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13230133056640625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1330709457397461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13922786712646484  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([1026, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1403183937072754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1403183937072754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1412968635559082  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1559739112854004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([1165, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1571512222290039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1571512222290039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1582622528076172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18270492553710938  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([1106, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18425893783569336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18425893783569336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18531370162963867  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21633481979370117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([1041, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21828937530517578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21828937530517578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2192821502685547  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2555670738220215  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([1038, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2580404281616211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2580404281616211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2590303421020508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30230236053466797  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([911, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30484819412231445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30484819412231445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 911, 128]), torch.Size([1, 911, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30571699142456055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3495917320251465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 911, 128])
m.shape torch.Size([952, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35278892517089844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35278892517089844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 952, 128]), torch.Size([1, 952, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3536968231201172  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40544700622558594  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 952, 128])
m.shape torch.Size([820, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4085121154785156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4085121154785156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 820, 128]), torch.Size([1, 820, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40929412841796875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.46072912216186523  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 820, 128])
m.shape torch.Size([12945, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5228381156921387  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5228381156921387  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12945, 128]), torch.Size([1, 12945, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5351834297180176  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4278006553649902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12945, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3491029739379883  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.369903564453125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3907041549682617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3697409629821777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21811, 256])
first layer input nodes number: 71884
first layer output nodes number: 21811
edges number: 173034
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3912420272827148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4120426177978516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4172430038452148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4172430038452148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([406, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4413790702819824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4413790702819824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4421534538269043  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4498062133789062  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([374, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4501380920410156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4501380920410156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4508514404296875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4618167877197266  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([282, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4622735977172852  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4622735977172852  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4628114700317383  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4764738082885742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([209, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4770088195800781  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4770088195800781  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.477407455444336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4889678955078125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4896965026855469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4896965026855469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4900646209716797  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.503316879272461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([141, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.503946304321289  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.503946304321289  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5042152404785156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5157794952392578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([136, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5165600776672363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5165600776672363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5168194770812988  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5297894477844238  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5305519104003906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5305519104003906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5307731628417969  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5433845520019531  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([91, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5440611839294434  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5440611839294434  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5442347526550293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5553431510925293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([98, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5561985969543457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5561985969543457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5563855171203613  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5696568489074707  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([61, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5702085494995117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5702085494995117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5703248977661133  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5794000625610352  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([65, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.580091953277588  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.580091953277588  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5802159309387207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5907540321350098  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591416835784912  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.591416835784912  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5915274620056152  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6017050743103027  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6020536422729492  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6020536422729492  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6021108627319336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6077756881713867  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6083097457885742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6083097457885742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.608384132385254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6162691116333008  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6166934967041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6166934967041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.616750717163086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6232166290283203  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6235804557800293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6235804557800293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6236262321472168  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6291193962097168  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.629563808441162  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.629563808441162  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.629615306854248  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.636155605316162  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6365866661071777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6365866661071777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.636634349822998  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.64302396774292  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6435003280639648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6435003280639648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.643549919128418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6505422592163086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6510019302368164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6510019302368164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.651047706604004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.657822608947754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6582016944885254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6582016944885254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6582379341125488  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6638550758361816  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.664146900177002  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.664146900177002  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6641736030578613  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.66849946975708  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6689705848693848  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6689705848693848  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6690106391906738  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6757798194885254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([333, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6837615966796875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6837615966796875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.684396743774414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.798387050628662  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 333, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7772674560546875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.77769136428833  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7781152725219727  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.777669906616211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21811
output nodes number: 2842
edges number: 23978
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7778539657592773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7778544425964355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04999971389770508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 27 input nodes size: 71014
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04582643508911133  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04582643508911133  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07968854904174805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07971000671386719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04541158676147461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046831607818603516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046831607818603516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046831607818603516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([71014, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046831607818603516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([863, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12937116622924805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12937116622924805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 863, 128]), torch.Size([1, 863, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13019418716430664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1367783546447754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 863, 128])
m.shape torch.Size([1041, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.137359619140625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.137359619140625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1383523941040039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1532440185546875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([1165, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1544346809387207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1544346809387207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15554571151733398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17998838424682617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([1104, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18153858184814453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18153858184814453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18259143829345703  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21358776092529297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([1014, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21547889709472656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21547889709472656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1014, 128]), torch.Size([1, 1014, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2164459228515625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25223255157470703  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1014, 128])
m.shape torch.Size([1047, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2547445297241211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2547445297241211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1047, 128]), torch.Size([1, 1047, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25574302673339844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2993640899658203  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1047, 128])
m.shape torch.Size([990, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3021693229675293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3021693229675293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 990, 128]), torch.Size([1, 990, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3031134605407715  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3517632484436035  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 990, 128])
m.shape torch.Size([929, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35483503341674805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35483503341674805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 929, 128]), torch.Size([1, 929, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35572099685668945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40630102157592773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 929, 128])
m.shape torch.Size([823, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4093899726867676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4093899726867676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4101748466491699  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.46158790588378906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([12342, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5200467109680176  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5200467109680176  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12342, 128]), torch.Size([1, 12342, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5318169593811035  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.367504596710205  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12342, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.29130220413208  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3116326332092285  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.331963062286377  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3114733695983887  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21318, 256])
first layer input nodes number: 71014
first layer output nodes number: 21318
edges number: 167397
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3324942588806152  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3528246879577637  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.358452320098877  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.358452320098877  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([403, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3812198638916016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3812198638916016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.381988525390625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3886299133300781  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([353, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3889245986938477  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3889245986938477  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3895978927612305  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4018573760986328  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([291, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.402359962463379  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.402359962463379  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4029150009155273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4203910827636719  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([245, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.421055793762207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.421055793762207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.421523094177246  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.435074806213379  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([179, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4357013702392578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4357013702392578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4360427856445312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.448333740234375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([169, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4491376876831055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4491376876831055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4494600296020508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4633207321166992  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4641284942626953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4641284942626953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4644031524658203  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4781360626220703  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([111, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4788522720336914  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4788522720336914  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4790639877319336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4911317825317383  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4917874336242676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4917874336242676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.491955280303955  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.502697467803955  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([89, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5034689903259277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5034689903259277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.503638744354248  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5156912803649902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([65, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.516294002532959  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.516294002532959  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5164179801940918  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5260882377624512  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([63, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5267529487609863  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5267529487609863  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5268731117248535  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5370869636535645  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5376644134521484  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5376644134521484  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5377616882324219  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5467109680175781  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([59, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5474562644958496  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5474562644958496  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5475687980651855  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5587096214294434  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5591435432434082  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5591435432434082  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5592083930969238  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.56608247756958  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5666499137878418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5666499137878418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5667243003845215  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5751299858093262  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5755505561828613  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5755505561828613  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.57560396194458  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.58201265335083  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.582470417022705  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.582470417022705  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5825238227844238  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.589306354522705  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5896997451782227  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5896997451782227  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5897436141967773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5956220626831055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5959463119506836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5959463119506836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5959806442260742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6008214950561523  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6013293266296387  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6013293266296387  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6013789176940918  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6087183952331543  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609158992767334  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609158992767334  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6092009544372559  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6157050132751465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6160602569580078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6160602569580078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6160926818847656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6213455200195312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.621629238128662  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.621629238128662  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6216540336608887  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6258444786071777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([284, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6326560974121094  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6326560974121094  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6331977844238281  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7464818954467773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7267680168151855  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7271919250488281  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7276158332824707  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.727170467376709  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21318
output nodes number: 2842
edges number: 23153
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.727351188659668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7273516654968262  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049463748931884766  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 28 input nodes size: 70773
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04541158676147461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04541158676147461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07915878295898438  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07918024063110352  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045296669006347656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046718597412109375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046718597412109375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046718597412109375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([70773, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046718597412109375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([789, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12921953201293945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12921953201293945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12997198104858398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13599157333374023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([1078, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1366434097290039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1366434097290039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1078, 128]), torch.Size([1, 1078, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13767147064208984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1530923843383789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1078, 128])
m.shape torch.Size([1118, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15423011779785156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15423011779785156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1118, 128]), torch.Size([1, 1118, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15529632568359375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1790924072265625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1118, 128])
m.shape torch.Size([1116, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18068790435791016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18068790435791016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1116, 128]), torch.Size([1, 1116, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18175220489501953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21299076080322266  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1116, 128])
m.shape torch.Size([1075, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21502161026000977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21502161026000977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21604681015014648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2532062530517578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([923, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25533437728881836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25533437728881836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25621461868286133  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29469728469848633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([923, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29733800888061523  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29733800888061523  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2982182502746582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3430023193359375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([823, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3457016944885254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3457016944885254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 823, 128]), torch.Size([1, 823, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34648656845092773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3924221992492676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 823, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3954157829284668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3954157829284668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39616823196411133  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.44522666931152344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([12565, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5053973197937012  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5053973197937012  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12565, 128]), torch.Size([1, 12565, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5173802375793457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3690481185913086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12565, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.292684555053711  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.312901496887207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3331184387207031  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3127431869506836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21199, 256])
first layer input nodes number: 70773
first layer output nodes number: 21199
edges number: 167472
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3336477279663086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3538646697998047  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.359856128692627  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.359856128692627  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([388, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3826403617858887  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3826403617858887  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.38338041305542  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.389474868774414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([403, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3898797035217285  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3898797035217285  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.390648365020752  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.402402400970459  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([295, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4028687477111816  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4028687477111816  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4034314155578613  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4184088706970215  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([233, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4190235137939453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4190235137939453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4194679260253906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4323558807373047  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([186, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.433027744293213  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.433027744293213  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.433382511138916  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4461541175842285  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([146, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4468188285827637  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4468188285827637  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4470973014831543  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4590716361999512  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([138, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4598612785339355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4598612785339355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4601244926452637  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.47328519821167  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([103, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4739456176757812  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4739456176757812  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.474142074584961  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4853401184082031  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4860553741455078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4860553741455078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4862346649169922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4977092742919922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([79, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4983792304992676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4983792304992676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4985299110412598  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.509228229522705  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([70, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5098934173583984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5098934173583984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5100269317626953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5204410552978516  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5210318565368652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5210318565368652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5211405754089355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.530381679534912  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([58, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5310521125793457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5310521125793457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5311627388000488  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5413403511047363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5416622161865234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5416622161865234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5417156219482422  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5470027923583984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5476107597351074  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5476107597351074  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5476946830749512  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5565905570983887  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.557194709777832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.557194709777832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5572748184204102  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5663270950317383  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.566810131072998  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.566810131072998  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.566871166229248  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.574195384979248  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5747013092041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5747013092041016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5747604370117188  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5822696685791016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5826787948608398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5826787948608398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5827245712280273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5888586044311523  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5894126892089844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5894126892089844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5894699096679688  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5975379943847656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.597893238067627  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.597893238067627  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5979294776916504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6032929420471191  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6036977767944336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6036977767944336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6037359237670898  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6096487045288086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609872817993164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609872817993164  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609893798828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6132926940917969  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6136746406555176  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6136746406555176  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6137070655822754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6191868782043457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([294, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.626235008239746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.626235008239746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.626795768737793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7324681282043457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 294, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.712714672088623  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7131385803222656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7135624885559082  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7131171226501465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21199
output nodes number: 2842
edges number: 23183
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.713296890258789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7132973670959473  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04934883117675781  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 29 input nodes size: 70925
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045296669006347656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.045296669006347656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0791163444519043  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07913780212402344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04536914825439453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046790122985839844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046790122985839844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046790122985839844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([70925, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046790122985839844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([851, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1293187141418457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1293187141418457  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 851, 128]), torch.Size([1, 851, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13013029098510742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13662290573120117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 851, 128])
m.shape torch.Size([1080, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13724708557128906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13724708557128906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1382770538330078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15372657775878906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([1123, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15481805801391602  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15481805801391602  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1123, 128]), torch.Size([1, 1123, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15588903427124023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18023967742919922  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1123, 128])
m.shape torch.Size([1113, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18182706832885742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18182706832885742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1113, 128]), torch.Size([1, 1113, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18288850784301758  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21407651901245117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1113, 128])
m.shape torch.Size([1105, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21618032455444336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21618032455444336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21723413467407227  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2557339668273926  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1001, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2580709457397461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2580709457397461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1001, 128]), torch.Size([1, 1001, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25902557373046875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3012709617614746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1001, 128])
m.shape torch.Size([895, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30378103256225586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30378103256225586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 895, 128]), torch.Size([1, 895, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30463457107543945  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34863853454589844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 895, 128])
m.shape torch.Size([828, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35137033462524414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35137033462524414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 828, 128]), torch.Size([1, 828, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3521599769592285  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.39781808853149414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 828, 128])
m.shape torch.Size([818, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40093374252319336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40093374252319336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 818, 128]), torch.Size([1, 818, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40171384811401367  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.45275354385375977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 818, 128])
m.shape torch.Size([12452, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5117392539978027  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5117392539978027  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12452, 128]), torch.Size([1, 12452, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5236144065856934  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3667502403259277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12452, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.2904729843139648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3107538223266602  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3310346603393555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3105950355529785  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21266, 256])
first layer input nodes number: 70925
first layer output nodes number: 21266
edges number: 167134
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3315653800964355  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3518462181091309  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.357001781463623  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.357001781463623  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([434, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.38008451461792  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.38008451461792  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3809123039245605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.387723445892334  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([363, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.388007640838623  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.388007640838623  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.388700008392334  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4006190299987793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([281, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4010834693908691  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4010834693908691  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4016194343566895  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.417121410369873  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([212, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4176688194274902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4176688194274902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4180731773376465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4297995567321777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([193, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.430525302886963  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.430525302886963  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4308934211730957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.444145679473877  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([165, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.444913387298584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.444913387298584  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.445228099822998  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4587607383728027  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.459390640258789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.459390640258789  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4596138000488281  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4707717895507812  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([114, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4715371131896973  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4715371131896973  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.471754550933838  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4841485023498535  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4848012924194336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4848012924194336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.484969139099121  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.495711326599121  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.496396541595459  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.496396541595459  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.496549129486084  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.507382869720459  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([58, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5079197883605957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5079197883605957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5080304145812988  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5166592597961426  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5171809196472168  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5171809196472168  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5172762870788574  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5253825187683105  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5259971618652344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5259971618652344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5260982513427734  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5353984832763672  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5360746383666992  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5360746383666992  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.536177635192871  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5463743209838867  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5469717979431152  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5469717979431152  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5470576286315918  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5561556816101074  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5566511154174805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5566511154174805  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.556717872619629  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5642614364624023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([43, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5649309158325195  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5649309158325195  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5650129318237305  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.574854850769043  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5753850936889648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5753850936889648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5754480361938477  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5834417343139648  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5839037895202637  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5839037895202637  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5839552879333496  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5908560752868652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5913686752319336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5913686752319336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5914220809936523  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.598952293395996  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5994911193847656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5994911193847656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5995445251464844  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6074485778808594  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6078662872314453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6078662872314453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6079063415527344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614114761352539  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614426612854004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614426612854004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.614455223083496  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6190900802612305  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.619399070739746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.619399070739746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6194257736206055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6239385604858398  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([291, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6309175491333008  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6309175491333008  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6314725875854492  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7429275512695312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7229242324829102  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7233481407165527  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7237720489501953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7233266830444336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21266
output nodes number: 2842
edges number: 23451
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7235069274902344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7235074043273926  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04942464828491211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 30 input nodes size: 70301
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04536914825439453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04536914825439453  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07889127731323242  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07891273498535156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04507160186767578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046489715576171875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046489715576171875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046489715576171875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([70301, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.046489715576171875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([845, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1290121078491211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.1290121078491211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 845, 128]), torch.Size([1, 845, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.12981796264648438  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13626480102539062  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 845, 128])
m.shape torch.Size([1021, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13683557510375977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13683557510375977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1021, 128]), torch.Size([1, 1021, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13780927658081055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15241479873657227  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1021, 128])
m.shape torch.Size([1117, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15352582931518555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15352582931518555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1117, 128]), torch.Size([1, 1117, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15459108352661133  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17838335037231445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1117, 128])
m.shape torch.Size([1088, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17992591857910156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.17992591857910156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1088, 128]), torch.Size([1, 1088, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18096351623535156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21190834045410156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1088, 128])
m.shape torch.Size([1073, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21394777297973633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21394777297973633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.21497106552124023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25229549407958984  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([972, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2545647621154785  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2545647621154785  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 972, 128]), torch.Size([1, 972, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2554917335510254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.295351505279541  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 972, 128])
m.shape torch.Size([918, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29795217514038086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.29795217514038086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 918, 128]), torch.Size([1, 918, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2988276481628418  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34337472915649414  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 918, 128])
m.shape torch.Size([883, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34630537033081055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34630537033081055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 883, 128]), torch.Size([1, 883, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34714746475219727  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3959517478942871  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 883, 128])
m.shape torch.Size([802, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3989725112915039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3989725112915039  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 802, 128]), torch.Size([1, 802, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.3997373580932617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.44869136810302734  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 802, 128])
m.shape torch.Size([12460, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5077228546142578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5077228546142578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12460, 128]), torch.Size([1, 12460, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5196056365966797  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3632831573486328  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12460, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.286961555480957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.307159423828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.327357292175293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3070015907287598  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21179, 256])
first layer input nodes number: 70301
first layer output nodes number: 21179
edges number: 167095
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.327883243560791  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.348081111907959  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3532023429870605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3532023429870605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([435, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3759799003601074  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3759799003601074  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3768095970153809  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3835902214050293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([345, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3838386535644531  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3838386535644531  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3844966888427734  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3957619667053223  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([305, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3963127136230469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3963127136230469  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3968944549560547  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.412243366241455  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4128713607788086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4128713607788086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4133272171020508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4265470504760742  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([200, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4272804260253906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4272804260253906  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4276618957519531  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4413948059082031  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([150, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4420695304870605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4420695304870605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4423556327819824  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.454658031463623  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([109, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4552483558654785  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4552483558654785  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.455456256866455  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4658513069152832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.466639518737793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.466639518737793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4668607711791992  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4794721603393555  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([105, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4802699089050293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4802699089050293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4804701805114746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4932875633239746  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([75, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.493908405303955  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.493908405303955  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.494051456451416  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5042080879211426  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([71, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.504887580871582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.504887580871582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5050230026245117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5155858993530273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([58, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5161871910095215  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5161871910095215  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5162978172302246  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5257010459899902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5262832641601562  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5262832641601562  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5263805389404297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.535329818725586  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.535752296447754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.535752296447754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5358190536499023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5424280166625977  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5428128242492676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5428128242492676  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5428681373596191  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5487313270568848  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549118995666504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549118995666504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5491704940795898  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5549898147583008  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5554380416870117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5554380416870117  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5554933547973633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5621309280395508  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5627264976501465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5627264976501465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5627951622009277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5715155601501465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5719199180603027  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5719199180603027  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5719656944274902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5780997276306152  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5785770416259766  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5785770416259766  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5786266326904297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5856189727783203  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5860180854797363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5860180854797363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5860581398010254  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5919861793518066  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5922622680664062  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5922622680664062  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5922889709472656  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5964279174804688  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.596834659576416  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.596834659576416  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5968708992004395  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6027417182922363  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6033005714416504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6033005714416504  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6033482551574707  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6114068031311035  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([298, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6185436248779297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6185436248779297  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6191120147705078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7322959899902344  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 298, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7125892639160156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7130131721496582  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7134370803833008  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.712991714477539  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2842, 40])
input nodes number: 21179
output nodes number: 2842
edges number: 23132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7131710052490234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7131714820861816  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04911088943481445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

pseudo mini batch 31 input nodes size: 71353
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04507160186767578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04507160186767578  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.07909536361694336  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.0791168212890625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.04557323455810547  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.047028541564941406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.047028541564941406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.047028541564941406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([71353, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.047028541564941406  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([782, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13152217864990234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13152217864990234  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 782, 128]), torch.Size([1, 782, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13226795196533203  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13823413848876953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 782, 128])
m.shape torch.Size([1031, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13884449005126953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13884449005126953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.13982772827148438  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15457630157470703  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([1120, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15635919570922852  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15635919570922852  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.15742731094360352  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18123102188110352  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([1137, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18286561965942383  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18286561965942383  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1137, 128]), torch.Size([1, 1137, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.18394994735717773  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2154088020324707  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1137, 128])
m.shape torch.Size([1104, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.217498779296875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.217498779296875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 1104, 128]), torch.Size([1, 1104, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2185516357421875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.2570343017578125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 1104, 128])
m.shape torch.Size([968, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25927734375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.25927734375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.26020050048828125  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.299957275390625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([888, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.302459716796875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.302459716796875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 888, 128]), torch.Size([1, 888, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.30330657958984375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.34654998779296875  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 888, 128])
m.shape torch.Size([889, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.349517822265625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.349517822265625  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 889, 128]), torch.Size([1, 889, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.35036563873291016  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4004554748535156  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 889, 128])
m.shape torch.Size([840, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40363645553588867  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.40363645553588867  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 840, 128]), torch.Size([1, 840, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4044375419616699  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.4571700096130371  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 840, 128])
m.shape torch.Size([12840, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5179953575134277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.5179953575134277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 12840, 128]), torch.Size([1, 12840, 128])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.530240535736084  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4204339981079102  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 12840, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3421697616577148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3627681732177734  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.383366584777832  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3626070022583008  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([21599, 256])
first layer input nodes number: 71353
first layer output nodes number: 21599
edges number: 171368
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.3839001655578613  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.40449857711792  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4099421501159668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4099421501159668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

m.shape torch.Size([396, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4340662956237793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4340662956237793  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.434821605682373  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4417839050292969  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([344, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4420676231384277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4420676231384277  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4427237510681152  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4530110359191895  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([278, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4534850120544434  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4534850120544434  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4540152549743652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4665884971618652  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([239, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4672422409057617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4672422409057617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.467698097229004  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4809179306030273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([218, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4817380905151367  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4817380905151367  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4821538925170898  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4971227645874023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([155, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4978089332580566  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4978089332580566  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.4981045722961426  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.510817050933838  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([121, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5114836692810059  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5114836692810059  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5117144584655762  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5232539176940918  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([113, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.524007797241211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.524007797241211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5242233276367188  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.536508560180664  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([98, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5372486114501953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5372486114501953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.537435531616211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.549398422241211  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([91, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5501799583435059  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5501799583435059  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5503535270690918  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5626769065856934  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5633621215820312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5633621215820312  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5635013580322266  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.574361801147461  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([62, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.575007438659668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.575007438659668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5751256942749023  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5851774215698242  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5856308937072754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5856308937072754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5857090950012207  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5929036140441895  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5932817459106445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5932817459106445  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5933408737182617  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5991945266723633  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([44, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.599799633026123  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.599799633026123  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.5998835563659668  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6087794303894043  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6091837882995605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6091837882995605  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.609239101409912  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6154894828796387  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6159520149230957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6159520149230957  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.61600923538208  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.622875690460205  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6232624053955078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6232624053955078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6233081817626953  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6291217803955078  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6296286582946777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6296286582946777  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6296839714050293  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6370959281921387  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6375107765197754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6375107765197754  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.63755464553833  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.643740177154541  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6441826820373535  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6441826820373535  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6442265510559082  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.650719165802002  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6511626243591309  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6511626243591309  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6512045860290527  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6577086448669434  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.657975196838379  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.657975196838379  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6579999923706055  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6620168685913086  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6624197959899902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6624197959899902  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6624541282653809  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6682562828063965  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([324, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6760244369506836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6760244369506836  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.6766424179077148  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7864184379577637  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

rst.shape  torch.Size([1, 324, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.765305995941162  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7657294273376465  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7661528587341309  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7657079696655273  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

torch.Size([2839, 40])
input nodes number: 21599
output nodes number: 2839
edges number: 23826
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.765890121459961  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 1.7658905982971191  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049709320068359375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049709320068359375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9725341796875 GB
    Memory Allocated: 0.049709320068359375  GigaBytes
Max Memory Allocated: 1.8070106506347656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |Using backend: pytorch

      |0.014131873846054077 |0.0022381022572517395 |0.11856131255626678 |8.891522884368896e-05 |0.0757545605301857 |0.0045680999755859375 |
----------------------------------------------------------pseudo_mini_loss sum 3.0818872451782227
Total (block generation + training)time/epoch 14.253082275390625
Training time/epoch 6.901221990585327
Training time without block to device /epoch 6.8296027183532715
Training time without total dataloading part /epoch 6.2255213260650635
load block tensor time/epoch 0.45221996307373047
block to device time/epoch 0.07161927223205566
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2942371
Number of first layer input nodes during this epoch:  2261402
Number of first layer output nodes during this epoch:  680969
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
